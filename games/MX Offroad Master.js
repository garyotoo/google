window.game = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuLXVzIj4KICA8aGVhZD4KICAgICAgPGJhc2UgaHJlZiA9ICJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvZmFyYWxvbmcvYWxsQG1haW4vbXhvZmZyb2FkLyI+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubyI+CiAgIAogICAgPGxpbmsgcmVsPSJzaG9ydGN1dCBpY29uIiBocmVmPSJUZW1wbGF0ZURhdGEvZmF2aWNvbi5pY28iPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJUZW1wbGF0ZURhdGEvc3R5bGUuY3NzIj4KICA8L2hlYWQ+CiAgPGJvZHkgY2xhc3M9ImRhcmsiPgogICAgICA8aDEgaWQgPSAibG9hZCI+IExvYWRpbmcuLi48L2gxPgogICAgPGRpdiBpZD0idW5pdHktY29udGFpbmVyIiBjbGFzcz0idW5pdHktZGVza3RvcCI+CiAgICAgIDxjYW52YXMgaWQ9InVuaXR5LWNhbnZhcyI+PC9jYW52YXM+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9ImxvYWRpbmctY292ZXIiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4KICAgICAgPGRpdiBpZD0idW5pdHktbG9hZGluZy1iYXIiPgogICAgICAgIDxkaXYgaWQ9InVuaXR5LWxvZ28iPjxpbWcgc3JjPSJsb2dvLnBuZyI+PC9kaXY+CiAgICAgICAgPGRpdiBpZD0idW5pdHktcHJvZ3Jlc3MtYmFyLWVtcHR5IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgPGRpdiBpZD0idW5pdHktcHJvZ3Jlc3MtYmFyLWZ1bGwiPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InNwaW5uZXIiPjwvZGl2PgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0idW5pdHktZnVsbHNjcmVlbi1idXR0b24iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+PC9kaXY+CiAgICA8c2NyaXB0IHNyYyA9ICJqc3ppcC5qcyI+PC9zY3JpcHQ+CiAgICAKICAgIDxzY3JpcHQ+CiAgICAgICAgIAogICAgICAKCiAgICAgIAogICAgICAKICBhc3luYyBmdW5jdGlvbiBmZXRjaEFuZENvbWJpbmVaaXAoYmluVXJscykgewogICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoYmluVXJscy5tYXAodXJsID0+IGZldGNoKHVybCkpKTsKICAgIGNvbnN0IGJ1ZmZlcnMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXNwb25zZXMubWFwKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSkpOwogICAgbGV0IHRvdGFsTGVuZ3RoID0gYnVmZmVycy5yZWR1Y2UoKGFjYywgYnVmKSA9PiBhY2MgKyBidWYuYnl0ZUxlbmd0aCwgMCk7CiAgICBsZXQgY29tYmluZWQgPSBuZXcgVWludDhBcnJheSh0b3RhbExlbmd0aCk7CiAgICBsZXQgb2Zmc2V0ID0gMDsKICAgIGZvciAobGV0IGJ1ZiBvZiBidWZmZXJzKSB7CiAgICAgICAgY29tYmluZWQuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZiksIG9mZnNldCk7CiAgICAgICAgb2Zmc2V0ICs9IGJ1Zi5ieXRlTGVuZ3RoOwogICAgfQogICAgcmV0dXJuIGNvbWJpbmVkOwp9Cgphc3luYyBmdW5jdGlvbiB1bnppcFdlYnBGcm9tRXh0ZXJuYWxCaW5zKGJpblVybHMpIHsKICAgIGNvbnN0IGJsb2JVcmxzID0ge307CiAgICBjb25zdCBieXRlcyA9IGF3YWl0IGZldGNoQW5kQ29tYmluZVppcChiaW5VcmxzKTsKICAgIGNvbnN0IHppcCA9IGF3YWl0IEpTWmlwLmxvYWRBc3luYyhieXRlcyk7CiAgICBmb3IgKGNvbnN0IFtmaWxlbmFtZSwgZmlsZV0gb2YgT2JqZWN0LmVudHJpZXMoemlwLmZpbGVzKSkgewogICAgICAgIGlmICghZmlsZS5kaXIpIHsKICAgICAgICAgICAgbGV0IG1pbWUgPSAnJzsKICAgICAgICAgICAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuanMnKSB8fCBmaWxlbmFtZS5lbmRzV2l0aCgnLm1qcycpKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ3RleHQvamF2YXNjcmlwdCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5jc3MnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICd0ZXh0L2Nzcyc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5odG1sJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAndGV4dC9odG1sJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLndlYnAnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICdpbWFnZS93ZWJwJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLnBuZycpKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ2ltYWdlL3BuZyc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5qcGcnKSB8fCBmaWxlbmFtZS5lbmRzV2l0aCgnLmpwZWcnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICdpbWFnZS9qcGVnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCByYXdCbG9iID0gYXdhaXQgZmlsZS5hc3luYygiYmxvYiIpOwogICAgICAgICAgICBjb25zdCBibG9iID0gbWltZSA/IG5ldyBCbG9iKFtyYXdCbG9iXSwgeyB0eXBlOiBtaW1lIH0pIDogcmF3QmxvYjsKICAgICAgICAgICAgY29uc3QgYmxvYlVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFeHRyYWN0ZWQ6IiwgZmlsZW5hbWUpOwogICAgICAgICAgICBibG9iVXJsc1tmaWxlbmFtZV0gPSBibG9iVXJsOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBibG9iVXJsczsKfQoKbGV0IGJsb2JVcmxzcyA9ICIiOwpsZXQgYmluUGFydHMgPSBbCiAgInBhcnRzLTEuYmluIiwKICAicGFydHMtMi5iaW4iLAogICJwYXJ0cy0zLmJpbiIsCiAgInBhcnRzLTQuYmluIiwKICAicGFydHMtNS5iaW4iLAogICJwYXJ0cy02LmJpbiIsCl07Cgp1bnppcFdlYnBGcm9tRXh0ZXJuYWxCaW5zKGJpblBhcnRzKS50aGVuKGJsb2JVcmxzID0+IHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2FkIikucmVtb3ZlKCkKICAgIGJsb2JVcmxzcyA9IGJsb2JVcmxzOwogICAgY29uc3QgT1JJR0lOQUxfQ1JFQVRFX0VMRU1FTlQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50OwogICAgY29uc3QgT1JJR0lOQUxfU0VUX0FUVFJJQlVURSA9IEVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZTsKCiAgICAKICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbih0YWdOYW1lKSB7CiAgICAgICAgY29uc3QgZWwgPSBPUklHSU5BTF9DUkVBVEVfRUxFTUVOVC5jYWxsKHRoaXMsIHRhZ05hbWUpOwoKICAgICAgICBpZiAodGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc2NyaXB0JykgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICdzcmMnLCB7CiAgICAgICAgICAgICAgICBzZXQobmV3U3JjKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBleHRyYWN0RmlsZW5hbWUobmV3U3JjKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IGJsb2JVcmxzc1tmaWxlbmFtZV07CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBPUklHSU5BTF9TRVRfQVRUUklCVVRFLmNhbGwoZWwsICdzcmMnLCByZXBsYWNlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgT1JJR0lOQUxfU0VUX0FUVFJJQlVURS5jYWxsKGVsLCAnc3JjJywgbmV3U3JjKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZ2V0KCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5nZXRBdHRyaWJ1dGUoJ3NyYycpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBlbDsKICAgIH07CgogICAgCiAgICBFbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAgIGlmICh0aGlzLnRhZ05hbWUgPT09ICdTQ1JJUFQnICYmIG5hbWUgPT09ICdzcmMnKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZXh0cmFjdEZpbGVuYW1lKHZhbHVlKTsKICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBibG9iVXJsc3NbZmlsZW5hbWVdOwogICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQpIHsKICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmV0dXJuIE9SSUdJTkFMX1NFVF9BVFRSSUJVVEUuY2FsbCh0aGlzLCBuYW1lLCByZXBsYWNlbWVudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBPUklHSU5BTF9TRVRfQVRUUklCVVRFLmNhbGwodGhpcywgbmFtZSwgdmFsdWUpOwogICAgfTsKCiAgICBmdW5jdGlvbiBleHRyYWN0RmlsZW5hbWUodXJsKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBVUkwodXJsLCBsb2NhdGlvbi5ocmVmKS5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICByZXR1cm4gdXJsLnNwbGl0KCcvJykucG9wKCk7IAogICAgICAgIH0KICAgIH0KCgpjb25zdCBpbWFnZVNyY0Rlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEltYWdlLnByb3RvdHlwZSwgJ3NyYycpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2UucHJvdG90eXBlLCAnc3JjJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBpbWFnZVNyY0Rlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogaW1hZ2VTcmNEZXNjcmlwdG9yLmdldCwKICBjb25maWd1cmFibGU6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKfSk7CgoKY29uc3Qgc2NyaXB0U3JjRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTFNjcmlwdEVsZW1lbnQucHJvdG90eXBlLCAnc3JjJyk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShIVE1MU2NyaXB0RWxlbWVudC5wcm90b3R5cGUsICdzcmMnLCB7CiAgc2V0KHZhbHVlKSB7CiAgICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHZhbHVlKTsKICAgIHNjcmlwdFNyY0Rlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogc2NyaXB0U3JjRGVzY3JpcHRvci5nZXQsCiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGVudW1lcmFibGU6IHRydWUsCn0pOwoKCmNvbnN0IGxpbmtIcmVmRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTExpbmtFbGVtZW50LnByb3RvdHlwZSwgJ2hyZWYnKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KEhUTUxMaW5rRWxlbWVudC5wcm90b3R5cGUsICdocmVmJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBsaW5rSHJlZkRlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogbGlua0hyZWZEZXNjcmlwdG9yLmdldCwKICBjb25maWd1cmFibGU6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKfSk7CgoKY29uc3QgbWVkaWFTcmNEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsICdzcmMnLCB7CiAgc2V0KHZhbHVlKSB7CiAgICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHZhbHVlKTsKICAgIG1lZGlhU3JjRGVzY3JpcHRvci5zZXQuY2FsbCh0aGlzLCBuZXdVUkwpOwogIH0sCiAgZ2V0OiBtZWRpYVNyY0Rlc2NyaXB0b3IuZ2V0LAogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlLAp9KTsKCi8vIGZldGNoCmNvbnN0IG9yaWdpbmFsRmV0Y2ggPSB3aW5kb3cuZmV0Y2g7CndpbmRvdy5mZXRjaCA9IGZ1bmN0aW9uKHJlc291cmNlLCBpbml0KSB7CgogIGlmICh0eXBlb2YgcmVzb3VyY2UgPT09ICJzdHJpbmciKSB7CiAgLy9jb25zb2xlLmxvZyhyZXNvdXJjZSkKICAgIHJlc291cmNlID0gcmV3cml0ZVVSTChyZXNvdXJjZSk7CiAgfSBlbHNlIGlmIChyZXNvdXJjZSBpbnN0YW5jZW9mIFJlcXVlc3QpIHsKICAgIHJlc291cmNlID0gbmV3IFJlcXVlc3QocmV3cml0ZVVSTChyZXNvdXJjZS51cmwpLCByZXNvdXJjZSk7CiAgfQogIHJldHVybiBvcmlnaW5hbEZldGNoLmNhbGwodGhpcywgcmVzb3VyY2UsIGluaXQpOwp9OwoKLy8gWE1MSHR0cFJlcXVlc3QKY29uc3Qgb3JpZ2luYWxPcGVuID0gWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW47ClhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24obWV0aG9kLCB1cmwsIC4uLnJlc3QpIHsKICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHVybCk7CiAgcmV0dXJuIG9yaWdpbmFsT3Blbi5jYWxsKHRoaXMsIG1ldGhvZCwgbmV3VVJMLCAuLi5yZXN0KTsKfTsKCgpjb25zdCBPcmlnaW5hbEF1ZGlvID0gd2luZG93LkF1ZGlvOwp3aW5kb3cuQXVkaW8gPSBmdW5jdGlvbihzcmMpIHsKICBjb25zdCBhdWRpbyA9IG5ldyBPcmlnaW5hbEF1ZGlvKCk7CiAgaWYgKHNyYykgewogICAgYXVkaW8uc3JjID0gcmV3cml0ZVVSTChzcmMpOwogIH0KICByZXR1cm4gYXVkaW87Cn07CndpbmRvdy5BdWRpby5wcm90b3R5cGUgPSBPcmlnaW5hbEF1ZGlvLnByb3RvdHlwZTsKCgpmdW5jdGlvbiByZXdyaXRlVVJMKG9yaWdpbmFsKSB7CiAgdmFyIHRyaW1tZWQgPSBvcmlnaW5hbC5zcGxpdCgiLyIpLnBvcCgpOwogIC8vY29uc29sZS5sb2codHJpbW1lZCkKICBpZiAodHJpbW1lZC5pbmNsdWRlcygiPyIpKSB0cmltbWVkID0gdHJpbW1lZC5zcGxpdCgiPyIpWzBdCiAgcmV0dXJuIGJsb2JVcmxzc1t0cmltbWVkXSB8fCBvcmlnaW5hbDsKfQogICAgICAgIAogICAgICBjb25zdCBoaWRlRnVsbFNjcmVlbkJ1dHRvbiA9ICIxIjsKICAgICAgY29uc3QgYnVpbGRVcmwgPSAiQnVpbGQiOwogICAgICBjb25zdCBsb2FkZXJVcmwgPSBidWlsZFVybCArICIvTVhPZmZyb2FkTWFzdGVydjE1LmxvYWRlcnIuanMiOwogICAgICBjb25zdCBjb25maWcgPSB7CiAgICAgICAgZGF0YVVybDogYnVpbGRVcmwgKyAiL01YT2Zmcm9hZE1hc3RlcnYxNS5kYXRhLnVuaXR5d2ViIiwKICAgICAgICBmcmFtZXdvcmtVcmw6IGJ1aWxkVXJsICsgIi9NWE9mZnJvYWRNYXN0ZXJ2MTUuZnJhbWV3b3JrLmpzLnVuaXR5d2ViIiwKICAgICAgICBjb2RlVXJsOiBidWlsZFVybCArICIvTVhPZmZyb2FkTWFzdGVydjE1Lndhc20udW5pdHl3ZWIiLAogICAgICAgIHN0cmVhbWluZ0Fzc2V0c1VybDogIlN0cmVhbWluZ0Fzc2V0cyIsCiAgICAgICAgY29tcGFueU5hbWU6ICJSaG0gSW50ZXJhY3RpdmUiLAogICAgICAgIHByb2R1Y3ROYW1lOiAiTVggT2Zmcm9hZCBNYXN0ZXIiLAogICAgICAgIHByb2R1Y3RWZXJzaW9uOiAiMSIsCiAgICAgIH07CgogICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktY29udGFpbmVyIik7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1jYW52YXMiKTsKICAgICAgY29uc3QgbG9hZGluZ0NvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2xvYWRpbmctY292ZXIiKTsKICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJFbXB0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1wcm9ncmVzcy1iYXItZW1wdHkiKTsKICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJGdWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3VuaXR5LXByb2dyZXNzLWJhci1mdWxsIik7CiAgICAgIGNvbnN0IGZ1bGxzY3JlZW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktZnVsbHNjcmVlbi1idXR0b24iKTsKICAgICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGlubmVyJyk7CgogICAgICBjb25zdCBjYW5GdWxsc2NyZWVuID0gKGZ1bmN0aW9uKCkgewogICAgICAgIGZvciAoY29uc3Qga2V5IG9mIFsKICAgICAgICAgICAgJ2V4aXRGdWxsc2NyZWVuJywKICAgICAgICAgICAgJ3dlYmtpdEV4aXRGdWxsc2NyZWVuJywKICAgICAgICAgICAgJ3dlYmtpdENhbmNlbEZ1bGxTY3JlZW4nLAogICAgICAgICAgICAnbW96Q2FuY2VsRnVsbFNjcmVlbicsCiAgICAgICAgICAgICdtc0V4aXRGdWxsc2NyZWVuJywKICAgICAgICAgIF0pIHsKICAgICAgICAgIGlmIChrZXkgaW4gZG9jdW1lbnQpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSgpKTsKCiAgICAgIGlmICgvaVBob25lfGlQYWR8aVBvZHxBbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgewogICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAidW5pdHktbW9iaWxlIjsKICAgICAgICBjb25maWcuZGV2aWNlUGl4ZWxSYXRpbyA9IDE7CiAgICAgIH0KICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmQgPSAidXJsKCciICsgYnVpbGRVcmwgKyAiL01YT2Zmcm9hZE1hc3RlcnYxNS5qcGcnKSBjZW50ZXIgLyBjb3ZlciI7CiAgICAgIGxvYWRpbmdDb3Zlci5zdHlsZS5kaXNwbGF5ID0gIiI7CgogICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgc2NyaXB0LnNyYyA9IGxvYWRlclVybDsKICAgICAgc2NyaXB0Lm9ubG9hZCA9ICgpID0+IHsKICAgICAgICBjcmVhdGVVbml0eUluc3RhbmNlKGNhbnZhcywgY29uZmlnLCAocHJvZ3Jlc3MpID0+IHsKICAgICAgICAgIHNwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIHByb2dyZXNzQmFyRW1wdHkuc3R5bGUuZGlzcGxheSA9ICIiOwogICAgICAgICAgcHJvZ3Jlc3NCYXJGdWxsLnN0eWxlLndpZHRoID0gYCR7MTAwICogcHJvZ3Jlc3N9JWA7CiAgICAgICAgfSkudGhlbigodW5pdHlJbnN0YW5jZSkgPT4gewogICAgICAgICAgbG9hZGluZ0NvdmVyLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICBpZiAoY2FuRnVsbHNjcmVlbikgewogICAgICAgICAgICBpZiAoIWhpZGVGdWxsU2NyZWVuQnV0dG9uKSB7CiAgICAgICAgICAgICAgZnVsbHNjcmVlbkJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVsbHNjcmVlbkJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICAgIHVuaXR5SW5zdGFuY2UuU2V0RnVsbHNjcmVlbigxKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaCgobWVzc2FnZSkgPT4gewogICAgICAgICAgYWxlcnQobWVzc2FnZSk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKfSk7CiAgICA8L3NjcmlwdD4KICA8L2JvZHk+CjwvaHRtbD4K";
