window.game = "PCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KPCFkb2N0eXBlIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQoNCjxoZWFkPg0KICAgIDxiYXNlIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9nZW5penkvd2ViLXBvcnRAbWFpbi95dW1lLW5pa2tpLyI+DQogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4NCiAgICA8dGl0bGU+WXVtZSBOaWtraTwvdGl0bGU+DQogICAgPHN0eWxlPg0KICAgICAgICA6cm9vdCB7DQogICAgICAgICAgICAtLWNvbG9yLWdyYXk6IGhzbCgwLCAwJSwgNTUlKTsNCiAgICAgICAgICAgIC0tY29udHJvbHMtc2l6ZTogMTB2aDsNCiAgICAgICAgfQ0KDQogICAgICAgIEBtZWRpYSAob3JpZW50YXRpb246IGxhbmRzY2FwZSkgew0KICAgICAgICAgICAgOnJvb3Qgew0KICAgICAgICAgICAgICAgIC0tY29udHJvbHMtc2l6ZTogMjB2aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGh0bWwgew0KICAgICAgICAgICAgdG91Y2gtYWN0aW9uOiBub25lOw0KICAgICAgICB9DQoNCiAgICAgICAgYm9keSB7DQogICAgICAgICAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAiU2Vnb2UgVUkiLCBSb2JvdG8sIHNhbnMtc2VyaWYsICJBcHBsZSBDb2xvciBFbW9qaSIsICJTZWdvZSBVSSBFbW9qaSI7DQogICAgICAgICAgICBtYXJnaW46IDA7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiBibGFjazsNCiAgICAgICAgfQ0KDQogICAgICAgIC51bnNlbGVjdGFibGUgew0KICAgICAgICAgICAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOw0KICAgICAgICAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsNCiAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lOw0KICAgICAgICB9DQoNCiAgICAgICAgI3N0YXR1cyB7DQogICAgICAgICAgICBmb250LXNpemU6IDEuNXJlbTsNCiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci1ncmF5KTsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgICNjb250cm9scyB7DQogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICAgICAgICB0ZXh0LWFsaWduOiByaWdodDsNCiAgICAgICAgICAgIHotaW5kZXg6IDEwOw0KICAgICAgICB9DQoNCiAgICAgICAgI2NvbnRyb2xzIGJ1dHRvbiB7DQogICAgICAgICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IGJ1dHRvbjsNCiAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7DQogICAgICAgICAgICBib3JkZXI6IDA7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBmb250LWZhbWlseTogaW5oZXJpdDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMWVtOw0KICAgICAgICAgICAgbGluZS1oZWlnaHQ6IGluaGVyaXQ7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBwYWRkaW5nOiAwLjVyZW07DQogICAgICAgIH0NCg0KICAgICAgICAjY29udHJvbHMgc3ZnIHsNCiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICB9DQoNCiAgICAgICAgI2NhbnZhcyB7DQogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICB0b3A6IDUwJTsNCiAgICAgICAgICAgIGxlZnQ6IDUwJTsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgYm9yZGVyOiAwOw0KICAgICAgICAgICAgaW1hZ2UtcmVuZGVyaW5nOiBwaXhlbGF0ZWQ7DQogICAgICAgICAgICBpbWFnZS1yZW5kZXJpbmc6IGNyaXNwLWVkZ2VzOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7DQogICAgICAgIH0NCg0KICAgICAgICBpbWcjY2FudmFzIHsNCiAgICAgICAgICAgIG9iamVjdC1maXQ6IGNvbnRhaW47DQogICAgICAgIH0NCg0KICAgICAgICAjZHBhZCwNCiAgICAgICAgI2FwYWQgew0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgYm90dG9tOiAxcmVtOw0KICAgICAgICB9DQoNCiAgICAgICAgI2RwYWQgew0KICAgICAgICAgICAgbGVmdDogMXJlbTsNCiAgICAgICAgfQ0KDQogICAgICAgICNhcGFkIHsNCiAgICAgICAgICAgIHJpZ2h0OiAxcmVtOw0KICAgICAgICB9DQoNCiAgICAgICAgI2RwYWQgc3ZnIHsNCiAgICAgICAgICAgIHdpZHRoOiBjYWxjKDIgKiB2YXIoLS1jb250cm9scy1zaXplKSk7DQogICAgICAgICAgICBoZWlnaHQ6IGNhbGMoMiAqIHZhcigtLWNvbnRyb2xzLXNpemUpKTsNCiAgICAgICAgICAgIGZpbGw6IHZhcigtLWNvbG9yLWdyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgI2RwYWQgc3ZnIHJlY3Qgew0KICAgICAgICAgICAgb3BhY2l0eTogMC40Ow0KICAgICAgICB9DQoNCiAgICAgICAgI2FwYWQ+KiB7DQogICAgICAgICAgICB3aWR0aDogdmFyKC0tY29udHJvbHMtc2l6ZSk7DQogICAgICAgICAgICBoZWlnaHQ6IHZhcigtLWNvbnRyb2xzLXNpemUpOw0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItZ3JheSk7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgIH0NCg0KICAgICAgICAjYXBhZD4gOmxhc3QtY2hpbGQgew0KICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgcmlnaHQ6IHZhcigtLWNvbnRyb2xzLXNpemUpOw0KICAgICAgICB9DQoNCiAgICAgICAgI2RwYWQgcGF0aDpub3QoLmFjdGl2ZSksDQogICAgICAgICNhcGFkPio6bm90KC5hY3RpdmUpIHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDAuNDsNCiAgICAgICAgfQ0KICAgICAgICAjb3ZlcmxheSB7DQogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICB0b3A6IDA7IGxlZnQ6IDA7DQogICAgICAgICAgICB3aWR0aDogMTAwdnc7DQogICAgICAgICAgICBoZWlnaHQ6IDEwMHZoOw0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7DQogICAgICAgICAgICB6LWluZGV4OiA5OTk5Ow0KICAgICAgICB9DQogICAgPC9zdHlsZT4NCjwvaGVhZD4NCg0KPGJvZHk+DQogICAgPGRpdiBpZD0ib3ZlcmxheSI+PC9kaXY+DQogICAgPGRpdiBpZD0iY29udHJvbHMiPg0KICAgICAgICA8YnV0dG9uIGlkPSJjb250cm9scy1mdWxsc2NyZWVuIiBjbGFzcz0idW5zZWxlY3RhYmxlIj4NCiAgICAgICAgICAgIDxzdmcgdmlld0JveD0iMCAwIDE1IDE1IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNSIgaGVpZ2h0PSIyNSI+DQogICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjUgMTMuNUgxMG0zLjUgMFYxMG0wIDMuNWwtNC00bS41LThoMy41bTAgMFY1bTAtMy41bC00IDRNNSAxLjVIMS41bTAgMFY1bTAtMy41bDQgNG0tNCA0LjV2My41bTAgMEg1bS0zLjUgMGw0LTQiIHN0cm9rZT0iY3VycmVudENvbG9yIj48L3BhdGg+DQogICAgICAgICAgICA8L3N2Zz4NCiAgICAgICAgPC9idXR0b24+DQogICAgPC9kaXY+DQogICAgPGRpdiBpZD0ic3RhdHVzIj48L2Rpdj4NCiAgICA8ZGl2IGlkPSJ2aWV3cG9ydCI+DQogICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhcyIgdGFiaW5kZXg9Ii0xIiBjbGFzcz0idW5zZWxlY3RhYmxlIj48L2NhbnZhcz4NCiAgICAgICAgPGRpdiBpZD0iZHBhZCIgY2xhc3M9InVuc2VsZWN0YWJsZSI+DQogICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcyIDcyIj4NCiAgICAgICAgICAgICAgICA8cGF0aCBpZD0iZHBhZC11cCIgZGF0YS1rZXk9IkFycm93VXAiIGQ9Ik00OCw1LjhDNDgsMi41LDQ1LjQsMCw0MiwwSDI5LjlDMjYuNiwwLDI0LDIuNCwyNCw1LjhWMjRoMjRWNS44eiIgLz4NCiAgICAgICAgICAgICAgICA8cGF0aCBpZD0iZHBhZC1yaWdodCIgZGF0YS1rZXk9IkFycm93UmlnaHQiIGQ9Ik02Ni4yLDI0SDQ4djI0aDE4LjJjMy4zLDAsNS44LTIuNyw1LjgtNlYyOS45QzcyLDI2LjUsNjkuNSwyNCw2Ni4yLDI0eiIgLz4NCiAgICAgICAgICAgICAgICA8cGF0aCBpZD0iZHBhZC1kb3duIiBkYXRhLWtleT0iQXJyb3dEb3duIiBkPSJNMjQsNjYuM2MwLDMuMywyLjYsNS43LDUuOSw1LjdINDJjMy4zLDAsNi0yLjQsNi01LjdWNDhIMjRWNjYuM3oiIC8+DQogICAgICAgICAgICAgICAgPHBhdGggaWQ9ImRwYWQtbGVmdCIgZGF0YS1rZXk9IkFycm93TGVmdCIgZD0iTTUuNywyNEMyLjQsMjQsMCwyNi41LDAsMjkuOVY0MmMwLDMuMywyLjMsNiw1LjcsNkgyNFYyNEg1Ljd6IiAvPg0KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJkcGFkLWNlbnRlciIgeD0iMjQiIHk9IjI0IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIC8+DQogICAgICAgICAgICA8L3N2Zz4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxkaXYgaWQ9ImFwYWQiIGNsYXNzPSJ1bnNlbGVjdGFibGUiPg0KICAgICAgICAgICAgPGRpdiBpZD0iYXBhZC1lc2NhcGUiIGRhdGEta2V5PSJFc2NhcGUiPjwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBpZD0iYXBhZC1lbnRlciIgZGF0YS1rZXk9IkVudGVyIj48L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQogICAgPHNjcmlwdCBhc3luYyB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaW5kZXguanMiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQ+DQogICAgICAgIGNvbnN0IGhhc1RvdWNoc2NyZWVuID0gd2luZG93Lm1hdGNoTWVkaWEoJyhob3Zlcjogbm9uZSksIChwb2ludGVyOiBjb2Fyc2UpJykubWF0Y2hlczsNCiAgICAgICAgY29uc3QgcHJldmVudE5hdGl2ZUtleXMgPSBbJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0Fycm93UmlnaHQnLCAnQXJyb3dMZWZ0JywgJyAnLCAnRjEyJ107DQogICAgICAgIGNvbnN0IGtleXMgPSBuZXcgTWFwKCk7DQogICAgICAgIGNvbnN0IGtleXNEb3duID0gbmV3IE1hcCgpOw0KICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7DQogICAgICAgIGxldCBlYXN5cnBnUGxheWVyOw0KICAgICAgICBsZXQgbGFzdFRvdWNoZWRJZDsNCiAgICAgICAgLy8gTGF1bmNoIHRoZSBQbGF5ZXIgYW5kIGNvbmZpZ3VyZSBpdA0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4gew0KICAgICAgICAgICAgY3JlYXRlRWFzeVJwZ1BsYXllcih7DQogICAgICAgICAgICAgICAgZ2FtZTogdW5kZWZpbmVkLA0KICAgICAgICAgICAgICAgIHNhdmVGczogdW5kZWZpbmVkDQogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChNb2R1bGUpIHsNCiAgICAgICAgICAgICAgICAvLyBNb2R1bGUgaXMgcmVhZHkNCiAgICAgICAgICAgICAgICBlYXN5cnBnUGxheWVyID0gTW9kdWxlOw0KICAgICAgICAgICAgICAgIGVhc3lycGdQbGF5ZXIuaW5pdEFwaSgpOw0KICAgICAgICAgICAgICAgIGNhbnZhcy5mb2N1cygpOw0KICAgICAgICAgICAgICAgIC8vIEN1c3RvbSBjb2RlIGhlcmUNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgLy8gTWFrZSBFYXN5UlBHIHBsYXllciBlbWJlZGRhYmxlDQogICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gY2FudmFzLmZvY3VzKCkpOw0KICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBjYW52YXMuZm9jdXMoKSk7DQogICAgICAgIC8vIEhhbmRsZSBjbGlja2luZyBvbiB0aGUgZnVsbHNjcmVlbiBidXR0b24NCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbnRyb2xzLWZ1bGxzY3JlZW4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdwb3J0Jyk7DQogICAgICAgICAgICBpZiAodmlld3BvcnQucmVxdWVzdEZ1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICB2aWV3cG9ydC5yZXF1ZXN0RnVsbHNjcmVlbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgLyoqDQogICAgICAgICAqIFNpbXVsYXRlIGEga2V5Ym9hcmQgZXZlbnQgb24gdGhlIGVtc2NyaXB0ZW4gY2FudmFzDQogICAgICAgICAqDQogICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFR5cGUgVHlwZSBvZiB0aGUga2V5Ym9hcmQgZXZlbnQNCiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBLZXkgdG8gc2ltdWxhdGUNCiAgICAgICAgICovDQogICAgICAgIGZ1bmN0aW9uIHNpbXVsYXRlS2V5Ym9hcmRFdmVudChldmVudFR5cGUsIGtleSkgew0KICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgRXZlbnQoZXZlbnRUeXBlLCB7DQogICAgICAgICAgICAgICAgYnViYmxlczogdHJ1ZQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBldmVudC5jb2RlID0ga2V5Ow0KICAgICAgICAgICAgY2FudmFzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOw0KICAgICAgICB9DQogICAgICAgIC8qKg0KICAgICAgICAgKiBTaW11bGF0ZSBhIGtleWJvYXJkIGlucHV0IGZyb20gYGtleWRvd25gIHRvIGBrZXl1cGANCiAgICAgICAgICoNCiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBLZXkgdG8gc2ltdWxhdGUNCiAgICAgICAgICovDQogICAgICAgIGZ1bmN0aW9uIHNpbXVsYXRlS2V5Ym9hcmRJbnB1dChrZXkpIHsNCiAgICAgICAgICAgIHNpbXVsYXRlS2V5Ym9hcmRFdmVudCgna2V5ZG93bicsIGtleSk7DQogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgc2ltdWxhdGVLZXlib2FyZEV2ZW50KCdrZXl1cCcsIGtleSk7DQogICAgICAgICAgICB9LCAxMDApOw0KICAgICAgICB9DQogICAgICAgIC8qKg0KICAgICAgICAgKiBCaW5kIGEgbm9kZSBieSBhIHNwZWNpZmljIGtleSB0byBzaW11bGF0ZSBvbiB0b3VjaA0KICAgICAgICAgKg0KICAgICAgICAgKiBAcGFyYW0geyp9IG5vZGUgVGhlIG5vZGUgdG8gYmluZCBhIGtleSB0bw0KICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IEtleSB0byBzaW11bGF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgZnVuY3Rpb24gYmluZEtleShub2RlLCBrZXkpIHsNCiAgICAgICAgICAgIGtleXMuc2V0KG5vZGUuaWQsIGtleSk7DQogICAgICAgICAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBldmVudCA9PiB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBzaW11bGF0ZUtleWJvYXJkRXZlbnQoJ2tleWRvd24nLCBrZXkpOw0KICAgICAgICAgICAgICAgIGtleXNEb3duLnNldChldmVudC50YXJnZXQuaWQsIG5vZGUuaWQpOw0KICAgICAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBldmVudCA9PiB7DQogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBwcmVzc2VkS2V5ID0ga2V5c0Rvd24uZ2V0KGV2ZW50LnRhcmdldC5pZCk7DQogICAgICAgICAgICAgICAgaWYgKHByZXNzZWRLZXkgJiYga2V5cy5oYXMocHJlc3NlZEtleSkpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5nZXQocHJlc3NlZEtleSk7DQogICAgICAgICAgICAgICAgICAgIHNpbXVsYXRlS2V5Ym9hcmRFdmVudCgna2V5dXAnLCBrZXkpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBrZXlzRG93bi5kZWxldGUoZXZlbnQudGFyZ2V0LmlkKTsNCiAgICAgICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICAgIGlmIChsYXN0VG91Y2hlZElkKSB7DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxhc3RUb3VjaGVkSWQpLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgLy8gSW5zcGlyZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL3B1bHNlamV0L21reHAtd2ViL2Jsb2IvMjYyYTIyNTRiNjg0NTY3MzExYzlmMGUxMzVlZTI5ZjZlOGMzNjEzZS9leHRyYS9qcy9kcGFkLmpzDQogICAgICAgICAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGV2ZW50ID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCB7DQogICAgICAgICAgICAgICAgICAgIHRhcmdldCwNCiAgICAgICAgICAgICAgICAgICAgY2xpZW50WCwNCiAgICAgICAgICAgICAgICAgICAgY2xpZW50WQ0KICAgICAgICAgICAgICAgIH0gPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTsNCiAgICAgICAgICAgICAgICBjb25zdCBvcmlnVGFyZ2V0SWQgPSBrZXlzRG93bi5nZXQodGFyZ2V0LmlkKTsNCiAgICAgICAgICAgICAgICBjb25zdCBuZXh0VGFyZ2V0SWQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGNsaWVudFgsIGNsaWVudFkpLmlkOw0KICAgICAgICAgICAgICAgIGlmIChvcmlnVGFyZ2V0SWQgPT09IG5leHRUYXJnZXRJZCkgcmV0dXJuOw0KICAgICAgICAgICAgICAgIGlmIChvcmlnVGFyZ2V0SWQpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5cy5nZXQob3JpZ1RhcmdldElkKTsNCiAgICAgICAgICAgICAgICAgICAgc2ltdWxhdGVLZXlib2FyZEV2ZW50KCdrZXl1cCcsIGtleSk7DQogICAgICAgICAgICAgICAgICAgIGtleXNEb3duLmRlbGV0ZSh0YXJnZXQuaWQpOw0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcmlnVGFyZ2V0SWQpLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoa2V5cy5oYXMobmV4dFRhcmdldElkKSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBrZXlzLmdldChuZXh0VGFyZ2V0SWQpOw0KICAgICAgICAgICAgICAgICAgICBzaW11bGF0ZUtleWJvYXJkRXZlbnQoJ2tleWRvd24nLCBrZXkpOw0KICAgICAgICAgICAgICAgICAgICBrZXlzRG93bi5zZXQodGFyZ2V0LmlkLCBuZXh0VGFyZ2V0SWQpOw0KICAgICAgICAgICAgICAgICAgICBsYXN0VG91Y2hlZElkID0gbmV4dFRhcmdldElkOw0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChuZXh0VGFyZ2V0SWQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgICAgLyoqIEB0eXBlIHt7W2tleTogbnVtYmVyXTogR2FtZXBhZH19ICovDQogICAgICAgIGxldCBnYW1lcGFkcyA9IHt9Ow0KICAgICAgICBjb25zdCBoYXZlRXZlbnRzID0gJ29uZ2FtZXBhZGNvbm5lY3RlZCcgaW4gd2luZG93Ow0KDQogICAgICAgIGZ1bmN0aW9uIGFkZEdhbWVwYWQoZ2FtZXBhZCkgew0KICAgICAgICAgICAgaWYgKGdhbWVwYWQgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZ2FtZXBhZHNbZ2FtZXBhZC5pbmRleF0gPSBnYW1lcGFkOw0KICAgICAgICAgICAgdXBkYXRlVG91Y2hDb250cm9sc1Zpc2liaWxpdHkoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIHJlbW92ZUdhbWVwYWQoZ2FtZXBhZCkgew0KICAgICAgICAgICAgaWYgKGdhbWVwYWQgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZGVsZXRlIGdhbWVwYWRzW2dhbWVwYWQuaW5kZXhdOw0KICAgICAgICAgICAgdXBkYXRlVG91Y2hDb250cm9sc1Zpc2liaWxpdHkoKTsNCiAgICAgICAgfQ0KICAgICAgICAvKiogQHJldHVybnMge0dhbWVwYWRbXX0gKi8NCiAgICAgICAgZnVuY3Rpb24gZ2V0R2FtZXBhZHMoKSB7DQogICAgICAgICAgICB2YXIgcGFkcyA9IG5hdmlnYXRvci5nZXRHYW1lcGFkcyA/IG5hdmlnYXRvci5nZXRHYW1lcGFkcygpIDogKG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcyA/IG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcygpIDogW10pOw0KICAgICAgICAgICAgcmV0dXJuIHBhZHM7DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBzY2FuR2FtZVBhZHMoKSB7DQogICAgICAgICAgICB2YXIgcGFkcyA9IGdldEdhbWVwYWRzKCk7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhZHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAocGFkc1tpXSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAocGFkc1tpXS5pbmRleCBpbiBnYW1lcGFkcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZXBhZHNbcGFkc1tpXS5pbmRleF0gPSBwYWRzW2ldOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgYWRkR2FtZXBhZChwYWRzW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWhhdmVFdmVudHMpIHsNCiAgICAgICAgICAgIHNldEludGVydmFsKHNjYW5HYW1lUGFkcywgNTAwKTsNCiAgICAgICAgfQ0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZ2FtZXBhZGNvbm5lY3RlZCcsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICBhZGRHYW1lcGFkKGUuZ2FtZXBhZCk7DQogICAgICAgIH0pOw0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZ2FtZXBhZGRpc2Nvbm5lY3RlZCcsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICByZW1vdmVHYW1lcGFkKGUuZ2FtZXBhZCk7DQogICAgICAgIH0pDQoNCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlVG91Y2hDb250cm9sc1Zpc2liaWxpdHkoKSB7DQogICAgICAgICAgICBpZiAoaGFzVG91Y2hzY3JlZW4gJiYgT2JqZWN0LmtleXMoZ2FtZXBhZHMpLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZWxlbSBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZHBhZCwgI2FwYWQnKSkgew0KICAgICAgICAgICAgICAgICAgICBlbGVtLnN0eWxlLmRpc3BsYXkgPSAnJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSB0b3VjaCBzY3JlZW4sIE9SIGFueSBnYW1lcGFkcyBhcmUgY29ubmVjdGVkLi4uDQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBlbGVtIG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNkcGFkLCAjYXBhZCcpKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIEhpZGUgdGhlIHRvdWNoIGNvbnRyb2xzDQogICAgICAgICAgICAgICAgICAgIGVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy8gQmluZCBhbGwgZWxlbWVudHMgcHJvdmlkaW5nIGEgYGRhdGEta2V5YCBhdHRyaWJ1dGUgd2l0aCB0aGUNCiAgICAgICAgLy8gZ2l2ZW4ga2V5IG9uIHRvdWNoLWJhc2VkIGRldmljZXMNCiAgICAgICAgaWYgKGhhc1RvdWNoc2NyZWVuKSB7DQogICAgICAgICAgICBmb3IgKGNvbnN0IGJ1dHRvbiBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1rZXldJykpIHsNCiAgICAgICAgICAgICAgICBiaW5kS2V5KGJ1dHRvbiwgYnV0dG9uLmRhdGFzZXQua2V5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIFByZXZlbnQgc2Nyb2xsaW5nIHdoZW4gcHJlc3Npbmcgc3BlY2lmaWMga2V5cw0KICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHByZXZlbnROYXRpdmVLZXlzLmluY2x1ZGVzKGV2ZW50LmtleSkpIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGV2ZW50ID0+IHsNCiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIC8vIHNpbXVsYXRlS2V5Ym9hcmRJbnB1dCgnRXNjYXBlJywgMjcpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAvLyBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICAgICAgICAvLyAgIHNpbXVsYXRlS2V5Ym9hcmRJbnB1dCgnRW50ZXInLCAxMyk7DQogICAgICAgICAgICAvLyB9KTsNCiAgICAgICAgfQ0KICAgICAgICB1cGRhdGVUb3VjaENvbnRyb2xzVmlzaWJpbGl0eSgpOw0KDQogICAgICAgIGNvbnN0IHh5eiA9ICIwMDAwMDAwNS54eXoiOw0KICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm92ZXJsYXkiKTsNCiAgICAgICAgY29uc3Qgb2d4aHIgPSB3aW5kb3cuWE1MSHR0cFJlcXVlc3Q7DQogICAgICAgIGZ1bmN0aW9uIHhocmZ1bmMoKSB7DQogICAgICAgICAgICBjb25zdCB4aHIgPSBuZXcgb2d4aHIoKTsNCiAgICAgICAgICAgIGNvbnN0IG9wZW4gPSB4aHIub3BlbjsNCiAgICAgICAgICAgIHhoci5vcGVuID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsLCAuLi5yZXN0KSB7DQogICAgICAgICAgICAgICAgaWYgKHVybC5pbmNsdWRlcyh4eXopKSB7DQogICAgICAgICAgICAgICAgb3ZlcmxheT8ucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBvcGVuLmNhbGwodGhpcywgbWV0aG9kLCB1cmwsIC4uLnJlc3QpOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJldHVybiB4aHI7DQogICAgICAgIH0NCiAgICAgICAgd2luZG93LlhNTEh0dHBSZXF1ZXN0ID0geGhyZnVuYzsNCiAgICA8L3NjcmlwdD4NCjwvYm9keT4NCg0KPC9odG1sPg==";
