window.game = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuLXVzIj4KPCEtLSBab29tIG91dCBpZiB0aGUgY2FudmFzIGlzIHRvbyBiaWcgLS0+CiAgICA8aGVhZD4KICAgICAgICA8YmFzZSBocmVmID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9mYXJhbG9uZy9hbGxAbWFpbi9zdGlja2NsYXNoLyI+CiAgICAgICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogICAgICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4KICAgICAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubyI+CiAgICAgICAgCiAgICAgICAgPGxpbmsgcmVsPSJzaG9ydGN1dCBpY29uIiBocmVmPSIuLi8uLi9kZWZhdWx0LzIwMjAvVGVtcGxhdGVEYXRhL2Zhdmljb24uaWNvIj4KCQk8c2NyaXB0Pjwvc2NyaXB0PgogICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vLi4vZGVmYXVsdC8yMDIwL1RlbXBsYXRlRGF0YS9zdHlsZS5jc3MiPgoJPHN0eWxlPgogIGh0bWwsIGJvZHkgewogICAgbWFyZ2luOiAwOwogICAgcGFkZGluZzogMDsKICAgIG92ZXJmbG93OiBoaWRkZW47IC8qIHByZXZlbnRzIHNjcm9sbGJhcnMgKi8KICAgIGhlaWdodDogMTAwJTsKICAgIHdpZHRoOiAxMDAlOwogIH0KCiAgI3VuaXR5LWNvbnRhaW5lciwgI3VuaXR5LWNhbnZhcyB7CiAgICBkaXNwbGF5OiBibG9jazsKICB9Cjwvc3R5bGU+CgogICAgICAgIDxzY3JpcHQgc3JjID0gImpzemlwLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQ+ICAgIAoJCiAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbmRDb21iaW5lWmlwKGJpblVybHMpIHsKICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKGJpblVybHMubWFwKHVybCA9PiBmZXRjaCh1cmwpKSk7CiAgICBjb25zdCBidWZmZXJzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVzcG9uc2VzLm1hcChyZXMgPT4gcmVzLmFycmF5QnVmZmVyKCkpKTsKICAgIGxldCB0b3RhbExlbmd0aCA9IGJ1ZmZlcnMucmVkdWNlKChhY2MsIGJ1ZikgPT4gYWNjICsgYnVmLmJ5dGVMZW5ndGgsIDApOwogICAgbGV0IGNvbWJpbmVkID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpOwogICAgbGV0IG9mZnNldCA9IDA7CiAgICBmb3IgKGxldCBidWYgb2YgYnVmZmVycykgewogICAgICAgIGNvbWJpbmVkLnNldChuZXcgVWludDhBcnJheShidWYpLCBvZmZzZXQpOwogICAgICAgIG9mZnNldCArPSBidWYuYnl0ZUxlbmd0aDsKICAgIH0KICAgIHJldHVybiBjb21iaW5lZDsKfQoKYXN5bmMgZnVuY3Rpb24gdW56aXBXZWJwRnJvbUV4dGVybmFsQmlucyhiaW5VcmxzKSB7CiAgICBjb25zdCBibG9iVXJscyA9IHt9OwogICAgY29uc3QgYnl0ZXMgPSBhd2FpdCBmZXRjaEFuZENvbWJpbmVaaXAoYmluVXJscyk7CiAgICBjb25zdCB6aXAgPSBhd2FpdCBKU1ppcC5sb2FkQXN5bmMoYnl0ZXMpOwogICAgZm9yIChjb25zdCBbZmlsZW5hbWUsIGZpbGVdIG9mIE9iamVjdC5lbnRyaWVzKHppcC5maWxlcykpIHsKICAgICAgICBpZiAoIWZpbGUuZGlyKSB7CiAgICAgICAgICAgIGxldCBtaW1lID0gJyc7CiAgICAgICAgICAgIGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLmpzJykgfHwgZmlsZW5hbWUuZW5kc1dpdGgoJy5tanMnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICd0ZXh0L2phdmFzY3JpcHQnOwogICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuY3NzJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAndGV4dC9jc3MnOwogICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuaHRtbCcpKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ3RleHQvaHRtbCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy53ZWJwJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAnaW1hZ2Uvd2VicCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5wbmcnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICdpbWFnZS9wbmcnOwogICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuanBnJykgfHwgZmlsZW5hbWUuZW5kc1dpdGgoJy5qcGVnJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAnaW1hZ2UvanBlZyc7CiAgICAgICAgICAgIH0KCQkJZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy53YXNtJykgKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ2FwcGxpY2F0aW9uL3dhc20nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHJhd0Jsb2IgPSBhd2FpdCBmaWxlLmFzeW5jKCJibG9iIik7CiAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBtaW1lID8gbmV3IEJsb2IoW3Jhd0Jsb2JdLCB7IHR5cGU6IG1pbWUgfSkgOiByYXdCbG9iOwogICAgICAgICAgICBjb25zdCBibG9iVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkV4dHJhY3RlZDoiLCBmaWxlbmFtZSk7CiAgICAgICAgICAgIGJsb2JVcmxzW2ZpbGVuYW1lXSA9IGJsb2JVcmw7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGJsb2JVcmxzOwp9CgpsZXQgYmxvYlVybHNzID0gIiI7CmxldCBiaW5QYXJ0cyA9IFsKICAicGFydHNfMS5iaW4iLAogICJwYXJ0c18yLmJpbiIKXTsKCnVuemlwV2VicEZyb21FeHRlcm5hbEJpbnMoYmluUGFydHMpLnRoZW4oYmxvYlVybHMgPT4gewoKICAgIGJsb2JVcmxzcyA9IGJsb2JVcmxzOwogICAgY29uc3QgT1JJR0lOQUxfQ1JFQVRFX0VMRU1FTlQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50OwogICAgY29uc3QgT1JJR0lOQUxfU0VUX0FUVFJJQlVURSA9IEVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZTsKCiAgICAKICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbih0YWdOYW1lKSB7CiAgICAgICAgY29uc3QgZWwgPSBPUklHSU5BTF9DUkVBVEVfRUxFTUVOVC5jYWxsKHRoaXMsIHRhZ05hbWUpOwoKICAgICAgICBpZiAodGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc2NyaXB0JykgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICdzcmMnLCB7CiAgICAgICAgICAgICAgICBzZXQobmV3U3JjKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBleHRyYWN0RmlsZW5hbWUobmV3U3JjKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IGJsb2JVcmxzc1tmaWxlbmFtZV07CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBPUklHSU5BTF9TRVRfQVRUUklCVVRFLmNhbGwoZWwsICdzcmMnLCByZXBsYWNlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgT1JJR0lOQUxfU0VUX0FUVFJJQlVURS5jYWxsKGVsLCAnc3JjJywgbmV3U3JjKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZ2V0KCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5nZXRBdHRyaWJ1dGUoJ3NyYycpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBlbDsKICAgIH07CgogICAgCiAgICBFbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAgIGlmICh0aGlzLnRhZ05hbWUgPT09ICdTQ1JJUFQnICYmIG5hbWUgPT09ICdzcmMnKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZXh0cmFjdEZpbGVuYW1lKHZhbHVlKTsKICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBibG9iVXJsc3NbZmlsZW5hbWVdOwogICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQpIHsKICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmV0dXJuIE9SSUdJTkFMX1NFVF9BVFRSSUJVVEUuY2FsbCh0aGlzLCBuYW1lLCByZXBsYWNlbWVudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBPUklHSU5BTF9TRVRfQVRUUklCVVRFLmNhbGwodGhpcywgbmFtZSwgdmFsdWUpOwogICAgfTsKCiAgICBmdW5jdGlvbiBleHRyYWN0RmlsZW5hbWUodXJsKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBVUkwodXJsLCBsb2NhdGlvbi5ocmVmKS5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpOwogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICByZXR1cm4gdXJsLnNwbGl0KCcvJykucG9wKCk7IAogICAgICAgIH0KICAgIH0KCgpjb25zdCBpbWFnZVNyY0Rlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEltYWdlLnByb3RvdHlwZSwgJ3NyYycpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2UucHJvdG90eXBlLCAnc3JjJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBpbWFnZVNyY0Rlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogaW1hZ2VTcmNEZXNjcmlwdG9yLmdldCwKICBjb25maWd1cmFibGU6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKfSk7CgoKY29uc3Qgc2NyaXB0U3JjRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTFNjcmlwdEVsZW1lbnQucHJvdG90eXBlLCAnc3JjJyk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShIVE1MU2NyaXB0RWxlbWVudC5wcm90b3R5cGUsICdzcmMnLCB7CiAgc2V0KHZhbHVlKSB7CiAgICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHZhbHVlKTsKICAgIHNjcmlwdFNyY0Rlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogc2NyaXB0U3JjRGVzY3JpcHRvci5nZXQsCiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGVudW1lcmFibGU6IHRydWUsCn0pOwoKCmNvbnN0IGxpbmtIcmVmRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTExpbmtFbGVtZW50LnByb3RvdHlwZSwgJ2hyZWYnKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KEhUTUxMaW5rRWxlbWVudC5wcm90b3R5cGUsICdocmVmJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBsaW5rSHJlZkRlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogbGlua0hyZWZEZXNjcmlwdG9yLmdldCwKICBjb25maWd1cmFibGU6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKfSk7CgoKY29uc3QgbWVkaWFTcmNEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihIVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsICdzcmMnLCB7CiAgc2V0KHZhbHVlKSB7CiAgICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHZhbHVlKTsKICAgIG1lZGlhU3JjRGVzY3JpcHRvci5zZXQuY2FsbCh0aGlzLCBuZXdVUkwpOwogIH0sCiAgZ2V0OiBtZWRpYVNyY0Rlc2NyaXB0b3IuZ2V0LAogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlLAp9KTsKCi8vIGZldGNoCmNvbnN0IG9yaWdpbmFsRmV0Y2ggPSB3aW5kb3cuZmV0Y2g7CndpbmRvdy5mZXRjaCA9IGZ1bmN0aW9uKHJlc291cmNlLCBpbml0KSB7CgogIGlmICh0eXBlb2YgcmVzb3VyY2UgPT09ICJzdHJpbmciKSB7CiAgLy9jb25zb2xlLmxvZyhyZXNvdXJjZSkKICAgIHJlc291cmNlID0gcmV3cml0ZVVSTChyZXNvdXJjZSk7CiAgfSBlbHNlIGlmIChyZXNvdXJjZSBpbnN0YW5jZW9mIFJlcXVlc3QpIHsKICAgIHJlc291cmNlID0gbmV3IFJlcXVlc3QocmV3cml0ZVVSTChyZXNvdXJjZS51cmwpLCByZXNvdXJjZSk7CiAgfQogIHJldHVybiBvcmlnaW5hbEZldGNoLmNhbGwodGhpcywgcmVzb3VyY2UsIGluaXQpOwp9OwoKLy8gWE1MSHR0cFJlcXVlc3QKY29uc3Qgb3JpZ2luYWxPcGVuID0gWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW47ClhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24obWV0aG9kLCB1cmwsIC4uLnJlc3QpIHsKICBjb25zdCBuZXdVUkwgPSByZXdyaXRlVVJMKHVybCk7CiAgcmV0dXJuIG9yaWdpbmFsT3Blbi5jYWxsKHRoaXMsIG1ldGhvZCwgbmV3VVJMLCAuLi5yZXN0KTsKfTsKCgpjb25zdCBPcmlnaW5hbEF1ZGlvID0gd2luZG93LkF1ZGlvOwp3aW5kb3cuQXVkaW8gPSBmdW5jdGlvbihzcmMpIHsKICBjb25zdCBhdWRpbyA9IG5ldyBPcmlnaW5hbEF1ZGlvKCk7CiAgaWYgKHNyYykgewogICAgYXVkaW8uc3JjID0gcmV3cml0ZVVSTChzcmMpOwogIH0KICByZXR1cm4gYXVkaW87Cn07CndpbmRvdy5BdWRpby5wcm90b3R5cGUgPSBPcmlnaW5hbEF1ZGlvLnByb3RvdHlwZTsKCgpmdW5jdGlvbiByZXdyaXRlVVJMKG9yaWdpbmFsKSB7CiAgdmFyIHRyaW1tZWQgPSBvcmlnaW5hbC5zcGxpdCgiLyIpLnBvcCgpOwogIC8vY29uc29sZS5sb2codHJpbW1lZCkKICBpZiAodHJpbW1lZC5pbmNsdWRlcygiPyIpKSB0cmltbWVkID0gdHJpbW1lZC5zcGxpdCgiPyIpWzBdCiAgcmV0dXJuIGJsb2JVcmxzc1t0cmltbWVkXSB8fCBvcmlnaW5hbDsKfQoKCmNvbnN0IGhpZGVGdWxsU2NyZWVuQnV0dG9uID0gIiI7CiAgICAgICAgICAgIGNvbnN0IGJ1aWxkVXJsID0gIkJ1aWxkLyI7CiAgICAgICAgICAgIGNvbnN0IGxvYWRlclVybCA9IGJ1aWxkVXJsICsgIldlYmdsLmxvYWRlci1lZGl0My5qcyI7CiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHsKICAgICAgICAgICAgICAgIGRhdGFVcmw6IGJ1aWxkVXJsICsgIldlYmdsLmRhdGEiLAogICAgICAgICAgICAgICAgZnJhbWV3b3JrVXJsOiBidWlsZFVybCArICJXZWJnbC5mcmFtZXdvcmsuanMiLAogICAgICAgICAgICAgICAgY29kZVVybDogYnVpbGRVcmwgKyAiV2ViMi53YXNtIiwKICAgICAgICAgICAgICAgIHN0cmVhbWluZ0Fzc2V0c1VybDogIlN0cmVhbWluZ0Fzc2V0cyIsCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktY29udGFpbmVyIik7CiAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1jYW52YXMiKTsKICAgICAgICAgICAgY29uc3QgbG9hZGluZ0NvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2xvYWRpbmctY292ZXIiKTsKICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJFbXB0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1wcm9ncmVzcy1iYXItZW1wdHkiKTsKICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJGdWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3VuaXR5LXByb2dyZXNzLWJhci1mdWxsIik7CiAgICAgICAgICAgIGNvbnN0IGZ1bGxzY3JlZW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktZnVsbHNjcmVlbi1idXR0b24iKTsKICAgICAgICAgICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGlubmVyJyk7CgogICAgICAgICAgICBjb25zdCBjYW5GdWxsc2NyZWVuID0gKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgWydleGl0RnVsbHNjcmVlbicsICd3ZWJraXRFeGl0RnVsbHNjcmVlbicsICd3ZWJraXRDYW5jZWxGdWxsU2NyZWVuJywgJ21vekNhbmNlbEZ1bGxTY3JlZW4nLCAnbXNFeGl0RnVsbHNjcmVlbicsIF0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoa2V5IGluIGRvY3VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSgpKTsKCiAgICAgICAgICAgIGlmICgvaVBob25lfGlQYWR8aVBvZHxBbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgewogICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICJ1bml0eS1tb2JpbGUiOwogICAgICAgICAgICAgICAgY29uZmlnLmRldmljZVBpeGVsUmF0aW8gPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxvYWRpbmdDb3Zlci5zdHlsZS5kaXNwbGF5ID0gIiI7CiAgICAgICAgICAgIHZhciBuZXdJbnN0YW5jZSA9IG51bGw7CgogICAgICAgICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgICAgICAgc2NyaXB0LnNyYyA9IGxvYWRlclVybDsKICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9ICgpPT57CiAgICAgICAgICAgICAgICBjcmVhdGVVbml0eUluc3RhbmNlKGNhbnZhcywgY29uZmlnLCAocHJvZ3Jlc3MpPT57CiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyRW1wdHkuc3R5bGUuZGlzcGxheSA9ICIiOwogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyRnVsbC5zdHlsZS53aWR0aCA9IGAkezEwMCAqIHByb2dyZXNzfSVgOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKS50aGVuKCh1bml0eUluc3RhbmNlKT0+ewogICAgICAgICAgICAgICAgICAgIG5ld0luc3RhbmNlID0gdW5pdHlJbnN0YW5jZTsKICAgICAgICAgICAgICAgICAgICBsb2FkaW5nQ292ZXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICAgICAgICBpZiAoY2FuRnVsbHNjcmVlbikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhpZGVGdWxsU2NyZWVuQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsc2NyZWVuQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmdWxsc2NyZWVuQnV0dG9uLm9uY2xpY2sgPSAoKT0+ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5zdGFuY2UuU2V0RnVsbHNjcmVlbigxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKS5jYXRjaCgobWVzc2FnZSk9PnsKICAgICAgICAgICAgICAgICAgICBhbGVydChtZXNzYWdlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIAoJCQkKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwoKCn0pOwoKPC9zY3JpcHQ+CiAgICA8L2hlYWQ+CiAgICA8Ym9keSBjbGFzcz0iZGFyayI+CiAgICAgICAgPGRpdiBpZD0idW5pdHktY29udGFpbmVyIiBjbGFzcz0idW5pdHktZGVza3RvcCI+CiAgICAgICAgICAgIDxjYW52YXMgaWQ9InVuaXR5LWNhbnZhcyI+PC9jYW52YXM+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBpZD0ibG9hZGluZy1jb3ZlciIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPgogICAgICAgICAgICA8ZGl2IGlkPSJ1bml0eS1sb2FkaW5nLWJhciI+CiAgICAgICAgICAgICAgICA8IS0tPGRpdiBpZD0idW5pdHktbG9nbyI+CiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9ImxvZ28ucG5nIj4KICAgICAgICAgICAgICAgIDwvZGl2Pi0tPgogICAgICAgICAgICAgICAgPGRpdiBpZD0idW5pdHktcHJvZ3Jlc3MtYmFyLWVtcHR5IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InVuaXR5LXByb2dyZXNzLWJhci1mdWxsIj48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3Bpbm5lciI+PC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgaWQ9InVuaXR5LWZ1bGxzY3JlZW4tYnV0dG9uIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPjwvZGl2PgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgIAogICAgICAgIDwvc2NyaXB0PgoJCTxzY3JpcHQ+CmZ1bmN0aW9uIHJlc2l6ZUNhbnZhcygpIHsKICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1bml0eS1jYW52YXMiKTsKICAgCiAgICBjYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsKICAgIGNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAKICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICsgInB4IjsKICAgIGNhbnZhcy5zdHlsZS5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgKyAicHgiOwp9CgoKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCByZXNpemVDYW52YXMpOwp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgcmVzaXplQ2FudmFzKTsKPC9zY3JpcHQ+CiAgICA8L2JvZHk+CjwvaHRtbD4K";
