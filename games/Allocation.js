window.game = "DQoNCjwhLS0gVWx0aW1hdGUgR2FtZSBTdGFzaCBmaWxlLS0+IA0KPCEtLSBGb3IgdGhlIHJlZ3VsYXJseSB1cGRhdGluZyBkb2MgZ28gdG8gaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xX0ZtSDNCbFNCUUk3RkdnQVFMNTktWlBlOGVDeHMzNXdlbDZKVXlWYUc4US8gLS0+DQoNCg0KDQo8aHRtbD48aGVhZD4NCiAgICA8dGl0bGU+UElDTy04IENhcnRyaWRnZTwvdGl0bGU+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgdXNlci1zY2FsYWJsZT1ubyI+DQogICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgIA0KICAgICAgICAvLyBEZWZhdWx0IHNoZWxsIGZvciBQSUNPLTggMC4yLjIgKGluY2x1ZGVzIEB3ZWVibGUncyBnYW1lcGFkIG1vZCAxLjApDQogICAgICAgIC8vIFRoaXMgZmlsZSBpcyBhdmFpbGFibGUgdW5kZXIgYSBDQzAgbGljZW5zZSBodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvc2hhcmUteW91ci13b3JrL3B1YmxpYy1kb21haW4vY2MwLw0KICAgICAgICAvLyAobm90ZTogInRoaXMgZmlsZSIgZG9lcyBub3QgaW5jbHVkZSBhbnkgY2FydHJpZGdlIG9yIGNhcnRyaWRnZSBhcnR3b3JrIGluamVjdGVkIGludG8gYSBkZXJpdmF0aXZlIGh0bWwgZmlsZSB3aGVuIHVzaW5nIHRoZSBQSUNPLTggaHRtbCBleHBvcnRlcikNCiAgICANCiAgICAgICAgLy8gb3B0aW9ucw0KICAgIA0KICAgICAgICAvLyBmdWxsc2NyZWVuLCBzb3VuZCwgY2xvc2UgYnV0dG9uIGF0IHRvcCB3aGVuIHBsYXlpbmcgb24gdG91Y2hzY3JlZW4NCiAgICAgICAgdmFyIHA4X2FsbG93X21vYmlsZV9tZW51ID0gdHJ1ZTsNCiAgICANCiAgICAgICAgLy8gcDhfYXV0b3BsYXkgdHJ1ZSB0byBib290IHRoZSBjYXJ0cmlkZ2UgYXV0b21hdGljYWxseSBhZnRlciBwYWdlIGxvYWQgd2hlbiBwb3NzaWJsZQ0KICAgICAgICAvLyBpZiB0aGUgYnJvd3NlciBjYW4gbm90IGNyZWF0ZSBhbiBhdWRpbyBjb250ZXh0IG91dHNpZGUgb2YgYSB1c2VyIGdlc3R1cmUgKGUuZy4gb24gaU9TKSwgcDhfYXV0b3BsYXkgaGFzIG5vIGVmZmVjdA0KICAgICAgICB2YXIgcDhfYXV0b3BsYXkgPSB0cnVlOw0KICAgIA0KICAgICAgICAvLyBXaGVuIHBpY284X3N0YXRlIGlzIGRlZmluZWQsIFBJQ08tOCB3aWxsIHNldCAuaXNfcGF1c2VkLCAuc291bmRfdm9sdW1lIGFuZCAuZnJhbWVfbnVtYmVyIGVhY2ggZnJhbWUgDQogICAgICAgIC8vICh1c2VkIGZvciBkZXRlcm1pbmluZyBidXR0b24gaWNvbnMpDQogICAgICAgIHZhciBwaWNvOF9zdGF0ZSA9IFtdOw0KICAgIA0KICAgICAgICAvLyBXaGVuIHBpY284X2J1dHRvbnMgaXMgZGVmaW5lZCwgUElDTy04IHJlYWRzIGVhY2ggaW50IGFzIGEgYml0ZmllbGQgaG9sZGluZyB0aGF0IHBsYXllcidzIGJ1dHRvbiBzdGF0ZXMNCiAgICAgICAgLy8gMHgxIGxlZnQsIDB4MiByaWdodCwgMHg0IHVwLCAweDggcmlnaHQsIDB4MTAgTywgMHgyMCBYLCAweDQwIG1lbnUNCiAgICAgICAgLy8gKHVzZWQgYnkgcDhfdXBkYXRlX2dhbWVwYWRzKQ0KICAgICAgICB2YXIgcGljbzhfYnV0dG9ucyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsgLy8gbWF4IDggcGxheWVycw0KICAgIA0KICAgICAgICAvLyBXaGVuIHBpY284X21vdXNlIGlzIGRlZmluZWQsIFBJQ08tOCByZWFkcyB0aGUgMyBpbnRlZ2VycyBhcyBYLCBZIGFuZCBhIGJpdGZpZWxkIGZvciBidXR0b25zOiAweDEgTE1CLCAweDIgUk1CDQogICAgICAgIHZhciBwaWNvOF9tb3VzZSA9IFtdOw0KICAgIA0KICAgICAgICAvLyB1c2VkIHRvIGRpc3BsYXkgbnVtYmVyIG9mIGRldGVjdGVkIGpveXN0aWNrcw0KICAgICAgICB2YXIgcGljbzhfZ2FtZXBhZHMgPSB7fTsNCiAgICAgICAgcGljbzhfZ2FtZXBhZHMuY291bnQgPSAwOw0KICAgIA0KICAgICAgICAvLyBXaGVuIHBpY284X2dwaW8gaXMgZGVmaW5lZCwgcmVhZGluZyBhbmQgd3JpdGluZyB0byBncGlvIHBpbnMgd2lsbCByZWFkIGFuZCB3cml0ZSB0byB0aGVzZSB2YWx1ZXMNCiAgICAgICAgdmFyIHBpY284X2dwaW8gPSBuZXcgQXJyYXkoMTI4KTsNCiAgICANCiAgICAgICAgLy8gV2hlbiBwaWNvOF9hdWRpb19jb250ZXh0IGNvbnRleHQgaXMgZGVmaW5lZCwgdGhlIGh0bWwgc2hlbGwgKHRoaXMgZmlsZSkgaXMgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIGFuZCBtYW5hZ2luZyBpdC4NCiAgICAgICAgLy8gVGhpcyBtYWtlcyBzYXRpc2Z5aW5nIGJyb3dzZXIgcmVxdWlyZW1lbnRzIGVhc2llciAtLSBlLmcuIGluaXRpYWxpc2luZyBhdWRpbyBmcm9tIGEgc2hvcnQgc2NyaXB0IGluIHJlc3BvbnNlIHRvIGEgdXNlciBhY3Rpb24uDQogICAgICAgIC8vIE90aGVyd2lzZSBQSUNPLTggd2lsbCB0cnkgdG8gY3JlYXRlIGFuZCB1c2UgaXRzIG93biBjb250ZXh0Lg0KICAgIA0KICAgICAgICB2YXIgcGljbzhfYXVkaW9fY29udGV4dDsNCiAgICANCiAgICANCiAgICAgICAgLy8gbWVudSBidXR0b24gYW5kIGNvbnRyb2xsZXIgZ3JhcGhpY3MNCiAgICAgICAgcDhfZ2Z4X2RhdD17DQogICAgICAgICAgICAgICAgInA4Yl9wYXVzZTEiOiAiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCZ0FBQUFZQ0FZQUFBRGdkejM0QUFBQU9VbEVRVlJJeDJOZ0dQYmcvOGNYLzBGNDZGdEFNNHZvYmdIVkxSb3dDNmhtMFlCYlFMRkZveGFNNEZRMGRIUHkwQzFOaDI2Tk51Z0JBQW5pek5pTWZ2YkdBQUFBQUVsRlRrU3VRbUNDIiwNCiAgICAicDhiX2NvbnRyb2xzIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCZ0FBQUFZQ0FZQUFBRGdkejM0QUFBQVEwbEVRVlJJeDJOZ0dBWEVnUDhmWC95bkJhYXA0WEJMaHFjRjFJeWZZV1FCclpMejBMRUFsenFxeFFGVkxjQW1UM01McUpxVGFXN0I0Q3FMYUY0ZmpJSUJCd0JML0IydnF0UFZJd0FBQUFCSlJVNUVya0pnZ2c9PSIsDQogICAgInA4Yl9mdWxsIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCZ0FBQUFZQ0FZQUFBRGdkejM0QUFBQU4wbEVRVlJJeDJOZ0dQTGcvOGNYLzJtSjZXY0JyVUptNEN3Z09TZ0dyUVZFQjhXb0JhTVdER01MaG01T0hucWw2ZEN0MFlZOEFBQTlvWm0rOVo5eFFBQUFBQUJKUlU1RXJrSmdnZz09IiwNCiAgICAicDhiX3BhdXNlMCI6ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQmdBQUFBWUNBWUFBQURnZHozNEFBQUFLVWxFUVZSSXgyTmdHSGJnLzhjWC83RmhjdFdOV2pCcXdhZ0ZveGFNV2pCcXdhZ0Y1Rmt3NUFBQVBhR1p2c0lVdFhVQUFBQUFTVVZPUks1Q1lJST0iLA0KICAgICJwOGJfc291bmQwIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCZ0FBQUFZQ0FZQUFBRGdkejM0QUFBQU5rbEVRVlJJeDJOZ0dESGcvOGNYLzVIeDBMRUEzY0NoWXdFdWd3YXZCY1JHNHFnRm94WU1ad3VHZms0ZWZxWHA4S25SQmowQUFNejdjTERuRzRGZUFBQUFBRWxGVGtTdVFtQ0MiLA0KICAgICJwOGJfc291bmQxIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCZ0FBQUFZQ0FZQUFBRGdkejM0QUFBQVBVbEVRVlJJeDJOZ0dESGcvOGNYLzVIeDBMRUEzY0NoWXdFdWd3aFpRTFFEcUc0QnNaRklLTWhHTFJpMVlDaGJNUFJ6OHZBclRZZFBqVGJvQVFDU1ZncFhVV1FBTUFBQUFBQkpSVTVFcmtKZ2dnPT0iLA0KICAgICJwOGJfY2xvc2UiOiJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJnQUFBQVlDQVlBQUFEZ2R6MzRBQUFBVTBsRVFWUkl4Mk5rb0RGZ3BKc0YveisrK0k4aXdTOUJrdVc0OUErY0JjUmFSRWdmL1N3ZzFTSmkxZEhmQWtJRzRFeU9PSUp5NEN3ZzFpSkNpV0RVQXZJdEdMcXBhT2ptNUtGZm1nNzlHbTNJdGlvQWwrbUFHVllJWlVVQUFBQUFTVVZPUks1Q1lJST0iLA0KICAgIA0KICAgICJjb250cm9sc19sZWZ0X3BhbmVsIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFTd0FBQUVzQ0FZQUFBQjVmWTUxQUFBRUkwbEVRVlI0MnUzZE1VN0RRQkNHMFRqYW05RFRjUDhqcEVtZnN3UzVpSEJoQXNMeGV2L2h2UVk2cEdYeVpSVFErblFDQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUhxYkhFRXRsK3Z0N2hTK2ZMeS9tWEhCUXF4RWkvNmFJL0FpRlc5U25CMkJXRGtEQkF0QXNBREJBaEFzQU1FQ0JBdEFzQUFFQ3hBc0FNRUNFQ3hBc0FBRUMwQ3dPTko4dFl2clhSQXNJbUsxOWowSUZzUEdTclFRTENKaU5WK2V0N3hBVDdRUUxJYU4xZHIzb29WZ01XeXNSQXZCSWlwV29vVmdFUlVyMFVLd2lJcVZhQ0ZZUk1WS3RCQXNvbUlsV2dnV1ViRVNMUVNMcUZpSkZvSkZWS3hFQzhFaUtsYWloV0FSRlN2UlFyRFlKU1NWZmhhQ0JTQllBSUlGQ0JiQUhwb2o0Qmwvc2NPR0JXREQ0bFg4aXdFMkxBREJBZ1FMUUxBQUJBc1FMQURCQWhBc1FMQUFCQXRBc0FEQkFoQXNBTUVDQkF0QXNBQUVDeEFzQU1FQ0VDeEFzQUFFQ3hBc0FNRUNFQ3hBc01oMXVkN3VUc0haVkRjWnlGbzhZdDVzVko2TnlVQWFTTkV5SXltYVh3WmVwSUtkNG13b1FiQUZDMEN3QU1FQ0VDd0F3UUlFQzBDd0FBUUxFQ3dBd1FJUUxFQ3dBQVFMUUxBQXdRSTRVSE1FMi8xMFFacTd1c3lCT2JCaFJRd3BtQlViMW5BRHVQYnVhVUQvcDJlek1IKzFhZG13aG9zVmZCY3hiMlNDSlZhSWxtQWhWb2lXWUlrVm9pVmFnaVZXaUpaZ2laVllJVnFDSlZhSWxtZ0psbGdoV29JbFZpQmFnaVZXaUpab0NaWllJVnFDSlZZZ1dvSWxWaUJhZ2dVSWxuYzBzUEVMbG1naFZtSWxXS0tGV0FtV2FJRllDWlpvSVZZSWxtZ2hWb0lsV2lCV2dpVmFpSlZnSVZxSWxXQ0pGb2lWWUlrV1lpVllpQlppSlZpaWhWaUoxWGJORVd5TDFtTVFSWXZmdklHSmxRMXJtRTBMeklvTnl5QmlEckJoQVlJRklGaUFZQUVJRm9CZ0FZSUZJRmdBZ2dVSUZvQmdBUWdXSUZnQWdnVWdXSUJnRGMrTm4xRC90ZEg4WXVwd2daeTVxRzR5a0tJbFZtWkRzRGpzaFNsYXpxUXFIN3A3OTNRMkNCYUFZQUdDQlNCWUFJSUZDQmFBWUFFSUZpQllBSUlGSUZpQVlBRUlGb0JnQVlJRklGZ0FnZ1VJRm9CZ0FRZ1dJRmdBZ2dVZ1dJQmdBUWdXd0VOekJLeFpQdWI5Q0o3V2pBMExzR0ZSVis5TjUrak5EaHNXZ0dBQmdnVWdXQUNDeFc1NmZnanVBM2NFaXo5Wi9uV3dSMGlXUDhQL1lDRllEQnN0c1VLd2lJaVdXQ0ZZUkVSTHJCQXNJcUlsVmdnV0VkRVNLd1NMaUdpSkZZSkZSTFRFQ3NFaUlscGloV0FSRVMyeFFyQ0lpSlpZSVZoRVJFdXNFQ3dpb2lWV0NCWXgwUklyQkl1b2FJa1ZyK1loRkhUWnRNQ0dCUWdXZ0dBQkNCWWdXQUNDQlNCWWdHQUJDQmFBWUFHQ0JTQllBSUlGQ0JiajJ1T1I4czZBRWJoZXhnc1dZcmkzU0toS2N6Y1hBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBTUEybitlMFVNRHpoM3lUQUFBQUFFbEZUa1N1UW1DQyIsDQogICAgDQogICAgDQogICAgImNvbnRyb2xzX3JpZ2h0X3BhbmVsIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFTd0FBQUZlQ0FZQUFBQS9seUsvQUFBS0hrbEVRVlI0MnUzZEFaS2FXQkFHWUUzdHZmQm1NQ2ZEbkd6V0pMaExISEJHQnQ3cmh1K3JTaVdiYkFrOHAzKzdVZUYwQWdBQUFBQUFBQUFBQU9BUXpwYUF6TjV2RGxPc053SUxoSlhRU3VJZlAvWW9aTUdjeFE5TGdMQnlmQUlMUUdBQkFndEFZQUVJTEVCZ0FRZ3NBSUVGQ0N3QWdRVWdzQUNCQlNDd0FBUVdJTEFBQkJZc3QvY0wzTG1BMy85Y2NSUkZUUnF1WklpZ3lsS3NyandLQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU1aMHRBWHowL3Y3ZUxpNnE4L25OQ2dvczJDS1ltdHR2bCtFL3V3MDJjWC9NNnkzSWZscHhnUVZMdTZmdVNjQzhIRElQNGZmMDhYVmh3Tk13dWYzcTN6OXF2elArZlRVZ2gxK1AraUhrQVA0TGk2bVFhaXJ0VHpPM1Q1NHRFRlJodTVtWnJrOXd3WUdEcW8wK2RzMTBYWUlMamhSVWpnT0kySjMwZXpxUnZjZGpBbUgxZHpleXU2S2VDQzdkRmlRdDVzTVU4bU13ZS9ZaFY5Y3gxamh1UUtlaHN3UldDS3ZtNEd2UkNDM0kwVlVZaFQ2R2x2TmFJS3lFRmlDc2hCWUlLNkVsdEtCdUFRb3Jhd1lLejlvQmF4V2N0K3VYcmFHUGYwQ2hZdXVkaDdHT2tLa3pVR1RyaHBaT0ZUWWNCWTB4MWhSMEE3cFdRRkY1TVlEREZKU3hwZEJvYURWZ3A5M1ZrM3NKem1tamRqRjc2ckxjK1ptcTNkWHZIOEtiS0NGMStuUG41c3ZEUDEySFgxT20vdjlmdWtoM2Q0NjIxcEMxdTJvRDdjdjQrdkR0d3NjSmVaL0JTT3NOS2J1cjJ1ZFZ0cnFsVnRUN0REcVhCUWxmN2FkdW8xVW9GUHNqcnp2b3JwYUZWZEdiT1V3RVpIUEV0WWVNWWRYVTZqWnFYemNxUW1pTjlzSEhTT0NGc2FRcHZOMG1TSWRUOVdvS28zVXdGa0xFa1NUYVpXdHFoNmV4RUlLK3VrZTl4dGE0MHpwS2x3dkd3YyszMlFmK05IMlZmVE1XUXNCUkpNTVhxMnQ5YmNaWUNGOHJrclowVVVZZWZXcDlPZmtlNXRsK2huNG9JMG9WU09uT1pmampyKy8wL1l5NkxzTytYV3VzVWExdFFvckFLandPcGhwNUtuVlp6bU5CN1lMTStCV1VHdnZzUEJZOEw0NWVJYzd1Yy9GdkFOeFArR2RhSitld0tPbTYwMjE5MitoYzFzVWFDU3dxanpzVnRuVk51RlRYMHV0Vlkzc0NpeXhkeE5zZXQ1VjFuek91a2NCaWJ6ckhzRjhDQzZFVmNDeEVZSUhBRWxnQUFndEFZQUVDQzBCZ0FRZ3NpT2RpQ1FRV3g5SUpMSUVGd3NveENDeFlXOFlMMDdtWW5zRGlZQVU1K2tKdnh0SHE4bkFNQWhJcWhWV3hxMm02Z04vWEE4c0YvT0NURHFLQUxtRUhjVitiNnc2ZkQwalpZYmtKUmFEOXpkaUo2ckFvcFN1OHZXdVdMbXQ4UzdJRFBDK1Fvb05vM1VoMWNoK3Iza2pWaVhkNEhpQnRoYUowcS9xWnRmRlRDWjkwUEpVQ29RKzRIdFgyelQwSjRlc2RUMU53bTgxb05Hd0Ryc1Y3aFcwM3hrRUlXaWpSUXV0aGY1b0syMitqbjl1RHc0NkZFVUppcXJPcXRSL0dRVWp3NnY0UVdqWE9HL1VCd3NvNENBc0twcSs4L1dMQk1XeXpEOUxoOWNaQlNEU1NUQVJJditHMjJwcGRuWEVRMWl2aU5zaCtySHBDZmdqRVRSNTdEK3NPdXF4MWc2dGZVdFRENC9UUmdtcFAzZFZaNlZBckpFNS92c2ZXbGJyKzB4ZjM2WEw2ZUJXRDYybitLZ3BULy84cDBuRkZYVytCUmJvdTYvY1A0VTNRUUQyZHZ2N2w0RzQ0bGpkckRUdnRzcUovMTI4bjY5dzdkd1VydmZKN20zM1Q5VzI4TXdpNkxOMFZLQ3E4R0VDU3NjVm9hRTFCTjZCckJUWXFNcUZsSFNIVkdLTXorRjZuYWhTRXdxR2w0S3dkS0R4ckJxeFpnTDBDWEJSV3psdUIwQkpXZ05BU1ZpQzBoQlZRcjBDOVhUOGRWajcrQVFsQ3F6L29HdlRDQ25KMkY0ZnB0bzU2M0tEVDBGa0N0UXQ1YjEzSHhPM0lqSUN3czZKT0gxeDdQQ1pndnR0SzI0M3M1VGlBaFFVZnZUdUpldU5Wb0Y1d2hSdXJKa1kvUVFXQzY0TnFYZGRNTnlXb2dFKzdtWHQ0dFJ0dnU1MEpLU2ZUWCtRdXNCeXk2eHIrMkUzODgvanZydWZ6K2Vjcm9YajYrN2IxczQrZitYYnhBbXYvaGZINkUrTUh1bGpuTlFxWmJvTk5kRXZDRDRIbGh4NHZOZ0xMV0dHc0FFSjJVazdjQXVHN0tXK05BOW1DeW9jUGdmQkI1ZXNkUVB5Z2NoeEF4TzdFSlVxQVZOMklpOEFCWVl2WlpYYUJGRjJIR3hrWUVVR25vYk1FMWc0ck4rTVVXcENpcXpBS25kenVISVNWMEFLRWxkQUNZWVhRZ21BRktLeXNHU2c4YXdlc1ZYRGVybCsyaGo3K0FZV0tyWGNleGpwQ3BzNUFrYTBiV2pwVjJIQVVOTVpZVTlBTjZGb0JSZVhGQUE1VFVNYVdRcU9oMVlCQTNkV2VpbkxOWTlGbHdZcmRWZFRIMjh1NjdHbHR5T3RIOXU1cStHTzMxbU9lYjdKM1d2ZDl2eC9MaXJxSGRRY2l2T0puN1NhMjNtOWRGanFzSU4xVjlrNXJ3ODVLbHdVWlh1bXpkQlFsOTFPWGhRN3J0WUs1ZjN6aHV2VzJNblJhaFRxcnNldkQ4d0FDNjRuTGx1TmdwdENxRUZiamRiOG9JUWc2a2tRYmhXcnVqN0VRSGRacjQyQlhldHVST3ExS25kV0hMc3RZaU1ENjJqaDRyYkh4Q0tFVklLekc2MjhzaE9pamlMSFVXSWdPNjZWeHBLWWFuVmFRemlyVTg0REFpdHhkaGZxd1lzblFDaGhXWVo4WEJGWW90NXA5TzFKb1JRMnJTTThEUk95d3dwNHoyV3Jmb3A4bmNoNExIZFp6MTZCZDMrcWRWdVF4TVByemdjQlNJQVZESzBsWUNTd0Uxa3dCcHppeHUwWm9KUXFyZE04UEFxdDBJTHdsMk1mRm9aVXRySng0UjJEdHdKTFF5dGhaZ2NBNllHZ0pLeEJZS1VKTFdJSEFTaEZhd2dvRVZvclFFbFlnc0ZLRWxyQUNnWlVtdElRVkNLendwa1pDUUdDRkRhdnpRR2lCd0FvZlZvOGpvZEFDZ1JVNnJJUVdDS3hVWVNXMFlPZUJsZW1xQUs5OGRDRnJhTGxLQXdKcnVxRGZraFh5eTUrenl0eHB1V29EQW12YVpZOWhsVGkwTHNvSVpvSWdlaUd2dFk5WnJwWHVtdTdvc09aMWUrMnNrbmRhblZKQ1lNMEhReHR3bjFiL2JtRDAwSExDSFlIMXZJRGZnaGJ1Wmw5a3p0QnBPZUVPVDhJaFV2R1cycCtJNTRxY3YwS0g5Ymx1S0pabXo1MVY5RTVydFA2ZE1rSmd6YnNPdjErT0VsWkJRK3Z5OEh3QUVVZVJvMi9mT0lnT0s4bFlHT0ZLb2JVN0xlTWd2Rmd3d3d0OGYrU3VvdGIrL0ZyM1lkT05uMFlJV0t4UlI2QWErMlVjeEVpNGZDeHNTeFJvN1RFd3luZzRXbS9qSUVSN3BmZWRQdDBWT3F3VVhWYW1XM0dWNkxSMFZ4RDBGVDlySjdIbGZ1dXUwR0d0MTJYMWF4Wm1sczZxVktjMVdsL2RGYXp4eXIvRzIreDc2U0xXUEk3UngwaDBWN0JDUWJWcmZTNXJUMFc1WW1EZFAzZmxjaktncUk3eFlnQk1qQzArZ1cxTlFUZWdhd1UyS2pLaFpSMGgxUmlqTS9oZXAyb1VoTUtocGVDc0hTZzhhd2FzV1lDOUFsd1VWczViZ2RBU1ZvRFFFbFlndElRVlVLOUF2VjAvSFZZKy9nRUpRcXMvNkJyMHdncHlkaGVINmJhT2V0eWcwOUJaQXJVTGVXOWR4OUJWR1FGaHgwV2RQcmoyZUV6QWZMZVZ0aHZaeTNFQUN3cytlbmN5ZEZTQ0NnUlgzTEZxWXZRVFZDQzRQcWpXZGMxMFU0SUsrTFNidVlkWHUvRzIyNW1RY2pLZHd6aGJndVVCTXZ5eG0vam44ZDlkeitmenoxZEM4ZmJiWmVheC92cTcyK08rZVNZUVdMemNlWTFDcHR0Z0U5MlM4QU9CeFpJdTdQVW5SdmNFQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUN3d0wvY3ZCSWgwOStoSkFBQUFBQkpSVTVFcmtKZ2dnPT0iLA0KICAgIA0KICAgICAgICB9Ow0KICAgIA0KICAgIA0KICAgICAgICAvLyBhZGRlZCAwLjIuMTogd29yay1hcm91bmQgZm9yIGlPUy9TYWZhcmkgcnVubmluZyBmcm9tIGFuIGlGcmFtZSAoZS5nLiBmcm9tIGl0Y2guaW8gcGFnZSk6DQogICAgICAgIC8vIHRvdWNoIGV2ZW50cyBvbmx5IHJlZ2lzdGVyIGFmdGVyIGFkZGluZyBkdW1teSBsaXN0ZW5lcnMgb24gZG9jdW1lbnQuDQogICAgDQogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB7fSk7DQogICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHt9KTsNCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB7fSk7DQogICAgDQogICAgDQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgIC8vIHBpY28tOCAwLjIuMjogYWxsb3cgZHJvcHBpbmcgZmlsZXMNCiAgICAgICAgdmFyIHA4X2Ryb3BwZWRfY2FydCA9IG51bGw7DQogICAgICAgIHZhciBwOF9kcm9wcGVkX2NhcnRfbmFtZSA9ICIiOw0KICAgICAgICBmdW5jdGlvbiBwOF9kcm9wX2ZpbGUoZSkNCiAgICAgICAgew0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIkBAIGRyb3BwaW5nIGZpbGUuLi4iKTsNCiAgICAgICAgDQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIA0KICAgICAgICAgICAgaWYgKGUuZGF0YVRyYW5zZmVyICYmIGUuZGF0YVRyYW5zZmVyLmZpbGVzICYmIGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIHJlYWQgZnJvbSBmaWxlDQogICAgICAgICAgICAgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgcDhfZHJvcHBlZF9jYXJ0X25hbWUgPSAndW50aXRsZWQucDgnOw0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdLm5hbWUgIT09ICd1bmRlZmluZWQnKSBwOF9kcm9wcGVkX2NhcnRfbmFtZSA9IGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdLm5hbWU7DQogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZS5kYXRhVHJhbnNmZXIuZmlsZXNbMF0uZmlsZU5hbWUgIT09ICd1bmRlZmluZWQnKSBwOF9kcm9wcGVkX2NhcnRfbmFtZSA9IGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdLmZpbGVOYW1lOw0KICAgICAgICAgICAgICAgICAgICBwOF9kcm9wcGVkX2NhcnQgPSByZWFkZXIucmVzdWx0Ow0KICAgICAgICAgICAgICAgICAgICAvLyBkYXRhOmltYWdlL3BuZztiYXNlNjQNCiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICBjb2RvX2NvbW1hbmQgPSA5OyAvLyByZWFkIGRpcmVjdGx5IGZyb20gcDhfZHJvcHBlZF9jYXJ0IHdpdGggbGliYjY0IGRlY29kZXINCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGUuZGF0YVRyYW5zZmVyLmZpbGVzWzBdKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvLyByZWFkIGZyb20gdXJsIChvciBkYXRhIHVybCkNCiAgICAgICAgICAgICAgICB0eHQgPSBlLmRhdGFUcmFuc2Zlci5nZXREYXRhKCdUZXh0Jyk7DQogICAgICAgICAgICAgICAgaWYgKHR4dCl7DQogICAgICAgICAgICAgICAgICAgIHA4X2Ryb3BwZWRfY2FydF9uYW1lID0gInVudGl0bGVkLnA4LnBuZyI7DQogICAgICAgICAgICAgICAgICAgIHA4X2Ryb3BwZWRfY2FydCA9IHR4dDsNCiAgICAgICAgICAgICAgICAgICAgY29kb19jb21tYW5kID0gOTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZnVuY3Rpb24gbm9wKGV2dCkgew0KICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIH0NCiAgICAgICAgZnVuY3Rpb24gZHJhZ292ZXIoZXZ0KSB7DQogICAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIE1vZHVsZS5waWNvOERyYWdPdmVyKCk7DQogICAgICAgIH0NCiAgICAgICAgZnVuY3Rpb24gZHJhZ3N0b3AoZXZ0KSB7DQogICAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIE1vZHVsZS5waWNvOERyYWdTdG9wKCk7DQogICAgICAgIH0NCiAgICANCiAgICAgICAgLy8gZG93bmxvYWQgKHBpY28tOCAwLjIuNGQgd2ViIGV4cG9ydHMgY2FuIHNhdmUgYSAud2F2IGZpbGUpDQogICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkX2Jyb3dzZXJfZmlsZShmaWxlbmFtZSwgY29udGVudHMpDQogICAgICAgIHsNCiAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICBpZiAoZmlsZW5hbWUuc3Vic3RyKGZpbGVuYW1lLmxlbmd0aCAtIDcpID09ICIucDgucG5nIikNCiAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LCcgKyBlbmNvZGVVUklDb21wb25lbnQoY29udGVudHMpKTsNCiAgICAgICAgICBlbHNlIGlmIChmaWxlbmFtZS5zdWJzdHIoZmlsZW5hbWUubGVuZ3RoIC0gNCkgPT0gIi53YXYiKQ0KICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnaHJlZicsICdkYXRhOmF1ZGlvL3gtd2F2O2Jhc2U2NCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KGNvbnRlbnRzKSk7DQogICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnaHJlZicsICdkYXRhOnRleHQvcGxhaW47Y2hhcnNldD11dGYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KGNvbnRlbnRzKSk7DQogICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpOw0KICAgICAgICAgIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOw0KICAgICAgICAgIGVsZW1lbnQuY2xpY2soKTsNCiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOw0KICAgICAgICB9DQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgDQogICAgDQogICAgICAgIHZhciBwOF9idXR0b25zX2hhc2ggPSAtMTsNCiAgICAgICAgZnVuY3Rpb24gcDhfdXBkYXRlX2J1dHRvbl9pY29ucygpDQogICAgICAgIHsNCiAgICAgICAgICAgIC8vIGJ1dHRvbnMgb25seSBhcHBlYXIgd2hlbiBydW5uaW5nDQogICAgICAgICAgICBpZiAoIXA4X2lzX3J1bm5pbmcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHA4X3VwZGF0ZV9idXR0b25faWNvbnMpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBpc19mdWxsc2NyZWVuPShkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC5tb3pGdWxsU2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC53ZWJraXRJc0Z1bGxTY3JlZW4gfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIGhhc2ggYmFzZWQgb246IHBpY284X3N0YXRlLnNvdW5kX3ZvbHVtZSAgcGljbzhfc3RhdGUuaXNfcGF1c2VkIGJvdHRvbV9tYXJnaW4gbGVmdCBpc19mdWxsc2NyZWVuIHA4X3RvdWNoX2RldGVjdGVkDQogICAgICAgICAgICB2YXIgaGFzaCA9IDA7DQogICAgICAgICAgICBoYXNoID0gcGljbzhfc3RhdGUuc291bmRfdm9sdW1lOw0KICAgICAgICAgICAgaWYgKHBpY284X3N0YXRlLmlzX3BhdXNlZCkgaGFzaCArPSAweDEwMDsNCiAgICAgICAgICAgIGlmIChwOF90b3VjaF9kZXRlY3RlZCkgICAgIGhhc2ggKz0gMHgyMDA7DQogICAgICAgICAgICBpZiAoaXNfZnVsbHNjcmVlbikgICAgICAgICBoYXNoICs9IDB4NDAwOw0KICAgIA0KICAgICAgICAgICAgaWYgKHA4X2J1dHRvbnNfaGFzaCA9PSBoYXNoKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShwOF91cGRhdGVfYnV0dG9uX2ljb25zKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHA4X2J1dHRvbnNfaGFzaCA9IGhhc2g7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiQEAgdXBkYXRpbmcgYnV0dG9uIGljb25zIik7DQogICAgDQogICAgICAgICAgICBlbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwOF9tZW51X2J1dHRvbicpOw0KICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBlbCA9IGVsc1tpXTsNCiAgICAgICAgICAgICAgICBpbmRleCA9IGVsLmlkOwkJCQ0KICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSAncDhiX3NvdW5kJykgaW5kZXggKz0gKHBpY284X3N0YXRlLnNvdW5kX3ZvbHVtZSA9PSAwID8gIjAiIDogIjEiKTsgLy8gMSBpZiB1bmRlZmluZWQNCiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gJ3A4Yl9wYXVzZScpIGluZGV4ICs9IChwaWNvOF9zdGF0ZS5pc19wYXVzZWQgPiAwID8gIjEiIDogIjAiKTsgICAgIC8vIDAgaWYgdW5kZWZpbmVkDQogICAgDQogICAgICAgICAgICAgICAgbmV3X3N0ciA9ICc8aW1nIHdpZHRoPTI0IGhlaWdodD0yNCBzdHlsZT0icG9pbnRlci1ldmVudHM6bm9uZSIgc3JjPSInK3A4X2dmeF9kYXRbaW5kZXhdKyciPic7DQogICAgICAgICAgICAgICAgaWYgKGVsLmlubmVySFRNTCAhPSBuZXdfc3RyKQ0KICAgICAgICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSBuZXdfc3RyOw0KICAgIA0KICAgIA0KICAgIA0KICAgIA0KICAgICAgICAgICAgICAgIC8vIGhpZGUgYWxsIGJ1dHRvbnMgZm9yIHRvdWNoIG1vZGUgKGNhbiBwYXVzZSB3aXRoIG1lbnUgYnV0dG9ucykNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB2YXIgaXNfdmlzaWJsZSA9IHA4X2lzX3J1bm5pbmc7DQogICAgDQogICAgICAgICAgICAgICAgaWYgKCghcDhfdG91Y2hfZGV0ZWN0ZWQgfHwgIXA4X2FsbG93X21vYmlsZV9tZW51KSAmJiBlbC5wYXJlbnRFbGVtZW50LmlkID09ICJwOF9tZW51X2J1dHRvbnNfdG91Y2giKQ0KICAgICAgICAgICAgICAgICAgICBpc192aXNpYmxlID0gZmFsc2U7DQogICAgDQogICAgICAgICAgICAgICAgaWYgKHA4X3RvdWNoX2RldGVjdGVkICYmIGVsLnBhcmVudEVsZW1lbnQuaWQgPT0gInA4X21lbnVfYnV0dG9ucyIpDQogICAgICAgICAgICAgICAgICAgIGlzX3Zpc2libGUgPSBmYWxzZTsNCiAgICANCiAgICAgICAgICAgICAgICBpZiAoaXNfZnVsbHNjcmVlbikgDQogICAgICAgICAgICAgICAgICAgIGlzX3Zpc2libGUgPSBmYWxzZTsNCiAgICANCiAgICAgICAgICAgICAgICBpZiAoaXNfdmlzaWJsZSkNCiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheT0iIjsNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmRpc3BsYXk9Im5vbmUiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHA4X3VwZGF0ZV9idXR0b25faWNvbnMpOw0KICAgICAgICB9DQogICAgDQogICAgDQogICAgDQogICAgICAgIGZ1bmN0aW9uIGFicyh4KQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4geCA8IDAgPyAteCA6IHg7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIHN0ZXAgMCBkb3duIDEgZHJhZyAyIHVwIChub3QgdXNlZCkNCiAgICAgICAgZnVuY3Rpb24gcGljbzhfYnV0dG9uc19ldmVudChlLCBzdGVwKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoIXA4X2lzX3J1bm5pbmcpIHJldHVybjsNCiAgICAgICAgDQogICAgICAgICAgICBwaWNvOF9idXR0b25zWzBdID0gMDsNCiAgICANCiAgICAgICAgICAgIGlmIChzdGVwID09IDIgJiYgdHlwZW9mKHBpY284X21vdXNlKSAhPT0gJ3VuZGVmaW5lZCcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcGljbzhfbW91c2VbMl0gPSAwOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB2YXIgbnVtID0gMDsNCiAgICAgICAgICAgIGlmIChlLnRvdWNoZXMpIG51bSA9IGUudG91Y2hlcy5sZW5ndGg7DQogICAgDQogICAgICAgICAgICBpZiAobnVtID09IDAgJiYgdHlwZW9mKHBpY284X21vdXNlKSAhPT0gJ3VuZGVmaW5lZCcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gIG5vIGFjdGl2ZSB0b3VjaGVzOiByZWxlYXNlIG1vdXNlIGJ1dHRvbiBmcm9tIGFueXdoZXJlIG9uIHBhZ2UuIChtYXliZSByZWR1bmRhbnQ/IGJ1dCBqdXN0IGluIGNhc2UpDQogICAgICAgICAgICAgICAgcGljbzhfbW91c2VbMl0gPSAwOw0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bTsgaSsrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHZhciB0b3VjaCA9IGUudG91Y2hlc1tpXTsNCiAgICAgICAgICAgICAgICB2YXIgeCA9IHRvdWNoLmNsaWVudFg7DQogICAgICAgICAgICAgICAgdmFyIHkgPSB0b3VjaC5jbGllbnRZOw0KICAgICAgICAgICAgICAgIHZhciB3ID0gd2luZG93LmlubmVyV2lkdGg7DQogICAgICAgICAgICAgICAgdmFyIGggPSB3aW5kb3cuaW5uZXJIZWlnaHQ7DQogICAgDQogICAgICAgICAgICAgICAgdmFyIHIgPSBNYXRoLm1pbih3LGgpIC8gMTI7DQogICAgICAgICAgICAgICAgaWYgKHIgPiA0MCkgciA9IDQwOw0KICAgIA0KICAgICAgICAgICAgICAgIC8vIG1vdXNlICgwLjEuMTJkKQ0KICAgIA0KICAgICAgICAgICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FudmFzIik7DQogICAgICAgICAgICAgICAgaWYgKHA4X3RvdWNoX2RldGVjdGVkKQ0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YocGljbzhfbW91c2UpICE9PSAndW5kZWZpbmVkJykNCiAgICAgICAgICAgICAgICBpZiAoY2FudmFzKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVjdC50b3AsIHJlY3QucmlnaHQsIHJlY3QuYm90dG9tLCByZWN0LmxlZnQsIHgsIHkpOw0KICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoeCA+PSByZWN0LmxlZnQgJiYgeCA8IHJlY3QucmlnaHQgJiYgeSA+PSByZWN0LnRvcCAmJiB5IDwgcmVjdC5ib3R0b20pDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBpY284X21vdXNlID0gWw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKHggLSByZWN0LmxlZnQpICogMTI4IC8gKHJlY3QucmlnaHQgLSByZWN0LmxlZnQpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKCh5IC0gcmVjdC50b3ApICogMTI4IC8gKHJlY3QuYm90dG9tIC0gcmVjdC50b3ApKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwIDwgMiA/IDEgOiAwDQogICAgICAgICAgICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuOyAvLyBjb21tZW50ZWQgLS0gYmxvY2tzIG92ZXJsYXBwaW5nIGJ1dHRvbnMNCiAgICAgICAgICAgICAgICAgICAgfWVsc2UNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGljbzhfbW91c2VbMl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgIA0KICAgIA0KICAgICAgICAgICAgICAgIC8vIGJ1dHRvbnMNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBiID0gMDsNCiAgICANCiAgICAgICAgICAgICAgICBpZiAoeSA8IGggLSByKjgpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvLyBubyBjb250cm9sbGVyIGJ1dHRvbnMgdXAgaGVyZTsgaW5jbHVkZXMgY2FudmFzIGFuZCBtZW51IGJ1dHRvbnMgYXQgdG9wIGluIHRvdWNoIG1vZGUNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoKHkgPCBoIC0gcio2KSAmJiB5ID4gKGggLSByKjgpKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBtZW51IGJ1dHRvbjogaGFsZiBhcyBoaWdoIGFzIFggTyBidXR0b24NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0cmV0Y2ggYWNyb3NzIHJpZ2h0LWhhbmQgaGFsZiBhYm92ZSBYIE8gYnV0dG9ucw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHggPiB3IC0gciozKSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiIHw9IDB4NDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoeCA8IHcvMiAmJiB4IDwgcio2KQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGljaw0KICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFzayA9IDB4ZjsgLy8gZHBhZA0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN4ID0gMCArIHIqMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjeSA9IGggLSByKjM7DQogICAgDQogICAgICAgICAgICAgICAgICAgICAgICBkZWFkem9uZSA9IHIvMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkeCA9IHggLSBjeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkeSA9IHkgLSBjeTsNCiAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYnMoZHgpID4gYWJzKGR5KSAqIDAuNikgLy8gaG9yaXpvbnRhbCANCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHggPCAtZGVhZHpvbmUpIGIgfD0gMHgxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkeCA+IGRlYWR6b25lKSBiIHw9IDB4MjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYnMoZHkpID4gYWJzKGR4KSAqIDAuNikgLy8gdmVydGljYWwNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHkgPCAtZGVhZHpvbmUpIGIgfD0gMHg0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkeSA+IGRlYWR6b25lKSBiIHw9IDB4ODsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh4ID4gdyAtIHIqNikNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnV0dG9uOyBkaWFnb25hbCBzcGxpdCBmcm9tIGJvdHRvbSByaWdodCBjb3JuZXINCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICBtYXNrID0gMHgzMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25lIG9yIGJvdGggb2YgW1hdLCBbT10NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKGgteSkgPiAody14KSAqIDAuOCkgYiB8PSAweDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAody14KSA+IChoLXkpICogMC44KSBiIHw9IDB4MjA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICAgICAgcGljbzhfYnV0dG9uc1swXSB8PSBiOw0KICAgICAgICAgICAgDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICANCiAgICAgICAgLy8gcDhfdXBkYXRlX2xheW91dF9oYXNoIGlzIHVzZWQgdG8gZGVjaWRlIHdoZW4gdG8gdXBkYXRlIGxheW91dCAoZXhwZW5zaXZlIGVzcGVjaWFsbHkgd2hlbiBwYXJ0IG9mIGEgaGVhdnkgcGFnZSkNCiAgICAgICAgdmFyIHA4X3VwZGF0ZV9sYXlvdXRfaGFzaCA9IC0xOw0KICAgICAgICB2YXIgbGFzdF93aW5kb3dlZF9jb250YWluZXJfaGVpZ2h0ID0gNTEyOw0KICAgICAgICB2YXIgcDhfbGF5b3V0X2ZyYW1lcyA9IDA7DQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X3VwZGF0ZV9sYXlvdXQoKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOw0KICAgICAgICAgICAgdmFyIHA4X3BsYXlhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInA4X3BsYXlhcmVhIik7DQogICAgICAgICAgICB2YXIgcDhfY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInA4X2NvbnRhaW5lciIpOw0KICAgICAgICAgICAgdmFyIHA4X2ZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInA4X2ZyYW1lIik7DQogICAgICAgICAgICB2YXIgY3NpemUgPSA1MTI7DQogICAgICAgICAgICB2YXIgbWFyZ2luX3RvcCA9IDA7DQogICAgICAgICAgICB2YXIgbWFyZ2luX2xlZnQgPSAwOw0KICAgIA0KICAgICAgICAgICAgLy8gcGFnZSBkaWRuJ3QgbG9hZCB5ZXQ/IGZpcnN0IGNhbGwgc2hvdWxkIGJlIGFmdGVyIHA4X2ZyYW1lIGlzIGNyZWF0ZWQgc28gdGhhdCBsYXlvdXQgZG9lc24ndCBqdW1wIGFyb3VuZC4NCiAgICAgICAgICAgIGlmICghY2FudmFzIHx8ICFwOF9wbGF5YXJlYSB8fCAhcDhfY29udGFpbmVyIHx8ICFwOF9mcmFtZSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBwOF91cGRhdGVfbGF5b3V0X2hhc2ggPSAtMTsNCiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocDhfdXBkYXRlX2xheW91dCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgcDhfbGF5b3V0X2ZyYW1lcyArKzsNCiAgICANCiAgICAgICAgICAgIC8vIGFzc3VtZXMgZnJhbWUgZG9lc24ndCBoYXZlIHBhZGRpbmcNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdmFyIGlzX2Z1bGxzY3JlZW49KGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50LndlYmtpdElzRnVsbFNjcmVlbiB8fCBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50KTsNCiAgICAgICAgICAgIHZhciBmcmFtZV93aWR0aCA9IHA4X2ZyYW1lLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgdmFyIGZyYW1lX2hlaWdodCA9IHA4X2ZyYW1lLm9mZnNldEhlaWdodDsNCiAgICANCiAgICAgICAgICAgIGlmIChpc19mdWxsc2NyZWVuKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIHNhbWUgYXMgd2luZG93DQogICAgICAgICAgICAgICAgZnJhbWVfd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsNCiAgICAgICAgICAgICAgICBmcmFtZV9oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlew0KICAgICAgICAgICAgICAgIC8vIG5ldmVyIGxhcmdlciB0aGFuIHdpbmRvdyAgLy8gKGhhcHBlbnMgd2hlbiBhZGRyZXNzIGJhciBpcyBkb3duIGluIHBvcnRyYWlnaHQgbW9kZSBvbiBwaG9uZSkNCiAgICAgICAgICAgICAgICBmcmFtZV93aWR0aCAgPSBNYXRoLm1pbihmcmFtZV93aWR0aCwgd2luZG93LmlubmVyV2lkdGgpOw0KICAgICAgICAgICAgICAgIGZyYW1lX2hlaWdodCA9IE1hdGgubWluKGZyYW1lX2hlaWdodCwgd2luZG93LmlubmVySGVpZ2h0KTsNCiAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgIC8vIGFzIGJpZyBhcyB3aWxsIGZpdCBpbiBhIGZyYW1lLi4NCiAgICAgICAgICAgIGNzaXplID0gIE1hdGgubWluKGZyYW1lX3dpZHRoLGZyYW1lX2hlaWdodCk7DQogICAgDQogICAgICAgICAgICAvLyAuLiBidXQgbmV2ZXIgbW9yZSB0aGFuIDIvMyBvZiBsb25nZXN0IHNpZGUgZm9yIHRvdWNoIChlLmcuIGxlYXZlIHNwYWNlIGZvciBjb250cm9scyBvbiBpUGFkKQ0KICAgICAgICAgICAgaWYgKHA4X3RvdWNoX2RldGVjdGVkICYmIHA4X2lzX3J1bm5pbmcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIGxvbmdlc3Rfc2lkZSA9IE1hdGgubWF4KHdpbmRvdy5pbm5lcldpZHRoLHdpbmRvdy5pbm5lckhlaWdodCk7DQogICAgICAgICAgICAgICAgY3NpemUgPSBNYXRoLm1pbihjc2l6ZSwgbG9uZ2VzdF9zaWRlICogMi8zKTsNCiAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgIC8vIHBpeGVsIHBlcmZlY3Q6IHF1YW50aXplIHRvIGNsb3Nlc3QgbXVsdGlwbGUgb2YgMTI4DQogICAgICAgICAgICAvLyBvbmx5IHdoZW4gbGFyZ2UgZGlzcGxheSAoZGVza3RvcCkNCiAgICAgICAgICAgIGlmIChmcmFtZV93aWR0aCA+PSA1MTIgJiYgZnJhbWVfaGVpZ2h0ID49IDUxMikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjc2l6ZSA9IChjc2l6ZSsxKSAmIH4weDdmOw0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgLy8gY3NpemUgc2hvdWxkIG5ldmVyIGJlIGhpZ2hlciB0aGFuIHBhcmVudCBmcmFtZQ0KICAgICAgICAgICAgLy8gKG90aGVyd2lzZSBzdHJldGNoZWQgbGFyZ2Ugd2hlbiBmdWxsc2NyZWVuIGFuZCB0aGVuIHJldHVybikNCiAgICAgICAgICAgIGlmICghaXNfZnVsbHNjcmVlbiAmJiBwOF9mcmFtZSkgDQogICAgICAgICAgICAgICAgY3NpemUgPSBNYXRoLm1pbihjc2l6ZSwgbGFzdF93aW5kb3dlZF9jb250YWluZXJfaGVpZ2h0KTsgLy8gcDhfZnJhbWVfMCBwYXJlbnQNCiAgICAgICAgICAgIA0KICAgIA0KICAgICAgICAgICAgaWYgKGlzX2Z1bGxzY3JlZW4pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gYWx3YXlzIGNlbnRlciBob3Jpem9udGFsbHkNCiAgICAgICAgICAgICAgICBtYXJnaW5fbGVmdCA9IChmcmFtZV93aWR0aCAtIGNzaXplKS8yOw0KICAgIA0KICAgICAgICAgICAgICAgIGlmIChwOF90b3VjaF9kZXRlY3RlZCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IHdpbmRvdy5pbm5lckhlaWdodCkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9ydHJhaXQ6IGtlZXAgYXQgeT00MCAoYXZvaWQgcm91bmRlZCB0b3AgY29ybmVycyAvIGNhbWVyYSBudWIgdGhpbmcgZXRjLikNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbl90b3AgPSBNYXRoLm1pbig0MCwgZnJhbWVfaGVpZ2h0IC0gY3NpemUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGFuZHNjYXBlOiBwdXQgYSBsaXR0bGUgYWJvdmUgdmVydGljYWwgY2VudGVyDQogICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW5fdG9wID0gKGZyYW1lX2hlaWdodCAtIGNzaXplKS80Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgIC8vIG5vbi10b3VjaDogY2VudGVyIHZlcnRpY2FsbHkNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luX3RvcCA9IChmcmFtZV9oZWlnaHQgLSBjc2l6ZSkvMjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICAvLyBza2lwIGlmIHJlbGV2YW50IHN0YXRlIGhhcyBub3QgY2hhbmdlZA0KICAgIA0KICAgICAgICAgICAgdmFyIHVwZGF0ZV9oYXNoID0gY3NpemUgKyBtYXJnaW5fdG9wICogMTAwMC4zICsgbWFyZ2luX2xlZnQgKiAwLjAwMSArIGZyYW1lX3dpZHRoICogMzMzLjMzICsgZnJhbWVfaGVpZ2h0ICogNzcyLjE1MTM0Ow0KICAgICAgICAgICAgaWYgKGlzX2Z1bGxzY3JlZW4pIHVwZGF0ZV9oYXNoICs9IDAuMTIzNzsNCiAgICANCiAgICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdGhpbmdzIGNhbiBoYXBwZW4gaW4gdGhlIGZpcnN0IGZldyBzZWNvbmRzLCBzbyBqdXN0IGtlZXAgcmUtY2FsY3VsYXRpbmcgbGF5b3V0LiB3YXNtIHZlcnNpb24gYnJlYWtzIGxheW91dCBvdGhlcndpc2UuDQogICAgICAgICAgICAvLyBhbHNvOiBib251cyByZWZyZXNoIGF0IDUsIDggc2Vjb25kcyBqdXN0IGluIGNhc2UgLl8uDQogICAgICAgICAgICBpZiAocDhfbGF5b3V0X2ZyYW1lcyA8IDE4MCB8fCBwOF9sYXlvdXRfZnJhbWVzID09IDYwKjUgfHwgcDhfbGF5b3V0X2ZyYW1lcyA9PSA2MCo4ICkNCiAgICAgICAgICAgICAgICB1cGRhdGVfaGFzaCA9IHA4X2xheW91dF9mcmFtZXM7DQogICAgDQogICAgICAgICAgICBpZiAoIWlzX2Z1bGxzY3JlZW4pIC8vIGZ1bGxzY3JlZW46IHVwZGF0ZSBldmVyeSBmcmFtZSBmb3Igc2FmZXR5LiBzaG91bGQgYmUgY2hlYXAhDQogICAgICAgICAgICBpZiAoIXA4X3RvdWNoX2RldGVjdGVkKSAvLyBtb2JpbGU6IHVwZGF0ZSBldmVyeSBmcmFtZSBiZWNhdXNlIG5vdGhpbmcgY2FuIGJlIHRydXN0ZWQNCiAgICAgICAgICAgIGlmIChwOF91cGRhdGVfbGF5b3V0X2hhc2ggPT0gdXBkYXRlX2hhc2gpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygicDhfdXBkYXRlX2xheW91dCgpOiBza2lwcGluZyIpOw0KICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShwOF91cGRhdGVfbGF5b3V0KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBwOF91cGRhdGVfbGF5b3V0X2hhc2ggPSB1cGRhdGVfaGFzaDsNCiAgICANCiAgICAgICAgICAgIC8vIHJlY29yZCB0aGlzIGZvciByZXR1cm5pbmcgdG8gb3JpZ2luYWwgc2l6ZSBhZnRlciBmdWxsc2NyZWVuIHB1c2hlcyBvdXQgY29udGFpbmVyIGhlaWdodCAoYXJnaCkNCiAgICAgICAgICAgIGlmICghaXNfZnVsbHNjcmVlbiAmJiBwOF9mcmFtZSkNCiAgICAgICAgICAgICAgICBsYXN0X3dpbmRvd2VkX2NvbnRhaW5lcl9oZWlnaHQgPSBwOF9mcmFtZS5wYXJlbnROb2RlLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0Ow0KICAgICAgICAgICAgDQogICAgDQogICAgICAgICAgICAvLyBtb2JpbGUgaW4gcG9ydHJhaXQgbW9kZTogcHV0IHNjcmVlbiBhdCB0b3AgKHcgLyBhIGxpdHRsZSBleHRyYSBzcGFjZSBmb3IgZnVsbHNjcmVlbiBidXR0b24gaWYgbmVlZGVkKQ0KICAgICAgICAgICAgLy8gKGRvbid0IGNhcnQgdG9vIGFib3V0IGJ1dHRvbnMgb3ZlcmxhcHBpbmcgc2NyZWVuKQ0KICAgICAgICAgICAgaWYgKHA4X3RvdWNoX2RldGVjdGVkICYmIHA4X2lzX3J1bm5pbmcgJiYgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCA8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KQ0KICAgICAgICAgICAgICAgIHA4X3BsYXlhcmVhLnN0eWxlLm1hcmdpblRvcCA9IHA4X2FsbG93X21vYmlsZV9tZW51ID8gMzIgOiA4Ow0KICAgICAgICAgICAgZWxzZSBpZiAocDhfdG91Y2hfZGV0ZWN0ZWQgJiYgcDhfaXNfcnVubmluZykgLy8gbGFuZHNjYXBlOiBzbGlnaHRseSBhYm92ZSB2ZXJ0aWNhbCBjZW50ZXIgKG9ubHkgcmVsZXZhbnQgZm9yIGlQYWQgLyBoaWdocmVzIGRldmljZXMpDQogICAgICAgICAgICAgICAgcDhfcGxheWFyZWEuc3R5bGUubWFyZ2luVG9wID0gKGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0IC0gY3NpemUpIC8gNDsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBwOF9wbGF5YXJlYS5zdHlsZS5tYXJnaW5Ub3AgPSAiIjsNCiAgICANCiAgICAgICAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9IGNzaXplOw0KICAgICAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IGNzaXplOw0KICAgIA0KICAgICAgICAgICAgLy8gdG8gZG86IHRoaXMgc2hvdWxkIGp1c3QgaGFwcGVuIGZyb20gY3NzIGxheW91dA0KICAgICAgICAgICAgY2FudmFzLnN0eWxlLm1hcmdpbkxlZnQgPSBtYXJnaW5fbGVmdDsNCiAgICAgICAgICAgIGNhbnZhcy5zdHlsZS5tYXJnaW5Ub3AgPSBtYXJnaW5fdG9wOw0KICAgIA0KICAgICAgICAgICAgcDhfY29udGFpbmVyLnN0eWxlLndpZHRoID0gY3NpemU7DQogICAgICAgICAgICBwOF9jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gY3NpemU7DQogICAgDQogICAgICAgICAgICAvLyBzZXQgbWVudSBidXR0b25zIHBvc2l0aW9uIHRvIGJvdHRvbSByaWdodA0KICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicDhfbWVudV9idXR0b25zIik7DQogICAgICAgICAgICBlbC5zdHlsZS5tYXJnaW5Ub3AgPSBjc2l6ZSAtIGVsLm9mZnNldEhlaWdodDsNCiAgICANCiAgICAgICAgICAgIGlmIChwOF90b3VjaF9kZXRlY3RlZCAmJiBwOF9pc19ydW5uaW5nKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vIHR1cm4gb2ZmIHBvaW50ZXIgZXZlbnRzIHRvIHByZXZlbnQgZG91YmxlLXRhcCB6b29tIGV0YyAod29ya3Mgb24gQW5kcm9pZCkNCiAgICAgICAgICAgICAgICAvLyBkb24ndCB3YW50IHRoaXMgZm9yIGRlc2t0b3AgYmVjYXVzZSBicmVha3MgbW91c2UgaW5wdXQgJiBjbGljay10by1mb2N1cyB3aGVuIHVzaW5nIGNvZG9fdGV4dGFyZWENCiAgICAgICAgICAgICAgICBjYW52YXMuc3R5bGUucG9pbnRlckV2ZW50cyA9ICJub25lIjsNCiAgICANCiAgICAgICAgICAgICAgICBwOF9jb250YWluZXIuc3R5bGUubWFyZ2luVG9wID0gIjBweCI7DQogICAgDQogICAgICAgICAgICAgICAgLy8gYnV0dG9ucw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIHNhbWUgYXMgdG91Y2ggZXZlbnQgaGFuZGxpbmcNCiAgICAgICAgICAgICAgICB2YXIgdyA9IHdpbmRvdy5pbm5lcldpZHRoOw0KICAgICAgICAgICAgICAgIHZhciBoID0gd2luZG93LmlubmVySGVpZ2h0Ow0KICAgICAgICAgICAgICAgIHZhciByID0gTWF0aC5taW4odyxoKSAvIDEyOw0KICAgIA0KICAgICAgICAgICAgICAgIGlmIChyID4gNDApIHIgPSA0MDsNCiAgICANCiAgICAgICAgICAgICAgICBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250cm9sc19yaWdodF9wYW5lbCIpOw0KICAgICAgICAgICAgICAgIGVsLnN0eWxlLmxlZnQgPSB3LXIqNjsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS50b3AgPSBoLXIqNzsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS53aWR0aCA9IHIqNjsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSByKjc7DQogICAgICAgICAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZSgic3JjIikgIT0gcDhfZ2Z4X2RhdFsiY29udHJvbHNfcmlnaHRfcGFuZWwiXSkgLy8gb3B0aW1pc2F0aW9uOiBhdm9pZCByZWxvYWQ/IChicm93c2VyIHNob3VsZCBoYW5kbGUgdGhvdWdoKQ0KICAgICAgICAgICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoInNyYyIsIHA4X2dmeF9kYXRbImNvbnRyb2xzX3JpZ2h0X3BhbmVsIl0pOw0KICAgIA0KICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbnRyb2xzX2xlZnRfcGFuZWwiKTsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS5sZWZ0ID0gMDsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS50b3AgPSBoLXIqNjsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS53aWR0aCA9IHIqNjsNCiAgICAgICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSByKjY7DQogICAgICAgICAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZSgic3JjIikgIT0gcDhfZ2Z4X2RhdFsiY29udHJvbHNfbGVmdF9wYW5lbCJdKSAvLyBvcHRpbWlzYXRpb246IGF2b2lkIHJlbG9hZD8gKGJyb3dzZXIgc2hvdWxkIGhhbmRsZSB0aG91Z2gpDQogICAgICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgic3JjIiwgcDhfZ2Z4X2RhdFsiY29udHJvbHNfbGVmdF9wYW5lbCJdKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyBzY3JvbGwgdG8gY2FydCAoY29tbWVudGVkOyB3YXMgYSBmYWlsZWQgYXR0ZW1wdCB0byBwcmV2ZW50IHNjcm9sbC1vbi1kcmFnIG9uIHNvbWUgYnJvd3NlcnMpDQogICAgICAgICAgICAgICAgLy8gcDhfZnJhbWUuc2Nyb2xsSW50b1ZpZXcodHJ1ZSk7DQogICAgDQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvdWNoX2NvbnRyb2xzX2dmeCIpLnN0eWxlLmRpc3BsYXk9InRhYmxlIjsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidG91Y2hfY29udHJvbHNfYmFja2dyb3VuZCIpLnN0eWxlLmRpc3BsYXk9InRhYmxlIjsNCiAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRvdWNoX2NvbnRyb2xzX2dmeCIpLnN0eWxlLmRpc3BsYXk9Im5vbmUiOw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0b3VjaF9jb250cm9sc19iYWNrZ3JvdW5kIikuc3R5bGUuZGlzcGxheT0ibm9uZSI7DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICBpZiAoIXA4X2lzX3J1bm5pbmcpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcDhfcGxheWFyZWEuc3R5bGUuZGlzcGxheT0ibm9uZSI7DQogICAgICAgICAgICAgICAgcDhfY29udGFpbmVyLnN0eWxlLmRpc3BsYXk9ImZsZXgiOw0KICAgICAgICAgICAgICAgIHA4X2NvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3A9ImF1dG8iOw0KICAgIA0KICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInA4X3N0YXJ0X2J1dHRvbiIpOw0KICAgICAgICAgICAgICAgIGlmIChlbCkgZWwuc3R5bGUuZGlzcGxheT0iZmxleCI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocDhfdXBkYXRlX2xheW91dCk7DQogICAgICAgIH0NCiAgICANCiAgICANCiAgICAgICAgdmFyIHA4X3RvdWNoX2RldGVjdGVkID0gZmFsc2U7DQogICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCBmdW5jdGlvbihldmVudCkNCiAgICAgICAgew0KICAgICAgICAgICAgcDhfdG91Y2hfZGV0ZWN0ZWQgPSB0cnVlOw0KICAgIA0KICAgICAgICAgICAgLy8gaGlkZSBjb2RvX3RleHRhcmVhIC0tIGNsaXBib2FyZCBzdXBwb3J0IG9uIG1vYmlsZSBpcyBub3QgZmVhc2libGUNCiAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvZG9fdGV4dGFyZWEiKTsNCiAgICAgICAgICAgIGlmIChlbCAmJiBlbC5zdHlsZS5kaXNwbGF5ICE9ICJub25lIil7DQogICAgICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheT0ibm9uZSI7DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgIH0sICB7cGFzc2l2ZTogdHJ1ZX0pOw0KICAgIA0KICAgICAgICBmdW5jdGlvbiBwOF9jcmVhdGVfYXVkaW9fY29udGV4dCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChwaWNvOF9hdWRpb19jb250ZXh0KSANCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBwaWNvOF9hdWRpb19jb250ZXh0LnJlc3VtZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjYXRjaChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIioqIHBpY284X2F1ZGlvX2NvbnRleHQucmVzdW1lKCkgZmFpbGVkIik7DQogICAgICAgICAgICAgICAgfQkNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICB2YXIgd2ViQXVkaW9BUEkgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQgfHwgd2luZG93Lm1vekF1ZGlvQ29udGV4dCB8fCB3aW5kb3cub0F1ZGlvQ29udGV4dCB8fCB3aW5kb3cubXNBdWRpb0NvbnRleHQ7CQkJDQogICAgICAgICAgICBpZiAod2ViQXVkaW9BUEkpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcGljbzhfYXVkaW9fY29udGV4dCA9IG5ldyB3ZWJBdWRpb0FQSTsNCiAgICANCiAgICAgICAgICAgICAgICAvLyB3YWtlIHVwIGlPUw0KICAgICAgICAgICAgICAgIGlmIChwaWNvOF9hdWRpb19jb250ZXh0KQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdW1teV9zb3VyY2Vfc2Z4ID0gcGljbzhfYXVkaW9fY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGR1bW15X3NvdXJjZV9zZnguYnVmZmVyID0gcGljbzhfYXVkaW9fY29udGV4dC5jcmVhdGVCdWZmZXIoMSwgMSwgMjIwNTApOyAvLyBkdW1teQ0KICAgICAgICAgICAgICAgICAgICAgICAgZHVtbXlfc291cmNlX3NmeC5jb25uZWN0KHBpY284X2F1ZGlvX2NvbnRleHQuZGVzdGluYXRpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZHVtbXlfc291cmNlX3NmeC5zdGFydCgxLCAwLjI1KTsgLy8gZ2l2ZXMgSW52YWxpZFN0YXRlRXJyb3IgLS0gd2h5PyBoYXNuJ3QgYmVlbiBwbGF5ZWQgYmVmb3JlIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy9kdW1teV9zb3VyY2Vfc2Z4Lm5vdGVPbigwKTsgLy8gZGVsZXRlbWUNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBjYXRjaChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCIqKiBkdW1teV9zb3VyY2Vfc2Z4LnN0YXJ0KDEsIDAuMjUpIGZhaWxlZCIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X2Nsb3NlX2NhcnQoKQ0KICAgICAgICB7DQogICAgICAgICAgICAvLyBqdXN0IHJlbG9hZCBwYWdlISB1c2VkIGZvciB0b3VjaCBidXR0b25zIC0tIGhhcmQgdG8gcm9sbCBiYWNrIHN0YXRlIA0KICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAiIjsgLy8gdHJpZ2dlcnMgcmVsb2FkDQogICAgICAgIH0NCiAgICANCiAgICAgICAgdmFyIHA4X2lzX3J1bm5pbmcgPSBmYWxzZTsNCiAgICAgICAgdmFyIHA4X3NjcmlwdCA9IG51bGw7DQogICAgICAgIHZhciBNb2R1bGUgPSBudWxsOw0KICAgICAgICBmdW5jdGlvbiBwOF9ydW5fY2FydCgpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmIChwOF9pc19ydW5uaW5nKSByZXR1cm47DQogICAgICAgICAgICBwOF9pc19ydW5uaW5nID0gdHJ1ZTsNCiAgICANCiAgICAgICAgICAgIC8vIHRvdWNoOiBoaWRlIGV2ZXJ5dGhpbmcgZXhjZXB0IHA4X2ZyYW1lXzANCiAgICAgICAgICAgIGlmIChwOF90b3VjaF9kZXRlY3RlZCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJib2R5XzAiKTsNCiAgICAgICAgICAgICAgICBlbDIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicDhfZnJhbWVfMCIpOw0KICAgICAgICAgICAgICAgIGlmIChlbCAmJiBlbDIpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5kaXNwbGF5PSJub25lIjsNCiAgICAgICAgICAgICAgICAgICAgZWwucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChlbDIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgIC8vIGNyZWF0ZSBhdWRpbyBjb250ZXh0IGFuZCB3YWtlIGl0IHVwIChmb3IgaU9TIC0tIG5lZWRzIGhhcHBlbiBpbnNpZGUgdG91Y2ggZXZlbnQpCQkNCiAgICAgICAgICAgIHA4X2NyZWF0ZV9hdWRpb19jb250ZXh0KCk7DQogICAgDQogICAgICAgICAgICAvLyBzaG93IHRvdWNoIGVsZW1lbnRzDQogICAgICAgICAgICBlbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwOF9jb250cm9sbGVyX2FyZWEnKTsNCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZWxzW2ldLnN0eWxlLmRpc3BsYXk9IiI7DQogICAgDQogICAgDQogICAgICAgICAgICAvLyBpbnN0YWxsIHRvdWNoIGV2ZW50cy4gVGhlc2UgYWxzbyBzZXJ2ZSB0byBibG9jayBzY3JvbGxpbmcgLyBwaW5jaGluZyAvIHpvb21pbmcgb24gcGhvbmVzIHdoZW4gcDhfaXNfcnVubmluZw0KICAgICAgICAgICAgICAgIC8vIG1vdmVkIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IGNhbGxzIGludG8gcGljbzhfYnV0dG9uc19ldmVudCgpICh3YW50IHRvIGxldCB0b3AgYnV0dG9ucyBwYXNzIHRocm91Z2gpDQogICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgZnVuY3Rpb24oZXZlbnQpeyBwaWNvOF9idXR0b25zX2V2ZW50KGV2ZW50LCAwKTsgfSwge3Bhc3NpdmU6IGZhbHNlfSk7DQogICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCAgZnVuY3Rpb24oZXZlbnQpeyBwaWNvOF9idXR0b25zX2V2ZW50KGV2ZW50LCAxKTsgfSwge3Bhc3NpdmU6IGZhbHNlfSk7DQogICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKCJ0b3VjaGVuZCIsICAgZnVuY3Rpb24oZXZlbnQpeyBwaWNvOF9idXR0b25zX2V2ZW50KGV2ZW50LCAyKTsgfSwge3Bhc3NpdmU6IGZhbHNlfSk7DQogICAgDQogICAgDQogICAgICAgICAgICAvLyBsb2FkIGFuZCBydW4gc2NyaXB0DQogICAgICAgICAgICBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7DQogICAgICAgICAgICBwOF9zY3JpcHQgPSBlOw0KICAgICAgICAgICAgZS5vbmxvYWQgPSBmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIHNob3cgY2FudmFzIC8gbWVudSBidXR0b25zIG9ubHkgYWZ0ZXIgbG9hZGluZw0KICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInA4X3BsYXlhcmVhIik7DQogICAgICAgICAgICAgICAgaWYgKGVsKSBlbC5zdHlsZS5kaXNwbGF5PSJ0YWJsZSI7DQogICAgDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZihwOF91cGRhdGVfbGF5b3V0X2hhc2gpICE9PSAndW5kZWZpbmVkJykNCiAgICAgICAgICAgICAgICAgICAgcDhfdXBkYXRlX2xheW91dF9oYXNoID0gLTc3Ow0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YocDhfYnV0dG9uc19oYXNoKSAhPT0gJ3VuZGVmaW5lZCcpDQogICAgICAgICAgICAgICAgICAgIHA4X2J1dHRvbnNfaGFzaCA9IC0zMzsNCiAgICANCiAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGUudHlwZSA9ICJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0IjsNCiAgICAgICAgICAgIGUuc3JjID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9idWJibHMvVUdTLUFzc2V0c0BlY2IxNDA3YjVhMTlhZmZiYTU5YzQyYmY2NjY0NzNiZjE1N2I3MTQ5L2FsbG9jYXRpb24uanMiOw0KICAgICAgICAgICAgZS5pZCA9ICJlX3NjcmlwdCI7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZSk7IC8vIGxvYWQgYW5kIHJ1bg0KICAgIA0KICAgICAgICAgICAgLy8gaGlkZSBzdGFydCBidXR0b24gYW5kIHNob3cgY2FudmFzIC8gbWVudSBidXR0b25zLiBoaWRlIHN0YXJ0IGJ1dHRvbg0KICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicDhfc3RhcnRfYnV0dG9uIik7DQogICAgICAgICAgICBpZiAoZWwpIGVsLnN0eWxlLmRpc3BsYXk9Im5vbmUiOw0KICAgIA0KICAgICAgICAgICAgLy8gYWRkICNwbGF5aW5nIGZvciB0b3VjaHNjcmVlbiBkZXZpY2VzIChhbGxvd3MgYmFjayBidXR0b24gdG8gY2xvc2UpDQogICAgICAgICAgICAvLyBYIGJ1dHRvbiBjYW4gYWxzbyBiZSB1c2VkIHRvIHRyaWdnZXIgdGhpcyANCiAgICAgICAgICAgIGlmIChwOF90b3VjaF9kZXRlY3RlZCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICIjcGxheWluZyI7DQogICAgICAgICAgICAgICAgd2luZG93Lm9uaGFzaGNoYW5nZSA9IGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaC5zZWFyY2goInBsYXlpbmciKSA8IDApDQogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgLy8gaW5zdGFsbCBkcmFnJmRyb3AgbGlzdGVuZXJzDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsNCiAgICAgICAgICAgICAgICBpZiAoY2FudmFzKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGRyYWdvdmVyLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGRyYWdvdmVyLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBkcmFnc3RvcCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIG5vcCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHA4X2Ryb3BfZmlsZSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIA0KICAgICAgICANCiAgICAgICAgICAgIC8vIEdhbWVwYWQgY29kZQ0KICAgICAgICANCiAgICAgICAgdmFyIFA4X0JVVFRPTl9PID0ge2FjdGlvbjonYnV0dG9uJywgY29kZTogMHgxMH07DQogICAgICAgIHZhciBQOF9CVVRUT05fWCA9IHthY3Rpb246J2J1dHRvbicsIGNvZGU6IDB4MjB9Ow0KICAgICAgICB2YXIgUDhfRFBBRF9MRUZUID0ge2FjdGlvbjonYnV0dG9uJywgY29kZTogMHgxfTsNCiAgICAgICAgdmFyIFA4X0RQQURfUklHSFQgPSB7YWN0aW9uOididXR0b24nLCBjb2RlOiAweDJ9Ow0KICAgICAgICB2YXIgUDhfRFBBRF9VUCA9IHthY3Rpb246J2J1dHRvbicsIGNvZGU6IDB4NH07DQogICAgICAgIHZhciBQOF9EUEFEX0RPV04gPSB7YWN0aW9uOididXR0b24nLCBjb2RlOiAweDh9Ow0KICAgICAgICB2YXIgUDhfTUVOVSA9IHthY3Rpb246J21lbnUnfTsNCiAgICAgICAgdmFyIFA4X05PX0FDVElPTiA9IHthY3Rpb246J25vbmUnfTsNCiAgICANCiAgICAgICAgdmFyIFA4X0JVVFRPTl9NQVBQSU5HID0gWw0KICAgICAgICAgICAgLy8gcmVmOiBodHRwczovL3czYy5naXRodWIuaW8vZ2FtZXBhZC8jcmVtYXBwaW5nDQogICAgICAgICAgICBQOF9CVVRUT05fTywgICAgICAgICAgLy8gQm90dG9tIGZhY2UgYnV0dG9uDQogICAgICAgICAgICBQOF9CVVRUT05fWCwgICAgICAgICAgLy8gUmlnaHQgZmFjZSBidXR0b24NCiAgICAgICAgICAgIFA4X0JVVFRPTl9YLCAgICAgICAgICAvLyBMZWZ0IGZhY2UgYnV0dG9uDQogICAgICAgICAgICBQOF9CVVRUT05fTywgICAgICAgICAgLy8gVG9wIGZhY2UgYnV0dG9uDQogICAgICAgICAgICBQOF9OT19BQ1RJT04sICAgICAgICAgLy8gTmVhciBsZWZ0IHNob3VsZGVyIGJ1dHRvbiAoTDEpDQogICAgICAgICAgICBQOF9OT19BQ1RJT04sICAgICAgICAgLy8gTmVhciByaWdodCBzaG91bGRlciBidXR0b24gKFIxKQ0KICAgICAgICAgICAgUDhfTk9fQUNUSU9OLCAgICAgICAgIC8vIEZhciBsZWZ0IHNob3VsZGVyIGJ1dHRvbiAoTDIpDQogICAgICAgICAgICBQOF9OT19BQ1RJT04sICAgICAgICAgLy8gRmFyIHJpZ2h0IHNob3VsZGVyIGJ1dHRvbiAoUjIpDQogICAgICAgICAgICBQOF9NRU5VLCAgICAgICAgICAgICAgLy8gTGVmdCBhdXhpbGlhcnkgYnV0dG9uIChzZWxlY3QpDQogICAgICAgICAgICBQOF9NRU5VLCAgICAgICAgICAgICAgLy8gUmlnaHQgYXV4aWxpYXJ5IGJ1dHRvbiAoc3RhcnQpDQogICAgICAgICAgICBQOF9OT19BQ1RJT04sICAgICAgICAgLy8gTGVmdCBzdGljayBidXR0b24NCiAgICAgICAgICAgIFA4X05PX0FDVElPTiwgICAgICAgICAvLyBSaWdodCBzdGljayBidXR0b24NCiAgICAgICAgICAgIFA4X0RQQURfVVAsICAgICAgICAgICAvLyBEcGFkIHVwDQogICAgICAgICAgICBQOF9EUEFEX0RPV04sICAgICAgICAgLy8gRHBhZCBkb3duDQogICAgICAgICAgICBQOF9EUEFEX0xFRlQsICAgICAgICAgLy8gRHBhZCBsZWZ0DQogICAgICAgICAgICBQOF9EUEFEX1JJR0hULCAgICAgICAgLy8gRHBhZCByaWdodA0KICAgICAgICBdOw0KICAgIA0KICAgICAgICAvLyBUcmFjayB3aGljaCBwbGF5ZXIgaXMgY29udHJvbGxlciBieSBlYWNoIGdhbWVwYWQuIEdhbWVwYWQgaW5kZXggaSBjb250cm9scyB0aGUNCiAgICAgICAgLy8gcGxheWVyIHdpdGggaW5kZXggcGljbzhfZ2FtZXBhZHNfbWFwcGluZ1tpXS4gR2FtZXBhZHMgd2l0aCBudWxsIHBsYXllciBhcmUNCiAgICAgICAgLy8gY3VycmVudGx5IHVuYXNzaWduZWQgLSB0aGV5IGdldCBhc3NpZ25lZCB0byBhIHBsYXllciB3aGVuIGEgYnV0dG9uIGlzIHByZXNzZWQuDQogICAgICAgIHZhciBwaWNvOF9nYW1lcGFkc19tYXBwaW5nID0gW107DQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X3VuYXNzaWduX2dhbWVwYWQoZ2FtZXBhZF9pbmRleCkgew0KICAgICAgICAgICAgaWYgKHBpY284X2dhbWVwYWRzX21hcHBpbmdbZ2FtZXBhZF9pbmRleF0gPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHBpY284X2J1dHRvbnNbcGljbzhfZ2FtZXBhZHNfbWFwcGluZ1tnYW1lcGFkX2luZGV4XV0gPSAwOw0KICAgICAgICAgICAgcGljbzhfZ2FtZXBhZHNfbWFwcGluZ1tnYW1lcGFkX2luZGV4XSA9IG51bGw7DQogICAgICAgIH0NCiAgICANCiAgICANCiAgICAgICAgZnVuY3Rpb24gcDhfZmlyc3RfcGxheWVyX3dpdGhvdXRfZ2FtZXBhZChtYXhfcGxheWVycykgew0KICAgICAgICAgICAgdmFyIGFsbG9jYXRlZF9wbGF5ZXJzID0gcGljbzhfZ2FtZXBhZHNfbWFwcGluZy5maWx0ZXIoZnVuY3Rpb24oeCkgeyByZXR1cm4geCAhPSBudWxsOyB9KTsNCiAgICAgICAgICAgIHZhciBzb3J0ZWRfcGxheWVycyA9IEFycmF5LmZyb20oYWxsb2NhdGVkX3BsYXllcnMpLnNvcnQoKTsNCiAgICAgICAgICAgIGZvciAodmFyIGRlc2lyZWQgPSAwOyBkZXNpcmVkIDwgc29ydGVkX3BsYXllcnMubGVuZ3RoICYmIGRlc2lyZWQgPCBtYXhfcGxheWVyczsgKytkZXNpcmVkKSB7DQogICAgICAgICAgICAgICAgaWYgKGRlc2lyZWQgIT0gc29ydGVkX3BsYXllcnNbZGVzaXJlZF0pIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlc2lyZWQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHNvcnRlZF9wbGF5ZXJzLmxlbmd0aCA8IG1heF9wbGF5ZXJzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHNvcnRlZF9wbGF5ZXJzLmxlbmd0aDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICB9DQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X2Fzc2lnbl9nYW1lcGFkX3RvX3BsYXllcihnYW1lcGFkX2luZGV4LCBwbGF5ZXJfaW5kZXgpIHsNCiAgICAgICAgICAgIHA4X3VuYXNzaWduX2dhbWVwYWQoZ2FtZXBhZF9pbmRleCk7DQogICAgICAgICAgICBwaWNvOF9nYW1lcGFkc19tYXBwaW5nW2dhbWVwYWRfaW5kZXhdID0gcGxheWVyX2luZGV4Ow0KICAgICAgICB9DQogICAgDQogICAgDQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X2NvbnZlcnRfc3RhbmRhcmRfZ2FtZXBhZF90b19idXR0b25fc3RhdGUoZ2FtZXBhZCwgYXhpc190aHJlc2hvbGQsIGJ1dHRvbl90aHJlc2hvbGQpIHsNCiAgICAgICAgICAgIC8vIEdpdmVuIGEgZ2FtZXBhZCBvYmplY3QsIHJldHVybjoNCiAgICAgICAgICAgIC8vIHsNCiAgICAgICAgICAgIC8vICAgICBidXR0b25fc3RhdGU6IHRoZSBiaW5hcnkgZW5jb2RlZCBQaWNvIDggYnV0dG9uIHN0YXRlDQogICAgICAgICAgICAvLyAgICAgbWVudV9idXR0b246IHRydWUgaWYgYW55IG1lbnUtbWFwcGVkIGJ1dHRvbiB3YXMgcHJlc3NlZA0KICAgICAgICAgICAgLy8gICAgIGFueV9idXR0b246IHRydWUgaWYgYW55IGJ1dHRvbiB3YXMgcHJlc3NlZCwgaW5jbHVkaW5nIGQtcGFkDQogICAgICAgICAgICAvLyAgICAgICAgIGJ1dHRvbnMgYW5kIHVubWFwcGVkIGJ1dHRvbnMNCiAgICAgICAgICAgIC8vIH0NCiAgICAgICAgICAgIGlmICghZ2FtZXBhZCB8fCAhZ2FtZXBhZC5heGVzIHx8ICFnYW1lcGFkLmJ1dHRvbnMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICBidXR0b25fc3RhdGU6IDAsDQogICAgICAgICAgICAgICAgICAgIG1lbnVfYnV0dG9uOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgYW55X2J1dHRvbjogZmFsc2UNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZnVuY3Rpb24gYnV0dG9uX3N0YXRlX2Zyb21fYXhpcyhheGlzLCBsb3dfc3RhdGUsIGhpZ2hfc3RhdGUsIGRlZmF1bHRfc3RhdGUpIHsNCiAgICAgICAgICAgICAgICBpZiAoYXhpcyAmJiBheGlzIDwgLWF4aXNfdGhyZXNob2xkKSByZXR1cm4gbG93X3N0YXRlOw0KICAgICAgICAgICAgICAgIGlmIChheGlzICYmIGF4aXMgPiBheGlzX3RocmVzaG9sZCkgcmV0dXJuIGhpZ2hfc3RhdGU7DQogICAgICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRfc3RhdGU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgYXhlc19hY3Rpb25zID0gWw0KICAgICAgICAgICAgICAgIGJ1dHRvbl9zdGF0ZV9mcm9tX2F4aXMoZ2FtZXBhZC5heGVzWzBdLCBQOF9EUEFEX0xFRlQsIFA4X0RQQURfUklHSFQsIFA4X05PX0FDVElPTiksDQogICAgICAgICAgICAgICAgYnV0dG9uX3N0YXRlX2Zyb21fYXhpcyhnYW1lcGFkLmF4ZXNbMV0sIFA4X0RQQURfVVAsIFA4X0RQQURfRE9XTiwgUDhfTk9fQUNUSU9OKSwNCiAgICAgICAgICAgIF07DQogICAgDQogICAgICAgICAgICB2YXIgYnV0dG9uX2FjdGlvbnMgPSBnYW1lcGFkLmJ1dHRvbnMubWFwKGZ1bmN0aW9uIChidXR0b24sIGluZGV4KSB7DQogICAgICAgICAgICAgICAgdmFyIHByZXNzZWQgPSBidXR0b24udmFsdWUgPiBidXR0b25fdGhyZXNob2xkIHx8IGJ1dHRvbi5wcmVzc2VkOw0KICAgICAgICAgICAgICAgIGlmICghcHJlc3NlZCkgcmV0dXJuIFA4X05PX0FDVElPTjsNCiAgICAgICAgICAgICAgICByZXR1cm4gUDhfQlVUVE9OX01BUFBJTkdbaW5kZXhdIHx8IFA4X05PX0FDVElPTjsNCiAgICAgICAgICAgIH0pOw0KICAgIA0KICAgICAgICAgICAgdmFyIGFsbF9hY3Rpb25zID0gYXhlc19hY3Rpb25zLmNvbmNhdChidXR0b25fYWN0aW9ucyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHZhciBtZW51X2J1dHRvbiA9IGJ1dHRvbl9hY3Rpb25zLnNvbWUoZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gYWN0aW9uLmFjdGlvbiA9PSAnbWVudSc7IH0pOw0KICAgICAgICAgICAgdmFyIGJ1dHRvbl9zdGF0ZSA9IChhbGxfYWN0aW9ucw0KICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuYWN0aW9uID09ICdidXR0b24nOyB9KQ0KICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuY29kZTsgfSkNCiAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChyZXN1bHQsIGNvZGUpIHsgcmV0dXJuIHJlc3VsdCB8IGNvZGU7IH0sIDApDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgdmFyIGFueV9idXR0b24gPSBnYW1lcGFkLmJ1dHRvbnMuc29tZShmdW5jdGlvbiAoYnV0dG9uKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbi52YWx1ZSA+IGJ1dHRvbl90aHJlc2hvbGQgfHwgYnV0dG9uLnByZXNzZWQ7DQogICAgICAgICAgICB9KTsNCiAgICANCiAgICAgICAgICAgIGFueV9idXR0b24gfD0gYnV0dG9uX3N0YXRlOyAvL2p3dzogaW5jbHVkZSBheGVzIDAsMSBhcyBtaWdodCBiZSBmaXJzdCBpbnRlbmRlZCBhY3Rpb24NCiAgICANCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgYnV0dG9uX3N0YXRlLA0KICAgICAgICAgICAgICAgIG1lbnVfYnV0dG9uLA0KICAgICAgICAgICAgICAgIGFueV9idXR0b24NCiAgICAgICAgICAgIH07DQogICAgICAgIH0NCiAgICANCiAgICAgICAgLy8gand3OiBwaWNvLTggMC4yLjEgdmVyc2lvbiBmb3IgdW5tYXBwZWQgZ2FtZXBhZHMsIGZvbGxvd2luZyBwOF9jb252ZXJ0X3N0YW5kYXJkX2dhbWVwYWRfdG9fYnV0dG9uX3N0YXRlDQogICAgICAgIC8vIGF4ZXMgMCwxICYgYnV0dG9ucyAwLDEsMiwzIGFyZSByZWFzb25hYmx5IHNhZmUuIGRvbid0IHRyeSB0byByZWFkIGRwYWQuDQogICAgICAgIC8vIG1lbnUgYnV0dG9ucyBhcmUgdW5wcmVkaWN0YWJsZSwgYnV0IHVzZSA2Li44IGFueXdheSAoYmV0dGVyIHRvIGhhdmUgYSB3ZWlyZCBtZW51IGJ1dHRvbiB0aGFuIG5vbmUpDQogICAgDQogICAgICAgIGZ1bmN0aW9uIHA4X2NvbnZlcnRfdW5tYXBwZWRfZ2FtZXBhZF90b19idXR0b25fc3RhdGUoZ2FtZXBhZCwgYXhpc190aHJlc2hvbGQsIGJ1dHRvbl90aHJlc2hvbGQpIHsNCiAgICANCiAgICAgICAgICAgIGlmICghZ2FtZXBhZCB8fCAhZ2FtZXBhZC5heGVzIHx8ICFnYW1lcGFkLmJ1dHRvbnMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICBidXR0b25fc3RhdGU6IDAsDQogICAgICAgICAgICAgICAgICAgIG1lbnVfYnV0dG9uOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgYW55X2J1dHRvbjogZmFsc2UNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgdmFyIGJ1dHRvbl9zdGF0ZSA9IDA7DQogICAgDQogICAgICAgICAgICBpZiAoZ2FtZXBhZC5heGVzWzBdICYmIGdhbWVwYWQuYXhlc1swXSA8IC1heGlzX3RocmVzaG9sZCkgYnV0dG9uX3N0YXRlIHw9IDB4MTsNCiAgICAgICAgICAgIGlmIChnYW1lcGFkLmF4ZXNbMF0gJiYgZ2FtZXBhZC5heGVzWzBdID4gYXhpc190aHJlc2hvbGQpICBidXR0b25fc3RhdGUgfD0gMHgyOw0KICAgICAgICAgICAgaWYgKGdhbWVwYWQuYXhlc1sxXSAmJiBnYW1lcGFkLmF4ZXNbMV0gPCAtYXhpc190aHJlc2hvbGQpIGJ1dHRvbl9zdGF0ZSB8PSAweDQ7DQogICAgICAgICAgICBpZiAoZ2FtZXBhZC5heGVzWzFdICYmIGdhbWVwYWQuYXhlc1sxXSA+IGF4aXNfdGhyZXNob2xkKSAgYnV0dG9uX3N0YXRlIHw9IDB4ODsNCiAgICANCiAgICAgICAgICAgIC8vIGJ1dHRvbnM6IGZpcnN0IDQgdGFrZW4gdG8gYmUgTy9YLCA2Li44IHRha2VuIHRvIGJlIG1lbnUgYnV0dG9uDQogICAgDQogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgZ2FtZXBhZC5idXR0b25zLmxlbmd0aDsgaisrKQ0KICAgICAgICAgICAgaWYgKGdhbWVwYWQuYnV0dG9uc1tqXS52YWx1ZSA+IDAgfHwgZ2FtZXBhZC5idXR0b25zW2pdLnByZXNzZWQpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKGogPCA0KQ0KICAgICAgICAgICAgICAgICAgICBidXR0b25fc3RhdGUgfD0gKDB4MTAgPDwgKCgoaisxKS8yKSYxKSk7IC8vIDAgMSAxIDAgLS0gQSxYIC0+IE8sWCBvbiB4Ym94MzYwDQogICAgICAgICAgICAgICAgZWxzZSBpZiAoaiA+PSA2ICYmIGogPD0gOCkNCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uX3N0YXRlIHw9IDB4NDA7DQogICAgICAgICAgICB9DQogICAgDQogICAgICAgICAgICB2YXIgbWVudV9idXR0b24gPSBidXR0b25fc3RhdGUgJiAweDQwOw0KICAgIA0KICAgICAgICAgICAgdmFyIGFueV9idXR0b24gPSBnYW1lcGFkLmJ1dHRvbnMuc29tZShmdW5jdGlvbiAoYnV0dG9uKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbi52YWx1ZSA+IGJ1dHRvbl90aHJlc2hvbGQgfHwgYnV0dG9uLnByZXNzZWQ7DQogICAgICAgICAgICB9KTsNCiAgICANCiAgICAgICAgICAgIGFueV9idXR0b24gfD0gYnV0dG9uX3N0YXRlOyAvL2p3dzogaW5jbHVkZSBheGVzIDAsMSBhcyBtaWdodCBiZSBmaXJzdCBpbnRlbmRlZCBhY3Rpb24NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBidXR0b25fc3RhdGUsDQogICAgICAgICAgICAgICAgbWVudV9idXR0b24sDQogICAgICAgICAgICAgICAgYW55X2J1dHRvbg0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgIA0KICAgICAgICANCiAgICAgICAgLy8gZ2FtZXBhZCAgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0dhbWVwYWRfQVBJL1VzaW5nX3RoZV9HYW1lcGFkX0FQSQ0KICAgICAgICAvLyAoc2V0cyBiaXRzIGluIHBpY284X2J1dHRvbnNbXSkNCiAgICAgICAgZnVuY3Rpb24gcDhfdXBkYXRlX2dhbWVwYWRzKCkgew0KICAgICAgICAgICAgdmFyIGF4aXNfdGhyZXNob2xkID0gMC4zOw0KICAgICAgICAgICAgdmFyIGJ1dHRvbl90aHJlc2hvbGQgPSAwLjU7IC8vIFNob3VsZCBiZSB1bm5lY2Vzc2FyeSwgd2Ugc2hvdWxkIGJlIGFibGUgdG8gdHJ1c3QgLnByZXNzZWQNCiAgICAgICAgICAgIHZhciBtYXhfcGxheWVycyA9IDg7DQogICAgICAgICAgICB2YXIgZ3BzID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzKCkgfHwgbmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKCk7DQogICAgDQogICAgICAgICAgICBpZiAoIWdwcykgcmV0dXJuOw0KICAgIA0KICAgICAgICAgICAgLy8gSW4gQ2hyb21lLCBncHMgaXMgaXRlcmFibGUgYnV0IGl0J3Mgbm90IGFuIGFycmF5Lg0KICAgICAgICAgICAgZ3BzID0gQXJyYXkuZnJvbShncHMpOw0KICAgIA0KICAgICAgICAgICAgcGljbzhfZ2FtZXBhZHMuY291bnQgPSBncHMubGVuZ3RoOw0KICAgICAgICAgICAgd2hpbGUgKGdwcy5sZW5ndGggPiBwaWNvOF9nYW1lcGFkc19tYXBwaW5nLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHBpY284X2dhbWVwYWRzX21hcHBpbmcucHVzaChudWxsKTsNCiAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgIHZhciBtZW51X2J1dHRvbiA9IGZhbHNlOw0KICAgICAgICAgICAgdmFyIGdhbWVwYWRfc3RhdGVzID0gZ3BzLm1hcChmdW5jdGlvbiAoZ3ApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gKGdwICYmIGdwLm1hcHBpbmcgPT0gInN0YW5kYXJkIikgPw0KICAgICAgICAgICAgICAgICAgICBwOF9jb252ZXJ0X3N0YW5kYXJkX2dhbWVwYWRfdG9fYnV0dG9uX3N0YXRlKGdwLCBheGlzX3RocmVzaG9sZCwgYnV0dG9uX3RocmVzaG9sZCkgOg0KICAgICAgICAgICAgICAgICAgICBwOF9jb252ZXJ0X3VubWFwcGVkX2dhbWVwYWRfdG9fYnV0dG9uX3N0YXRlKGdwLCBheGlzX3RocmVzaG9sZCwgYnV0dG9uX3RocmVzaG9sZCk7DQogICAgICAgICAgICB9KTsNCiAgICANCiAgICAgICAgICAgIC8vIFVuYXNzaWduIGRpc2Nvbm5lY3RlZCBnYW1lcGFkcy4NCiAgICAgICAgICAgIC8vIGdwcy5mb3JFYWNoKGZ1bmN0aW9uIChncCwgaSkgeyBpZiAoZ3AgJiYgIWdwLmNvbm5lY3RlZCkgeyBwOF91bmFzc2lnbl9nYW1lcGFkKGkpOyB9fSk7DQogICAgICAgICAgICBncHMuZm9yRWFjaChmdW5jdGlvbiAoZ3AsIGkpIHsgaWYgKCFncCB8fCAhZ3AuY29ubmVjdGVkKSB7IHA4X3VuYXNzaWduX2dhbWVwYWQoaSk7IH19KTsgLy8gaHR0cHM6Ly93d3cubGV4YWxvZmZsZS5jb20vYmJzLz9waWQ9ODcxMzIjcA0KICAgIA0KICAgIA0KICAgICAgICAgICAgLy8gQXNzaWduIHVuYXNzaWduZWQgZ2FtZXBhZHMgd2hlbiBhbnkgYnV0dG9uIGlzIHByZXNzZWQuDQogICAgICAgICAgICBnYW1lcGFkX3N0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdGF0ZSwgaSkgew0KICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5hbnlfYnV0dG9uICYmIHBpY284X2dhbWVwYWRzX21hcHBpbmdbaV0gPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RfZnJlZV9wbGF5ZXIgPSBwOF9maXJzdF9wbGF5ZXJfd2l0aG91dF9nYW1lcGFkKG1heF9wbGF5ZXJzKTsNCiAgICAgICAgICAgICAgICAgICAgcDhfYXNzaWduX2dhbWVwYWRfdG9fcGxheWVyKGksIGZpcnN0X2ZyZWVfcGxheWVyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICANCiAgICAgICAgICAgIC8vIFVwZGF0ZSBwaWNvOF9idXR0b25zIGFycmF5Lg0KICAgICAgICAgICAgZ2FtZXBhZF9zdGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoZ2FtZXBhZF9zdGF0ZSwgaSkgew0KICAgICAgICAgICAgICAgIGlmIChwaWNvOF9nYW1lcGFkc19tYXBwaW5nW2ldICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgcGljbzhfYnV0dG9uc1twaWNvOF9nYW1lcGFkc19tYXBwaW5nW2ldXSA9IGdhbWVwYWRfc3RhdGUuYnV0dG9uX3N0YXRlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgIA0KICAgICAgICAgICAgLy8gVXBkYXRlIG1lbnUgYnV0dG9uLg0KICAgICAgICAgICAgLy8gUGljbyA4IG9ubHkgcmVjb2duaXNlcyB0aGUgbWVudSBidXR0b24gb24gdGhlIGZpcnN0IHBsYXllciwgc28gd2UNCiAgICAgICAgICAgIC8vIHByZXNzIGl0IHdoZW4gYW55IGdhbWVwYWQgaGFzIHByZXNzZWQgYSBidXR0b24gbWFwcGVkIHRvIG1lbnUuDQogICAgICAgICAgICBpZiAoZ2FtZXBhZF9zdGF0ZXMuc29tZShmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIHN0YXRlLm1lbnVfYnV0dG9uOyB9KSkgew0KICAgICAgICAgICAgICAgIHBpY284X2J1dHRvbnNbMF0gfD0gMHg0MDsNCiAgICAgICAgICAgIH0NCiAgICANCiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShwOF91cGRhdGVfZ2FtZXBhZHMpOw0KICAgICAgICB9DQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShwOF91cGRhdGVfZ2FtZXBhZHMpOw0KICAgIA0KICAgICAgICAvLyBFbmQgb2YgZ2FtZXBhZCBjb2RlDQogICAgDQogICAgDQogICAgICAgIC8vIGtleSBibG9ja2VyLiBwcmV2ZW50IGJyb3dzZXIgb3BlcmF0aW9ucyB3aGlsZSBwbGF5aW5nIGNhcnQgc28gdGhhdCBQSUNPLTggY2FuIHVzZSB0aG9zZSBrZXlzIGUuZy4gY3Vyc29ycyB0byBzY3JvbGwsIGN0cmwtciB0byByZWxvYWQNCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsDQogICAgICAgIGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICAgICAgZXZlbnQgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7DQogICAgICAgICAgICBpZiAoIXA4X2lzX3J1bm5pbmcpIHJldHVybjsNCiAgICANCiAgICAgICAgICAgIGlmIChwaWNvOF9zdGF0ZS5oYXNfZm9jdXMgPT0gMSkNCiAgICAgICAgICAgICAgICBpZiAoWzMyLCAzNywgMzgsIDM5LCA0MCwgNzcsIDgyLCA4MCwgOV0uaW5kZXhPZihldmVudC5rZXlDb2RlKSA+IC0xKSAgICAgICAvLyBibG9jayBvbmx5IGN1cnNvcnMsIE0gUiBQLCB0YWINCiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KSBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIA0KICAgICAgICB9LHtwYXNzaXZlOiBmYWxzZX0pOw0KICAgIA0KICAgICAgICAvLyB3aGVuIHVzaW5nIGNvZG9fdGV4dGFyZWEgdG8gZGV0ZXJtaW5lIGZvY3VzLCBuZWVkIHRvIGV4cGxpY2l0bHkgaGFuZCBmb2N1cyBiYWNrIHdoZW4gY2xpY2tpbmcgYSBwOF9tZW51X2J1dHRvbg0KICAgICAgICBmdW5jdGlvbiBwOF9naXZlX2ZvY3VzKCkNCiAgICAgICAgew0KICAgICAgICAgICAgZWwgPSAodHlwZW9mIGNvZG9fdGV4dGFyZWEgPT09ICd1bmRlZmluZWQnKSA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb2RvX3RleHRhcmVhIikgOiBjb2RvX3RleHRhcmVhOw0KICAgICAgICAgICAgaWYgKGVsKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGVsLmZvY3VzKCk7DQogICAgICAgICAgICAgICAgZWwuc2VsZWN0KCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICANCiAgICAgICAgZnVuY3Rpb24gcDhfcmVxdWVzdF9mdWxsc2NyZWVuKCkgew0KICAgIA0KICAgICAgICAgICAgdmFyIGlzX2Z1bGxzY3JlZW49KGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50LndlYmtpdElzRnVsbFNjcmVlbiB8fCBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50KTsNCiAgICANCiAgICAgICAgICAgIGlmIChpc19mdWxsc2NyZWVuKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuKSB7DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuKCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKSB7DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4pIHsNCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwOF9wbGF5YXJlYSIpOw0KICAgIA0KICAgICAgICAgICAgaWYgKCBlbC5yZXF1ZXN0RnVsbHNjcmVlbiApIHsNCiAgICAgICAgICAgICAgICBlbC5yZXF1ZXN0RnVsbHNjcmVlbigpOw0KICAgICAgICAgICAgfSBlbHNlIGlmICggZWwubW96UmVxdWVzdEZ1bGxTY3JlZW4gKSB7DQogICAgICAgICAgICAgICAgZWwubW96UmVxdWVzdEZ1bGxTY3JlZW4oKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGVsLndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuICkgew0KICAgICAgICAgICAgICAgIGVsLndlYmtpdFJlcXVlc3RGdWxsU2NyZWVuKCBFbGVtZW50LkFMTE9XX0tFWUJPQVJEX0lOUFVUICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICANCiAgICA8L3NjcmlwdD4NCiAgICANCiAgICA8U1RZTEUgVFlQRT0idGV4dC9jc3MiPg0KICAgIDwhLS0NCiAgICAucDhfbWVudV9idXR0b257DQogICAgICAgIG9wYWNpdHk6MC4zOw0KICAgICAgICBwYWRkaW5nOjRweDsNCiAgICAgICAgZGlzcGxheTp0YWJsZTsNCiAgICAgICAgd2lkdGg6MjRweDsNCiAgICAgICAgaGVpZ2h0OjI0cHg7DQogICAgICAgIGZsb2F0OnJpZ2h0Ow0KICAgIH0NCiAgICANCiAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOjUxMnB4KSB7DQogICAgICAgIC5wOF9tZW51X2J1dHRvbnsNCiAgICAgICAgICAgIHdpZHRoOjI0cHg7IG1hcmdpbi1sZWZ0OjhweDsgbWFyZ2luLWJvdHRvbTo4cHg7DQogICAgICAgIH0NCiAgICB9DQogICAgLnA4X21lbnVfYnV0dG9uOmhvdmVyew0KICAgICAgICBvcGFjaXR5OjEuMDsNCiAgICAgICAgY3Vyc29yOnBvaW50ZXI7DQogICAgfQ0KICAgIA0KICAgIGNhbnZhc3sNCiAgICAgICAgaW1hZ2UtcmVuZGVyaW5nOiBvcHRpbWl6ZVNwZWVkOw0KICAgICAgICBpbWFnZS1yZW5kZXJpbmc6IC1tb3otY3Jpc3AtZWRnZXM7DQogICAgICAgIGltYWdlLXJlbmRlcmluZzogLXdlYmtpdC1vcHRpbWl6ZS1jb250cmFzdDsNCiAgICAgICAgaW1hZ2UtcmVuZGVyaW5nOiBvcHRpbWl6ZS1jb250cmFzdDsNCiAgICAgICAgaW1hZ2UtcmVuZGVyaW5nOiBwaXhlbGF0ZWQ7DQogICAgICAgIC1tcy1pbnRlcnBvbGF0aW9uLW1vZGU6IG5lYXJlc3QtbmVpZ2hib3I7DQogICAgICAgIGJvcmRlcjogMHB4Ow0KICAgICAgICBjdXJzb3I6IG5vbmU7DQogICAgfQ0KICAgIA0KICAgIA0KICAgIC5wOF9zdGFydF9idXR0b257DQogICAgICAgIGltYWdlLXJlbmRlcmluZzogcGl4ZWxhdGVkOw0KICAgICAgICBpbWFnZS1yZW5kZXJpbmc6IC1tb3otY3Jpc3AtZWRnZXM7DQogICAgICAgIGltYWdlLXJlbmRlcmluZzogY3Jpc3AtZWRnZXM7DQogICAgICAgIGN1cnNvcjpwb2ludGVyOw0KICAgICAgICBiYWNrZ3JvdW5kOnVybCgiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFNZ0FBQURJQ0FJQUFBQWlPam5KQUFBQUJHZEJUVUVBQUxHUEMveGhCUUFBQWlKSlJFRlVlRjd0MElFQUFBQUF3NkQ1VXgva2hWQmh3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdEQmd3SUFCQXdZTUdERHdNRERWbHdBQkJXY1NyUUFBQUFCSlJVNUVya0pnZ2c9PSIpOw0KICAgICAgICAtcmVwZWF0IGNlbnRlcjsNCiAgICAgICAgLXdlYmtpdC1iYWNrZ3JvdW5kLXNpemU6Y292ZXI7IC1tb3otYmFja2dyb3VuZC1zaXplOmNvdmVyOyAtby1iYWNrZ3JvdW5kLXNpemU6Y292ZXI7IGJhY2tncm91bmQtc2l6ZTpjb3ZlcjsNCiAgICB9DQogICAgDQogICAgLmJ1dHRvbl9nZnh7DQogICAgICAgIHN0cm9rZS13aWR0aDoyOw0KICAgICAgICBzdHJva2U6ICNmZmZmZmY7DQogICAgICAgIHN0cm9rZS1vcGFjaXR5OjAuNDsNCiAgICAgICAgZmlsbC1vcGFjaXR5OjAuMjsNCiAgICAgICAgZmlsbDpibGFjazsNCiAgICB9DQogICAgDQogICAgLmJ1dHRvbl9nZnhfaWNvbnsNCiAgICAgICAgc3Ryb2tlLXdpZHRoOjM7DQogICAgICAgIHN0cm9rZTogIzkwOTA5MDsNCiAgICAgICAgc3Ryb2tlLW9wYWNpdHk6MC43Ow0KICAgICAgICBmaWxsOm5vbmU7DQogICAgfQ0KICAgIA0KICAgIC0tPg0KICAgIDwvU1RZTEU+DQogICAgDQogICAgPC9oZWFkPg0KICAgIA0KICAgIDxib2R5IHN0eWxlPSJwYWRkaW5nOjBweDsgbWFyZ2luOjBweDsgY29sb3I6I2NjYyI+DQogICAgPGRpdiBpZD0iYm9keV8wIj4gPCEtLSBoaWRlIHRoaXMgd2hlbiBwbGF5aW5nIGluIG1vYmlsZSAocDhfdG91Y2hfZGV0ZWN0ZWQpIHNvIHRoYXQgZWxlbWVudHMgZG9uJ3QgYWZmZWN0IGxheW91dCAtLT4NCiAgICANCiAgICANCiAgICA8IS0tIEFkZCBhbnkgY29udGVudCBhYm92ZSB0aGUgY2FydCBoZXJlIC0tPg0KICAgIA0KICAgIA0KICAgIDxkaXYgaWQ9InA4X2ZyYW1lXzAiIHN0eWxlPSJtYXgtd2lkdGg6ODAwcHg7IG1heC1oZWlnaHQ6ODAwcHg7IG1hcmdpbjphdXRvOyI+IDwhLS0gZG91YmxlIGZ1bmN0aW9uOiBsaW1pdCBzaXplLCBhbmQgZGlzcGxheSBvbmx5IHRoaXMgZGl2IGZvciB0b3VjaCBkZXZpY2VzIC0tPg0KICAgIDxkaXYgaWQ9InA4X2ZyYW1lIiBzdHlsZT0iZGlzcGxheTpmbGV4OyB3aWR0aDoxMDAlOyBtYXgtd2lkdGg6MTAwdnc7IGhlaWdodDoxMDB2dzsgbWF4LWhlaWdodDoxMDB2aDsgbWFyZ2luOmF1dG87Ij4NCiAgICANCiAgICAgICAgPGRpdiBpZD0icDhfbWVudV9idXR0b25zX3RvdWNoIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjEwMCU7IHotaW5kZXg6MTA7IGxlZnQ6MHB4OyI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwOF9tZW51X2J1dHRvbiIgaWQ9InA4Yl9mdWxsIiAgc3R5bGU9ImZsb2F0OmxlZnQ7bWFyZ2luLWxlZnQ6MTBweCIgb25DbGljaz0icDhfZ2l2ZV9mb2N1cygpOyBwOF9yZXF1ZXN0X2Z1bGxzY3JlZW4oKTsiPjwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIGlkPSJwOGJfc291bmQiIHN0eWxlPSJmbG9hdDpsZWZ0O21hcmdpbi1sZWZ0OjEwcHgiIG9uQ2xpY2s9InA4X2dpdmVfZm9jdXMoKTsgcDhfY3JlYXRlX2F1ZGlvX2NvbnRleHQoKTsgTW9kdWxlLnBpY284VG9nZ2xlU291bmQoKTsiPjwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIGlkPSJwOGJfY2xvc2UiIHN0eWxlPSJmbG9hdDpyaWdodDsgbWFyZ2luLXJpZ2h0OjEwcHgiIG9uQ2xpY2s9InA4X2Nsb3NlX2NhcnQoKTsiPjwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICANCiAgICAgICAgPGRpdiBpZD0icDhfY29udGFpbmVyIg0KICAgICAgICAgICAgc3R5bGU9Im1hcmdpbjphdXRvOyBkaXNwbGF5OnRhYmxlOyINCiAgICAgICAgICAgIG9uY2xpY2s9InA4X2NyZWF0ZV9hdWRpb19jb250ZXh0KCk7IHA4X3J1bl9jYXJ0KCk7Ij4NCiAgICANCiAgICAgICAgICAgIDxkaXYgaWQ9InA4X3N0YXJ0X2J1dHRvbiIgY2xhc3M9InA4X3N0YXJ0X2J1dHRvbiIgc3R5bGU9IndpZHRoOjEwMCU7IGhlaWdodDoxMDAlOyBkaXNwbGF5OmZsZXg7Ij4NCiAgICAgICAgICAgICAgICA8aW1nIHdpZHRoPTgwIGhlaWdodD04MCBzdHlsZT0ibWFyZ2luOmF1dG87Ig0KICAgICAgICAgICAgc3JjPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUZBQUFBQlFDQVlBQUFDT0VmS3RBQUFCcGtsRVFWUjQydTNhdTIzRFFCQ0VZVVhPWElHS2N1alFYVWdGdUEwWElLZ1c5MFE5b0VBZytMamQyN3ZkMlJzQ2YwNThnRURxaG9mUGorT0I2U01DQVFsSVFBSXlBaEtRZ0FSa0JBUURuTTZYU1JzQjcvMmUvdFNBMC8vMTJmQ0FLc1FYM250REE0b1JGd0JSSWMwQWl4RTM4QkFoVFFHTEVBc0JVU0ROQVhjUmhZRFJJWnNBUGxwOTlWRUNSb1hzRHBnTjBnMHdDNlE3SURwa0dFQlV5RzZBMCt2S0J0a2RNQnVrRzJBV1NIZEFkTWd3Z0tpUTRRRFJJTU1Db2tDR0I0d09DUVBZRlZLdzJjQUJOb2NVamw2d2dFMGdGYXNoUEtBWnBISjJUUU5ZQlZteFc2Y0RGRU5XRHY5cEFVc2hDVmdKU2NCS1NBSVNrRDloUGtUNEdrTkFNZHplcHlqOEt5ZTg1MkVCTGU1MUNaSEhXUUs0SmNUaEQxU2xjSFBFWVkvMGErQTBuNlNrR1pWNnc2V1pOYjNnNElkMWI3aHdnR2h3WVFCUjRkd0IwZUhjQUxQQWRRZk1CaGNPRUEwdURDQXFuRHNnT3B3YllCYTRwb0EvMzErclpZRnJCcmlGcHdHTUN0Y0VjQTlQQWhnZHpoeXdCSzhFRVFYT0ZGQ0N0d2FJQm1jR0tNV2JJNkxDbVFCcThSNmh3NWtBTWdJU2tJQUVKQ0FqSUFFSlNFQkdRSTl1a1Y3bFJuOW5EK2dBQUFBQVNVVk9SSzVDWUlJPSIvPg0KICAgICAgICAgICAgPC9kaXY+DQogICAgDQogICAgICAgICAgICA8ZGl2IGlkPSJwOF9wbGF5YXJlYSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsgbWFyZ2luOmF1dG87DQogICAgICAgICAgICAgICAgICAgIC13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsgLW1vei11c2VyLXNlbGVjdDogbm9uZTsgdXNlci1zZWxlY3Q6IG5vbmU7IC13ZWJraXQtdG91Y2gtY2FsbG91dDpub25lOw0KICAgICAgICAgICAgIj4NCiAgICANCiAgICAgICAgICAgICAgICA8ZGl2ICBpZD0idG91Y2hfY29udHJvbHNfYmFja2dyb3VuZCINCiAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0iIHBvaW50ZXItZXZlbnRzOm5vbmU7IGRpc3BsYXk6bm9uZTsgYmFja2dyb3VuZC1jb2xvcjojMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpmaXhlZDsgdG9wOjBweDsgbGVmdDowcHg7IGJvcmRlcjowOyB3aWR0aDoxMDB2dzsgaGVpZ2h0OjEwMHZoIj4NCiAgICAgICAgICAgICAgICAgICAgJm5ic3ANCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICANCiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7IHBvc2l0aW9uOnJlbGF0aXZlIj4NCiAgICAgICAgICAgICAgICAgICAgPCEtLSBwb2ludGVyLWV2ZW50cyB0dXJuZWQgb2ZmIGZvciBtb2JpbGUgaW4gcDhfdXBkYXRlX2xheW91dCBiZWNhdXNlIG5lZWQgZm9yIGRlc2t0b3AgbW91c2UgLS0+DQogICAgICAgICAgICAgICAgICAgIDxjYW52YXMgY2xhc3M9ImVtc2NyaXB0ZW4iIGlkPSJjYW52YXMiIG9uY29udGV4dG1lbnU9ImV2ZW50LnByZXZlbnREZWZhdWx0KCk7IiA+DQogICAgICAgICAgICAgICAgICAgIDwvY2FudmFzPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPXA4X21lbnVfYnV0dG9ucyBpZD0icDhfbWVudV9idXR0b25zIiBzdHlsZT0ibWFyZ2luLWxlZnQ6MTBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgYm90dG9tOjEyNXB4IiBpZD0icDhiX2NvbnRyb2xzIiBvbkNsaWNrPSJwOF9naXZlX2ZvY3VzKCk7IE1vZHVsZS5waWNvOFRvZ2dsZUNvbnRyb2xNZW51KCk7Ij48L2Rpdj4JCQkJCQ0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgYm90dG9tOjkwcHgiIGlkPSJwOGJfcGF1c2UiIG9uQ2xpY2s9InA4X2dpdmVfZm9jdXMoKTsgTW9kdWxlLnBpY284VG9nZ2xlUGF1c2VkKCk7IHA4X3VwZGF0ZV9sYXlvdXRfaGFzaCA9IC0yMjsiPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgYm90dG9tOjU1cHgiIGlkPSJwOGJfc291bmQiIG9uQ2xpY2s9InA4X2dpdmVfZm9jdXMoKTsgcDhfY3JlYXRlX2F1ZGlvX2NvbnRleHQoKTsgTW9kdWxlLnBpY284VG9nZ2xlU291bmQoKTsiPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icDhfbWVudV9idXR0b24iIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTsgYm90dG9tOjIwcHgiIGlkPSJwOGJfZnVsbCIgb25DbGljaz0icDhfZ2l2ZV9mb2N1cygpOyBwOF9yZXF1ZXN0X2Z1bGxzY3JlZW4oKTsiPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICANCiAgICANCiAgICAgICAgICAgICAgICA8IS0tIGRpc3BsYXkgYWZ0ZXIgZmlyc3QgbGF5b3V0IHVwZGF0ZSAtLT4NCiAgICAgICAgICAgICAgICA8ZGl2ICBpZD0idG91Y2hfY29udHJvbHNfZ2Z4Ig0KICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSIgcG9pbnRlci1ldmVudHM6bm9uZTsgZGlzcGxheTp0YWJsZTsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOmZpeGVkOyB0b3A6MHB4OyBsZWZ0OjBweDsgYm9yZGVyOjA7IHdpZHRoOjEwMHZ3OyBoZWlnaHQ6MTAwdmgiPg0KICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9IiIgaWQ9ImNvbnRyb2xzX3JpZ2h0X3BhbmVsIiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7IG9wYWNpdHk6MC41OyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz0iIiBpZD0iY29udHJvbHNfbGVmdF9wYW5lbCIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlOyAgb3BhY2l0eTowLjU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICA8L2Rpdj4gPCEtLSB0b3VjaF9jb250cm9sc19nZnggLS0+DQogICAgDQogICAgICAgICAgICAgICAgPCEtLSB1c2VkIGZvciBjbGlwYm9hcmQgYWNjZXNzICYga2V5Ym9hcmQgaW5wdXQ7IGRpc3BsYXllZCBhbmQgdXNlZCBieSBQSUNPLTggb25seSBvbmNlIG5lZWRlZC4gY2FuIGJlIHNhZmVseSByZW1vdmVkIGlmIGNsaXBib2FyZCAvIGtleSBwcmVzc2VzIG5vdCBuZWVkZWQuIC0tPg0KICAgICAgICAgICAgICAgIDwhLS0gKG5lZWRzIHRvIGJlIGluc2lkZSBwOF9wbGF5YXJlYSBzbyB0aGF0IGl0IHN0aWxsIHdvcmtzIHVuZGVyIENocm9tZSB3aGVuIGZ1bGxzY3JlZW5lZCkgLS0+DQogICAgICAgICAgICAgICAgPCEtLSAwLjIuNTogYWRkZWQgImRpc3BsYXk6bm9uZSI7IHBpY284LmpzIHNob3dzIG9uIGRlbWFuZCB0byBhdm9pZCBtYWMgb3N4IGFjY2VudCBjaGFyYWN0ZXIgc2VsZWN0b3IgLy8gaHR0cHM6Ly93d3cubGV4YWxvZmZsZS5jb20vYmJzLz90aWQ9NDc3NDMgLS0+DQogICAgDQogICAgICAgICAgICAgICAgPHRleHRhcmVhIGlkPSJjb2RvX3RleHRhcmVhIiBjbGFzcz0iZW1zY3JpcHRlbiIgc3R5bGU9ImRpc3BsYXk6bm9uZTsgcG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6LTk5OTlweDsgaGVpZ2h0OjBweDsgb3ZlcmZsb3c6aGlkZGVuIj48L3RleHRhcmVhPg0KICAgIA0KICAgICAgICAgICAgPC9kaXY+IDwhLS1wOF9wbGF5YXJlYSAtLT4NCiAgICANCiAgICAgICAgPC9kaXY+IDwhLS0gcDhfY29udGFpbmVyIC0tPg0KICAgIA0KICAgIDwvZGl2PiA8IS0tIHA4X2ZyYW1lIC0tPg0KICAgIDwvZGl2PiA8IS0tIHA4X2ZyYW1lXzAgc2l6ZSBsaW1pdCAtLT4NCiAgICANCiAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogICAgDQogICAgICAgIHA4X3VwZGF0ZV9sYXlvdXQoKTsNCiAgICAgICAgcDhfdXBkYXRlX2J1dHRvbl9pY29ucygpOw0KICAgIA0KICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOw0KICAgICAgICBNb2R1bGUgPSB7fTsNCiAgICAgICAgTW9kdWxlLmNhbnZhcyA9IGNhbnZhczsNCiAgICANCiAgICAgICAgLy8gZnJvbSBAdWx0cmFicml0ZSdzIHNoZWxsOiB0ZXN0IGlmIGFuIEF1ZGlvQ29udGV4dCBjYW4gYmUgY3JlYXRlZCBvdXRzaWRlIG9mIGFuIGV2ZW50IGNhbGxiYWNrLg0KICAgICAgICAvLyBJZiBpdCBjYW4ndCBiZSBjcmVhdGVkLCB0aGVuIHJlcXVpcmUgcHJlc3NpbmcgdGhlIHN0YXJ0IGJ1dHRvbiB0byBydW4gdGhlIGNhcnRyaWRnZQ0KICAgIA0KICAgICAgICBpZiAocDhfYXV0b3BsYXkpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciB0ZW1wX2NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7DQogICAgICAgICAgICB0ZW1wX2NvbnRleHQub25zdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKHRlbXBfY29udGV4dC5zdGF0ZT09J3J1bm5pbmcnKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgcDhfcnVuX2NhcnQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGVtcF9jb250ZXh0LmNsb3NlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KICAgIA0KICAgICAgICAvLyBwb2ludGVyIGxvY2sgcmVxdWVzdCBuZWVkcyB0byBiZSBpbnNpZGUgYSBjYW52YXMgaW50ZXJhY3Rpb24gZXZlbnQNCiAgICAgICAgLy8gcGljbzhfc3RhdGUucmVxdWVzdF9wb2ludGVyX2xvY2sgaXMgdHJ1ZSB3aGVuIDB4NWYyZCBiaXQgMCBhbmQgYml0IDIgYXJlIHNldCAtLSBwb2tlKDB4NWYyZCwweDUpIA0KICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbigpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICghcDhfdG91Y2hfZGV0ZWN0ZWQpDQogICAgICAgICAgICAgICAgaWYgKHBpY284X3N0YXRlLnJlcXVlc3RfcG9pbnRlcl9sb2NrKQ0KICAgICAgICAgICAgICAgICAgICBjYW52YXMucmVxdWVzdFBvaW50ZXJMb2NrKCk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICA8L3NjcmlwdD4NCiAgICANCiAgICANCiAgICANCiAgICA8IS0tIEFkZCBjb250ZW50IGJlbG93IHRoZSBjYXJ0IGhlcmUgLS0+DQogICAgDQogICAgDQogICAgDQogICAgDQogICAgPC9kaXY+IDwhLS0gYm9keV8wIC0tPg0KICAgIDwvYm9keT48L2h0bWw+DQogICAgDQogICAgPHNjcmlwdCBkZWZlciBzcmM9IiIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij48L3NjcmlwdD4NCiAgICANCg==";
