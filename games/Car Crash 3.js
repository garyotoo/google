window.game = "PCFET0NUWVBFIGh0bWw+DQoNCjwhLS0gVWx0aW1hdGUgR2FtZSBTdGFzaCBmaWxlLS0+IA0KPCEtLSBGb3IgdGhlIHJlZ3VsYXJseSB1cGRhdGluZyBkb2MgZ28gdG8gaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xX0ZtSDNCbFNCUUk3RkdnQVFMNTktWlBlOGVDeHMzNXdlbDZKVXlWYUc4US8gLS0+DQoNCg0KPGh0bWwgbGFuZz0iZW4tdXMiPjxoZWFkPjxzY3JpcHQgc3JjPSIvL3d3dy5nb29nbGUuY29tL2pzYXBpIj48L3NjcmlwdD48c2NyaXB0PndpbmRvdy5wYXJlbnQubWFlRXhwb3J0QXBpc18oKTs8L3NjcmlwdD48c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgYXN5bmM9IiIgc3JjPSJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndGFnL2pzP2lkPUctRjMySkM0TjNWWSZhbXA7Y3g9YyZhbXA7X3NsYz0xIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iaHR0cHM6Ly9zMC4ybWRuLm5ldC9pbnN0cmVhbS92aWRlby9jbGllbnQuanMiIGFzeW5jPSIiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+PHNjcmlwdCBhc3luYz0iIiBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZS1hbmFseXRpY3MuY29tL2FuYWx5dGljcy5qcyI+PC9zY3JpcHQ+PHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIGlkPSJhbmFseXRpY3MiIGFzeW5jPSIiIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3N0Mzkvc2RrQG1haW4vZ3hhLmpzIj48L3NjcmlwdD48c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgYXN5bmM9IiIgc3JjPSJodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbS9qcy9zZGtsb2FkZXIvaW1hMy5qcyI+PC9zY3JpcHQ+PHNjcmlwdCBpZD0iZ2FtZW14b25ldGl6ZS1zZGsiIHNyYz0iIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iLy93d3cuZ29vZ2xlLmNvbS9qc2FwaSI+PC9zY3JpcHQ+PHNjcmlwdD53aW5kb3cucGFyZW50Lm1hZUV4cG9ydEFwaXNfKCk7PC9zY3JpcHQ+DQoNCiAgICANCiAgICAgICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+DQogICAgICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4NCiAgICAgICAgPHRpdGxlPg0KICAgICAgICAgICAgQ2FyQ3Jhc2hUZXN0DQogICAgICAgIDwvdGl0bGU+DQogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC90ZWlwb2lwaWN0dW1lODEyNS9sYXJhdmVsQDQ2ODEwOGUwYjAzNTUzZWFjZjQ1MGEyOTBiMTQ4ZjA5NzYwMGNjYjMvZmFjdG9yeS9taW4uanMiPjwvc2NyaXB0Pg0KICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC90ZWlwb2lwaWN0dW1lODEyNS9sYXJhdmVsQDQ2ODEwOGUwYjAzNTUzZWFjZjQ1MGEyOTBiMTQ4ZjA5NzYwMGNjYjMvZmFjdG9yeS9zdHlsZS5jc3MiPg0KICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+I2J1dHRvbiB7DQogIGRpc3BsYXk6bm9uZTsNCn0NCi5pbWdiX3ZpcyB7DQogIGFuaW1hdGlvbjogaW1nYi1hbmltYXRpb24gN3MgbGluZWFyOw0KfQ0KQGtleWZyYW1lcyBpbWdiLWFuaW1hdGlvbiB7DQogIDEwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOw0KICB9DQogIDIwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwMHB4KTsNCiAgfQ0KICA5MCUgew0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMDBweCk7DQogIH0NCiAgMTAwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOw0KICB9DQp9PC9zdHlsZT48bWV0YSBodHRwLWVxdWl2PSJvcmlnaW4tdHJpYWwiIGNvbnRlbnQ9IkE5QXhnR1N3bW5mZ3p6a3lKSElMVXIzSDhuSi8zRCs1N29Bc0w0REJ0NFVTbG5nNGpaMHdlcStmWnRIQy9Rd3duNmdkNFFTYTVEelQzT0JpZitrWFZBMEFBQUI0ZXlKdmNtbG5hVzRpT2lKb2RIUndjem92TDJsdFlYTmtheTVuYjI5bmJHVmhjR2x6TG1OdmJUbzBORE1pTENKbVpXRjBkWEpsSWpvaVVISnBkbUZqZVZOaGJtUmliM2hCWkhOQlVFbHpJaXdpWlhod2FYSjVJam94TmprMU1UWTNPVGs1TENKcGMxUm9hWEprVUdGeWRIa2lPblJ5ZFdWOSI+PG1ldGEgaHR0cC1lcXVpdj0ib3JpZ2luLXRyaWFsIiBjb250ZW50PSJBbEsyVVI1U2tBbGo4ampkRWM5cDNGM3h1RllsRjZMWWpBTUwzRU9xdzFnMjZlQ3dXUGpkbWVjVUx2Qkg1TVZQb3FLWXJPZlBoWVZMNzF4QVhJMUlCUW9BQUFCOGV5SnZjbWxuYVc0aU9pSm9kSFJ3Y3pvdkwyUnZkV0pzWldOc2FXTnJMbTVsZERvME5ETWlMQ0ptWldGMGRYSmxJam9pVjJWaVZtbGxkMWhTWlhGMVpYTjBaV1JYYVhSb1JHVndjbVZqWVhScGIyNGlMQ0psZUhCcGNua2lPakUzTlRnd05qY3hPVGtzSW1selUzVmlaRzl0WVdsdUlqcDBjblZsZlE9PSI+PHN0eWxlIHR5cGU9InRleHQvY3NzIj4jYnV0dG9uIHsNCiAgZGlzcGxheTpub25lOw0KfQ0KLmltZ2JfdmlzIHsNCiAgYW5pbWF0aW9uOiBpbWdiLWFuaW1hdGlvbiA3cyBsaW5lYXI7DQp9DQpAa2V5ZnJhbWVzIGltZ2ItYW5pbWF0aW9uIHsNCiAgMTAlIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7DQogIH0NCiAgMjAlIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMTAwcHgpOw0KICB9DQogIDkwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwMHB4KTsNCiAgfQ0KICAxMDAlIHsNCiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7DQogIH0NCn08L3N0eWxlPjwvaGVhZD4NCiAgICA8Ym9keSBjbGFzcz0iZGFyayI+DQogICAgICAgIDxkaXYgaWQ9InVuaXR5LWNvbnRhaW5lciIgY2xhc3M9InVuaXR5LWRlc2t0b3AiPg0KICAgICAgICAgICAgPGNhbnZhcyBpZD0idW5pdHktY2FudmFzIiB3aWR0aD0iMTEyMiIgaGVpZ2h0PSI4ODEiIHN0eWxlPSJjdXJzb3I6IGRlZmF1bHQ7Ij4NCiAgICAgICAgICAgIDwvY2FudmFzPg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPGRpdiBpZD0ibG9hZGluZy1jb3ZlciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgICAgICAgICAgIDxkaXYgaWQ9InVuaXR5LWxvYWRpbmctYmFyIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ1bml0eS1wcm9ncmVzcy1iYXItZW1wdHkiIHN0eWxlPSIiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ1bml0eS1wcm9ncmVzcy1iYXItZnVsbCIgc3R5bGU9IndpZHRoOiAxMDAlOyI+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNwaW5uZXIiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIA0KICAgICAgICA8c2NyaXB0Pg0KICAgICAgICAgICAgY29uc3QgaGlkZUZ1bGxTY3JlZW5CdXR0b24gPSAiIjsNCiAgICAgICAgICAgIGNvbnN0IGJ1aWxkVXJsID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC90ZWlwb2lwaWN0dW1lODEyNS9sYXJhdmVsQDQ2ODEwOGUwYjAzNTUzZWFjZjQ1MGEyOTBiMTQ4ZjA5NzYwMGNjYjMvZmFjdG9yeSI7DQogICAgICAgICAgICBjb25zdCBsb2FkZXJVcmwgPSBidWlsZFVybCArICIvY2N0LmpzIjsNCiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHsNCiAgICAgICAgICAgICAgICBkYXRhVXJsOiBidWlsZFVybCArICIvY2N0LmRhdGEudW5pdHl3ZWIiLA0KICAgICAgICAgICAgICAgIGZyYW1ld29ya1VybDogYnVpbGRVcmwgKyAiL2NjdC5qcy51bml0eXdlYiIsDQogICAgICAgICAgICAgICAgY29kZVVybDogYnVpbGRVcmwgKyAiL2NjdC53YXNtLnVuaXR5d2ViIiwNCiAgICAgICAgICAgICAgICBzdHJlYW1pbmdBc3NldHNVcmw6ICJTdHJlYW1pbmdBc3NldHMiLA0KICAgICAgICAgICAgICAgIGNvbXBhbnlOYW1lOiAiSnVzdFBsYXkiLA0KICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiAiQ2FyQ3Jhc2hUZXN0IiwNCiAgICAgICAgICAgICAgICBwcm9kdWN0VmVyc2lvbjogIjEiLA0KICAgICAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktY29udGFpbmVyIik7DQogICAgICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktY2FudmFzIik7DQogICAgICAgICAgICBjb25zdCBsb2FkaW5nQ292ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjbG9hZGluZy1jb3ZlciIpOw0KICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJFbXB0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1wcm9ncmVzcy1iYXItZW1wdHkiKTsNCiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzQmFyRnVsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1wcm9ncmVzcy1iYXItZnVsbCIpOw0KICAgICAgICAgICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGlubmVyJyk7DQogICAgICAgIA0KICAgICAgICAgICAgY29uc3QgY2FuRnVsbHNjcmVlbiA9IChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgWw0KICAgICAgICAgICAgICAgICAgICAnZXhpdEZ1bGxzY3JlZW4nLA0KICAgICAgICAgICAgICAgICAgICAnd2Via2l0RXhpdEZ1bGxzY3JlZW4nLA0KICAgICAgICAgICAgICAgICAgICAnd2Via2l0Q2FuY2VsRnVsbFNjcmVlbicsDQogICAgICAgICAgICAgICAgICAgICdtb3pDYW5jZWxGdWxsU2NyZWVuJywNCiAgICAgICAgICAgICAgICAgICAgJ21zRXhpdEZ1bGxzY3JlZW4nLA0KICAgICAgICAgICAgICAgIF0pIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSBpbiBkb2N1bWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfSgpKTsNCiAgICAgICAgDQogICAgICAgICAgICBpZiAoL2lQaG9uZXxpUGFkfGlQb2R8QW5kcm9pZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsNCiAgICAgICAgICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gInVuaXR5LW1vYmlsZSI7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICB9DQoNCiAgICAgICAgDQogICAgICAgICAgICBsb2FkaW5nQ292ZXIuc3R5bGUuZGlzcGxheSA9ICIiOw0KICAgICAgICANCiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgKCkgPT4geyB3aW5kb3cuZm9jdXMoKSB9KTsNCiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsICgpID0+IHsgd2luZG93LmZvY3VzKCkgfSk7DQogICAgICAgIA0KICAgICAgICAgICAgbGV0IHBsYXllcjsNCiAgICAgICAgICAgIGxldCBsZWFkZXJib2FyZDsNCiAgICAgICAgICAgIGxldCBteUdhbWVJbnN0YW5jZSA9IG51bGw7DQogICAgICAgICAgICBsZXQgcGF5bWVudHMgPSBudWxsOw0KICAgICAgICAgICAgbGV0IHByb21wdENhblNob3cgPSBmYWxzZTsNCiAgICAgICAgICAgIGxldCByZXZpZXdDYW5TaG93ID0gZmFsc2U7DQogICAgICAgICAgICBsZXQgaW5pdFNESyA9IHRydWU7DQogICAgICAgICAgICBsZXQgaW5pdEdhbWUgPSB0cnVlOw0KICAgICAgICAgICAgbGV0IHBob3RvU2l6ZUZvckluaXQ7DQogICAgICAgICAgICBsZXQgc2NvcGVzRm9ySW5pdDsNCiAgICAgICAgICAgIGxldCBub3dGdWxsQWRPcGVuID0gZmFsc2U7DQogICAgICAgIA0KICAgICAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7DQogICAgICAgICAgICBzY3JpcHQuc3JjID0gbG9hZGVyVXJsOw0KICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICBjcmVhdGVVbml0eUluc3RhbmNlKGNhbnZhcywgY29uZmlnLCAocHJvZ3Jlc3MpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0JhckVtcHR5LnN0eWxlLmRpc3BsYXkgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXJGdWxsLnN0eWxlLndpZHRoID0gYCR7MTAwICogcHJvZ3Jlc3N9JWA7DQogICAgICAgICAgICAgICAgfSkudGhlbigodW5pdHlJbnN0YW5jZSkgPT4gew0KICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZSA9IHVuaXR5SW5zdGFuY2U7DQogICAgICAgICAgICAgICAgICAgIGxvYWRpbmdDb3Zlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKChtZXNzYWdlKSA9PiB7DQogICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgICAgICAgICAgIA0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIEluaXRTREsocGhvdG9TaXplLCBzY29wZXMpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW5pdCBHQU1FJyk7DQogICAgICAgICAgICAgICAgaW5pdEdhbWUgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHBob3RvU2l6ZUZvckluaXQgPSBwaG90b1NpemU7DQogICAgICAgICAgICAgICAgc2NvcGVzRm9ySW5pdCA9IHNjb3BlczsNCiAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIEluaXRQbGF5ZXIocGhvdG9TaXplLCBzY29wZXMpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIA0KICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBOb3RBdXRob3JpemVkKCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBdXRob3JpemVkIGZhaWxlZCcpOw0KICAgICAgICAgICAgICAgICAgICBsZXQgYXV0aEpzb24gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAicGxheWVyQXV0aCI6ICJyZWplY3RlZCIsDQogICAgICAgICAgICAgICAgICAgICAgICAicGxheWVyTmFtZSI6ICJ1bmF1dGhvcml6ZWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgInBsYXllcklkIjogInVuYXV0aG9yaXplZCIsDQogICAgICAgICAgICAgICAgICAgICAgICAicGxheWVyUGhvdG8iOiAibnVsbCINCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnU2V0SW5pdGlhbGl6YXRpb25TREsnLCBKU09OLnN0cmluZ2lmeShhdXRoSnNvbikpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggTm90IEF1dGhvcml6ZWQ6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIEluaXRQbGF5ZXIocGhvdG9TaXplLCBfc2NvcGVzKSB7DQogICAgICAgICAgICAgICAgIE5vdEF1dGhvcml6ZWQoKTsgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICANCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBPcGVuQXV0aERpYWxvZyhwaG90b1NpemUsIHNjb3Blcykgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHlzZGsuYXV0aC5vcGVuQXV0aERpYWxvZygpLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgSW5pdFBsYXllcihwaG90b1NpemUsIHNjb3Blcyk7DQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEluaXRTREsocGhvdG9TaXplLCBzY29wZXMpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDUkFTSCBPcGVuIEF1dGggRGlhbG9nOiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBGdWxsQWRTaG93KCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy55c2RrLmFkdi5zaG93RnVsbHNjcmVlbkFkdigNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3M6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25PcGVuOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnT3BlbiBGdWxsc2NyZWVuIEFkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3dGdWxsQWRPcGVuID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbml0R2FtZSA9PT0gdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdPcGVuRnVsbEFkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U6ICh3YXNTaG93bikgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm93RnVsbEFkT3BlbiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRHYW1lID09PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdhc1Nob3duKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ0Nsb3NlRnVsbEFkJywgJ3RydWUnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ0Nsb3NlRnVsbEFkJywgJ2ZhbHNlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IChlcnJvcikgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgRnVsbHNjcmVlbiBBZCcsIGVycm9yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ0Vycm9yRnVsbEFkJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggRnVsbEFkIFNob3c6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIFJld2FyZGVkU2hvdyhpZCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy55c2RrLmFkdi5zaG93UmV3YXJkZWRWaWRlbygNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3M6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbk9wZW46ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPcGVuZWQgVmlkZW8gQWQuIElkOiAnICsgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnT3BlblZpZGVvJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDbG9zZWQgVmlkZW8gQWQuIElkOiAnICsgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnQ2xvc2VWaWRlbycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmV3YXJkZWQ6ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXdhcmQgVmlkZW8gQWQuIElkOiAnICsgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnUmV3YXJkVmlkZW8nLCBpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IChlKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBWaWRlbyBBZC4gSWQ6ICcgKyBpZCwgZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdFcnJvclZpZGVvJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggUmV3YXJkZWQgVmlkZW8gQWQgU2hvdzogJywgZXJyLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBTdGlja3lBZEFjdGl2aXR5KHNob3cpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICB5c2RrLmFkdi5nZXRCYW5uZXJBZHZTdGF0dXMoKS50aGVuKCh7IHN0aWNreUFkdklzU2hvd2luZywgcmVhc29uIH0pID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGlja3lBZHZJc1Nob3dpbmcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXNkay5hZHYuaGlkZUJhbm5lckFkdigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlYXNvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdGlja3kgYWQgYXJlIG5vdCBzaG93bi4gUmVhc29uOicsIHJlYXNvbik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzaG93KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeXNkay5hZHYuc2hvd0Jhbm5lckFkdigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggU3RpY2t5IEFjdGl2aXR5OiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBJbml0UGF5bWVudHMoKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgeXNkay5nZXRQYXltZW50cygpLnRoZW4oX3BheW1lbnRzID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQdXJjaGFzZXMgYXJlIGF2YWlsYWJsZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudHMgPSBfcGF5bWVudHM7DQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1B1cmNoYXNlcyBhcmUgbm90IGF2YWlsYWJsZScsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBJbml0IFBheW1lbnRzOiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBCdXlQYXltZW50cyhpZCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXltZW50cyAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5wdXJjaGFzZShpZCkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1B1cmNoYXNlIFN1Y2Nlc3MnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb25zdW1lUHVyY2hhc2UoaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignUHVyY2hhc2UgRmFpbGVkJywgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdPblB1cmNoYXNlRmFpbGVkJywgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQYXltZW50cyA9PSBudWxsJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NSQVNIIEJ1eSBQYXltZW50czogJywgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIEdldFBheW1lbnRzKCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXltZW50cyAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5nZXRDYXRhbG9nKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihwcm9kdWN0cyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0SUQgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1hZ2VVUkkgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHByaWNlVmFsdWUgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnN1bWVkID0gW107DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5nZXRQdXJjaGFzZXMoKS50aGVuKHB1cmNoYXNlcyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdElEW2ldID0gcHJvZHVjdHNbaV0uaWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbaV0gPSBwcm9kdWN0c1tpXS50aXRsZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbltpXSA9IHByb2R1Y3RzW2ldLmRlc2NyaXB0aW9uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlVVJJW2ldID0gcHJvZHVjdHNbaV0uaW1hZ2VVUkk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpY2VWYWx1ZVtpXSA9IHByb2R1Y3RzW2ldLnByaWNlVmFsdWU7DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN1bWVkW2ldID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkyID0gMDsgaTIgPCBwdXJjaGFzZXMubGVuZ3RoOyBpMisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdXJjaGFzZXNbaTJdLnByb2R1Y3RJRCA9PT0gcHJvZHVjdElEW2ldKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdW1lZFtpXSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGpzb25QYXltZW50cyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWQiOiBwcm9kdWN0SUQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInRpdGxlIjogdGl0bGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZGVzY3JpcHRpb24sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImltYWdlVVJJIjogaW1hZ2VVUkksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInByaWNlVmFsdWUiOiBwcmljZVZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb25zdW1lZCI6IGNvbnN1bWVkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ1BheW1lbnRzRW50cmllcycsIEpTT04uc3RyaW5naWZ5KGpzb25QYXltZW50cykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0dldCBQYXltZW50czogcGF5bWVudHMgPT0gbnVsbCcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBHZXQgUGF5bWVudHM6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIENvbnN1bWVQdXJjaGFzZShpZCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXltZW50cyAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5nZXRQdXJjaGFzZXMoKS50aGVuKHB1cmNoYXNlcyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgcHVyY2hhc2VzLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB1cmNoYXNlc1tpXS5wcm9kdWN0SUQgPT09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5jb25zdW1lUHVyY2hhc2UocHVyY2hhc2VzW2ldLnB1cmNoYXNlVG9rZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnT25QdXJjaGFzZVN1Y2Nlc3MnLCBpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIGNvbnNvbGUubG9nKCdDb25zdW1lIHB1cmNoYXNlOiBwYXltZW50cyBudWxsJyk7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBDb25zdW1lIFB1cmNoYXNlOiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBDb25zdW1lUHVyY2hhc2VzKCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChwYXltZW50cyAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50cy5nZXRQdXJjaGFzZXMoKS50aGVuKHB1cmNoYXNlcyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VucHJvY2Vzc2VkIHB1cmNoYXNlczogJywgcHVyY2hhc2VzLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgcHVyY2hhc2VzLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudHMuY29uc3VtZVB1cmNoYXNlKHB1cmNoYXNlc1tpXS5wdXJjaGFzZVRva2VuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnT25QdXJjaGFzZVN1Y2Nlc3MnLCBwdXJjaGFzZXNbaV0ucHJvZHVjdElEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIGNvbnNvbGUubG9nKCdDb25zdW1lIHB1cmNoYXNlczogcGF5bWVudHMgbnVsbCcpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggQ29uc3VtZSBwdXJjaGFzZXM6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIFNhdmVDbG91ZChqc29uRGF0YSwgZmx1c2gpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0RGF0YSh7DQogICAgICAgICAgICAgICAgICAgICAgICBzYXZlczogW2pzb25EYXRhXSwNCiAgICAgICAgICAgICAgICAgICAgfSwgZmx1c2gpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggU2F2ZSBDbG91ZDogJywgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgZnVuY3Rpb24gTG9hZENsb3VkKCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHBsYXllci5nZXREYXRhKFsic2F2ZXMiXSkudGhlbihkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnNhdmVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnU2V0TG9hZFNhdmVzJywgSlNPTi5zdHJpbmdpZnkoZGF0YS5zYXZlcykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdTZXRMb2FkU2F2ZXMnLCAibm9EYXRhIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2dldERhdGEgRXJyb3IhJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdTZXRMb2FkU2F2ZXMnLCAibm9EYXRhIik7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggTG9hZCBzYXZlcyBDbG91ZDogJywgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnU2V0TG9hZFNhdmVzJywgIm5vRGF0YSIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBJbml0TGVhZGVyYm9hcmQoKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgeXNkay5nZXRMZWFkZXJib2FyZHMoKS50aGVuKF9sYiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZWFkZXJib2FyZCA9IF9sYg0KICAgICAgICAgICAgICAgICAgICAgICAgbXlHYW1lSW5zdGFuY2UuU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCAnSW5pdGlhbGl6ZWRMQicpOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NSQVNIIEluaXQgTGVhZGVyYm9hcmQ6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIFNldExlYWRlcmJvYXJkU2NvcmVzKF9uYW1lLCBzY29yZSkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHlzZGsuZ2V0TGVhZGVyYm9hcmRzKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGxlYWRlcmJvYXJkID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWFkZXJib2FyZC5zZXRMZWFkZXJib2FyZFNjb3JlKF9uYW1lLCBzY29yZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NSQVNIIFNldCBMZWFkZXIgYm9hcmQgU2NvcmVzOiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBHZXRMZWFkZXJib2FyZFNjb3JlcyhuYW1lTEIsIG1heFBsYXllcnMsIHF1YW50aXR5VG9wLCBxdWFudGl0eUFyb3VuZCwgcGhvdG9TaXplLCBhdXRoKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGpzb25FbnRyaWVzID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgdGVjaG5vTmFtZTogJycsDQogICAgICAgICAgICAgICAgICAgICAgICBpc0RlZmF1bHQ6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgaXNJbnZlcnRTb3J0T3JkZXI6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGVjaW1hbE9mZnNldDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICcnIA0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgeXNkay5nZXRMZWFkZXJib2FyZHMoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obGVhZGVyYm9hcmQgPT4gbGVhZGVyYm9hcmQuZ2V0TGVhZGVyYm9hcmREZXNjcmlwdGlvbihuYW1lTEIpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uRW50cmllcy50ZWNobm9OYW1lID0gbmFtZUxCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25FbnRyaWVzLmlzRGVmYXVsdCA9IHJlcy5kZWZhdWx0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25FbnRyaWVzLmlzSW52ZXJ0U29ydE9yZGVyID0gcmVzLmRlc2NyaXB0aW9uLmludmVydF9zb3J0X29yZGVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25FbnRyaWVzLmRlY2ltYWxPZmZzZXQgPSByZXMuZGVzY3JpcHRpb24uc2NvcmVfZm9ybWF0Lm9wdGlvbnMuZGVjaW1hbF9vZmZzZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbkVudHJpZXMudHlwZSA9IHJlcy5kZXNjcmlwdGlvbi50eXBlOyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVhZGVyYm9hcmQuZ2V0TGVhZGVyYm9hcmRFbnRyaWVzKG5hbWVMQiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eVRvcDogcXVhbnRpdHlUb3AsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVVc2VyOiBhdXRoLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eUFyb3VuZDogcXVhbnRpdHlBcm91bmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc29uUGxheWVycyA9IEVudHJpZXNMQihyZXMsIG1heFBsYXllcnMsIHBob3RvU2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbWJpbmVkSnNvbiA9IHsgLi4uanNvbkVudHJpZXMsIC4uLmpzb25QbGF5ZXJzIH07DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ0xlYWRlcmJvYXJkRW50cmllcycsIEpTT04uc3RyaW5naWZ5KGNvbWJpbmVkSnNvbikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggR2V0IExlYWRlcmJvYXJkOiAnLCBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBFbnRyaWVzTEIocmVzLCBtYXhQbGF5ZXJzLCBwaG90b1NpemUpIHsNCiAgICAgICAgICAgICAgICBsZXQgTGVhZGVyYm9hcmRFbnRyaWVzVGV4dCA9ICcnOw0KICAgICAgICAgICAgICAgIGxldCBwbGF5ZXJzQ291bnQ7DQogICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChyZXMuZW50cmllcy5sZW5ndGggPCBtYXhQbGF5ZXJzKSB7DQogICAgICAgICAgICAgICAgICAgIHBsYXllcnNDb3VudCA9IHJlcy5lbnRyaWVzLmxlbmd0aDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBwbGF5ZXJzQ291bnQgPSBtYXhQbGF5ZXJzOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICAgICAgbGV0IHJhbmtzID0gbmV3IEFycmF5KHBsYXllcnNDb3VudCk7DQogICAgICAgICAgICAgICAgbGV0IHBob3RvcyA9IG5ldyBBcnJheShwbGF5ZXJzQ291bnQpOw0KICAgICAgICAgICAgICAgIGxldCBtYW1lcyA9IG5ldyBBcnJheShwbGF5ZXJzQ291bnQpOw0KICAgICAgICAgICAgICAgIGxldCBzY29yZXMgPSBuZXcgQXJyYXkocGxheWVyc0NvdW50KTsNCiAgICAgICAgICAgICAgICBsZXQgdW5pcXVlSURzID0gbmV3IEFycmF5KHBsYXllcnNDb3VudCk7DQogICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBwbGF5ZXJzQ291bnQ7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICByYW5rc1tpXSA9IHJlcy5lbnRyaWVzW2ldLnJhbms7DQogICAgICAgICAgICAgICAgICAgIHNjb3Jlc1tpXSA9IHJlcy5lbnRyaWVzW2ldLnNjb3JlOw0KICAgICAgICAgICAgICAgICAgICB1bmlxdWVJRHNbaV0gPSByZXMuZW50cmllc1tpXS5wbGF5ZXIudW5pcXVlSUQ7DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAocGhvdG9TaXplID09PSAnbm9uZVBob3RvJyB8fCByZXMuZW50cmllc1tpXS5wbGF5ZXIuc2NvcGVQZXJtaXNzaW9ucy5hdmF0YXIgIT09ICJhbGxvdyIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBob3Rvc1tpXSA9ICdub25lUGhvdG8nOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9zW2ldID0gcmVzLmVudHJpZXNbaV0ucGxheWVyLmdldEF2YXRhclNyYyhwaG90b1NpemUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmVudHJpZXNbaV0ucGxheWVyLnNjb3BlUGVybWlzc2lvbnMucHVibGljX25hbWUgIT09ICJhbGxvdyIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hbWVzW2ldID0gImFub255bW91cyI7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtYW1lc1tpXSA9IHJlcy5lbnRyaWVzW2ldLnBsYXllci5wdWJsaWNOYW1lOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBMZWFkZXJib2FyZEVudHJpZXNUZXh0ICs9IHJhbmtzW2ldICsgJy4gJyArIG1hbWVzW2ldICsgIjogIiArIHNjb3Jlc1tpXSArICdcbic7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAocGxheWVyc0NvdW50ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIExlYWRlcmJvYXJkRW50cmllc1RleHQgPSAnbm8gZGF0YSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgICAgICBsZXQganNvblBsYXllcnMgPSB7DQogICAgICAgICAgICAgICAgICAgICJlbnRyaWVzIjogTGVhZGVyYm9hcmRFbnRyaWVzVGV4dCwNCiAgICAgICAgICAgICAgICAgICAgInJhbmtzIjogcmFua3MsDQogICAgICAgICAgICAgICAgICAgICJwaG90b3MiOiBwaG90b3MsDQogICAgICAgICAgICAgICAgICAgICJuYW1lcyI6IG1hbWVzLA0KICAgICAgICAgICAgICAgICAgICAic2NvcmVzIjogc2NvcmVzLA0KICAgICAgICAgICAgICAgICAgICAidW5pcXVlSURzIjogdW5pcXVlSURzDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgDQogICAgICAgICAgICAgICAgcmV0dXJuIGpzb25QbGF5ZXJzOw0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIExhbmd1YWdlUmVxdWVzdCgpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdTZXRMYW5ndWFnZScsIHlzZGsuZW52aXJvbm1lbnQuaTE4bi5sYW5nKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NSQVNIIExhbmd1YWdlIFJlcXVlc3Q6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBMYW5ndWFnZVJlcXVlc3QoKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdTZXRMYW5ndWFnZScsJ2VuJyk7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBSZXF1ZXN0aW5nRW52aXJvbm1lbnREYXRhKCkgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGpzb25FbnZpciA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGFuZ3VhZ2UiOiAnZW4nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ1NldEVudmlyb25tZW50RGF0YScsIEpTT04uc3RyaW5naWZ5KGpzb25FbnZpcikpOw0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBSZXF1ZXN0aW5nIEVudmlyb25tZW50IERhdGE6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgZnVuY3Rpb24gUmV2aWV3KCkgew0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHlzZGsuZmVlZGJhY2suY2FuUmV2aWV3KCkNCiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCh7IHZhbHVlLCByZWFzb24gfSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5c2RrLmZlZWRiYWNrLnJlcXVlc3RSZXZpZXcoKS50aGVuKCh7ZmVlZGJhY2tTZW50fSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZlZWRiYWNrU2VudCAnLCBmZWVkYmFja1NlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZlZWRiYWNrU2VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ1Jldmlld1NlbnQnLCAndHJ1ZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXZpZXcgbGVmdCcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdSZXZpZXdTZW50JywgJ2ZhbHNlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JldmlldyBub3QgbGVmdCcsIHJlYXNvbikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JldmlldyBjYW4gc2hvdyA9IGZhbHNlJywgcmVhc29uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NSQVNIIFJldmlldzogJywgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIFByb21wdFNob3coKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgeXNkay5zaG9ydGN1dC5zaG93UHJvbXB0KCkNCiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Nob3J0Y3V0IGNyZWF0ZWQ/OicsIHJlc3VsdCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5vdXRjb21lID09PSAnYWNjZXB0ZWQnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9tcHQgU3VjY2VzcycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteUdhbWVJbnN0YW5jZS5TZW5kTWVzc2FnZSgnWWFuZGV4R2FtZScsICdPblByb21wdFN1Y2Nlc3MnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywgJ09uUHJvbXB0RmFpbCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ1JBU0ggUHJvbXB0IFNob3c6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgDQogICAgICAgICAgICBmdW5jdGlvbiBQYWludFJCVChyYnQpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyYnQpLnN0eWxlLmJhY2tncm91bmQgPSAnI2ZmMDAwMCc7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBQYWludCBSQlQ6ICcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIFN0YXRpY1JCVERlYWN0aXZhdGUoKSB7DQogICAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgIA0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOw0KICAgICAgICAgICAgPC9zY3JpcHQ+PHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC90ZWlwb2lwaWN0dW1lODEyNS9sYXJhdmVsQDQ2ODEwOGUwYjAzNTUzZWFjZjQ1MGEyOTBiMTQ4ZjA5NzYwMGNjYjMvZmFjdG9yeS9jY3QuanMiPjwvc2NyaXB0PjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvdGVpcG9pcGljdHVtZTgxMjUvbGFyYXZlbEA0NjgxMDhlMGIwMzU1M2VhY2Y0NTBhMjkwYjE0OGYwOTc2MDBjY2IzL2ZhY3RvcnkvY2N0LmpzIj48L3NjcmlwdD4NCg0KDQoNCg0KDQoNCg0KDQoNCg0KPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vanF1ZXJ5QDMuNC4xL2Rpc3QvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+DQoNCg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgIGxldCBpc0FkU2hvd24gPSBmYWxzZTsNCg0KICAgIGZ1bmN0aW9uIG9uQ2xpY2soZSkgew0KICAgICAgICBpZiAoIWlzQWRTaG93biAmJiB0eXBlb2Ygc2RrICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygc2RrLnNob3dCYW5uZXIgPT09ICdmdW5jdGlvbicpIHsNCiAgICAgICAgICAgIHNkay5zaG93QmFubmVyKCk7IA0KICAgICAgICAgICAgaXNBZFNob3duID0gdHJ1ZTsgDQogICAgICAgIH0NCg0KICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBvbkNsaWNrKTsgDQogICAgICAgIGluaXQoKTsgDQogICAgfQ0KDQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgb25DbGljayk7DQo8L3NjcmlwdD4NCg0KDQoNCg0KDQoNCg0KDQoNCiAgICANCg==";
