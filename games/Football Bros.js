window.game = "PCFET0NUWVBFIGh0bWw+DQoNCg0KPCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KDQoJPCFET0NUWVBFIGh0bWw+DQoJPGh0bWwgbGFuZz0iZW4iPg0KDQoJPGhlYWQ+DQoNCgkgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4NCiAgICA8YmFzZSBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvYnViYmxzL1VHUy1Bc3NldHNAZDdmODA3OWY1ZDk3OTE4MmUwNGYwNWIxYWRlMjRmMmE3NTcyNTNhMy9mb290YmFsbCUyMGJyb3MvIg0KDQoJICA8bWV0YSBuYW1lPSJkZXNjcmlwdGlvbiIgY29udGVudD0iT25saW5lIG11bHRpcGxheWVyIGZvb3RiYWxsISBCb25lIGNydXNoaW5nIGhpdHMsIGxvbmcgYm9tYnMsIGFuZCB0b25zIG1vcmUhIiAvPg0KCSAgPG1ldGEgaWQ9InZpZXdwb3J0IiBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iIC8+DQoJICA8bGluayByZWw9InNob3J0Y3V0IGljb24iIHR5cGU9ImltYWdlL3BuZyIgaHJlZj0iLi9mYXZpY29uLnBuZyI+DQoJICA8bWV0YSBuYW1lPSJLZXl3b3JkcyIgY29udGVudD0iRm9vdGJhbGwsIFBsYXksIEZyZWUsIE9ubGluZSwgTXVsdGlwbGF5ZXIsIEdhbWVzLCBJTywgU3BvcnRzLCBTY3JvbGxpbmcsIEZyaWVuZHMiPg0KCSAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJCbHVlIFdpemFyZCBEaWdpdGFsIj4NCg0KCSAgPG1ldGEgcHJvcGVydHk9Im9nOnR5cGUiIGNvbnRlbnQ9IndlYnNpdGUiIC8+DQoJICA8bWV0YSBwcm9wZXJ0eT0ib2c6dGl0bGUiIGNvbnRlbnQ9IkZvb3RiYWxsIEJyb3MiIC8+DQoJICA8bWV0YSBwcm9wZXJ0eT0ib2c6ZGVzY3JpcHRpb24iIGNvbnRlbnQ9Ik9ubGluZSBtdWx0aXBsYXllciBmb290YmFsbCEgQm9uZSBjcnVzaGluZyBoaXRzLCBsb25nIGJvbWJzLCBhbmQgdG9ucyBtb3JlISIgLz4NCgkgIDxsaW5rIHJlbD0ibWFuaWZlc3QiIGhyZWY9Im1hbmlmZXN0Lmpzb24iPg0KDQoNCgkgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Ii4vRm9vdGJhbGxCcm9zLmpzP3RoPTI3MiI+PC9zY3JpcHQ+DQoNCgkgIDxzY3JpcHQ+DQoJICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCBmdW5jdGlvbihldmVudCkgew0KCSAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQoJICAgIH0sIHsNCgkgICAgICBjYXB0dXJlOiBmYWxzZSwNCgkgICAgICBwYXNzaXZlOiBmYWxzZQ0KCSAgICB9KTsNCgkgICAgaWYgKHR5cGVvZiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyA+IDIpIHsNCgkgICAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ2aWV3cG9ydCIpOw0KCSAgICAgIG1ldGEuc2V0QXR0cmlidXRlKCdjb250ZW50JywgJ3dpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0nICsgKDIgLyB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbykgKyAnLCB1c2VyLXNjYWxhYmxlPW5vJyk7DQoJICAgIH0NCgkgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7DQoJICAgICAgaWYgKChlLmtleUNvZGUgPT0gMzIgfHwgZS5rZXlDb2RlID09IDM4IHx8IGUua2V5Q29kZSA9PSA0MCB8fCBlLmtleUNvZGUgPT0gOSkgJiYgZS50YXJnZXQgPT0gZG9jdW1lbnQuYm9keSkgew0KCSAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KCSAgICAgIH0NCgkgICAgfSk7DQoJICAgIHZhciBhQ28gPSAnVVMnOw0KCSAgPC9zY3JpcHQ+DQoNCgkgIDxzdHlsZT4NCgkgICAgaHRtbCwNCgkgICAgYm9keSB7DQoJICAgICAgbWFyZ2luOiAwOw0KCSAgICAgIHBhZGRpbmc6IDA7DQoJICAgICAgaGVpZ2h0OiAxMDAlOw0KCSAgICAgIGJhY2tncm91bmQ6ICMwMDAwMDA7DQoJICAgICAgY29sb3I6IG9yYW5nZTsNCgkgICAgICBoZWlnaHQ6IDEwMCU7DQoJICAgICAgd2lkdGg6IDEwMCU7DQoJICAgICAgaGVpZ2h0OiAxMDB2aDsNCgkgICAgICB3aWR0aDogMTAwdnc7DQoJICAgICAgbWFyZ2luOiAwOw0KCSAgICAgIHBhZGRpbmc6IDA7DQoJICAgIH0NCg0KCSAgICAuYm9keTo6LXdlYmtpdC1zY3JvbGxiYXIgew0KCSAgICAgIC8qIFdlYktpdCAqLw0KCSAgICAgIHdpZHRoOiAwcHg7DQoJICAgIH0NCg0KCSAgICAjb3BlbmZsLWNvbnRlbnQgew0KCSAgICAgIGJhY2tncm91bmQ6ICMwMDAwMDA7DQoJICAgICAgd2lkdGg6IDEwMCU7DQoJICAgICAgaGVpZ2h0OiAxMDAlOw0KCSAgICB9DQoNCgkgICAgI3NwaW5uZXIgew0KCSAgICAgIC13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjogNTAlIDUwJTsNCgkgICAgICAtbW96LXRyYW5zZm9ybS1vcmlnaW46IDUwJSA1MCU7DQoJICAgICAgLW8tdHJhbnNmb3JtLW9yaWdpbjogNTAlIDUwJTsNCgkgICAgICB0cmFuc2Zvcm0tb3JpZ2luOiA1MCUgNTAlOw0KCSAgICAgIHdpZHRoOiA4MnB4Ow0KCSAgICAgIGhlaWdodDogODFweDsNCgkgICAgICAtd2Via2l0LWFuaW1hdGlvbjogc3BpbjEgMnMgaW5maW5pdGUgbGluZWFyOw0KCSAgICAgIC1tb3otYW5pbWF0aW9uOiBzcGluMSAycyBpbmZpbml0ZSBsaW5lYXI7DQoJICAgICAgLW8tYW5pbWF0aW9uOiBzcGluMSAycyBpbmZpbml0ZSBsaW5lYXI7DQoJICAgICAgLW1zLWFuaW1hdGlvbjogc3BpbjEgMnMgaW5maW5pdGUgbGluZWFyOw0KCSAgICAgIGFuaW1hdGlvbjogc3BpbjEgMnMgaW5maW5pdGUgbGluZWFyOw0KCSAgICB9DQoNCg0KDQoNCgkgICAgLyogTWFpbiBjb250ZW50IHN0eWxpbmcgKi8NCgkgICAgI21vcmUgew0KCSAgICAgIGRpc3BsYXk6IGZsZXg7DQoJICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KCSAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxYTFhMWE7DQoJICAgICAgcGFkZGluZzogNDBweDsNCgkgICAgICBib3JkZXItdG9wOiAwcHggc29saWQgIzQ0NDsNCgkgICAgICBjb2xvcjogI2ZmZjsNCgkgICAgICBmb250LWZhbWlseTogJ0FyaWFsJywgc2Fucy1zZXJpZjsNCgkgICAgfQ0KDQoJICAgIC5pbmZvLWJveCB7DQoJICAgICAgd2lkdGg6IDQ4JTsNCgkgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjIyOw0KCSAgICAgIHBhZGRpbmc6IDIwcHg7DQoJICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KCSAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDhweCByZ2JhKDAsIDAsIDAsIDAuNCk7DQoJICAgIH0NCg0KCSAgICBoMyB7DQoJICAgICAgZm9udC1zaXplOiAyNHB4Ow0KCSAgICAgIGNvbG9yOiAjZmZhNTAwOw0KCSAgICAgIC8qIEZvb3RiYWxsLXRoZW1lZCBjb2xvciAqLw0KCSAgICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQoJICAgIH0NCg0KCSAgICBwLA0KCSAgICBiIHsNCgkgICAgICBsaW5lLWhlaWdodDogMS42Ow0KCSAgICAgIGZvbnQtc2l6ZTogMTZweDsNCgkgICAgfQ0KDQoJICAgIHAgew0KCSAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQoJICAgIH0NCg0KCSAgICBiIHsNCgkgICAgICBjb2xvcjogI2ZmZDcwMDsNCgkgICAgICAvKiBIaWdobGlnaHRlZCBxdWVzdGlvbiBjb2xvciAqLw0KCSAgICB9DQoNCg0KCSAgICAvKiB1bnZpc2l0ZWQgbGluayAqLw0KCSAgICBhOmxpbmsgew0KCSAgICAgIGNvbG9yOiAjZmZkNzAwOw0KCSAgICB9DQoNCgkgICAgLyogdmlzaXRlZCBsaW5rICovDQoJICAgIGE6dmlzaXRlZCB7DQoJICAgICAgY29sb3I6ICNmZmQ3MDA7DQoJICAgIH0NCg0KCSAgICAvKiBtb3VzZSBvdmVyIGxpbmsgKi8NCgkgICAgYTpob3ZlciB7DQoJICAgICAgY29sb3I6ICNmZmQ3MDA7DQoJICAgIH0NCg0KCSAgICAvKiBzZWxlY3RlZCBsaW5rICovDQoJICAgIGE6YWN0aXZlIHsNCgkgICAgICBjb2xvcjogI2ZmZDcwMDsNCgkgICAgfQ0KDQoJICAgIC5ub3RjaC10b3AtbGVmdCB7DQoJICAgICAgd2lkdGg6IDIwcHg7DQoJICAgICAgaGVpZ2h0OiAyMHB4Ow0KCSAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtY29sb3IsICMxYTFhMWEpOw0KCSAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCgkgICAgICB0b3A6IC0xMHB4Ow0KCSAgICAgIGxlZnQ6IC0xMHB4Ow0KCSAgICAgIGNsaXAtcGF0aDogcG9seWdvbigxMDAlIDAsIDAgMTAwJSwgMTAwJSAxMDAlKTsNCgkgICAgfQ0KDQoJICAgIC8qIEZvb3RlciBzdHlsaW5nICovDQoJICAgIGZvb3RlciB7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMDsNCgkgICAgICBwYWRkaW5nOiAyMHB4IDA7DQoJICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KCSAgICAgIGNvbG9yOiAjY2NjOw0KCSAgICAgIGZvbnQtc2l6ZTogMTRweDsNCgkgICAgICBib3JkZXItdG9wOiAycHggc29saWQgIzQ0NDsNCgkgICAgICBtYXJnaW4tdG9wOiA0MHB4Ow0KCSAgICAgIGZvbnQtZmFtaWx5OiAnQXJpYWwnLCBzYW5zLXNlcmlmOw0KCSAgICAgIGJvcmRlcjogMDsNCgkgICAgfQ0KDQoJICAgIC5mZWVkYmFjay1mb3JtIHsNCgkgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQoJICAgICAgdG9wOiA1MCU7DQoJICAgICAgbGVmdDogNTAlOw0KCSAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOw0KCSAgICAgIHdpZHRoOiA1MHZ3Ow0KCSAgICAgIGhlaWdodDogNTB2aDsNCgkgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMkE2REIwOw0KCSAgICAgIHBhZGRpbmc6IDIwcHg7DQoJICAgICAgYm9yZGVyOiA0cHggc29saWQgI0ZGMDAwMDsNCgkgICAgICBib3gtc2hhZG93OiAwcHggMHB4IDEwcHggcmdiYSgwLCAwLCAwLCAwLjUpOw0KCSAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCgkgICAgICBjb2xvcjogI0ZGRkZGRjsNCgkgICAgfQ0KDQoJICAgIC5mZWVkYmFjay1mb3JtIGgzIHsNCgkgICAgICBmb250LXNpemU6IDI0cHg7DQoJICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCgkgICAgICBjb2xvcjogI0ZGRkZGRjsNCgkgICAgICB0ZXh0LXNoYWRvdzogMnB4IDJweCAjMDAwMDAwOw0KCSAgICB9DQoNCgkgICAgLmZlZWRiYWNrLWZvcm0gdGV4dGFyZWEgew0KCSAgICAgIHdpZHRoOiBjYWxjKDEwMCUgLSAyMHB4KTsNCgkgICAgICBoZWlnaHQ6IDUwJTsNCgkgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KCSAgICAgIHBhZGRpbmc6IDEwcHg7DQoJICAgICAgZm9udC1zaXplOiAxNnB4Ow0KCSAgICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQoJICAgICAgYm9yZGVyOiAzcHggc29saWQgIzAwMDAwMDsNCgkgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwMDAwOw0KCSAgICAgIC8qIEJsYWNrIGJhY2tncm91bmQgKi8NCgkgICAgICBjb2xvcjogI0ZGRkZGRjsNCgkgICAgICAvKiBXaGl0ZSB0ZXh0ICovDQoJICAgICAgcmVzaXplOiBub25lOw0KCSAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQoJICAgIH0NCg0KCSAgICAuZmVlZGJhY2stZm9ybSBidXR0b24gew0KCSAgICAgIHdpZHRoOiAxMDAlOw0KCSAgICAgIHBhZGRpbmc6IDEycHg7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRDcwMDsNCgkgICAgICAvKiBZZWxsb3dpc2ggYmFja2dyb3VuZCAqLw0KCSAgICAgIGNvbG9yOiAjMDAwMDAwOw0KCSAgICAgIGJvcmRlcjogM3B4IHNvbGlkICNGRjAwMDA7DQoJICAgICAgYm9yZGVyLXJhZGl1czogMDsNCgkgICAgICBmb250LXNpemU6IDE4cHg7DQoJICAgICAgY3Vyc29yOiBwb2ludGVyOw0KCSAgICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7DQoJICAgICAgdGV4dC1zaGFkb3c6IDFweCAxcHggIzAwMDAwMDsNCgkgICAgfQ0KDQoJICAgIC5mZWVkYmFjay1mb3JtIGJ1dHRvbjpob3ZlciB7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGQjgwMDsNCgkgICAgICAvKiBTbGlnaHRseSBkYXJrZXIgeWVsbG93IG9uIGhvdmVyICovDQoJICAgICAgY29sb3I6ICNGRkZGRkY7DQoJICAgIH0NCgkgIDwvc3R5bGU+DQoNCg0KCSAgPCEtLSBHb29nbGUgdGFnIChndGFnLmpzKSAtLT4NCgkgIDxzY3JpcHQgYXN5bmMgc3JjPSJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndGFnL2pzP2lkPUctR1JFQjYzUFdFTCI+PC9zY3JpcHQ+DQoNCgkgIDxzY3JpcHQ+DQoJICAgIHdpbmRvdy5kYXRhTGF5ZXIgPSB3aW5kb3cuZGF0YUxheWVyIHx8IFtdOw0KDQoJICAgIGZ1bmN0aW9uIGd0YWcoKSB7DQoJICAgICAgZGF0YUxheWVyLnB1c2goYXJndW1lbnRzKTsNCgkgICAgfQ0KCSAgICBndGFnKCdqcycsIG5ldyBEYXRlKCkpOw0KDQoJICAgIGlmIChsb2NhdGlvbi5ob3N0bmFtZSAhPSAibG9jYWxob3N0IikgZ3RhZygnY29uZmlnJywgJ0ctR1JFQjYzUFdFTCcsIHsNCgkgICAgICBjb29raWVfZmxhZ3M6ICdzZWN1cmU7c2FtZXNpdGU9bm9uZScNCgkgICAgfSk7DQoJICA8L3NjcmlwdD4NCg0KCSAgPHNjcmlwdD4NCgkgICAgLy9JbnRlcnN0aXRpYWwgYWQgYXZhaWxhYmxlIGV2ZW50DQoJICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImFpcF9pbnRlcnN0aXRpYWxhZGF2YWlsYWJsZSIsIGZ1bmN0aW9uKGUpIHsNCgkgICAgICBjb25zb2xlLmxvZygiQW4gaW50ZXJzdGl0aWFsIGFkIGlzIGF2YWlsYWJsZSIpOw0KCSAgICB9KTsNCgkgIDwvc2NyaXB0Pg0KCSAgPHNjcmlwdD4NCgkgICAgY29uc29sZS5sb2coIkluaXR0aW5nIEFJUCIpDQoJICAgIHdpbmRvdy5haXB0YWcgPSB3aW5kb3cuYWlwdGFnIHx8IHsNCgkgICAgICBjbWQ6IFtdDQoJICAgIH07DQoJICAgIGFpcHRhZy5jbWQuZGlzcGxheSA9IGFpcHRhZy5jbWQuZGlzcGxheSB8fCBbXTsNCgkgICAgYWlwdGFnLmNtZC5wbGF5ZXIgPSBhaXB0YWcuY21kLnBsYXllciB8fCBbXTsNCg0KCSAgICAvL0NNUCB0b29sIHNldHRpbmdzDQoJICAgIGFpcHRhZy5jb25zZW50ZWQgPSBmYWxzZTsgLy8gR0RQUiBzZXR0aW5nLCBwbGVhc2Ugc2V0IHRoaXMgdmFsdWUgdG8gZmFsc2UgaWYgYW4gRVUgdXNlciBoYXMgZGVjbGluZWQgb3Igbm90IHlldCBhY2NlcHRlZCBtYXJrZXRpbmcgY29va2llcywgZm9yIHVzZXJzIG91dHNpZGUgdGhlIEVVIHBsZWFzZSB1c2UgdHJ1ZSBhbmQgZm9yIHVzZXJzIGFjY2VwdGVkIHRoZSBHRFBSIGFsc28gdXNlIHRydWUNCgkgICAgYWlwdGFnLmNtcCA9IHsNCgkgICAgICBzaG93OiB0cnVlLA0KCSAgICAgIHBvc2l0aW9uOiAiY2VudGVyZWQiLA0KCSAgICAgIGJ1dHRvbjogZmFsc2UsDQoJICAgICAgYnV0dG9uVGV4dDogIlByaXZhY3kgc2V0dGluZ3MiLA0KCSAgICAgIGJ1dHRvblBvc2l0aW9uOiAiYm90dG9tLWxlZnQiDQoJICAgIH0NCgkgIDwvc2NyaXB0Pg0KCSAgPHNjcmlwdCBhc3luYyBzcmM9InRhZy5taW4uanMiPjwvc2NyaXB0Pg0KDQoJICA8c2NyaXB0Pg0KCSAgICBmdW5jdGlvbiBTZXR1cE1TTm90aWZpY2F0aW9uKCkgew0KCSAgICAgIGNvbnNvbGUubG9nKCJub3RpZnlpbmciKTsNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgY29uc29sZS5sb2coIm5vdGlmeWluZzIiKTsNCgkgICAgICAgIHZhciBpZCA9IGJ0b2EoIiIpOw0KCSAgICAgICAgJG1zc3RhcnQuc2NoZWR1bGVOb3RpZmljYXRpb25Bc3luYyh7DQoJICAgICAgICAgIHRpdGxlOiAnVW5sb2NrIG5ldyBicm9zIG5vdyEnLA0KCSAgICAgICAgICBkZXNjcmlwdGlvbjogJ1lvdSBhcmUganVzdCBhYm91dCB0byB1bmxvY2sgYSBuZXcgQnJvISBXaG8gd2lsbCBpdCBiZT8nLA0KCSAgICAgICAgICB0eXBlOiAxLA0KCSAgICAgICAgICBtaW5EZWxheUluU2Vjb25kczogMjQgKiA2MCAqIDYwDQoJICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coIm5vdGlmaWNhdGlvbiByZXNwb25zZTogIiArIHJlc3BvbnNlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgICAgJG1zc3RhcnQuc2NoZWR1bGVOb3RpZmljYXRpb25Bc3luYyh7DQoJICAgICAgICAgIHRpdGxlOiAnRHVuayBhbGwgb3ZlciB5b3VyIGJyb3MhJywNCgkgICAgICAgICAgZGVzY3JpcHRpb246ICdOZXcgYnJvcyBqdXN0IHdhaXRpbmcgdG8gYmUgZHVua2VkIG9uISBVbmxvY2sgdGhlbSBub3chJywNCgkgICAgICAgICAgdHlwZTogMSwNCgkgICAgICAgICAgbWluRGVsYXlJblNlY29uZHM6IDI0ICogNyAqIDYwICogNjANCgkgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gew0KCSAgICAgICAgICBjb25zb2xlLmxvZygibm90aWZpY2F0aW9uIHJlc3BvbnNlOiAiICsgcmVzcG9uc2UpOw0KCSAgICAgICAgfSk7DQoNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICB2YXIgbXNBZElEOw0KDQoJICAgIGZ1bmN0aW9uIExvYWRWaWRlbygpIHsNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgJG1zc3RhcnQubG9hZEFkc0FzeW5jKCkudGhlbihhZEluc3RhbmNlID0+IHsNCgkgICAgICAgICAgLy8gVXNlIHRoZSBhZEluc3RhbmNlLmluc3RhbmNlSWQgdG8gbWFrZSBhIGNhbGwgdG8gc2hvd0Fkc0FzeW5jDQoJICAgICAgICAgIG1zQWRJRCA9IGFkSW5zdGFuY2UuaW5zdGFuY2VJZDsNCgkgICAgICAgIH0pOw0KDQoJICAgICAgICBTZXR1cE1TTm90aWZpY2F0aW9uKCk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd1ZpZGVvKHRoZVVuaXROYW1lID0gbnVsbCkgew0KCSAgICAgIE1haW4uRG9uZVZpZGVvQWQodHJ1ZSk7DQoJICAgICAgcmV0dXJuOyAvLyEgd2hlbiBhaXAgaXMgbGl2ZSwgcmVtb3ZlIHRoaXMNCg0KCSAgICAgIGNvbnNvbGUubG9nKCdTSE9XX1ZJREVPOicgKyB0aGVVbml0TmFtZSk7DQoJICAgICAgdmFyIGFVbml0TmFtZSA9ICIiOw0KCSAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICAkbXNzdGFydC5zaG93QWRzQXN5bmMobXNBZElEKS50aGVuKGFkSW5zdGFuY2UgPT4gew0KCSAgICAgICAgICAvLyBVc2UgdGhlIGFkSW5zdGFuY2Uuc2hvd0Fkc0NvbXBsZXRlZEFzeW5jIHRvIGJlIG5vdGlmaWVkIG9mIHRoZSBjb21wbGV0aW9uIG9mIHNob3dpbmcgdGhlIGFkdmVydGlzZW1lbnQNCgkgICAgICAgICAgYWRJbnN0YW5jZS5zaG93QWRzQ29tcGxldGVkQXN5bmMudGhlbigodmFsKSA9PiB7DQoJICAgICAgICAgICAgY29uc29sZS5sb2coJ01TIFZpZGVvIEFkIENvbXBsZXRlJyk7DQoJICAgICAgICAgICAgTWFpbi5Eb25lVmlkZW9BZCgpOw0KCSAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KCSAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlbmZsLWNvbnRlbnQnKS5mb2N1cygpOw0KCSAgICAgICAgICAgIExvYWRWaWRlbygpOw0KCSAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7DQoJICAgICAgICAgICAgY29uc29sZS5sb2coJ01zIFZpZGVvIEFkIEVycm9yJyk7DQoJICAgICAgICAgICAgTWFpbi5Eb25lVmlkZW9BZCgpOw0KCSAgICAgICAgICAgIHdpbmRvdy5mb2N1cygpOw0KCSAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlbmZsLWNvbnRlbnQnKS5mb2N1cygpOw0KCSAgICAgICAgICAgIExvYWRWaWRlbygpOw0KCSAgICAgICAgICB9KTsNCgkgICAgICAgIH0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGdDcmF6eVNESy5hZGRFdmVudExpc3RlbmVyKCJhZEZpbmlzaGVkIiwgTWFpbi5Eb25lVmlkZW9BZCk7IC8vIHJlZW5hYmxlIHNvdW5kLCBlbmFibGUgdWkNCgkgICAgICAgIGdDcmF6eVNESy5hZGRFdmVudExpc3RlbmVyKCJhZEVycm9yIiwgTWFpbi5Eb25lVmlkZW9BZCk7IC8vIHJlZW5hYmxlIHNvdW5kLCBlbmFibGUgdWkNCgkgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0QWQoKTsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdDR19BRF9SRVFVRVNURUQnKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnY2d2aWRlbycpOw0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFkcGxheWVyID09PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgTWFpbi5Eb25lVmlkZW9BZCh0cnVlKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAndmlkZW9fYWRibG9ja2VkJyk7DQoJICAgICAgICBjb25zb2xlLmxvZygnVklERU9fQURCTE9DS0VEJyk7DQoNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgdmFyIGFTdHIgPSAncHJlcm9sbCc7DQoJICAgICAgICAvL2lmKHRoZVVuaXROYW1lICE9IG51bGwpIGFTdHIgPSB0aGVVbml0TmFtZTsNCgkgICAgICAgIGxhc3RVbml0UGxheWVkID0gYVN0cjsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnc3RhcnR2aWRlby0nICsgYVN0cik7DQoNCgkgICAgICAgIGFpcHRhZy5jbWQucGxheWVyLnB1c2goZnVuY3Rpb24oKSB7DQoJICAgICAgICAgIGFkcGxheWVyLnN0YXJ0VmlkZW9BZCh0aGVVbml0TmFtZSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9DQoJICAgIH0NCgkgIDwvc2NyaXB0Pg0KDQoJICA8IS0tIEZpcmViYXNlIEFwcCAodGhlIGNvcmUgRmlyZWJhc2UgU0RLKSAtLT4NCgkgIDxzY3JpcHQgc3JjPSJmaXJlYmFzZS1hcHAuanMiPjwvc2NyaXB0Pg0KCSAgPCEtLSBGaXJlYmFzZSBBdXRoZW50aWNhdGlvbiAtLT4NCgkgIDxzY3JpcHQgc3JjPSJmaXJlYmFzZS1hdXRoLmpzIj48L3NjcmlwdD4NCgkgIDwhLS0gRmlyZWJhc2UgRmlyZXN0b3JlIChEYXRhYmFzZSkgLS0+DQoJICA8c2NyaXB0IHNyYz0iZmlyZWJhc2UtZmlyZXN0b3JlLmpzIj48L3NjcmlwdD4NCg0KCSAgPHNjcmlwdD4NCgkgICAgLy8gWW91ciB3ZWIgYXBwJ3MgRmlyZWJhc2UgY29uZmlndXJhdGlvbg0KCSAgICBjb25zdCBmaXJlYmFzZUNvbmZpZyA9IHsNCgkgICAgICBhcGlLZXk6ICJBSXphU3lBRkN3WWRia0xveklndEg1enVHeWRjamtfTE5oWW52ZTAiLA0KCSAgICAgIGF1dGhEb21haW46ICJmb290YmFsbC1icm9zLThmMWIzLmZpcmViYXNlYXBwLmNvbSIsDQoJICAgICAgcHJvamVjdElkOiAiZm9vdGJhbGwtYnJvcy04ZjFiMyIsDQoJICAgICAgc3RvcmFnZUJ1Y2tldDogImZvb3RiYWxsLWJyb3MtOGYxYjMuYXBwc3BvdC5jb20iLA0KCSAgICAgIG1lc3NhZ2luZ1NlbmRlcklkOiAiODA3NDM0MDUxMTA2IiwNCgkgICAgICBhcHBJZDogIjE6ODA3NDM0MDUxMTA2OndlYjo3ZTJmZDU5NzgyZTdjMTMxNjVmNDdiIg0KCSAgICB9Ow0KDQoJICAgIC8vIEluaXRpYWxpemUgRmlyZWJhc2UNCgkgICAgZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7DQoJICAgIGNvbnN0IGF1dGggPSBmaXJlYmFzZS5hdXRoKCk7DQoJICAgIGNvbnN0IGRiID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7DQoJICAgIHZhciB1c2VyRGF0YSA9ICIiOw0KDQoJICAgIGZ1bmN0aW9uIHRyaWdnZXJTaWduSW4oKSB7DQoJICAgICAgdmFyIHByb3ZpZGVyID0gbmV3IGZpcmViYXNlLmF1dGguR29vZ2xlQXV0aFByb3ZpZGVyKCk7DQoJICAgICAgYXV0aC5zaWduSW5XaXRoUG9wdXAocHJvdmlkZXIpOw0KCSAgICB9DQoNCgkgICAgLy8gU2F2ZSBnYW1lIGRhdGEgZnVuY3Rpb24NCgkgICAgZnVuY3Rpb24gc2F2ZUdhbWVEYXRhKGdhbWVEYXRhKSB7DQoJICAgICAgY29uc29sZS5sb2coJ3NhdmluZyBnYW1lZGF0YTonICsgZ2FtZURhdGEpOw0KCSAgICAgIHZhciB1c2VySWQgPSBhdXRoLmN1cnJlbnRVc2VyLnVpZDsNCgkgICAgICB1c2VyRGF0YSA9IGdhbWVEYXRhOw0KCSAgICAgIGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZG9jKHVzZXJJZCkuc2V0KHsNCgkgICAgICAgIGdhbWVEYXRhOiBnYW1lRGF0YQ0KCSAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygnR2FtZSBkYXRhIHNhdmVkJyk7DQoJICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsNCgkgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBnYW1lIGRhdGE6JywgZXJyb3IpOw0KCSAgICAgIH0pOw0KCSAgICB9DQoNCgkgICAgLy8gTG9hZCBnYW1lIGRhdGEgZnVuY3Rpb24NCgkgICAgZnVuY3Rpb24gbG9hZEdhbWVEYXRhKCkgew0KCSAgICAgIHJldHVybiB1c2VyRGF0YTsNCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIGxvYWRHYW1lRGF0YUFzeW5jKCkgew0KCSAgICAgIHZhciB1c2VySWQgPSBhdXRoLmN1cnJlbnRVc2VyLnVpZDsNCgkgICAgICBkYi5jb2xsZWN0aW9uKCd1c2VycycpLmRvYyh1c2VySWQpLmdldCgpLnRoZW4oZnVuY3Rpb24oZG9jKSB7DQoJICAgICAgICBpZiAoZG9jLmV4aXN0cykgew0KCSAgICAgICAgICB1c2VyRGF0YSA9IGRvYy5kYXRhKCkuZ2FtZURhdGE7DQoJICAgICAgICAgIC8vTWFpbi5Mb2FkR2xvYmFscygpOw0KCSAgICAgICAgICBjb25zb2xlLmxvZygnR2FtZSBkYXRhOicsIGRvYy5kYXRhKCkuZ2FtZURhdGEpOw0KCSAgICAgICAgICBpZiAodHlwZW9mIE1haW4gIT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgICBNYWluLkxvYWREYXRhQ29tcGxldGUoKTsNCgkgICAgICAgICAgfQ0KCSAgICAgICAgICAvLyBVc2UgdGhlIGdhbWUgZGF0YSBpbiB5b3VyIGdhbWUNCgkgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBzdWNoIGRvY3VtZW50IScpOw0KCSAgICAgICAgfQ0KCSAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7DQoJICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGdhbWUgZGF0YTonLCBlcnJvcik7DQoJICAgICAgfSk7DQoJICAgIH0NCg0KCSAgICAvLyBGaXJlYmFzZSBhdXRoIHN0YXRlIG9ic2VydmVyDQoJICAgIGF1dGgub25BdXRoU3RhdGVDaGFuZ2VkKGZ1bmN0aW9uKHVzZXIpIHsNCgkgICAgICBpZiAodXNlcikgew0KCSAgICAgICAgbG9hZEdhbWVEYXRhQXN5bmMoKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnc2lnbl9pbicpOw0KCSAgICAgICAgY29uc29sZS5sb2coJ3VzZXIgc2lnbmVkIGluJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdObyB1c2VyIHNpZ25lZCBpbicpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdzaWduX291dCcpOw0KCSAgICAgIH0NCgkgICAgfSk7DQoNCgkgICAgZnVuY3Rpb24gc2lnbk91dCgpIHsNCgkgICAgICBhdXRoLnNpZ25PdXQoKS50aGVuKCgpID0+IHsNCgkgICAgICAgIE1haW4uU2lnbk91dENvbXBsZXRlKCk7DQoJICAgICAgICBjb25zb2xlLmxvZygnc2lnbmVkIG91dCcpOw0KCSAgICAgIH0pOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gaXNVc2VyTG9nZ2VkSW4oKSB7DQoJICAgICAgcmV0dXJuIGF1dGguY3VycmVudFVzZXIgIT09IG51bGw7DQoJICAgIH0NCgkgIDwvc2NyaXB0Pg0KDQoJPC9oZWFkPg0KDQoJPGJvZHkgc3R5bGU9Im92ZXJmbG93OmhpZGRlbjsiPg0KCSAgPG5vc2NyaXB0PkVuYWJsZSBKYXZhU2NyaXB0IGJybyE8L25vc2NyaXB0Pg0KCSAgPHNjcmlwdD4NCgkgICAgLy9hbGVydCgiR2xvYmFsczoiK2xvY2FsU3RvcmFnZS5nZXRJdGVtKCIvOkdsb2JhbHMiKS5sZW5ndGgpOw0KCSAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCgkgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCgkgICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOw0KCSAgICBpZiAodXJsLmluY2x1ZGVzKCJ3d3cuIikpIHsNCgkgICAgICB1cmwgPSB1cmwucmVwbGFjZSgid3d3LiIsICIiKTsNCg0KCSAgICAgIHZhciBmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpOw0KCSAgICAgIGYuYWN0aW9uID0gdXJsOw0KCSAgICAgIGYubWV0aG9kID0gJ1BPU1QnOw0KCSAgICAgIHZhciBpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCgkgICAgICBpLnR5cGUgPSAnaGlkZGVuJzsNCgkgICAgICBpLm5hbWUgPSAnRkdsb2JhbHMnOw0KCSAgICAgIGkudmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiLzpHbG9iYWxzIik7DQoJICAgICAgZi5hcHBlbmRDaGlsZChpKTsNCg0KCSAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZik7DQoJICAgICAgZi5zdWJtaXQoKTsNCgkgICAgfSBlbHNlIHsNCgkgICAgICB2YXIgYVBvc3QgPSAiIjsNCgkgICAgICB2YXIgYVN0b3JhZ2UgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiLzpHbG9iYWxzIik7DQoJICAgICAgdmFyIGFMZW4gPSAwOw0KCSAgICAgIGlmIChhU3RvcmFnZSAhPSBudWxsICYmIGFTdG9yYWdlLmxlbmd0aCA+IDApIHsNCgkgICAgICAgIGFMZW4gPSBhU3RvcmFnZS5sZW5ndGg7DQoJICAgICAgfQ0KCSAgICAgIGlmIChhUG9zdC5sZW5ndGggPiBhTGVuKSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiLzpHbG9iYWxzIiwgYVBvc3QpOw0KCSAgICAgIGlmIChhUG9zdC5sZW5ndGggPiAwICYmIGFQb3N0Lmxlbmd0aCA9PSBhTGVuKSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiLzpHbG9iYWxzIiwgYVBvc3QpOw0KCSAgICB9DQoJICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KCSAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KCSAgPC9zY3JpcHQ+DQoNCgkgIDxkaXYgaWQ9ImxvYWRpbmciIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7IHotaW5kZXg6IDE1OyB0b3A6IDYwJTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAwKTsgYmFja2dyb3VuZDogYmxhY2s7Ij4NCgkgICAgPGNlbnRlcj48aW1nIHNyYz0iYXNzZXRzL2xvYWRpbmc0LnBuZyI+PGJyIC8+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9mYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9zYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy93YnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9iYnJvLnBuZyI+DQoJICAgIDwvY2VudGVyPg0KCSAgPC9kaXY+DQoNCgkgIDxkaXYgaWQ9ImdhbWUyIiBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgIj4NCgkgICAgPGRpdiBpZD0ib3BlbmZsLWNvbnRlbnQiIG9uYmx1cj0id2luZG93LmZvY3VzKCk7IiBzdHlsZT0id2lkdGg6IGNhbGMoMTAwJSk7IGZsb2F0OmxlZnQ7Ij4NCgkgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQoJICAgICAgICBsaW1lLmVtYmVkKCJGb290YmFsbEJyb3MiLCAib3BlbmZsLWNvbnRlbnQiLCAwLCAwLCB7DQoJICAgICAgICAgIHBhcmFtZXRlcnM6IHt9DQoJICAgICAgICB9KTsNCgkgICAgICA8L3NjcmlwdD4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9InByZXJvbGwiIHN0eWxlPSJ3aWR0aDogOTYwcHg7IGhlaWdodDogNTQwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiA1MCU7IGxlZnQ6IDUwJTsgei1pbmRleDogMTAwOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsiPg0KCSAgICA8L2Rpdj4NCg0KCSAgICA8ZGl2IGlkPSJmb290YmFsbGJyb3MtaW9fMzAweDI1MCIgc3R5bGU9IndpZHRoOiAzMzZweDsgaGVpZ2h0OiAyODBweDsgdmlzaWJpbGl0eTpoaWRkZW47IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICAgIDxzY3JpcHQ+DQoJICAgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyA9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgICBhaXB0YWcuY21kLmRpc3BsYXkucHVzaChmdW5jdGlvbigpIHsNCgkgICAgICAgICAgICBhaXBEaXNwbGF5VGFnLmRpc3BsYXkoJ2Zvb3RiYWxsYnJvcy1pb18zMDB4MjUwJyk7DQoJICAgICAgICAgIH0pOw0KCSAgICAgICAgfQ0KCSAgICAgIDwvc2NyaXB0Pg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0iZm9vdGJhbGxicm9zLWlvXzMwMHgyNTBfMiIgc3R5bGU9IndpZHRoOiAzMzZweDsgaGVpZ2h0OiAyODBweDsgdmlzaWJpbGl0eTpoaWRkZW47IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICAgIDxzY3JpcHQ+DQoJICAgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyA9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgICBhaXB0YWcuY21kLmRpc3BsYXkucHVzaChmdW5jdGlvbigpIHsNCgkgICAgICAgICAgICBhaXBEaXNwbGF5VGFnLmRpc3BsYXkoJ2Zvb3RiYWxsYnJvcy1pb18zMDB4MjUwXzInKTsNCgkgICAgICAgICAgfSk7DQoJICAgICAgICB9DQoJICAgICAgPC9zY3JpcHQ+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJmb290YmFsbGJyb3MtaW9fMzM2eDI4MCIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyB3aWR0aDogMzM2cHg7IGhlaWdodDogNjAwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMzBweDsgei1pbmRleDogMTAwO292ZXJmbG93OiBoaWRkZW47Ij4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9ImZvb3RiYWxsYnJvcy1pb18zMzZ4MjgwXzIiIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsgd2lkdGg6IDMzNnB4OyBoZWlnaHQ6IDYwMHB4OyBkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJmb290YmFsbGJyb3MtaW9fNzI4eDkwIiBzdHlsZT0idmlzaWJpbGl0eTpoaWRkZW47IHdpZHRoOiA3MjhweDsgaGVpZ2h0OiA5MHB4OyBkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMzBweDsgbGVmdDogMzBweDsgei1pbmRleDogMTAwO292ZXJmbG93OiBoaWRkZW47Ij4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9ImZvb3RiYWxsYnJvcy1pb183Mjh4OTBfbSIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyB3aWR0aDogNzI4cHg7IGhlaWdodDogOTBweDsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDMwcHg7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJmb290YmFsbGJyb3MtaW9fOTcweDI1MCIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyB3aWR0aDogOTcwcHg7IGhlaWdodDogMjUwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7IHRleHQtYWxpZ246IGNlbnRlcjtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KDQoJICAgIDxkaXYgY2xhc3M9ImZlZWRiYWNrLWZvcm0iIGlkPSJmZWVkYmFja0Zvcm0iIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCgkgICAgICA8aDM+UmVwb3J0IGEgQnVnL0dsaXRjaDwvaDM+DQoJICAgICAgPHRleHRhcmVhIGlkPSJmZWVkYmFjayIgcGxhY2Vob2xkZXI9IkRlc2NyaWJlIHRoZSBidWcgb3IgZ2xpdGNoIHdpdGggYSBsb3Qgb2YgZGV0YWlscywgbGlrZSBob3cgdG8gbWFrZSB0aGUgZ2xpdGNoIGhhcHBlbiBhbmQgYW55dGhpbmcgZWxzZSB3aGV0aGVyIGl0IHNlZW1zIHVzZWZ1bCBvciBub3QuLi4iPjwvdGV4dGFyZWE+DQoJICAgICAgPHRleHRhcmVhIGlkPSJlbWFpbCIgcGxhY2Vob2xkZXI9IkVtYWlsIGFkZHJlc3MgKG9wdGlvbmFsKSIgc3R5bGU9ImhlaWdodDogNTBweDsiPjwvdGV4dGFyZWE+DQoJICAgICAgPHRleHRhcmVhIGlkPSJkaXNjb3JkIiBwbGFjZWhvbGRlcj0iRGlzY29yZCBJRCAob3B0aW9uYWwpIiBzdHlsZT0iaGVpZ2h0OiA1MHB4OyI+PC90ZXh0YXJlYT4NCgkgICAgICA8YnV0dG9uIG9uY2xpY2s9InNlbmRGZWVkYmFjaygpIiBpZD0ic3VibWl0QnRuIj5TdWJtaXQgRmVlZGJhY2s8L2J1dHRvbj4NCgkgICAgICA8YnIgLz4NCgkgICAgICA8YnIgLz4NCgkgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmZWVkYmFja0Zvcm0nKS5zdHlsZS5kaXNwbGF5PSdub25lJyIgaWQ9InN1Ym1pdEJ0biI+Q2FuY2VsPC9idXR0b24+DQoJICAgICAgPHAgaWQ9InJlc3BvbnNlTXNnIj48L3A+DQoJICAgIDwvZGl2Pg0KCSAgICA8c2NyaXB0Pg0KCSAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9GZWVkYmFjayA9IHRydWU7DQoJICAgICAgZnVuY3Rpb24gZ2V0T1NGcm9tVXNlckFnZW50KCkgew0KCSAgICAgICAgY29uc3QgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsNCgkgICAgICAgIGNvbnN0IHBsYXRmb3JtID0gbmF2aWdhdG9yLnBsYXRmb3JtOw0KDQoJICAgICAgICAvLyBDaGVjayBmb3IgY29tbW9uIHBsYXRmb3JtcyBhbmQgT1MNCgkgICAgICAgIGlmICgvV2luZG93cyBOVC9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdXaW5kb3dzJzsNCgkgICAgICAgIGlmICgvTWFjIE9TIFgvaS50ZXN0KHVzZXJBZ2VudCkpIHJldHVybiAnbWFjT1MnOw0KCSAgICAgICAgaWYgKC9MaW51eC9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdMaW51eCc7DQoJICAgICAgICBpZiAoL0FuZHJvaWQvaS50ZXN0KHVzZXJBZ2VudCkpIHJldHVybiAnQW5kcm9pZCc7DQoJICAgICAgICBpZiAoL2lQaG9uZXxpUGFkfGlQb2QvaS50ZXN0KHVzZXJBZ2VudCkpIHJldHVybiAnaU9TJzsNCgkgICAgICAgIGlmICgvQ3JPUy9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdDaHJvbWUgT1MnOw0KDQoJICAgICAgICAvLyBEZWZhdWx0IHRvIHRoZSBwbGF0Zm9ybSBpZiBubyBtYXRjaA0KCSAgICAgICAgcmV0dXJuIHBsYXRmb3JtIHx8ICdVbmtub3duJzsNCgkgICAgICB9DQoJICAgICAgYXN5bmMgZnVuY3Rpb24gc2VuZEZlZWRiYWNrKCkgew0KCSAgICAgICAgdmFyIGZlZWRiYWNrID0gJyonICsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlZWRiYWNrIikudmFsdWUudHJpbSgpICsgJyonOw0KCSAgICAgICAgdmFyIGVtYWlsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVtYWlsIikudmFsdWUudHJpbSgpOw0KCSAgICAgICAgdmFyIGRpc2NvcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGlzY29yZCIpLnZhbHVlLnRyaW0oKTsNCgkgICAgICAgIGNvbnN0IHNjcmVlblJlc29sdXRpb24gPSBgJHt3aW5kb3cuc2NyZWVuLndpZHRofXgke3dpbmRvdy5zY3JlZW4uaGVpZ2h0fWA7DQoJICAgICAgICBjb25zdCB3aW5kb3dSZXNvbHV0aW9uID0gYCR7d2luZG93LmlubmVyV2lkdGh9eCR7d2luZG93LmlubmVySGVpZ2h0fWA7DQoJICAgICAgICB2YXIgYU9TID0gZ2V0T1NGcm9tVXNlckFnZW50KCk7DQoJICAgICAgICB2YXIgYUNpdHkgPSAnUHJvdm8nOw0KCSAgICAgICAgY29uc3QgaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7DQoJICAgICAgICBjb25zdCBncHUgPSAoKCkgPT4gew0KCSAgICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsNCgkgICAgICAgICAgY29uc3QgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnKSB8fCBjYW52YXMuZ2V0Q29udGV4dCgnZXhwZXJpbWVudGFsLXdlYmdsJyk7DQoJICAgICAgICAgIGNvbnN0IGRlYnVnSW5mbyA9IGdsPy5nZXRFeHRlbnNpb24oJ1dFQkdMX2RlYnVnX3JlbmRlcmVyX2luZm8nKTsNCgkgICAgICAgICAgY29uc3QgZ3B1SW5mbyA9IGRlYnVnSW5mbyA/IGdsLmdldFBhcmFtZXRlcihkZWJ1Z0luZm8uVU5NQVNLRURfUkVOREVSRVJfV0VCR0wpIDogJ1Vua25vd24nOw0KDQoJICAgICAgICAgIC8vIENsZWFudXANCgkgICAgICAgICAgY2FudmFzLnJlbW92ZSgpOyAvLyBSZW1vdmUgdGhlIGNhbnZhcyBmcm9tIHRoZSBET00gKGlmIGl0IHdhcyBhZGRlZCkNCgkgICAgICAgICAgcmV0dXJuIGdwdUluZm87DQoJICAgICAgICB9KSgpOw0KDQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJ1xuRG9tYWluOiAnICsgaG9zdG5hbWU7DQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJywgT1M6ICcgKyBhT1M7DQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJywgU2NyZWVuIHJlczogJyArIHNjcmVlblJlc29sdXRpb247DQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJywgV2luZG93IHJlczogJyArIHdpbmRvd1Jlc29sdXRpb247DQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJywgR1BVOiAnICsgZ3B1Ow0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIENpdHk6ICcgKyBhQ2l0eTsNCgkgICAgICAgIGZlZWRiYWNrID0gZmVlZGJhY2sgKyAnLCBFbWFpbDogJyArIGVtYWlsOw0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIERpc2NvcmQ6ICcgKyBkaXNjb3JkOw0KDQoJICAgICAgICBjb25zdCByZXNwb25zZU1zZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXNwb25zZU1zZyIpOw0KCSAgICAgICAgY29uc3Qgc3VibWl0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN1Ym1pdEJ0biIpOw0KDQoJICAgICAgICBpZiAoIWZlZWRiYWNrKSB7DQoJICAgICAgICAgIGFsZXJ0KCJQbGVhc2UgZW50ZXIgZmVlZGJhY2suIik7DQoJICAgICAgICAgIHJldHVybjsNCgkgICAgICAgIH0NCg0KCSAgICAgICAgc3VibWl0QnRuLmRpc2FibGVkID0gdHJ1ZTsNCgkgICAgICAgIHJlc3BvbnNlTXNnLnRleHRDb250ZW50ID0gIlN1Ym1pdHRpbmcuLi4iOw0KDQoJICAgICAgICB0cnkgew0KCSAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCJzZW5kRmVlZGJhY2sucGhwIiwgew0KCSAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLA0KCSAgICAgICAgICAgIGhlYWRlcnM6IHsNCgkgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIg0KCSAgICAgICAgICAgIH0sDQoJICAgICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7DQoJICAgICAgICAgICAgICBmZWVkYmFjazogZmVlZGJhY2sNCgkgICAgICAgICAgICB9KQ0KCSAgICAgICAgICB9KTsNCg0KCSAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7DQoNCgkgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09ICJzdWNjZXNzIikgew0KCSAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmZWVkYmFja0Zvcm0iKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOyAvLyBDbG9zZSB0aGUgZmVlZGJhY2sgZm9ybQ0KCSAgICAgICAgICAgIGFsZXJ0KHJlc3VsdC5tZXNzYWdlKTsgLy8gU2hvdyBzdWNjZXNzIG1lc3NhZ2UNCgkgICAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmVlZGJhY2tGb3JtIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsgLy8gQ2xvc2UgdGhlIGZlZWRiYWNrIGZvcm0NCgkgICAgICAgICAgICBhbGVydChyZXN1bHQubWVzc2FnZSk7IC8vIFNob3cgZXJyb3IgbWVzc2FnZQ0KCSAgICAgICAgICB9DQoJICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KCSAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmVlZGJhY2tGb3JtIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsgLy8gQ2xvc2UgdGhlIGZlZWRiYWNrIGZvcm0NCgkgICAgICAgICAgYWxlcnQoIkVycm9yIHN1Ym1pdHRpbmcgZmVlZGJhY2suIFBsZWFzZSB0cnkgYWdhaW4uIik7DQoJICAgICAgICB9DQoNCgkgICAgICAgIHN1Ym1pdEJ0bi5kaXNhYmxlZCA9IGZhbHNlOw0KCSAgICAgIH0NCgkgICAgPC9zY3JpcHQ+DQoNCg0KDQoJICA8L2Rpdj4NCgkgIDxiciAvPg0KCSAgPGRpdiB0YWJpbmRleD0iLTEiIGlkPSJtb3JlIj4NCgkgICAgPGRpdiBjbGFzcz0iaW5mby1ib3giPg0KCSAgICAgIDxoMz5BYm91dCBGb290YmFsbCBCcm9zPC9oMz4NCgkgICAgICA8cD5BbHQgdXJsOiB3d3cuZHVuay5tb25zdGVyLiBGb290YmFsbCBCcm9zIGlzIGEgc2ltcGxlLCBmYXN0LXBhY2VkIGZvb3RiYWxsIGdhbWUgd2l0aCBhbGwga2luZHMgb2YgY3JhenkgYWN0aW9uISBXaXRoIG9ubGluZSBtdWx0aXBsYXllciBnYW1lcGxheSwgbG90cyBvZiBwbGF5cywgYW5kIGFsbCBraW5kcyBvZiBjcmF6eSBmb290YmFsbCBhY3Rpb24hPC9wPg0KCSAgICAgIDxwPlRoZSBjb250cm9scyBhcmUgdmVyeSBzaW1wbGU6IFVzZSBlaXRoZXIgdGhlIGFycm93IGtleXMgb3IgV0FTRCB0byBjb250cm9sIHlvdXIgYnJvLiBTcGFjZSBiYXIgd2lsbCB0aHJvdyBhIHBhc3MsIGRpdmUsIG9yIHN0aWZmIGFybSwgZGVwZW5kaW5nIG9uIHRoZSBzaXR1YXRpb24uPC9wPg0KCSAgICAgIDxwPkJlIHN1cmUgdG8gZm9sbG93IHVzIG9uIHNvY2lhbCBtZWRpYSBmb3IgdGhlIGxhdGVzdCB1cGRhdGVzIGFuZCBpbmZvITwvcD4NCgkgICAgICA8YnIgLz4NCgkgICAgICA8aDM+Q2hhbmdlbG9nICgxLzMwLzIwMjQpPC9oMz4NCgkgICAgICA8cD5BZGRlZCBTYXlqdWFuIHRvIFBoaWxseS48L3A+DQoJICAgICAgPHA+Q2hhbmdlZCBwbGF5IHNlbGVjdGlvbiB0byBhIGhvcml6b250YWwgc3RyaXAgdG8gZml0IG9uIG1vcmUgc2NyZWVucy48L3A+DQoJICAgICAgPHA+Rml4ZWQgc3R1Y2sgbW92aW5nIGluIGEgZGlyZWN0aW9uIG9uY2UgYSBwbGF5IHN0YXJ0cy48L3A+DQoJICAgICAgPHA+Rml4ZWQgIjEgd2lucyBhd2F5IiBncmFtbWFyLjwvcD4NCgkgICAgICA8cD5GaXhlZCBwdW50cyBzbyBraWNraW5nIHRlYW0gZG9lc250IGNyb3dkIGFyb3VuZCB0aGUgYmFsbC48L3A+DQoJICAgICAgPHA+Rml4ZWQgcHVudHMgc28gdGhhdCBraWNraW5nIHRlYW0gY291bGRuJ3QgY2F0Y2ggYSBraWNrIG9uIHRoZSBmbHkgYW5kIGdldCBhIDFzdCBkb3duLjwvcD4NCgkgICAgICA8cD5GaXhlZCBwb3Nlc3Npb24gb24gMiBwdCBjb252ZXJzaW9ucy48L3A+DQoJICAgICAgPHA+Rml4ZWQgZGl2aW5nIGludG8gYSBzbmFwcGVkIGJhbGwgc28geW91IGNhbid0IHN0YXJ0IGRpdmluZyB1bnRpbCB0aGUgcWIgYWN0dWFsbHkgaGFzIHRoZSBiYWxsLjwvcD4NCgkgICAgICA8cD5GaXhlZCBnbGl0Y2ggd2hlcmUgc29tZXRpbWVzIGEga2lja29mZi94cCB3b3VsZCBzaG93IHVwIHdoZW4gaXQgd2Fzbid0IHN1cHBvc2VkIHRvIHdoZW4gYSB0ZCB3YXMgc2NvcmVkIHJpZ2h0IGF0IDA6MDAgb2YgdGhlIDFzdCBoYWxmLjwvcD4NCgkgICAgICA8cD5BZGRlZCBibHVlIHdpemFyZCBsb2dvLjwvcD4NCgkgICAgICA8cD5BZGRlZCA1IG5ldyBwbGF5cyB0aGF0IGFyZSB1bmxvY2tlZCBhcyBwZXJrcy48L3A+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGNsYXNzPSJpbmZvLWJveCI+DQoJICAgICAgPGgzPkZBUTwvaDM+DQoJICAgICAgPGI+V2h5IGlzbid0IHRoZSBnYW1lIGxvYWRpbmc/PC9iPg0KCSAgICAgIDxwPllvdSBzaG91bGQgY2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCBtYWtlIHN1cmUgb3VyIHNpdGUgaXNuJ3QgYmxvY2tlZC4gQWxzbywgZGlzYWJsZSBhbGwgYWQgYmxvY2tlcnMuPC9wPg0KCSAgICAgIDxiPkhvdyBkbyBJIHBsYXk/PC9iPg0KCSAgICAgIDxwPlVzZSB5b3VyIGFycm93IGtleXMgYW5kIHNwYWNlIGJhciEgVGhlIHJlc3QgaXMgZWFzeS0gcGljayB5b3VyIHBsYXkgYW5kIGdvITwvcD4NCgkgICAgICA8Yj5XaGljaCBicm93c2VyIHNob3VsZCBJIHVzZT88L2I+DQoJICAgICAgPHA+WW91IHNob3VsZCB1c2UgQ2hyb21lLiBJdCBpcyB0aGUgb25seSBicm93c2VyIGd1YXJhbnRlZWQgdG8gd29yay4gRm9vdGJhbGwgQnJvcyBoYXMgYWxzbyBiZWVuIHRlc3RlZCB0byB3b3JrIG9uIEZpcmVmb3ggYW5kIFNhZmFyaSwgYnV0IG5vdCBndWFyYW50ZWVkLjwvcD4NCgkgICAgICA8Yj5BcmUgdGhlcmUgbW9yZSBCcm9zIGdhbWVzPzwvYj4NCgkgICAgICA8cD5ZZXMhIENoZWNrIG91dCA8YSB0YWJpbmRleD0iLTEiIGhyZWY9IiI+QmFza2V0IEJyb3M8L2E+LCA8YSB0YWJpbmRleD0iLTEiIGhyZWY9IiI+U29jY2VyIEJyb3M8L2E+IGFuZCA8YSB0YWJpbmRleD0iLTEiIGhyZWY9Imh0dHBzOi8vd3Jlc3RsZWJyb3MuaW8iPldyZXN0bGUgQnJvczwvYT4uIEFsc28gYmUgc3VyZSB0byBjaGVjayBvdXQgPGEgdGFiaW5kZXg9Ii0xIiBocmVmPSJodHRwczovL2lvZ2FtZXMuc3BhY2UiIHRhcmdldD0iX2JsYW5rIj5JTyBHYW1lcyBhdCBpb2dhbWVzLnNwYWNlPC9hPjwvcD4NCgkgICAgICA8Yj5EbyB5b3UgaGF2ZSBhIGZhdm9yaXRlIHRlYW0/PC9iPg0KCSAgICAgIDxwPlllcywgYnV0IHdlJ3JlIG5vdCBzYXlpbmcgd2hpY2ggb25lLiBEcm9wIHVzIGFuIGUtbWFpbCBpZiB5b3UgdGhpbmsgeW91IGtub3cuPC9wPg0KCSAgICAgIDxiPkknbSBibG9ja2VkLCB3aGVyZSBlbHNlIGNhbiBpIHBsYXk/PC9iPg0KCSAgICAgIDxwPkNoZWNrIGhlcmUsIHRoZXNlIGxpbmtzIHdvcmsgZm9yIGJvdGggZm9vdGJhbGwgYW5kIGJhc2tldCBicm9zOiA8YSBocmVmPSIiPkZvb3RiYWxsIEJyb3MgVW5ibG9ja2VkPC9hPjwvcD4NCg0KCSAgICA8L2Rpdj4NCgkgIDwvZGl2Pg0KCSAgPGZvb3Rlcj4NCgkgICAgPGRpdiB0YWJpbmRleD0iLTEiIGNsYXNzPSJmb290ZXItbGlua3MiPg0KCSAgICAgIDxhIGhyZWY9IiI+Q29weXJpZ2h0IDIwMjQgQmx1ZSBXaXphcmQgRGlnaXRhbDwvYT4gfA0KCSAgICAgIDxhIHRhYmluZGV4PSItMSIgaHJlZj0iIj5UZXJtcyBvZiBTZXJ2aWNlPC9hPiB8DQoJICAgICAgPGEgdGFiaW5kZXg9Ii0xIiBocmVmPSIiPlByaXZhY3kgUG9saWN5PC9hPg0KCSAgICA8L2Rpdj4NCgkgIDwvZm9vdGVyPg0KCSAgPHNjcmlwdD4NCgkgICAgdmFyIGxhc3RSZWZyZXNoID0gMDsNCg0KCSAgICBmdW5jdGlvbiByZWZyZXNoVGFnKHRoZVRhZykgew0KCSAgICAgIHRyeSB7DQoJICAgICAgICBhaXB0YWcuY21kLmRpc3BsYXkucHVzaChmdW5jdGlvbigpIHsNCgkgICAgICAgICAgYWlwRGlzcGxheVRhZy5yZWZyZXNoKHRoZVRhZyk7DQoJICAgICAgICB9KTsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdUYWcgcmVmcmVzaGVkIHN1Y2Nlc3NmdWxseScpOw0KCSAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQoJICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWZyZXNoaW5nIHRoZSB0YWc6JywgZXJyb3IpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkMShkb1JlZnJlc2gpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzE2MHg2MDAnKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoJICAgICAgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzE2MHg2MDAnKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTsNCgkgICAgICAgIHZhciBtcyA9IGQuZ2V0VGltZSgpOw0KCSAgICAgICAgaWYgKG1zIC0gbGFzdFJlZnJlc2ggPiAxMDAwMCkgew0KCSAgICAgICAgICBnQ3JhenlTREsucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJmb290YmFsbGJyb3MtaW9fMTYweDYwMCJdKTsNCgkgICAgICAgICAgbGFzdFJlZnJlc2ggPSBtczsNCgkgICAgICAgIH0NCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgcmVmcmVzaFRhZygnZm9vdGJhbGxicm9zLWlvXzE2MHg2MDAnKTsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb18xNjB4NjAwXzInKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KDQoJICAgIH0NCg0KCSAgICB2YXIgbGFzdFJlZnJlc2g2ID0gMDsNCgkgICAgdmFyIGRvVGFnT25jZSA9IHRydWU7DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkNigpIHsNCgkgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7DQoJICAgICAgdmFyIG1zID0gZC5nZXRUaW1lKCk7DQoJICAgICAgaWYgKG1zIC0gbGFzdFJlZnJlc2g2IDwgMTAwMDApIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgbGFzdFJlZnJlc2g2ID0gbXM7DQoNCg0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb290YmFsbGJyb3MtaW9fMzAweDI1MCcpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7fSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb18zMDB4MjUwJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgICBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzID09ICIiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX3Byb3NwZXInKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X3Byb3NwZXInKTsNCgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzLmlQcm9zcGVyVGVzdCAhPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfbGVnYWN5Jyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9sZWdhY3knKTsNCgkgICAgICAgIH0NCgkgICAgICAgIGRvVGFnT25jZSA9IGZhbHNlOw0KCSAgICAgIH0gZWxzZQ0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkJyk7DQoJICAgIH0NCg0KCSAgICB2YXIgbGFzdFJlZnJlc2gyID0gMDsNCg0KCSAgICBmdW5jdGlvbiBTaG93QWQyKCkgew0KDQoJICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpOw0KCSAgICAgIHZhciBtcyA9IGQuZ2V0VGltZSgpOw0KCSAgICAgIGlmIChtcyAtIGxhc3RSZWZyZXNoMiA8IDEwMDAwKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGxhc3RSZWZyZXNoMiA9IG1zOw0KDQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzMwMHgyNTBfMicpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHJldHVybjsNCgkgICAgICBsLnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTsNCgkgICAgICAgIHZhciBtcyA9IGQuZ2V0VGltZSgpOw0KCSAgICAgICAgaWYgKG1zIC0gbGFzdFJlZnJlc2gyID4gMTAwMDApIHsNCgkgICAgICAgICAgLy9obmRsZWQgYnkgdGhlIGZpcnN0IGJhbm5lciByZXF1ZXN0DQoJICAgICAgICAgIC8vZ0NyYXp5U0RLLnJlcXVlc3RCYW5uZXIoW3tjb250YWluZXJJZDogJ2Zvb3RiYWxsYnJvcy1pb18zMDB4MjUwXzInLHNpemU6ICczMDB4MjUwJyx9XSk7DQoJICAgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbImZvb3RiYWxsYnJvcy1pb18zMDB4MjUwIiwgImZvb3RiYWxsYnJvcy1pb18zMDB4MjUwXzIiXSk7DQoNCgkgICAgICAgICAgbGFzdFJlZnJlc2gyID0gbXM7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb18zMDB4MjUwXzInKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgYWlwdGFnICE9PSAndW5kZWZpbmVkJyAmJiBhaXB0YWcuc2V0dGluZ3MgPT0gIiIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfcHJvc3BlcicpOw0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3JlcXVlc3RfcHJvc3BlcicpOw0KCSAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwdGFnICE9PSAndW5kZWZpbmVkJyAmJiBhaXB0YWcuc2V0dGluZ3MuaVByb3NwZXJUZXN0ICE9PSAidW5kZWZpbmVkIikgew0KCSAgICAgICAgICBpZiAoZG9UYWdPbmNlKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9sZWdhY3knKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X2xlZ2FjeScpOw0KCSAgICAgICAgfQ0KCSAgICAgIH0gZWxzZQ0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkJyk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTaG93QWQzKCkgew0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb290YmFsbGJyb3MtaW9fNzI4eDkwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbImZvb3RiYWxsYnJvcy1pb183Mjh4OTAiXSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb183Mjh4OTAnKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KDQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTaG93QWQ0KCkgew0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHJldHVybjsNCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzMzNngyODAnKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgZ0NyYXp5U0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsiZm9vdGJhbGxicm9zLWlvXzMzNngyODAiXSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb18zMzZ4MjgwJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgICBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzID09ICIiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX3Byb3NwZXInKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X3Byb3NwZXInKTsNCgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzLmlQcm9zcGVyVGVzdCAhPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfbGVnYWN5Jyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9sZWdhY3knKTsNCgkgICAgICAgIH0NCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KDQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTaG93QWQ3KCkgew0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHJldHVybjsNCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzMzNngyODBfMicpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHJldHVybjsNCgkgICAgICBsLnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBnQ3JhenlTREsucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJmb290YmFsbGJyb3MtaW9fMzM2eDI4MF8yIl0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdmb290YmFsbGJyb3MtaW9fMzM2eDI4MF8yJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgICBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzID09ICIiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX3Byb3NwZXInKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X3Byb3NwZXInKTsNCgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzLmlQcm9zcGVyVGVzdCAhPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfbGVnYWN5Jyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9sZWdhY3knKTsNCgkgICAgICAgIH0NCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KDQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTaG93QWQ4KCkgew0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb290YmFsbGJyb3MtaW9fNzI4eDkwX20nKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgZ0NyYXp5U0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsiZm9vdGJhbGxicm9zLWlvXzcyOHg5MCJdKTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgcmVmcmVzaFRhZygnZm9vdGJhbGxicm9zLWlvXzcyOHg5MF9tJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlDQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWQnKTsNCg0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkOSgpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vdGJhbGxicm9zLWlvXzk3MHgyNTAnKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgZ0NyYXp5U0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsiZm9vdGJhbGxicm9zLWlvXzk3MHgyNTAiXSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Zvb3RiYWxsYnJvcy1pb185NzB4MjUwJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgICBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzID09ICIiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX3Byb3NwZXInKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X3Byb3NwZXInKTsNCgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzLmlQcm9zcGVyVGVzdCAhPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfbGVnYWN5Jyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9sZWdhY3knKTsNCgkgICAgICAgIH0NCg0KDQoJICAgICAgICBkb1RhZ09uY2UgPSBmYWxzZTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgbC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAidXJsKGFzc2V0cy90dXJub2ZmLmpwZykiOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkX21lc3NhZ2Vfc2hvd24nKTsNCgkgICAgICB9DQoNCgkgICAgfQ0KDQoNCg0KDQoNCgkgICAgZnVuY3Rpb24gcmlnaHQoc3RyLCBjaHIpIHsNCgkgICAgICByZXR1cm4gc3RyLnNsaWNlKHN0ci5sZW5ndGggLSBjaHIsIHN0ci5sZW5ndGgpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2V0Q0dJbnZpdGVMaW5rKCkgew0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgdmFyIG1ldGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2dsaW5rIik7DQoJICAgICAgICB2YXIgYVN0ciA9IG1ldGEudmFsdWU7DQoJICAgICAgICBhU3RyID0gcmlnaHQoYVN0ciwgOCk7DQoJICAgICAgICB2YXIgYUNHTGluayA9IGdDcmF6eVNESy5pbnZpdGVMaW5rKHsNCgkgICAgICAgICAgcm9vbUlkOiBhU3RyDQoJICAgICAgICB9KTsNCgkgICAgICAgIG1ldGEudmFsdWUgPSBhQ0dMaW5rOw0KCSAgICAgICAgbWV0YS5zZWxlY3QNCgkgICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdDb3B5JykNCgkgICAgICAgIGNvbnNvbGUubG9nKCJDT1BJRUQgQ0cgVVJMIik7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkQnJlYWsoKSB7DQoJICAgICAgLy9jaGVjayBpZiB0aGUgYWRzbGliIGlzIGxvYWRlZCBjb3JyZWN0bHkgb3IgYmxvY2tlZCBieSBhZGJsb2NrZXJzIGV0Yy4NCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIE1haW4uRG9uZUludGVyc3RpdGlhbEFkKGZhbHNlKTsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoNCgkgICAgICBpZiAodHlwZW9mIGFkcGxheWVyID09PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgTWFpbi5Eb25lSW50ZXJzdGl0aWFsQWQodHJ1ZSk7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGFpcHRhZy5jbWQucGxheWVyLnB1c2goZnVuY3Rpb24oKSB7DQoJICAgICAgICBhZHBsYXllci5zdGFydEFkQnJlYWsoKTsNCgkgICAgICB9KTsNCgkgICAgfQ0KDQoNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm9wZW5mbC1jb250ZW50IikuYWRkRXZlbnRMaXN0ZW5lcigid2hlZWwiLCBkb1Njcm9sbCk7DQoJICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3JlIikuYWRkRXZlbnRMaXN0ZW5lcigid2hlZWwiLCBkb1Njcm9sbCk7DQoNCgkgICAgZnVuY3Rpb24gZG9TY3JvbGwoZXZlbnQpIHsNCgkgICAgICB3aW5kb3cuc2Nyb2xsKDAsIHdpbmRvdy5zY3JvbGxZICsgZXZlbnQuZGVsdGFZKTsNCgkgICAgfQ0KDQoJICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KCSAgICAgIC8vY29uc29sZS5sb2coImFjdGl2ZSBlbGVtZW50OiIgKyBkb2N1bWVudC5hY3RpdmVFbGVtZW50KTsNCgkgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lID09ICJJRlJBTUUiKSB7DQoJICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTsNCgkgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgICAgICAvL2NvbnNvbGUubG9nKCdyZWZvY3VzaW5nJyk7DQoJICAgICAgfQ0KCSAgICB9LCAzMCk7DQoNCg0KCSAgICAvKnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgDQoJICAgIAl2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcm9sbCcpOw0KCSAgICAJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgIT09ICd2aXNpYmxlJykgew0KCSAgICAJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgIAkJaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KQ0KCSAgICAJCXsNCgkgICAgCQkJLy9kb2N1bWVudC5hY3RpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQoJICAgIAkJCXdpbmRvdy5mb2N1cygpOw0KCSAgICAJCQl3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgCQl9DQoJICAgIAl9DQoJICAgIH0sIDEwMDApOyovDQoNCg0KCSAgICAvKgkJc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyANCgkgICAgCQkJdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvb3RiYWxsYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgIAkJCWlmKGwgIT0gbnVsbCAmJiB0eXBlb2YgbC5zdHlsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbC5zdHlsZS52aXNpYmlsaXR5ID09ICd2aXNpYmxlJykgew0KCSAgICAJCQkJU2hvd0FkNSgpOw0KCSAgICAJCQl9DQoJICAgIAkJfSwgMzAwMDApOw0KDQoJICAgIAkJc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyANCgkgICAgCQkJdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvb3RiYWxsYnJvcy1pb18xNjB4NjAwXzInKTsNCgkgICAgCQkJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgPT0gJ3Zpc2libGUnKSB7DQoJICAgIAkJCQlTaG93QWQxKCk7DQoJICAgIAkJCX0NCgkgICAgCQl9LCAzMjAwMCk7Ki8NCg0KCSAgICB2YXIgc2lkID0gJ2RucTNoaW41ZzY3aWdrMnJiNnZpdjc4cGQxJw0KDQoJICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXR1cyhmcm9tRXZlbnQgPSBmYWxzZSkgew0KCSAgICAgIGNvbnN0IHJlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KCSAgICAgIHZhciBhU3RyID0gInJlY29yZHNlc3Npb24ucGhwP3M9IiArIHNpZDsNCgkgICAgICBpZiAoZnJvbUV2ZW50ID09IHRydWUpIGFTdHIgPSBhU3RyICsgIiZlPTEiDQoJICAgICAgcmVxLm9wZW4oIkdFVCIsIGFTdHIpOw0KCSAgICAgIHJlcS5zZW5kKCk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTZW5kRXZlbnQodGhlRXZlbnQsIHRoZUFjdGlvbiwgdGhlUGFybXMgPSAnJykgew0KCSAgICAgIGlmICh0aGVQYXJtcyA9PSAnJykgew0KCSAgICAgICAgZ3RhZyh0aGVFdmVudCwgdGhlQWN0aW9uKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgZ3RhZyh0aGVFdmVudCwgdGhlQWN0aW9uLCB0aGVQYXJtcyk7DQoJICAgICAgfQ0KCSAgICAgIHVwZGF0ZVN0YXR1cyh0cnVlKTsNCgkgICAgICAvL2NvbnNvbGUubG9nKCJTZW5kaW5nIGV2ZW50OiAiICsgdGhlRXZlbnQgKyAiLyIgKyB0aGVBY3Rpb24gKyAiLyIgKyB0aGVQYXJtcyk7DQoJICAgIH0NCgkgICAgLy9zZXRJbnRlcnZhbChmdW5jdGlvbigpIHsgdXBkYXRlU3RhdHVzLCA0KjYwKjEwMDApOwkJCQ0KCSAgICAvL3NldEludGVydmFsKCBmdW5jdGlvbigpIHsgDQoJICAgIC8vCXdpbmRvdy5zY3JvbGxUbygwLCAwKTsgDQoJICAgIC8vfSwgMjAwMCApOwkJCQkJDQoJICAgIHVwZGF0ZVN0YXR1cyh0cnVlKTsNCg0KCSAgICAvL3NldEludGVydmFsKENsZWFyQWRzLCAyMDAwKTsJCQ0KDQoJICAgIGZ1bmN0aW9uIEVtYWlsU2lnbnVwKCkgew0KCSAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2lnbnVwIikgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRlbGV0ZW1lIikpIHJldHVybjsNCgkgICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsNCgkgICAgICBpZnJhbWUuc3JjID0gIiI7DQoNCgkgICAgICAvLwkJCWlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsNCgkgICAgICBpZnJhbWUuc3R5bGUud2lkdGggPSAiNTUwcHgiOw0KCSAgICAgIGlmcmFtZS5zdHlsZS5oZWlnaHQgPSAiIiArIHdpbmRvdy5pbm5lckhlaWdodCAtIDEwMCArICJweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlLnBvc2l0aW9uID0gImFic29sdXRlIjsNCgkgICAgICBpZnJhbWUuc3R5bGUudG9wID0gIjUwcHgiOw0KCSAgICAgIGlmcmFtZS5zdHlsZS5sZWZ0ID0gIjUwJSI7DQoJICAgICAgaWZyYW1lLnN0eWxlWyJtYXJnaW4tbGVmdCJdID0gIi0yMjVweCI7DQoJICAgICAgLy9pZnJhbWUuc3R5bGVbIm1hcmdpbi1yaWdodCJdID0gIi0yNzVweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlWyJtYXgtd2lkdGgiXSA9ICIxMDAlIjsNCgkgICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCJpZCIsICJzaWdudXAiKTsNCg0KCSAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsNCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIEdhbWVQbGF5U3RhcnQoKSB7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygiR2FtZVBsYXlTdGFydCIpOw0KCSAgICAgICAgZ0NyYXp5U0RLLmdhbWVwbGF5U3RhcnQoKTsNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBHYW1lUGxheVN0b3AoKSB7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygiR2FtZVBsYXlTdG9wIik7DQoJICAgICAgICBnQ3JhenlTREsuZ2FtZXBsYXlTdG9wKCk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gSGFwcHlUaW1lKCkgew0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgY29uc29sZS5sb2coImhhcHB5dGltZSIpOw0KCSAgICAgICAgZ0NyYXp5U0RLLmhhcHB5dGltZSgpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIHZhciBzY3JvbGxlck1lc3NhZ2UgPSAiICAgIjsNCg0KCSAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50Jyk7DQoJICAgIC8vIEZ1bmN0aW9uIHRvIGtlZXAgdGhlIGVsZW1lbnQgZm9jdXNlZA0KCSAgICBmdW5jdGlvbiBrZWVwRm9jdXMoKSB7DQoJICAgICAgZWxlbWVudC5mb2N1cygpOw0KCSAgICB9DQoJICAgIC8vIEV2ZW50IGxpc3RlbmVycyB0byByZXN0b3JlIGZvY3VzIHdoZW4gbG9zdA0KCSAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBrZWVwRm9jdXMpOw0KCSAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0Jywga2VlcEZvY3VzKTsNCgkgIDwvc2NyaXB0Pg0KCTwvYm9keT4NCg0KCTwvaHRtbD4=";
