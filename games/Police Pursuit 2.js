window.game = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8YmFzZSBocmVmID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9Qb2sxMmQvdGFAbWFpbi9wb2xpY2VwdXJzdWl0Mi8iPgogICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgoKCjxzY3JpcHQ+ZnVuY3Rpb24gVW5pdHlQcm9ncmVzcyhnYW1lSW5zdGFuY2UsIHByb2dyZXNzKSB7CiAgaWYgKCFnYW1lSW5zdGFuY2UuTW9kdWxlKQogICAgcmV0dXJuOwogIGlmICghZ2FtZUluc3RhbmNlLnByb2dyZXNzKSB7ICAgIAogICAgZ2FtZUluc3RhbmNlLnByb2dyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICBnYW1lSW5zdGFuY2UucHJvZ3Jlc3MuY2xhc3NOYW1lID0gInByb2dyZXNzIjsKICAgIAogICAgZ2FtZUluc3RhbmNlLnByb2dyZXNzLmJhY2tncm91bmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIGdhbWVJbnN0YW5jZS5wcm9ncmVzcy5iYWNrZ3JvdW5kLmNsYXNzTmFtZSA9ICJiYWNrZ3JvdW5kIjsKICAgIGdhbWVJbnN0YW5jZS5wcm9ncmVzcy5hcHBlbmRDaGlsZChnYW1lSW5zdGFuY2UucHJvZ3Jlc3MuYmFja2dyb3VuZCk7CgogICAgZ2FtZUluc3RhbmNlLnByb2dyZXNzLmZ1bGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIGdhbWVJbnN0YW5jZS5wcm9ncmVzcy5mdWxsLmNsYXNzTmFtZSA9ICJmdWxsIjsKICAgIGdhbWVJbnN0YW5jZS5wcm9ncmVzcy5hcHBlbmRDaGlsZChnYW1lSW5zdGFuY2UucHJvZ3Jlc3MuZnVsbCk7CiAgICAKCWdhbWVJbnN0YW5jZS5wcm9ncmVzcy5lbXB0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgZ2FtZUluc3RhbmNlLnByb2dyZXNzLmVtcHR5LmNsYXNzTmFtZSA9ICJlbXB0eSI7CiAgICBnYW1lSW5zdGFuY2UucHJvZ3Jlc3MuYXBwZW5kQ2hpbGQoZ2FtZUluc3RhbmNlLnByb2dyZXNzLmVtcHR5KTsKCQoJZ2FtZUluc3RhbmNlLmNvbnRhaW5lci5hcHBlbmRDaGlsZChnYW1lSW5zdGFuY2UucHJvZ3Jlc3MpOwoJCiAgfQogIGdhbWVJbnN0YW5jZS5wcm9ncmVzcy5mdWxsLnN0eWxlLndpZHRoID0gKDEwMCAqIHByb2dyZXNzKSArICIlIjsKICAvL2dhbWVJbnN0YW5jZS5wcm9ncmVzcy5lbXB0eS5zdHlsZS53aWR0aCA9ICgxMDAgKiAoMSAtIHByb2dyZXNzKSkgKyAiJSI7CiAgaWYgKHByb2dyZXNzID09IDEpCiAgICBnYW1lSW5zdGFuY2UucHJvZ3Jlc3Muc3R5bGUuZGlzcGxheSA9ICJub25lIjsKfTwvc2NyaXB0PgoKCgogPHNjcmlwdCBzcmM9InBha28uanMiPjwvc2NyaXB0PgoKCgoKCgoKICAgIDxzdHlsZT4KICAgICAgICBib2R5IHsgbWFyZ2luOiAwOyBvdmVyZmxvdzogaGlkZGVuOyBiYWNrZ3JvdW5kLWNvbG9yOiAjMjMxRjIwOyB9CiAgICAgICAgI3VuaXR5LWNvbnRhaW5lciB7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMHZoOyBwb3NpdGlvbjogcmVsYXRpdmU7IH0KICAgICAgICBjYW52YXMgeyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBkaXNwbGF5OiBibG9jazsgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KPGgxIGlkID0gImxvYWRpbmciPkxvYWRpbmcuLi48L2gxPgogICAgPGRpdiBpZD0idW5pdHktY29udGFpbmVyIj4KICAgICAgICA8Y2FudmFzIGlkPSJ1bml0eS1jYW52YXMiPjwvY2FudmFzPgogICAgPC9kaXY+CgoKPHNjcmlwdD52YXIganNMb2FkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKQpqc0xvYWRlci5zcmMgPSAiVW5pdHlMb2FkZXIuanMiOwpkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGpzTG9hZGVyKTwvc2NyaXB0PgogICAgCiAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8c2NyaXB0IHNyYyA9ICJqc3ppcC5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0PiAgICAKCQogIGFzeW5jIGZ1bmN0aW9uIGZldGNoQW5kQ29tYmluZVppcChiaW5VcmxzKSB7CiAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChiaW5VcmxzLm1hcCh1cmwgPT4gZmV0Y2godXJsKSkpOwogICAgY29uc3QgYnVmZmVycyA9IGF3YWl0IFByb21pc2UuYWxsKHJlc3BvbnNlcy5tYXAocmVzID0+IHJlcy5hcnJheUJ1ZmZlcigpKSk7CiAgICBsZXQgdG90YWxMZW5ndGggPSBidWZmZXJzLnJlZHVjZSgoYWNjLCBidWYpID0+IGFjYyArIGJ1Zi5ieXRlTGVuZ3RoLCAwKTsKICAgIGxldCBjb21iaW5lZCA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTsKICAgIGxldCBvZmZzZXQgPSAwOwogICAgZm9yIChsZXQgYnVmIG9mIGJ1ZmZlcnMpIHsKICAgICAgICBjb21iaW5lZC5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQgKz0gYnVmLmJ5dGVMZW5ndGg7CiAgICB9CiAgICByZXR1cm4gY29tYmluZWQ7Cn0KCmFzeW5jIGZ1bmN0aW9uIHVuemlwV2VicEZyb21FeHRlcm5hbEJpbnMoYmluVXJscykgewogICAgY29uc3QgYmxvYlVybHMgPSB7fTsKICAgIGNvbnN0IGJ5dGVzID0gYXdhaXQgZmV0Y2hBbmRDb21iaW5lWmlwKGJpblVybHMpOwogICAgY29uc3QgemlwID0gYXdhaXQgSlNaaXAubG9hZEFzeW5jKGJ5dGVzKTsKICAgIGZvciAoY29uc3QgW2ZpbGVuYW1lLCBmaWxlXSBvZiBPYmplY3QuZW50cmllcyh6aXAuZmlsZXMpKSB7CiAgICAgICAgCgogICAgICAgIGlmICghZmlsZS5kaXIpIHsKICAgICAgICAgICAgbGV0IG1pbWUgPSAnJzsKICAgICAgICAgICAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuanMnKSB8fCBmaWxlbmFtZS5lbmRzV2l0aCgnLm1qcycpKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ3RleHQvamF2YXNjcmlwdCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5jc3MnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICd0ZXh0L2Nzcyc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5odG1sJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAndGV4dC9odG1sJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlbmFtZS5pbmNsdWRlcygnZjAzZTIwZDkyMTlkZDIyZjY3YjZmNGJkMzNhZGJkYTUnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICdhcHBsaWNhdGlvbi93YXNtJzsKICAgICAgICAgICAgfSAKICAgICAgICAgICAgZWxzZSBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoJ2ZlZGJjNTM4ODQ2ZTNiMGRmNDk0MDYyYWYzY2E0MzdmJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAnYXBwbGljYXRpb24vamF2YXNjcmlwdCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5wbmcnKSkgewogICAgICAgICAgICAgICAgbWltZSA9ICdpbWFnZS9wbmcnOwogICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuanBnJykgfHwgZmlsZW5hbWUuZW5kc1dpdGgoJy5qcGVnJykpIHsKICAgICAgICAgICAgICAgIG1pbWUgPSAnaW1hZ2UvanBlZyc7CiAgICAgICAgICAgIH0KCQkJZWxzZSBpZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy53YXNtJykgKSB7CiAgICAgICAgICAgICAgICBtaW1lID0gJ2FwcGxpY2F0aW9uL3dhc20nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBlbHNlIGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLmRhdGEudW5pdHl3ZWInKSkgewogICAgbWltZSA9ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOwp9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuYXNtLmNvZGUudW5pdHl3ZWInKSkgewogICAgbWltZSA9ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JzsKfSBlbHNlIGlmIChmaWxlbmFtZS5lbmRzV2l0aCgnLmFzbS5tZW1vcnkudW5pdHl3ZWInKSkgewogICAgbWltZSA9ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOwp9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuZnJhbWV3b3JrLnVuaXR5d2ViZScpKSB7CiAgICBtaW1lID0gJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnOwp9IGVsc2UgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCd3YXNtLmNvZGUudW5pdHl3ZWInKSkgewogICAgbWltZSA9ICdhcHBsaWNhdGlvbi93YXNtJzsKICAgIAogICAgCiAgICAKfQoKaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCcuYXNtLmZyYW1ld29yay51bml0eXdlYicpKSBtaW1lID0gJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnOwppZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5hc20uY29kZS51bml0eXdlYicpKSBtaW1lID0gJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnOwppZiAoZmlsZW5hbWUuZW5kc1dpdGgoJy5hc20ubWVtb3J5LnVuaXR5d2ViJykpIG1pbWUgPSAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJzsKCiAgICAgICAgICAgIGxldCByYXdCeXRlcyA9IGF3YWl0IGZpbGUuYXN5bmMoInVpbnQ4YXJyYXkiKTsKCgppZiAocmF3Qnl0ZXNbMF0gPT09IDB4MWYgJiYgcmF3Qnl0ZXNbMV0gPT09IDB4OGIpIHsKICAgIGNvbnNvbGUubG9nKCJEZWNvbXByZXNzaW5nIGd6aXBwZWQ6IiwgZmlsZW5hbWUpOwogICAgCiAgICByYXdCeXRlcyA9IHBha28uaW5mbGF0ZShyYXdCeXRlcyk7Cn0KCmNvbnN0IGJsb2IgPSBuZXcgQmxvYihbcmF3Qnl0ZXNdLCB7IHR5cGU6IG1pbWUgfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFeHRyYWN0ZWQ6IiwgZmlsZW5hbWUsIGJsb2Iuc2l6ZSk7CiAgICAgICAgICAgIGNvbnN0IGJsb2JVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiRXh0cmFjdGVkOiIsIGZpbGVuYW1lKTsKICAgICAgICAgICAgYmxvYlVybHNbZmlsZW5hbWVdID0gYmxvYlVybDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gYmxvYlVybHM7Cn0KCmxldCBibG9iVXJsc3MgPSAiIjsKbGV0IGJpblBhcnRzID0gWwogICJwYXJ0XzEuYmluIiwKICAicGFydF8yLmJpbiIsCiAgInBhcnRfMy5iaW4iLAogICJwYXJ0XzQuYmluIiwKIAogIApdOwoKdW56aXBXZWJwRnJvbUV4dGVybmFsQmlucyhiaW5QYXJ0cykudGhlbihibG9iVXJscyA9PiB7Cglkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibG9hZGluZyIpLnJlbW92ZSgpCiAgICBibG9iVXJsc3MgPSBibG9iVXJsczsKICAgIGNvbnN0IE9SSUdJTkFMX0NSRUFURV9FTEVNRU5UID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudDsKICAgIGNvbnN0IE9SSUdJTkFMX1NFVF9BVFRSSUJVVEUgPSBFbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGU7CgogICAgCiAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24odGFnTmFtZSkgewogICAgICAgIGNvbnN0IGVsID0gT1JJR0lOQUxfQ1JFQVRFX0VMRU1FTlQuY2FsbCh0aGlzLCB0YWdOYW1lKTsKCiAgICAgICAgaWYgKHRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3NjcmlwdCcpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAnc3JjJywgewogICAgICAgICAgICAgICAgc2V0KG5ld1NyYykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZXh0cmFjdEZpbGVuYW1lKG5ld1NyYyk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBibG9iVXJsc3NbZmlsZW5hbWVdOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgT1JJR0lOQUxfU0VUX0FUVFJJQlVURS5jYWxsKGVsLCAnc3JjJywgcmVwbGFjZW1lbnQpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE9SSUdJTkFMX1NFVF9BVFRSSUJVVEUuY2FsbChlbCwgJ3NyYycsIG5ld1NyYyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGdldCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWwuZ2V0QXR0cmlidXRlKCdzcmMnKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZWw7CiAgICB9OwoKICAgIAogICAgRWxlbWVudC5wcm90b3R5cGUuc2V0QXR0cmlidXRlID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsKICAgICAgICBpZiAodGhpcy50YWdOYW1lID09PSAnU0NSSVBUJyAmJiBuYW1lID09PSAnc3JjJykgewogICAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGV4dHJhY3RGaWxlbmFtZSh2YWx1ZSk7CiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gYmxvYlVybHNzW2ZpbGVuYW1lXTsKICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50KSB7CiAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHJldHVybiBPUklHSU5BTF9TRVRfQVRUUklCVVRFLmNhbGwodGhpcywgbmFtZSwgcmVwbGFjZW1lbnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gT1JJR0lOQUxfU0VUX0FUVFJJQlVURS5jYWxsKHRoaXMsIG5hbWUsIHZhbHVlKTsKICAgIH07CgogICAgZnVuY3Rpb24gZXh0cmFjdEZpbGVuYW1lKHVybCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgVVJMKHVybCwgbG9jYXRpb24uaHJlZikucGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTsKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcmV0dXJuIHVybC5zcGxpdCgnLycpLnBvcCgpOyAKICAgICAgICB9CiAgICB9CgoKY29uc3QgaW1hZ2VTcmNEZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihJbWFnZS5wcm90b3R5cGUsICdzcmMnKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlLnByb3RvdHlwZSwgJ3NyYycsIHsKICBzZXQodmFsdWUpIHsKICAgIGNvbnN0IG5ld1VSTCA9IHJld3JpdGVVUkwodmFsdWUpOwogICAgaW1hZ2VTcmNEZXNjcmlwdG9yLnNldC5jYWxsKHRoaXMsIG5ld1VSTCk7CiAgfSwKICBnZXQ6IGltYWdlU3JjRGVzY3JpcHRvci5nZXQsCiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGVudW1lcmFibGU6IHRydWUsCn0pOwoKCmNvbnN0IHNjcmlwdFNyY0Rlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEhUTUxTY3JpcHRFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoSFRNTFNjcmlwdEVsZW1lbnQucHJvdG90eXBlLCAnc3JjJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBzY3JpcHRTcmNEZXNjcmlwdG9yLnNldC5jYWxsKHRoaXMsIG5ld1VSTCk7CiAgfSwKICBnZXQ6IHNjcmlwdFNyY0Rlc2NyaXB0b3IuZ2V0LAogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlLAp9KTsKCgpjb25zdCBsaW5rSHJlZkRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEhUTUxMaW5rRWxlbWVudC5wcm90b3R5cGUsICdocmVmJyk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShIVE1MTGlua0VsZW1lbnQucHJvdG90eXBlLCAnaHJlZicsIHsKICBzZXQodmFsdWUpIHsKICAgIGNvbnN0IG5ld1VSTCA9IHJld3JpdGVVUkwodmFsdWUpOwogICAgbGlua0hyZWZEZXNjcmlwdG9yLnNldC5jYWxsKHRoaXMsIG5ld1VSTCk7CiAgfSwKICBnZXQ6IGxpbmtIcmVmRGVzY3JpcHRvci5nZXQsCiAgY29uZmlndXJhYmxlOiB0cnVlLAogIGVudW1lcmFibGU6IHRydWUsCn0pOwoKCmNvbnN0IG1lZGlhU3JjRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsICdzcmMnKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KEhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjJywgewogIHNldCh2YWx1ZSkgewogICAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh2YWx1ZSk7CiAgICBtZWRpYVNyY0Rlc2NyaXB0b3Iuc2V0LmNhbGwodGhpcywgbmV3VVJMKTsKICB9LAogIGdldDogbWVkaWFTcmNEZXNjcmlwdG9yLmdldCwKICBjb25maWd1cmFibGU6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKfSk7CgovLyBmZXRjaApjb25zdCBvcmlnaW5hbEZldGNoID0gd2luZG93LmZldGNoOwp3aW5kb3cuZmV0Y2ggPSBmdW5jdGlvbihyZXNvdXJjZSwgaW5pdCkgewoKICBpZiAodHlwZW9mIHJlc291cmNlID09PSAic3RyaW5nIikgewogIC8vY29uc29sZS5sb2cocmVzb3VyY2UpCiAgICByZXNvdXJjZSA9IHJld3JpdGVVUkwocmVzb3VyY2UpOwogIH0gZWxzZSBpZiAocmVzb3VyY2UgaW5zdGFuY2VvZiBSZXF1ZXN0KSB7CiAgICByZXNvdXJjZSA9IG5ldyBSZXF1ZXN0KHJld3JpdGVVUkwocmVzb3VyY2UudXJsKSwgcmVzb3VyY2UpOwogIH0KICByZXR1cm4gb3JpZ2luYWxGZXRjaC5jYWxsKHRoaXMsIHJlc291cmNlLCBpbml0KTsKfTsKCi8vIFhNTEh0dHBSZXF1ZXN0CmNvbnN0IG9yaWdpbmFsT3BlbiA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOwpYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKG1ldGhvZCwgdXJsLCAuLi5yZXN0KSB7CiAgY29uc3QgbmV3VVJMID0gcmV3cml0ZVVSTCh1cmwpOwogIHJldHVybiBvcmlnaW5hbE9wZW4uY2FsbCh0aGlzLCBtZXRob2QsIG5ld1VSTCwgLi4ucmVzdCk7Cn07CgoKY29uc3QgT3JpZ2luYWxBdWRpbyA9IHdpbmRvdy5BdWRpbzsKd2luZG93LkF1ZGlvID0gZnVuY3Rpb24oc3JjKSB7CiAgY29uc3QgYXVkaW8gPSBuZXcgT3JpZ2luYWxBdWRpbygpOwogIGlmIChzcmMpIHsKICAgIGF1ZGlvLnNyYyA9IHJld3JpdGVVUkwoc3JjKTsKICB9CiAgcmV0dXJuIGF1ZGlvOwp9Owp3aW5kb3cuQXVkaW8ucHJvdG90eXBlID0gT3JpZ2luYWxBdWRpby5wcm90b3R5cGU7CgoKZnVuY3Rpb24gcmV3cml0ZVVSTChvcmlnaW5hbCkgewoJCiAgdmFyIHRyaW1tZWQgPSBvcmlnaW5hbC5zcGxpdCgiLyIpLnBvcCgpOwogIAogIGlmIChvcmlnaW5hbC5zdGFydHNXaXRoKCJCdWlsZC8iKSkgcmV0dXJuIG9yaWdpbmFsLnNwbGl0KCJCdWlsZC8iKVsxXQogIGNvbnNvbGUubG9nKG9yaWdpbmFsKQogIGlmICh0cmltbWVkLmluY2x1ZGVzKCI/IikpIHRyaW1tZWQgPSB0cmltbWVkLnNwbGl0KCI/IilbMF0KICByZXR1cm4gYmxvYlVybHNzW3RyaW1tZWRdIHx8IG9yaWdpbmFsOwp9CgoKICAgICAgIHZhciBidWlsZFNldHRpbmdzID0gewoiY29tcGFueU5hbWUiOiAiWGZvcm1HYW1lcyIsCiJwcm9kdWN0TmFtZSI6ICJQb2xpY2UgUHVyc3VpdCAyIiwKImRhdGFVcmwiOiBibG9iVXJsc3NbIlBvbGljZVB1cnN1aXQyLmRhdGEudW5pdHl3ZWIiXSwKIndhc21Db2RlVXJsIjogYmxvYlVybHNzWyJQb2xpY2VQdXJzdWl0Mi53YXNtLmNvZGUudW5pdHl3ZWIiXSwKIndhc21GcmFtZXdvcmtVcmwiOiBibG9iVXJsc3NbIlBvbGljZVB1cnN1aXQyLndhc20uZnJhbWV3b3JrLnVuaXR5d2ViIl0sCiJUT1RBTF9NRU1PUlkiOiAxMzQyMTc3MjgsCiJncmFwaGljc0FQSSI6IFsiV2ViR0wgMi4wIiwgIldlYkdMIDEuMCJdLAoid2ViZ2xDb250ZXh0QXR0cmlidXRlcyI6IHsicHJlc2VydmVEcmF3aW5nQnVmZmVyIjogZmFsc2V9LAoic3BsYXNoU2NyZWVuU3R5bGUiOiAiRGFyayIsCiJiYWNrZ3JvdW5kQ29sb3IiOiAiIzIzMUYyMCIKfQogICAgICAgIAogICAgICAgIGNvbnN0IGJ1aWxkQmxvYiA9IG5ldyBCbG9iKAogIFtKU09OLnN0cmluZ2lmeShidWlsZFNldHRpbmdzKV0sCiAgeyB0eXBlOiAiYXBwbGljYXRpb24vanNvbiIgfQopOwpjb25zdCBidWlsZFVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYnVpbGRCbG9iKTsKCiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVuaXR5LWNhbnZhcyIpOwoKICAgICAgICBVbml0eUxvYWRlci5pbnN0YW50aWF0ZSgidW5pdHktY29udGFpbmVyIiwgYnVpbGRVcmwsIHtvblByb2dyZXNzOiBVbml0eVByb2dyZXNzLCBNb2R1bGU6IHsgYmFja2dyb3VuZENvbG9yOiAidHJhbnNwYXJlbnQifSB9KTsKfSk7CiAgICA8L3NjcmlwdD4KICAgIAogICAgCgoJPHNjcmlwdD4KCQoJPC9zY3JpcHQ+Cgo8L2JvZHk+CjwvaHRtbD4K";
