window.game = "PCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KPCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbi11cyI+DQogICAgPGhlYWQ+DQogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4NCiAgICAgICAgPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiPg0KICAgICAgICA8c3R5bGU+aHRtbCwgYm9keSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDBweDsNCiAgICAgICAgICAgICAgICBtYXJnaW46IDBweDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC5mdWxsc2NyZWVuIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzgzODM4Ow0KICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICAgICAgdG9wOiAwcHg7DQogICAgICAgICAgICAgICAgbGVmdDogMHB4Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgI2Jhbm5lci1jb250YWluZXIgew0KICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgICAgICBib3R0b206IDBweDsNCiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDkwcHg7DQogICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICNsb2FkaW5nLW92ZXJsYXkgew0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDsNCiAgICAgICAgICAgICAgICB6LWluZGV4OiAxOw0KICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgI2ljb24gew0KICAgICAgICAgICAgICAgIG1heC13aWR0aDogMTIwcHg7DQogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgI3Byb2dyZXNzLWJhciB7DQogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgICAgICAgICAgICAgIHdpZHRoOiA5MCU7DQogICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAyNTBweDsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDIwcHg7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzI0MjQyNDsNCiAgICAgICAgICAgICAgICBwYWRkaW5nOiA1cHg7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAjcHJvZ3Jlc3MtYmFyLWZpbGwgew0KICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCiAgICAgICAgICAgICAgICB3aWR0aDogMCU7DQogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICNGRjlBMDA7DQogICAgICAgICAgICB9DQogICAgICAgIDwvc3R5bGU+DQogICAgPC9oZWFkPg0KICAgIDxib2R5Pg0KICAgICAgICA8Y2FudmFzIGlkPSJjYW52YXMiIGNsYXNzPSJmdWxsc2NyZWVuIj48L2NhbnZhcz4NCiAgICAgICAgPGRpdiBpZD0iYmFubmVyLWNvbnRhaW5lciI+PC9kaXY+DQogICAgICAgIDxkaXYgaWQ9ImxvYWRpbmctb3ZlcmxheSIgY2xhc3M9ImZ1bGxzY3JlZW4iPg0KICAgICAgICAgICAgPGltZyBpZD0iaWNvbiIgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvc3otZ2FtZXMvR2FtZXM4QGQxMmNhNTZkOGIwYTUxZWUxOTEyMjAwM2M3NTk4N2EzNDk4MTY4Mzcvb25seS11cC9pY29uLnBuZyIgLz4NCiAgICAgICAgICAgIDxkaXYgaWQ9InByb2dyZXNzLWJhciI+PGRpdiBpZD0icHJvZ3Jlc3MtYmFyLWZpbGwiPjwvZGl2PjwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zei1nYW1lcy9HYW1lczhAZDEyY2E1NmQ4YjBhNTFlZTE5MTIyMDAzYzc1OTg3YTM0OTgxNjgzNy9vbmx5LXVwL2luc3RhbnQtZ2FtZXMtYnJpZGdlLmpzIj48L3NjcmlwdD4NCiAgICAgICAgPHNjcmlwdD4NCiAgICAgICAgICAgIGlmICgvaVBob25lfGlQYWR8aVBvZHxBbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KICAgICAgICAgICAgICAgIGxldCBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpDQogICAgICAgICAgICAgICAgbWV0YS5uYW1lID0gJ3ZpZXdwb3J0Jw0KICAgICAgICAgICAgICAgIG1ldGEuY29udGVudCA9ICd3aWR0aD1kZXZpY2Utd2lkdGgsIGhlaWdodD1kZXZpY2UtaGVpZ2h0LCBpbml0aWFsLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubywgc2hyaW5rLXRvLWZpdD15ZXMnDQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChtZXRhKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpDQogICAgICAgICAgICBsZXQgbG9hZGluZ092ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZy1vdmVybGF5JykNCiAgICAgICAgICAgIGxldCBwcm9ncmVzc0JhckZpbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3MtYmFyLWZpbGwnKQ0KICAgICAgICAgICAgbGV0IGJhbm5lckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYW5uZXItY29udGFpbmVyJykNCg0KICAgICAgICAgICAgY29uc3QgU1RPUkFHRV9EQVRBX1NFUEFSQVRPUiA9ICd7YnJpZGdlX2RhdGFfc2VwYXJhdG9yfScNCiAgICAgICAgICAgIGNvbnN0IFNUT1JBR0VfS0VZU19TRVBBUkFUT1IgPSAne2JyaWRnZV9rZXlzX3NlcGFyYXRvcn0nDQogICAgICAgICAgICBjb25zdCBTVE9SQUdFX1ZBTFVFU19TRVBBUkFUT1IgPSAne2JyaWRnZV92YWx1ZXNfc2VwYXJhdG9yfScNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyB1dGlscw0KICAgICAgICAgICAgd2luZG93LnVuaXR5SW5zdGFuY2UgPSBudWxsDQogICAgICAgICAgICBsZXQgcHJvZ3Jlc3NCYXJGaWxsaW5nSW50ZXJ2YWwgPSBudWxsDQoJCQkNCgkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJsb2NrY2hhbmdlJywgZnVuY3Rpb24oKSB7DQoJCSAgDQoJCQlpZiAoZG9jdW1lbnQucG9pbnRlckxvY2tFbGVtZW50ID09PSBjYW52YXMpIHsNCgkJCQkvLyDQmtGD0YDRgdC+0YAg0YLQvtC70YzQutC+INGH0YLQviDQsdGL0Lsg0YHQutGA0YvRgg0KCQkJCS8vY29uc29sZS5sb2coJ9Ca0YPRgNGB0L7RgCDRgdC60YDRi9GCJyk7DQoJCQkJLy8g0JfQtNC10YHRjCDQvNC+0LbQvdC+INCy0YvQt9Cy0LDRgtGMINGE0YPQvdC60YbQuNGOINC40LvQuCDRg9Cy0LXQtNC+0LzQuNGC0Ywg0LLQsNGI0YMg0LjQs9GA0YMg0L4g0YLQvtC8LCDRh9GC0L4g0LrRg9GA0YHQvtGAINGB0LrRgNGL0YINCgkJCQkgICB3aW5kb3cudW5pdHlJbnN0YW5jZS5TZW5kTWVzc2FnZSgnR2FtZScsICdPbkN1cnNvclZpc2liaWxpdHlDaGFuZ2VkJywgMCk7DQoJCQkgIH0gZWxzZSB7DQoJCQkJLy8g0JrRg9GA0YHQvtGAINGC0L7Qu9GM0LrQviDRh9GC0L4g0YHRgtCw0Lsg0LLQuNC00LjQvNGL0LwNCgkJCQkvL2NvbnNvbGUubG9nKCfQmtGD0YDRgdC+0YAg0L7RgtC+0LHRgNCw0LbQsNC10YLRgdGPJyk7DQoJCQkJLy8g0JfQtNC10YHRjCDQvNC+0LbQvdC+INCy0YvQt9Cy0LDRgtGMINGE0YPQvdC60YbQuNGOINC40LvQuCDRg9Cy0LXQtNC+0LzQuNGC0Ywg0LLQsNGI0YMg0LjQs9GA0YMg0L4g0YLQvtC8LCDRh9GC0L4g0LrRg9GA0YHQvtGAINC+0YLQvtCx0YDQsNC20LDQtdGC0YHRjw0KCQkJCSAgIHdpbmRvdy51bml0eUluc3RhbmNlLlNlbmRNZXNzYWdlKCdHYW1lJywgJ09uQ3Vyc29yVmlzaWJpbGl0eUNoYW5nZWQnLCAxKTsNCgkJCSAgfQ0KCQkJfSk7DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHNlbmRNZXNzYWdlVG9Vbml0eShuYW1lLCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cudW5pdHlJbnN0YW5jZSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cudW5pdHlJbnN0YW5jZS5TZW5kTWVzc2FnZSgnQnJpZGdlJywgbmFtZSwgdmFsdWUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmdW5jdGlvbiBvblVuaXR5TG9hZGluZ1Byb2dyZXNzQ2hhbmdlZChwcm9ncmVzcykgew0KICAgICAgICAgICAgICAgIGlmIChwcm9ncmVzcyA9PT0gMC45KSB7DQogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlUHJvZ3Jlc3NCYXJGaWxsaW5nKCkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcHJvZ3Jlc3NCYXJGaWxsLnN0eWxlLndpZHRoID0gYCR7IHByb2dyZXNzICogMTAwIH0lYA0KICAgICAgICAgICAgICAgIGlmIChwcm9ncmVzcyA9PT0gMSAmJiBwcm9ncmVzc0JhckZpbGxpbmdJbnRlcnZhbCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHByb2dyZXNzQmFyRmlsbGluZ0ludGVydmFsKQ0KICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0JhckZpbGxpbmdJbnRlcnZhbCA9IG51bGwNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBsZXRlUHJvZ3Jlc3NCYXJGaWxsaW5nKCkgew0KICAgICAgICAgICAgICAgIGlmIChwcm9ncmVzc0JhckZpbGxpbmdJbnRlcnZhbCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFBlcmNlbnQgPSA5MA0KICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyRmlsbC5zdHlsZS53aWR0aCA9IGAkeyBjdXJyZW50UGVyY2VudCB9JWANCiAgICAgICAgICAgICAgICBwcm9ncmVzc0JhckZpbGxpbmdJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBlcmNlbnQrKw0KICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFBlcmNlbnQgPiAxMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQZXJjZW50ID0gMTAwDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc0JhckZpbGwuc3R5bGUud2lkdGggPSBgJHsgY3VycmVudFBlcmNlbnQgfSVgDQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRQZXJjZW50ID49IDEwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc0JhckZpbGxpbmdJbnRlcnZhbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyRmlsbGluZ0ludGVydmFsID0gbnVsbA0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LCAxMDApDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsICgpID0+IHsNCiAgICAgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKQ0KICAgICAgICAgICAgICAgIGNhbnZhcy5mb2N1cygpDQogICAgICAgICAgICB9KQ0KDQoNCiAgICAgICAgICAgIGxldCBicmlkZ2VPcHRpb25zID0gew0KICAgICAgICAgICAgICAgIHBsYXRmb3Jtczogew0KICAgICAgICAgICAgICAgICAgICAnZ2FtZV9kaXN0cmlidXRpb24nOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lSWQ6ICdjN2ExMWY4NmVlZGE0YTJiODhlOGQ1YWQyYmEyZjQxZCcNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gaW5pdGlhbGl6YXRpb24NCiAgICAgICAgICAgIGJyaWRnZQ0KICAgICAgICAgICAgICAgIC5pbml0aWFsaXplKGJyaWRnZU9wdGlvbnMpDQogICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5vbignYmFubmVyX3N0YXRlX2NoYW5nZWQnLCBzdGF0ZSA9PiBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uQmFubmVyU3RhdGVDaGFuZ2VkJywgc3RhdGUpKQ0KICAgICAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5vbignaW50ZXJzdGl0aWFsX3N0YXRlX2NoYW5nZWQnLCBzdGF0ZSA9PiBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uSW50ZXJzdGl0aWFsU3RhdGVDaGFuZ2VkJywgc3RhdGUpKQ0KICAgICAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5vbigncmV3YXJkZWRfc3RhdGVfY2hhbmdlZCcsIHN0YXRlID0+IHNlbmRNZXNzYWdlVG9Vbml0eSgnT25SZXdhcmRlZFN0YXRlQ2hhbmdlZCcsIHN0YXRlKSkNCiAgICAgICAgICAgICAgICAgICAgYnJpZGdlLmdhbWUub24oJ3Zpc2liaWxpdHlfc3RhdGVfY2hhbmdlZCcsIHN0YXRlID0+IHNlbmRNZXNzYWdlVG9Vbml0eSgnT25WaXNpYmlsaXR5U3RhdGVDaGFuZ2VkJywgc3RhdGUpKQ0KDQogICAgICAgICAgICAgICAgICAgIGxldCB1bml0eUxvYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpDQogICAgICAgICAgICAgICAgICAgIHVuaXR5TG9hZGVyLnNyYyA9ICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvc3otZ2FtZXMvR2FtZXM4QGQxMmNhNTZkOGIwYTUxZWUxOTEyMjAwM2M3NTk4N2EzNDk4MTY4Mzcvb25seS11cC9CdWlsZC9Pbmx5IFVwIDIzMDgxNV8zLmxvYWRlci5qcycNCiAgICAgICAgICAgICAgICAgICAgdW5pdHlMb2FkZXIub25sb2FkID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlVW5pdHlJbnN0YW5jZSgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVXJsOiAnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3N6LWdhbWVzL0dhbWVzOEBkMTJjYTU2ZDhiMGE1MWVlMTkxMjIwMDNjNzU5ODdhMzQ5ODE2ODM3L29ubHktdXAvQnVpbGQvNGI5NGYxMWVhNjcxZmU3YjNlYWU3OTQwZjRlMTVhNDAuZGF0YS51bml0eXdlYicsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1ld29ya1VybDogJ2h0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zei1nYW1lcy9HYW1lczhAZDEyY2E1NmQ4YjBhNTFlZTE5MTIyMDAzYzc1OTg3YTM0OTgxNjgzNy9vbmx5LXVwL0J1aWxkLzRjMzY5YjlkMjM4NmU0MDYzMDc4YmFjNTliNTgwZjVkLmpzLnVuaXR5d2ViJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZVVybDogJ2h0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zei1nYW1lcy9HYW1lczhAZDEyY2E1NmQ4YjBhNTFlZTE5MTIyMDAzYzc1OTg3YTM0OTgxNjgzNy9vbmx5LXVwL0J1aWxkLzY4NjZkOTc0NzFmMDM1M2RmNDcyZWQ2ZDgxMDRiMWNjLndhc20udW5pdHl3ZWInLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW1pbmdBc3NldHNVcmw6ICdTdHJlYW1pbmdBc3NldHMnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYW55TmFtZTogJ0NyYWZ0IEdhbWUgV29ybGQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TmFtZTogJ09ubHkgVXAhIFBhcmtvdXIgUnVubmluZyBHYW1lJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdFZlcnNpb246ICcxLjcnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXRjaFdlYkdMVG9DYW52YXNTaXplOiBmYWxzZSwgLy8gVW5jb21tZW50IHRoaXMgdG8gc2VwYXJhdGVseSBjb250cm9sIFdlYkdMIGNhbnZhcyByZW5kZXIgc2l6ZSBhbmQgRE9NIGVsZW1lbnQgc2l6ZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGV2aWNlUGl4ZWxSYXRpbzogMSwgLy8gVW5jb21tZW50IHRoaXMgdG8gb3ZlcnJpZGUgbG93IERQSSByZW5kZXJpbmcgb24gaGlnaCBEUEkgZGlzcGxheXMuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblVuaXR5TG9hZGluZ1Byb2dyZXNzQ2hhbmdlZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigodW5pdHlJbnN0YW5jZSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cudW5pdHlJbnN0YW5jZSA9IHVuaXR5SW5zdGFuY2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZ092ZXJsYXkucmVtb3ZlKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZvY3VzKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodW5pdHlMb2FkZXIpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcikpDQogICAgICAgICAgICANCg0KICAgICAgICAgICAgLy8gcGxhdGZvcm0NCiAgICAgICAgICAgIHdpbmRvdy5nZXRQbGF0Zm9ybUlkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5wbGF0Zm9ybS5pZA0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0UGxhdGZvcm1MYW5ndWFnZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UucGxhdGZvcm0ubGFuZ3VhZ2UNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldFBsYXRmb3JtUGF5bG9hZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGxldCBwYXlsb2FkID0gYnJpZGdlLnBsYXRmb3JtLnBheWxvYWQNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXlsb2FkDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0UGxhdGZvcm1UbGQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBsZXQgdGxkID0gYnJpZGdlLnBsYXRmb3JtLnRsZA0KICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGxkID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGxkDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuc2VuZE1lc3NhZ2VUb1BsYXRmb3JtID0gZnVuY3Rpb24obWVzc2FnZSkgew0KICAgICAgICAgICAgICAgIGJyaWRnZS5wbGF0Zm9ybS5zZW5kTWVzc2FnZShtZXNzYWdlKQ0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgIC8vIGRldmljZQ0KICAgICAgICAgICAgd2luZG93LmdldERldmljZVR5cGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLmRldmljZS50eXBlDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgLy8gcGxheWVyDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNQbGF5ZXJBdXRob3JpemF0aW9uU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5wbGF5ZXIuaXNBdXRob3JpemF0aW9uU3VwcG9ydGVkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzUGxheWVyQXV0aG9yaXplZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UucGxheWVyLmlzQXV0aG9yaXplZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5nZXRQbGF5ZXJJZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmIChicmlkZ2UucGxheWVyLmlkKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UucGxheWVyLmlkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gJycNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldFBsYXllck5hbWUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoYnJpZGdlLnBsYXllci5uYW1lKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UucGxheWVyLm5hbWUudG9TdHJpbmcoKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAnJw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0UGxheWVyUGhvdG9zID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgaWYgKGJyaWRnZS5wbGF5ZXIucGhvdG9zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGJyaWRnZS5wbGF5ZXIucGhvdG9zKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAnJw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuYXV0aG9yaXplUGxheWVyID0gZnVuY3Rpb24ob3B0aW9ucykgew0KICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLnBsYXllci5hdXRob3JpemUob3B0aW9ucykNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkF1dGhvcml6ZUNvbXBsZXRlZCcsICd0cnVlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25BdXRob3JpemVDb21wbGV0ZWQnLCAnZmFsc2UnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgIC8vIGdhbWUNCiAgICAgICAgICAgIHdpbmRvdy5nZXRWaXNpYmlsaXR5U3RhdGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLmdhbWUudmlzaWJpbGl0eVN0YXRlDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgLy8gc3RvcmFnZQ0KICAgICAgICAgICAgd2luZG93LmdldFN0b3JhZ2VEZWZhdWx0VHlwZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2Uuc3RvcmFnZS5kZWZhdWx0VHlwZQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNTdG9yYWdlU3VwcG9ydGVkID0gZnVuY3Rpb24oc3RvcmFnZVR5cGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLnN0b3JhZ2UuaXNTdXBwb3J0ZWQoc3RvcmFnZVR5cGUpLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzU3RvcmFnZUF2YWlsYWJsZSA9IGZ1bmN0aW9uKHN0b3JhZ2VUeXBlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5zdG9yYWdlLmlzQXZhaWxhYmxlKHN0b3JhZ2VUeXBlKS50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5nZXRTdG9yYWdlRGF0YSA9IGZ1bmN0aW9uKGtleSwgc3RvcmFnZVR5cGUpIHsNCiAgICAgICAgICAgICAgICBsZXQga2V5cyA9IGtleS5zcGxpdChTVE9SQUdFX0tFWVNfU0VQQVJBVE9SKQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLnN0b3JhZ2UuZ2V0KGtleXMsIHN0b3JhZ2VUeXBlKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXlzLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVzID0gW10NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBkYXRhW2ldDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKCcnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkdldFN0b3JhZ2VEYXRhU3VjY2VzcycsIGAke2tleX0ke1NUT1JBR0VfREFUQV9TRVBBUkFUT1J9JHt2YWx1ZXMuam9pbihTVE9SQUdFX1ZBTFVFU19TRVBBUkFUT1IpfWApDQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YVswXSAhPT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhWzBdKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9ICcnDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkdldFN0b3JhZ2VEYXRhU3VjY2VzcycsIGAke2tleX0ke1NUT1JBR0VfREFUQV9TRVBBUkFUT1J9JHtkYXRhfWApDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uR2V0U3RvcmFnZURhdGFGYWlsZWQnLCBrZXkpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5zZXRTdG9yYWdlRGF0YSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUsIHN0b3JhZ2VUeXBlKSB7DQogICAgICAgICAgICAgICAgbGV0IGtleXMgPSBrZXkuc3BsaXQoU1RPUkFHRV9LRVlTX1NFUEFSQVRPUikNCiAgICAgICAgICAgICAgICBsZXQgdmFsdWVzID0gdmFsdWUuc3BsaXQoU1RPUkFHRV9WQUxVRVNfU0VQQVJBVE9SKQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLnN0b3JhZ2Uuc2V0KGtleXMsIHZhbHVlcywgc3RvcmFnZVR5cGUpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25TZXRTdG9yYWdlRGF0YVN1Y2Nlc3MnLCBrZXkpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uU2V0U3RvcmFnZURhdGFGYWlsZWQnLCBrZXkpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5kZWxldGVTdG9yYWdlRGF0YSA9IGZ1bmN0aW9uKGtleSwgc3RvcmFnZVR5cGUpIHsNCiAgICAgICAgICAgICAgICBsZXQga2V5cyA9IGtleS5zcGxpdChTVE9SQUdFX0tFWVNfU0VQQVJBVE9SKQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLnN0b3JhZ2UuZGVsZXRlKGtleXMsIHN0b3JhZ2VUeXBlKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uRGVsZXRlU3RvcmFnZURhdGFTdWNjZXNzJywga2V5KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkRlbGV0ZVN0b3JhZ2VEYXRhRmFpbGVkJywga2V5KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgIC8vIGFkdmVydGlzZW1lbnQNCiAgICAgICAgICAgIHdpbmRvdy5nZXRJc0Jhbm5lclN1cHBvcnRlZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5pc0Jhbm5lclN1cHBvcnRlZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHdpbmRvdy5nZXRNaW5pbXVtRGVsYXlCZXR3ZWVuSW50ZXJzdGl0aWFsID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5hZHZlcnRpc2VtZW50Lm1pbmltdW1EZWxheUJldHdlZW5JbnRlcnN0aXRpYWwudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuc2V0TWluaW11bURlbGF5QmV0d2VlbkludGVyc3RpdGlhbCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5zZXRNaW5pbXVtRGVsYXlCZXR3ZWVuSW50ZXJzdGl0aWFsKEpTT04ucGFyc2Uob3B0aW9ucykpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5zaG93QmFubmVyID0gZnVuY3Rpb24ob3B0aW9ucykgew0KICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IHsgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChicmlkZ2UucGxhdGZvcm0uaWQgPT09IGJyaWRnZS5QTEFURk9STV9JRC5DUkFaWV9HQU1FUyB8fCBicmlkZ2UucGxhdGZvcm0uaWQgPT09IGJyaWRnZS5QTEFURk9STV9JRC5HQU1FX0RJU1RSSUJVVElPTikgew0KICAgICAgICAgICAgICAgICAgICBiYW5uZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jaycNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBvcHRpb25zWydjcmF6eV9nYW1lcyddID0gew0KICAgICAgICAgICAgICAgICAgICBjb250YWluZXJJZDogJ2Jhbm5lci1jb250YWluZXInDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgb3B0aW9uc1snZ2FtZV9kaXN0cmlidXRpb24nXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVySWQ6ICdiYW5uZXItY29udGFpbmVyJw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGJyaWRnZS5hZHZlcnRpc2VtZW50LnNob3dCYW5uZXIob3B0aW9ucykNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmhpZGVCYW5uZXIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoYnJpZGdlLnBsYXRmb3JtLmlkID09PSBicmlkZ2UuUExBVEZPUk1fSUQuQ1JBWllfR0FNRVMgfHwgYnJpZGdlLnBsYXRmb3JtLmlkID09PSBicmlkZ2UuUExBVEZPUk1fSUQuR0FNRV9ESVNUUklCVVRJT04pIHsNCiAgICAgICAgICAgICAgICAgICAgYmFubmVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5oaWRlQmFubmVyKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LnNob3dJbnRlcnN0aXRpYWwgPSBmdW5jdGlvbihvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IEpTT04ucGFyc2Uob3B0aW9ucykNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5zaG93SW50ZXJzdGl0aWFsKG9wdGlvbnMpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5zaG93UmV3YXJkZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBicmlkZ2UuYWR2ZXJ0aXNlbWVudC5zaG93UmV3YXJkZWQoKQ0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgIC8vIHNvY2lhbA0KICAgICAgICAgICAgd2luZG93LmdldElzU2hhcmVTdXBwb3J0ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLnNvY2lhbC5pc1NoYXJlU3VwcG9ydGVkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzSW52aXRlRnJpZW5kc1N1cHBvcnRlZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2Uuc29jaWFsLmlzSW52aXRlRnJpZW5kc1N1cHBvcnRlZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5nZXRJc0pvaW5Db21tdW5pdHlTdXBwb3J0ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLnNvY2lhbC5pc0pvaW5Db21tdW5pdHlTdXBwb3J0ZWQudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNDcmVhdGVQb3N0U3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5zb2NpYWwuaXNDcmVhdGVQb3N0U3VwcG9ydGVkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzQWRkVG9Ib21lU2NyZWVuU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5zb2NpYWwuaXNBZGRUb0hvbWVTY3JlZW5TdXBwb3J0ZWQudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNBZGRUb0Zhdm9yaXRlc1N1cHBvcnRlZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2Uuc29jaWFsLmlzQWRkVG9GYXZvcml0ZXNTdXBwb3J0ZWQudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNSYXRlU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5zb2NpYWwuaXNSYXRlU3VwcG9ydGVkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzRXh0ZXJuYWxMaW5rc0FsbG93ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLnNvY2lhbC5pc0V4dGVybmFsTGlua3NBbGxvd2VkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LnNoYXJlID0gZnVuY3Rpb24ob3B0aW9ucykgew0KICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLnNvY2lhbC5zaGFyZShvcHRpb25zKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uU2hhcmVDb21wbGV0ZWQnLCAndHJ1ZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uU2hhcmVDb21wbGV0ZWQnLCAnZmFsc2UnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuaW52aXRlRnJpZW5kcyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGJyaWRnZS5zb2NpYWwuaW52aXRlRnJpZW5kcygpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25JbnZpdGVGcmllbmRzQ29tcGxldGVkJywgJ3RydWUnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkludml0ZUZyaWVuZHNDb21wbGV0ZWQnLCAnZmFsc2UnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuam9pbkNvbW11bml0eSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucykgew0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGJyaWRnZS5zb2NpYWwuam9pbkNvbW11bml0eShvcHRpb25zKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uSm9pbkNvbW11bml0eUNvbXBsZXRlZCcsICd0cnVlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25Kb2luQ29tbXVuaXR5Q29tcGxldGVkJywgJ2ZhbHNlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmNyZWF0ZVBvc3QgPSBmdW5jdGlvbihvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IEpTT04ucGFyc2Uob3B0aW9ucykNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBicmlkZ2Uuc29jaWFsLmNyZWF0ZVBvc3Qob3B0aW9ucykNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkNyZWF0ZVBvc3RDb21wbGV0ZWQnLCAndHJ1ZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uQ3JlYXRlUG9zdENvbXBsZXRlZCcsICdmYWxzZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5hZGRUb0hvbWVTY3JlZW4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBicmlkZ2Uuc29jaWFsLmFkZFRvSG9tZVNjcmVlbigpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25BZGRUb0hvbWVTY3JlZW5Db21wbGV0ZWQnLCAndHJ1ZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uQWRkVG9Ib21lU2NyZWVuQ29tcGxldGVkJywgJ2ZhbHNlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmFkZFRvRmF2b3JpdGVzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgYnJpZGdlLnNvY2lhbC5hZGRUb0Zhdm9yaXRlcygpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25BZGRUb0Zhdm9yaXRlc0NvbXBsZXRlZCcsICd0cnVlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25BZGRUb0Zhdm9yaXRlc0NvbXBsZXRlZCcsICdmYWxzZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5yYXRlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgYnJpZGdlLnNvY2lhbC5yYXRlKCkNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPblJhdGVDb21wbGV0ZWQnLCAndHJ1ZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uUmF0ZUNvbXBsZXRlZCcsICdmYWxzZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgLy8gbGVhZGVyYm9hcmQNCiAgICAgICAgICAgIHdpbmRvdy5nZXRJc0xlYWRlcmJvYXJkU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5sZWFkZXJib2FyZC5pc1N1cHBvcnRlZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5nZXRJc0xlYWRlcmJvYXJkTmF0aXZlUG9wdXBTdXBwb3J0ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLmxlYWRlcmJvYXJkLmlzTmF0aXZlUG9wdXBTdXBwb3J0ZWQudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNMZWFkZXJib2FyZE11bHRpcGxlQm9hcmRzU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZS5sZWFkZXJib2FyZC5pc011bHRpcGxlQm9hcmRzU3VwcG9ydGVkLnRvU3RyaW5nKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmdldElzTGVhZGVyYm9hcmRTZXRTY29yZVN1cHBvcnRlZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiBicmlkZ2UubGVhZGVyYm9hcmQuaXNTZXRTY29yZVN1cHBvcnRlZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5nZXRJc0xlYWRlcmJvYXJkR2V0U2NvcmVTdXBwb3J0ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLmxlYWRlcmJvYXJkLmlzR2V0U2NvcmVTdXBwb3J0ZWQudG9TdHJpbmcoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cuZ2V0SXNMZWFkZXJib2FyZEdldEVudHJpZXNTdXBwb3J0ZWQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gYnJpZGdlLmxlYWRlcmJvYXJkLmlzR2V0RW50cmllc1N1cHBvcnRlZC50b1N0cmluZygpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5sZWFkZXJib2FyZFNldFNjb3JlID0gZnVuY3Rpb24ob3B0aW9ucykgew0KICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLmxlYWRlcmJvYXJkLnNldFNjb3JlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25MZWFkZXJib2FyZFNldFNjb3JlQ29tcGxldGVkJywgJ3RydWUnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZE1lc3NhZ2VUb1VuaXR5KCdPbkxlYWRlcmJvYXJkU2V0U2NvcmVDb21wbGV0ZWQnLCAnZmFsc2UnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB3aW5kb3cubGVhZGVyYm9hcmRHZXRTY29yZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucykgew0KICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zKQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGJyaWRnZS5sZWFkZXJib2FyZC5nZXRTY29yZShvcHRpb25zKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRHZXRTY29yZUNvbXBsZXRlZCcsIGRhdGEpDQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25MZWFkZXJib2FyZEdldFNjb3JlQ29tcGxldGVkJywgJycpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRHZXRTY29yZUNvbXBsZXRlZCcsICdmYWxzZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5sZWFkZXJib2FyZEdldEVudHJpZXMgPSBmdW5jdGlvbihvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyA9IEpTT04ucGFyc2Uob3B0aW9ucykNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBicmlkZ2UubGVhZGVyYm9hcmQuZ2V0RW50cmllcyhvcHRpb25zKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRHZXRFbnRyaWVzQ29tcGxldGVkU3VjY2VzcycsIGRhdGEpDQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlVG9Vbml0eSgnT25MZWFkZXJib2FyZEdldEVudHJpZXNDb21wbGV0ZWRTdWNjZXNzJywgJycpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRHZXRFbnRyaWVzQ29tcGxldGVkRmFpbGVkJywgJ2ZhbHNlJykNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmxlYWRlcmJvYXJkU2hvd05hdGl2ZVBvcHVwID0gZnVuY3Rpb24ob3B0aW9ucykgew0KICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgYnJpZGdlLmxlYWRlcmJvYXJkLnNob3dOYXRpdmVQb3B1cChvcHRpb25zKQ0KICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRTaG93TmF0aXZlUG9wdXBDb21wbGV0ZWQnLCAndHJ1ZScpDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZVRvVW5pdHkoJ09uTGVhZGVyYm9hcmRTaG93TmF0aXZlUG9wdXBDb21wbGV0ZWQnLCAnZmFsc2UnKQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICA8L3NjcmlwdD4NCiAgICA8L2JvZHk+DQo8L2h0bWw+";
