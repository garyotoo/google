window.game = "PCFET0NUWVBFIGh0bWw+DQoNCg0KPCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KDQoJPGh0bWwgbGFuZz0iZW4iPg0KICA8YmFzZSBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvYnViYmxzL1VHUy1Bc3NldHNAMGU0ZWNkNmQzMTgyNzJiNjJjZDY3MTAxMWQ1YWZlNjBhZWM2NjMyMS93cmVzdGxlJTIwYnJvcy8iPg0KCTxoZWFkPg0KDQoJICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+DQoNCgkgIDx0aXRsZT5XcmVzdGxlIEJyb3MgJiMxMjc5MTg7IFBsYXkgTm93IG9uIHRoZSBPZmZpY2lhbCBTaXRlPC90aXRsZT4NCg0KCSAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9Ik9ubGluZSBtdWx0aXBsYXllciBQUk8gV1JFU1RMSU5HISBCZWF0IHVwIHlvdXIgYnJvcyEiIC8+DQoJICA8bWV0YSBpZD0idmlld3BvcnQiIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wLCBtYXhpbXVtLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubyIgLz4NCgkgIDxsaW5rIHJlbD0ic2hvcnRjdXQgaWNvbiIgdHlwZT0iaW1hZ2UvcG5nIiBocmVmPSIuL2Zhdmljb24ucG5nIj4NCg0KCSAgPG1ldGEgbmFtZT0iS2V5d29yZHMiIGNvbnRlbnQ9IldyZXN0bGluZywgUGxheSwgRnJlZSwgT25saW5lLCBNdWx0aXBsYXllciwgR2FtZXMsIElPLCBGaWdodGluZywgU2xhbSwgU2Nyb2xsaW5nLCBGcmllbmRzIj4NCgkgIDxtZXRhIG5hbWU9ImF1dGhvciIgY29udGVudD0iQmx1ZSBXaXphcmQgRGlnaXRhbCI+DQoNCgkgIDxsaW5rIHJlbD0ibWFuaWZlc3QiIGhyZWY9Im1hbmlmZXN0Lmpzb24iPg0KDQoNCg0KCSAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iV3Jlc3RsZUJyb3MuanM/dGg9Njc2Ij48L3NjcmlwdD4NCg0KCSAgPHNjcmlwdD4NCgkgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsIGZ1bmN0aW9uKGV2ZW50KSB7DQoJICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCgkgICAgfSwgew0KCSAgICAgIGNhcHR1cmU6IGZhbHNlLA0KCSAgICAgIHBhc3NpdmU6IGZhbHNlDQoJICAgIH0pOw0KCSAgICBpZiAodHlwZW9mIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID4gMikgew0KCSAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZXdwb3J0Iik7DQoJICAgICAgbWV0YS5zZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnLCAnd2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPScgKyAoMiAvIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKSArICcsIHVzZXItc2NhbGFibGU9bm8nKTsNCgkgICAgfQ0KCSAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHsNCgkgICAgICBpZiAoKGUua2V5Q29kZSA9PSAzMiB8fCBlLmtleUNvZGUgPT0gMzggfHwgZS5rZXlDb2RlID09IDQwKSAmJiBlLnRhcmdldCA9PSBkb2N1bWVudC5ib2R5KSB7DQoJICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQoJICAgICAgfQ0KCSAgICB9KTsNCg0KCSAgICB2YXIgZGVmZXJyZWRQcm9tcHQ7DQoJICAgIHZhciB0ZXN0ZWRQV0EgPSBmYWxzZTsNCgkgICAgdmFyIGNhblByb2Nlc3NQV0EgPSBmYWxzZTsNCgkgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZWluc3RhbGxwcm9tcHQnLCAoZSkgPT4gew0KCSAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCgkgICAgICBkZWZlcnJlZFByb21wdCA9IGU7DQoJICAgICAgY2FuUHJvY2Vzc1BXQSA9IHRydWU7DQoJICAgIH0pOw0KDQoJICAgIGZ1bmN0aW9uIENoZWNrUFdBKCkgew0KCSAgICAgIGNvbnNvbGUubG9nKCJwd2ExIik7DQoJICAgICAgaWYgKHRlc3RlZFBXQSA9PSB0cnVlKSByZXR1cm47DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSByZXR1cm47DQoNCgkgICAgICB0ZXN0ZWRQV0EgPSB0cnVlOw0KCSAgICAgIGlmICh3aW5kb3cubWF0Y2hNZWRpYSgnKGRpc3BsYXktbW9kZTogc3RhbmRhbG9uZSknKS5tYXRjaGVzKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygicHdhMiIpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdpbl9wd2EnKTsNCgkgICAgICB9IGVsc2UgaWYgKGNhblByb2Nlc3NQV0EgPT0gdHJ1ZSkgew0KCSAgICAgICAgY29uc29sZS5sb2coInB3YTMiKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbm90X2luX3B3YScpOw0KCSAgICAgICAgZGVmZXJyZWRQcm9tcHQucHJvbXB0KCk7DQoJICAgICAgICBkZWZlcnJlZFByb21wdC51c2VyQ2hvaWNlLnRoZW4oKGNob2ljZVJlc3VsdCkgPT4gew0KCSAgICAgICAgICBpZiAoY2hvaWNlUmVzdWx0Lm91dGNvbWUgPT09ICdhY2NlcHRlZCcpIHsNCgkgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhY2NlcHRlZCB0aGUgaW5zdGFsbCBwcm9tcHQnKTsNCgkgICAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBkaXNtaXNzZWQgdGhlIGluc3RhbGwgcHJvbXB0Jyk7DQoJICAgICAgICAgIH0NCgkgICAgICAgIH0pOw0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3B3YV9ub3RfaW5zdGFsbGVkJyk7DQoJICAgICAgICBjb25zb2xlLmxvZygpDQoJICAgICAgfQ0KCSAgICB9DQoJICA8L3NjcmlwdD4NCg0KCSAgPHN0eWxlPg0KCSAgICBodG1sLA0KCSAgICBib2R5IHsNCgkgICAgICBtYXJnaW46IDA7DQoJICAgICAgcGFkZGluZzogMDsNCgkgICAgICBoZWlnaHQ6IDEwMCU7DQoJICAgICAgYmFja2dyb3VuZDogIzAwMDAwMDsNCgkgICAgICBjb2xvcjogb3JhbmdlOw0KCSAgICAgIGhlaWdodDogMTAwJTsNCgkgICAgICB3aWR0aDogMTAwJTsNCgkgICAgICBoZWlnaHQ6IDEwMHZoOw0KCSAgICAgIHdpZHRoOiAxMDB2dzsNCgkgICAgICBtYXJnaW46IDA7DQoJICAgICAgcGFkZGluZzogMDsNCgkgICAgfQ0KDQoJICAgIC5ib2R5Ojotd2Via2l0LXNjcm9sbGJhciB7DQoJICAgICAgLyogV2ViS2l0ICovDQoJICAgICAgd2lkdGg6IDBweDsNCgkgICAgfQ0KDQoJICAgICNvcGVuZmwtY29udGVudCB7DQoJICAgICAgYmFja2dyb3VuZDogIzAwMDAwMDsNCgkgICAgICB3aWR0aDogMTAwJTsNCgkgICAgICBoZWlnaHQ6IDEwMCU7DQoJICAgIH0NCg0KCSAgICAjc3Bpbm5lciB7DQoJICAgICAgLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgNTAlOw0KCSAgICAgIC1tb3otdHJhbnNmb3JtLW9yaWdpbjogNTAlIDUwJTsNCgkgICAgICAtby10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgNTAlOw0KCSAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDUwJSA1MCU7DQoJICAgICAgd2lkdGg6IDgycHg7DQoJICAgICAgaGVpZ2h0OiA4MXB4Ow0KCSAgICAgIC13ZWJraXQtYW5pbWF0aW9uOiBzcGluMSAycyBpbmZpbml0ZSBsaW5lYXI7DQoJICAgICAgLW1vei1hbmltYXRpb246IHNwaW4xIDJzIGluZmluaXRlIGxpbmVhcjsNCgkgICAgICAtby1hbmltYXRpb246IHNwaW4xIDJzIGluZmluaXRlIGxpbmVhcjsNCgkgICAgICAtbXMtYW5pbWF0aW9uOiBzcGluMSAycyBpbmZpbml0ZSBsaW5lYXI7DQoJICAgICAgYW5pbWF0aW9uOiBzcGluMSAycyBpbmZpbml0ZSBsaW5lYXI7DQoJICAgIH0NCgkgIDwvc3R5bGU+DQoNCg0KCSAgPCEtLSBHb29nbGUgdGFnIChndGFnLmpzKSAtLT4NCgkgIDxzY3JpcHQgYXN5bmMgc3JjPSJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndGFnL2pzP2lkPUctOVdGSkdGNllOSyI+PC9zY3JpcHQ+DQoJICA8c2NyaXB0Pg0KCSAgICB3aW5kb3cuZGF0YUxheWVyID0gd2luZG93LmRhdGFMYXllciB8fCBbXTsNCg0KCSAgICBmdW5jdGlvbiBndGFnKCkgew0KCSAgICAgIGRhdGFMYXllci5wdXNoKGFyZ3VtZW50cyk7DQoJICAgIH0NCgkgICAgZ3RhZygnanMnLCBuZXcgRGF0ZSgpKTsNCgkgICAgZ3RhZygnY29uZmlnJywgJ0ctOVdGSkdGNllOSycsIHsNCgkgICAgICBjb29raWVfZmxhZ3M6ICdzZWN1cmU7c2FtZXNpdGU9bm9uZScNCgkgICAgfSk7DQoJICA8L3NjcmlwdD4NCg0KCSAgPHNjcmlwdD4NCgkgICAgLy9JbnRlcnN0aXRpYWwgYWQgYXZhaWxhYmxlIGV2ZW50DQoJICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImFpcF9pbnRlcnN0aXRpYWxhZGF2YWlsYWJsZSIsIGZ1bmN0aW9uKGUpIHsNCgkgICAgICBjb25zb2xlLmxvZygiQW4gaW50ZXJzdGl0aWFsIGFkIGlzIGF2YWlsYWJsZSIpOw0KCSAgICB9KTsNCgkgIDwvc2NyaXB0Pg0KCSAgPHNjcmlwdCBzcmM9InRhZy5taW4uanMiPjwvc2NyaXB0Pg0KDQoJICA8c2NyaXB0Pg0KCSAgICB2YXIgYWlwdGFnID0gYWlwdGFnIHx8IHt9Ow0KCSAgICBhaXB0YWcuY21kID0gYWlwdGFnLmNtZCB8fCBbXTsNCgkgICAgYWlwdGFnLmNtZC5kaXNwbGF5ID0gYWlwdGFnLmNtZC5kaXNwbGF5IHx8IFtdOw0KCSAgICBhaXB0YWcuY21kLnBsYXllciA9IGFpcHRhZy5jbWQucGxheWVyIHx8IFtdOw0KCSAgICAvLyBTZXR0aW5ncw0KCSAgICBhaXB0YWcuY29uc2VudGVkID0gZmFsc2U7IC8vIEdEUFIgc2V0dGluZywgcGxlYXNlIHNldCB0aGlzIHZhbHVlIHRvIGZhbHNlIGlmIGFuIEVVIHVzZXIgaGFzIGRlY2xpbmVkIG9yIG5vdCB5ZXQgYWNjZXB0ZWQgbWFya2V0aW5nIGNvb2tpZXMsIGZvciB1c2VycyBvdXRzaWRlIHRoZSBFVSBwbGVhc2UgdXNlIHRydWUgYW5kIGZvciB1c2VycyBhY2NlcHRlZCB0aGUgR0RQUiBhbHNvIHVzZSB0cnVlDQoNCg0KDQoJICAgIGFpcHRhZy5jbWQucGxheWVyLnB1c2goZnVuY3Rpb24oKSB7DQoJICAgICAgYWRwbGF5ZXIgPSBuZXcgYWlwUGxheWVyKHsNCgkgICAgICAgIEFJUF9BREJSRUFLX0NPTVBMRVRFOiBmdW5jdGlvbigpIHsNCgkgICAgICAgICAgY29uc29sZS5sb2coIkFkYnJlYWsgQ29tcGxldGVkIik7DQoJICAgICAgICAgIE1haW4uRG9uZUludGVyc3RpdGlhbEFkKGZhbHNlKTsNCgkgICAgICAgIH0sDQoJICAgICAgICBBRF9XSURUSDogOTYwLA0KCSAgICAgICAgQURfSEVJR0hUOiA1NDAsDQoJICAgICAgICBBRF9ESVNQTEFZOiAnZGVmYXVsdCcsIC8vZGVmYXVsdCwgZnVsbHNjcmVlbiwgY2VudGVyLCBmaWxsDQoJICAgICAgICBUUlVTVEVEOiB0cnVlLA0KCSAgICAgICAgTE9BRElOR19URVhUOiAnbG9hZGluZyBhZHZlcnRpc2VtZW50JywNCgkgICAgICAgIFBSRVJPTExfRUxFTTogZnVuY3Rpb24oKSB7DQoJICAgICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcm9sbCcpDQoJICAgICAgICB9LA0KCSAgICAgICAgQUlQX0NPTVBMRVRFOiBmdW5jdGlvbihzdGF0ZSkgew0KCSAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKg0KCSAgICAgICAgICAgKioqKiogV0FSTklORyAqKioqKg0KCSAgICAgICAgICAqKioqKioqKioqKioqKioqKioqDQoJICAgICAgICAgIFBsZWFzZSBkbyBub3QgcmVtb3ZlIHRoZSBQUkVST0xMX0VMRU0NCgkgICAgICAgICAgZnJvbSB0aGUgcGFnZSwgaXQgd2lsbCBiZSBoaWRkZW4gYXV0b21hdGljbHkuDQoJICAgICAgICAgIElmIHlvdSBkbyB3YW50IHRvIHJlbW92ZSBpdCB1c2UgdGhlIEFJUF9SRU1PVkUgY2FsbGJhY2suDQoJICAgICAgICAgICovDQoJICAgICAgICAgIE1haW4uRG9uZVZpZGVvQWQoKTsNCgkgICAgICAgICAgd2luZG93LmZvY3VzKCk7DQoJICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3BlbmZsLWNvbnRlbnQnKS5mb2N1cygpOw0KCSAgICAgICAgICBpZiAoc3RhdGUgPT0gbnVsbCkgc3RhdGUgPSAnbnVsbCc7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdWaWRlbyBBZCBDb21wbGV0ZTogJyArIHN0YXRlKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdkb25ldmlkZW8tJyArIGxhc3RVbml0UGxheWVkICsgIi0iICsgc3RhdGUpOw0KCSAgICAgICAgfSwNCgkgICAgICAgIEFJUF9SRU1PVkU6IGZ1bmN0aW9uKCkgew0KCSAgICAgICAgICAvLyBIZXJlIGl0J3Mgc2FmZSB0byByZW1vdmUgdGhlIFBSRVJPTExfRUxFTSBmcm9tIHRoZSBwYWdlIGlmIHlvdSB3YW50LiBCdXQgaXQncyBub3QgcmVjb21tZW5kLg0KCSAgICAgICAgfQ0KCSAgICAgIH0pOw0KCSAgICB9KTsNCg0KDQoJICAgIGZ1bmN0aW9uIFNldHVwTVNOb3RpZmljYXRpb24oKSB7DQoJICAgICAgY29uc29sZS5sb2coIm5vdGlmeWluZyIpOw0KCSAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygibm90aWZ5aW5nMiIpOw0KCSAgICAgICAgdmFyIGlkID0gYnRvYSgiaHR0cHM6Ly93cmVzdGxlYnJvcy5pby93YnJvc18zNjR4MTgwLnBuZyIpOw0KCSAgICAgICAgJG1zc3RhcnQuc2NoZWR1bGVOb3RpZmljYXRpb25Bc3luYyh7DQoJICAgICAgICAgIHRpdGxlOiAnVW5sb2NrIG5ldyBicm9zIG5vdyEnLA0KCSAgICAgICAgICBkZXNjcmlwdGlvbjogJ1lvdSBhcmUganVzdCBhYm91dCB0byB1bmxvY2sgYSBuZXcgQnJvISBXaG8gd2lsbCBpdCBiZT8nLA0KCSAgICAgICAgICB0eXBlOiAxLA0KCSAgICAgICAgICBtaW5EZWxheUluU2Vjb25kczogMjQgKiA2MCAqIDYwDQoJICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coIm5vdGlmaWNhdGlvbiByZXNwb25zZTogIiArIHJlc3BvbnNlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgICAgJG1zc3RhcnQuc2NoZWR1bGVOb3RpZmljYXRpb25Bc3luYyh7DQoJICAgICAgICAgIHRpdGxlOiAnR2V0IG1vcmUgYnJvcyEnLA0KCSAgICAgICAgICBkZXNjcmlwdGlvbjogJ05ldyBicm9zIGp1c3Qgd2FpdGluZyB0byBzY29yZSBnb2FscyBmb3IgeW91IScsDQoJICAgICAgICAgIHR5cGU6IDEsDQoJICAgICAgICAgIG1pbkRlbGF5SW5TZWNvbmRzOiAyNCAqIDcgKiA2MCAqIDYwDQoJICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coIm5vdGlmaWNhdGlvbiByZXNwb25zZTogIiArIHJlc3BvbnNlKTsNCgkgICAgICAgIH0pOw0KDQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgdmFyIG1zQWRJRDsNCg0KCSAgICBmdW5jdGlvbiBMb2FkVmlkZW8oKSB7DQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgICRtc3N0YXJ0LmxvYWRBZHNBc3luYygpLnRoZW4oYWRJbnN0YW5jZSA9PiB7DQoJICAgICAgICAgIC8vIFVzZSB0aGUgYWRJbnN0YW5jZS5pbnN0YW5jZUlkIHRvIG1ha2UgYSBjYWxsIHRvIHNob3dBZHNBc3luYw0KCSAgICAgICAgICBtc0FkSUQgPSBhZEluc3RhbmNlLmluc3RhbmNlSWQ7DQoJICAgICAgICB9KTsNCg0KCSAgICAgICAgU2V0dXBNU05vdGlmaWNhdGlvbigpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dWaWRlbyh0aGVVbml0TmFtZSA9IG51bGwsIGZvcmNlYWlwID0gZmFsc2UpIHsNCgkgICAgICBjb25zb2xlLmxvZygnU0hPV19WSURFTycpOw0KCSAgICAgIHZhciBhVW5pdE5hbWUgPSAiIjsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXJvbGwnKTsNCgkgICAgICAgIGlmIChsID09IG51bGwpIHJldHVybjsNCgkgICAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCgkgICAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOw0KCSAgICAgICAgd2luZG93LmZvY3VzKCk7DQoJICAgICAgICB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgICAgIE1haW4uRG9uZVZpZGVvQWQoKTsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJyAmJiBmb3JjZWFpcCA9PSBmYWxzZSkgew0KCSAgICAgICAgJG1zc3RhcnQuc2hvd0Fkc0FzeW5jKG1zQWRJRCkudGhlbihhZEluc3RhbmNlID0+IHsNCgkgICAgICAgICAgLy8gVXNlIHRoZSBhZEluc3RhbmNlLnNob3dBZHNDb21wbGV0ZWRBc3luYyB0byBiZSBub3RpZmllZCBvZiB0aGUgY29tcGxldGlvbiBvZiBzaG93aW5nIHRoZSBhZHZlcnRpc2VtZW50DQoJICAgICAgICAgIGFkSW5zdGFuY2Uuc2hvd0Fkc0NvbXBsZXRlZEFzeW5jLnRoZW4oKHZhbCkgPT4gew0KCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNUyBWaWRlbyBBZCBDb21wbGV0ZScpOw0KCSAgICAgICAgICAgIE1haW4uRG9uZVZpZGVvQWQoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX3ZpZGVvX3Nob3duMicpOw0KCSAgICAgICAgICAgIExvYWRWaWRlbygpOw0KCSAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7DQoJICAgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdtc192aWRlb19ub3RfY29tcGxldGVkJyk7DQoJICAgICAgICAgICAgTG9hZFZpZGVvKCk7DQoJICAgICAgICAgIH0pOw0KCSAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gew0KCSAgICAgICAgICBjb25zb2xlLmxvZygnTXMgVmlkZW8gQWQgRXJyb3IsIHNob3dpbmcgYWlwJyk7DQoJICAgICAgICAgIC8vTWFpbi5Eb25lVmlkZW9BZCgpOw0KCSAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCgkgICAgICAgICAgd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfdmlkZW9fc2hvd19lcnJvcjInKTsNCgkgICAgICAgICAgTG9hZFZpZGVvKCk7DQoJICAgICAgICAgIFNob3dWaWRlbyh0aGVVbml0TmFtZSwgdHJ1ZSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cuQ3JhenlHYW1lcyAhPT0gJ3VuZGVmaW5lZCcpIHsNCg0KCSAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gew0KCSAgICAgICAgICBhZEZpbmlzaGVkOiAoKSA9PiBNYWluLkRvbmVWaWRlb0FkKCksDQoJICAgICAgICAgIGFkRXJyb3I6IChlcnJvcikgPT4gTWFpbi5Eb25lVmlkZW9BZCgpLA0KCSAgICAgICAgICBhZFN0YXJ0ZWQ6ICgpID0+IGNvbnNvbGUubG9nKCJTdGFydCBtaWRnYW1lIGFkIiksDQoJICAgICAgICB9Ow0KCSAgICAgICAgd2luZG93LkNyYXp5R2FtZXMuU0RLLmFkLnJlcXVlc3RBZCgibWlkZ2FtZSIsIGNhbGxiYWNrcyk7DQoNCgkgICAgICAgIC8vCQkJd2luZG93LkNyYXp5R2FtZXMuU0RLLmFkZEV2ZW50TGlzdGVuZXIoImFkRmluaXNoZWQiLCBNYWluLkRvbmVWaWRlb0FkKTsgLy8gcmVlbmFibGUgc291bmQsIGVuYWJsZSB1aQ0KCSAgICAgICAgLy8JCQl3aW5kb3cuQ3JhenlHYW1lcy5TREsuYWRkRXZlbnRMaXN0ZW5lcigiYWRFcnJvciIsIE1haW4uRG9uZVZpZGVvQWQpOyAvLyByZWVuYWJsZSBzb3VuZCwgZW5hYmxlIHVpDQoJICAgICAgICAvLwkJCXdpbmRvdy5DcmF6eUdhbWVzLlNESy5yZXF1ZXN0QWQoKTsJCQ0KCSAgICAgICAgY29uc29sZS5sb2coJ0NHX0FEX1JFUVVFU1RFRCcpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdjZ3ZpZGVvJyk7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWRwbGF5ZXIgPT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBNYWluLkRvbmVWaWRlb0FkKHRydWUpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICd2aWRlb19hZGJsb2NrZWQnKTsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdWSURFT19BREJMT0NLRUQnKTsNCg0KCSAgICAgIH0gZWxzZSB7DQoJICAgICAgICB2YXIgYVN0ciA9ICdwcmVyb2xsJzsNCgkgICAgICAgIGlmICh0aGVVbml0TmFtZSAhPSBudWxsKSBhU3RyID0gdGhlVW5pdE5hbWU7DQoJICAgICAgICBsYXN0VW5pdFBsYXllZCA9IGFTdHI7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3N0YXJ0dmlkZW8tJyArIGFTdHIpOw0KDQoNCgkgICAgICAgIGFpcHRhZy5jbWQucGxheWVyLnB1c2goZnVuY3Rpb24oKSB7DQoJICAgICAgICAgIGFkcGxheWVyLnN0YXJ0UHJlUm9sbCh0aGVVbml0TmFtZSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9DQoJICAgIH0NCgkgIDwvc2NyaXB0Pg0KCTwvaGVhZD4NCg0KCTxib2R5IHN0eWxlPSJvdmVyZmxvdzpoaWRkZW47Ij4NCgkgIDxpZnJhbWUgc3JjPSJzaWxlbmNlLm1wMyIgYWxsb3c9ImF1dG9wbGF5IiBpZD0iYXVkaW8iIHN0eWxlPSJkaXNwbGF5OiBub25lIj48L2lmcmFtZT4NCgkgIDxub3NjcmlwdD5FbmFibGUgSmF2YVNjcmlwdCBicm8hPC9ub3NjcmlwdD4NCgkgIDxkaXYgaWQ9ImxvYWRpbmciIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7IHotaW5kZXg6IDE1OyB0b3A6IDYwJTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAwKTsgYmFja2dyb3VuZDogYmxhY2s7Ij4NCgkgICAgPGNlbnRlcj48aW1nIHNyYz0iYXNzZXRzL2xvYWRpbmc0LnBuZyI+PGJyIC8+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9mYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9zYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy93YnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9iYnJvLnBuZyI+DQoJICAgIDwvY2VudGVyPg0KCSAgPC9kaXY+DQoNCgkgIDxkaXYgaWQ9ImdhbWUyIiBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgIj4NCgkgICAgPGRpdiBpZD0ib3BlbmZsLWNvbnRlbnQiIG9uYmx1cj0id2luZG93LmZvY3VzKCk7IiBzdHlsZT0id2lkdGg6IGNhbGMoMTAwJSk7IGZsb2F0OmxlZnQ7Ij4NCgkgICAgICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQoJICAgICAgICBsaW1lLmVtYmVkKCJXcmVzdGxlQnJvcyIsICJvcGVuZmwtY29udGVudCIsIDAsIDAsIHsNCgkgICAgICAgICAgcGFyYW1ldGVyczoge30NCgkgICAgICAgIH0pOw0KCSAgICAgIDwvc2NyaXB0Pg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0icHJlcm9sbCIgc3R5bGU9IndpZHRoOiA5NjBweDsgaGVpZ2h0OiA1NDBweDsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDUwJTsgbGVmdDogNTAlOyB6LWluZGV4OiAxMDA7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOyI+DQoJICAgIDwvZGl2Pg0KDQoJICAgIDxkaXYgaWQ9IndyZXN0bGVicm9zLWlvXzMwMHgyNTAiIHN0eWxlPSJ3aWR0aDogMzAwcHg7IGhlaWdodDogMjUwcHg7IHZpc2liaWxpdHk6aGlkZGVuOyBkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMzBweDsgbGVmdDogMzBweDsgei1pbmRleDogMTAwOyBvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJ3cmVzdGxlYnJvcy1pb18zMDB4MjUwXzIiIHN0eWxlPSJ3aWR0aDogMzAwcHg7IGhlaWdodDogMjUwcHg7IHZpc2liaWxpdHk6aGlkZGVuOyBkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMzBweDsgbGVmdDogMzBweDsgei1pbmRleDogMTAwOyBvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJ3cmVzdGxlYnJvcy1pb183Mjh4OTAiIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsgd2lkdGg6IDcyOHB4OyBoZWlnaHQ6IDkwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0id3Jlc3RsZWJyb3MtaW9fNzI4eDkwX20iIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsgd2lkdGg6IDcyOHB4OyBoZWlnaHQ6IDkwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0id3Jlc3RsZWJyb3MtaW9fOTcweDI1MCIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyB3aWR0aDogOTcwcHg7IGhlaWdodDogMjUwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0id3Jlc3RsZWJyb3MtaW9fMTYweDYwMCIgc3R5bGU9IndpZHRoOiAxNjBweDsgaGVpZ2h0OiA2MDBweDsgdmlzaWJpbGl0eTpoaWRkZW47IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0id3Jlc3RsZWJyb3MtaW9fMTYweDYwMF8yIiBzdHlsZT0id2lkdGg6IDE2MHB4OyBoZWlnaHQ6IDYwMHB4OyB2aXNpYmlsaXR5OmhpZGRlbjsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDMwcHg7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgIDwvZGl2Pg0KDQoNCgkgIDwvZGl2Pg0KCSAgPGJyIC8+DQoJICA8ZGl2IGlkPSJtb3JlIj4NCgkgICAgPGRpdiBjbGFzcz0ibm90Y2gtdG9wLWxlZnQiIHN0eWxlPSItLW5vdGNoLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLWNvbG9yKSI+PC9kaXY+DQoJICAgIDxkaXYgY2xhc3M9ImluZm8tYm94Ij4NCgkgICAgICA8aDM+QWJvdXQgV3Jlc3RsZSBCcm9zPC9oMz4NCgkgICAgICA8cD5Cb2R5IHNsYW0geW91ciBicm9zIGluIHRoaXMgZnJlZSBwcm8gd3Jlc3RsaW5nIGJyb3dzZXIgZ2FtZSBmcm9tIEJsdWUgV2l6YXJkISBQbGF5IGdhbWVzIGFnYWluc3QgeW91ciBmcmllbmRzIG9ubGluZSBvciB3cmVzdGxlIHRoZSBDUFUgdG8gdW5sb2NrIG5ldyB3cmVzdGxlcnMgYW5kIGdlYXIuIExldCdzIGdldCByZWFkeSB0byBydW1ibGUgaW4gdGhlIHVsdGltYXRlIGNhZ2UgbWF0Y2ghIEZseSBvZmYgdGhlIHRvcCByb3BlLCBzbWFzaCB5b3VyIG9wcG9uZW50IGludG8gdGhlIGNhbnZhcywgb3IgZXZlbiBib3VuY2Ugb2ZmIHRoZSByb3BlcyEgQmVzdCBvZiBhbGwsIHlvdSBjYW4gcGxheSBvbmxpbmUgdnMgeW91ciBmcmllbmRzLCBicm8hPC9wPg0KCSAgICAgIDxwPlRoZSBjb250cm9scyBhcmUgdmVyeSBzaW1wbGU6IFVzZSBlaXRoZXIgdGhlIGFycm93IGtleXMgb3Igd2FzZCB0byBjb250cm9sIHlvdXIgd3Jlc3RsZSBici4gSnVtcCBieSBwcmVzc2luZyB0aGUgdXAgYXJyb3csIGFuZCBkb3VibGUganVtcCB0byBwaW4uIEVudGVyL1NwYWNlIHdpbGwgYXR0YWNrIGluIGRpZmZlcmVudCB3YXlzLCBkZXBlbmRpbmcgb24gd2hhdCB0aGUgc2l0dWF0aW9uIGlzLjwvcD4NCgkgICAgICA8cD5CZSBzdXJlIHRvIHNpZ24gdXAgZm9yIG91ciBuZXdzbGV0dGVyIHRvIGtub3cgYWx0IGxpbmtzIGFuZCBuZXcgdXBkYXRlcyB0byBXcmVzdGxlIEJyb3MhPC9wPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBjbGFzcz0iaW5mby1ib3giPg0KCSAgICAgIDxoMz5GQVE8L2gzPg0KCSAgICAgIDxiPldoeSBpc24ndCB0aGUgZ2FtZSBsb2FkaW5nPzwvYj4NCgkgICAgICA8cD5Zb3Ugc2hvdWxkIGNoZWNrIHlvdXIgaW50ZXJuZXQgY29ubmVjdGlvbiBhbmQgbWFrZSBzdXJlIG91ciBzaXRlIGlzbid0IGJsb2NrZWQuIEFsc28sIGRpc2FibGUgYWxsIGFkIGJsb2NrZXJzLjwvcD4NCgkgICAgICA8Yj5Ib3cgZG8gSSBwbGF5PzwvYj4NCgkgICAgICA8cD5KdXN0IGhvcCBpbiBhbmQgc3RhcnQgc3VwbGV4aW5nIHlvdXIgYnJvcyE8L3A+DQoJICAgICAgPGI+V2hpY2ggYnJvd3NlciBzaG91bGQgSSB1c2U/PC9iPg0KCSAgICAgIDxwPllvdSBzaG91bGQgdXNlIGNocm9tZS4gSXQgaXMgdGhlIG9ubHkgYnJvd3NlciBndWFyYW50ZWVkIHRvIHdvcmsuIFdyZXN0bGUgQnJvcyBoYXMgYWxzbyBiZWVuIHRlc3RlZCB0byB3b3JrIG9uIEZpcmVGb3ggYW5kIFNhZmFyaSwgYnV0IG5vdCBndWFyYW50ZWVkLjwvcD4NCgkgICAgICA8Yj5BcmUgdGhlcmUgbW9yZSBCcm9zIGdhbWVzPzwvYj4NCgkgICAgICA8cD5ZZXMhIE91ciBuZXdlc3QgaXMgPGEgaHJlZj0iaHR0cHM6Ly9mb290YmFsbGJyb3MuaW8iPkZvb3RiYWxsIEJyb3M8L2E+IHdoaWNoIGlzIGp1c3Qgb3V0LiBCdXQgd2UgYWxzbyBoYXZlIDxhIGhyZWY9Imh0dHBzOi8vc29jY2VyYnJvcy5nZyI+U29jY2VyIEJyb3M8L2E+IGFuZCA8YSBocmVmPSJodHRwczovL2Jhc2tldGJyb3MuaW8iPkJhc2tldCBCcm9zPC9hPi48L3A+DQoJICAgIDwvZGl2Pg0KCSAgPC9kaXY+DQoJICA8ZGl2IGNsYXNzPSJzZWN0aW9uIj4NCgkgICAgPGRpdiBzdHlsZT0iZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IHJvdzsgZmxleC13cmFwOiB3cmFwOyBtYXJnaW46IDEwcHg7IHBhZGRpbmc6IDJweDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Ij4NCgkgICAgICA8ZGl2IGNsYXNzPSJwYXJ0bmVyIj4NCgkgICAgICAgIDxzY3JpcHQ+DQoJICAgICAgICAgIGZ1bmN0aW9uIGdldFBhcnRuZXIoeSkgew0KCSAgICAgICAgICAgIHZhciByZWZlcnJlciA9IGRvY3VtZW50LnJlZmVycmVyOw0KCSAgICAgICAgICAgIGlmIChyZWZlcnJlci5pbmNsdWRlcygnY3JhenlnYW1lcycpKSB7DQoJICAgICAgICAgICAgICByZXR1cm4gJzxjZW50ZXI+PGJyPjxkaXYgc3R5bGU9InRyYW5zZm9ybTp0cmFuc2xhdGUoJyArICctNTAnICsgJ3B4LCcgKyB5ICsgJ3B4KTsgd2lkdGg9NzAlOyB6LWluZGV4OiAxMDE7IHRleHQtYWxpZ246cmlnaHQ7Pjxmb250IHN0eWxlPSJmb250LXdlaWdodDpub3JtYWw7Zm9udC1mYW1pbHk6QXJpYWw7Y29sb3I6IzAxMDEwMTtmb250LXNpemU6MjBweDsiPjxhIGhyZWY9Imh0dHBzOi8vY3JhenlnYW1lcy5jb20iIHRhcmdldD0iX2JsYW5rIj5DcmF6eSBHYW1lczwvYT48L2ZvbnQ+PGJyPjwvZGl2PjwvY2VudGVyPic7DQoJICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZlcnJlci5pbmNsdWRlcygnaW9nYW1lcy5zcGFjZScpKSB7DQoJICAgICAgICAgICAgICByZXR1cm4gJzxjZW50ZXI+PGJyPjxkaXYgc3R5bGU9InRyYW5zZm9ybTp0cmFuc2xhdGUoJyArICctNTAnICsgJ3B4LCcgKyB5ICsgJ3B4KTsgd2lkdGg9NzAlOyB6LWluZGV4OiAxMDE7IHRleHQtYWxpZ246cmlnaHQ7Pjxmb250IHN0eWxlPSJmb250LXdlaWdodDpub3JtYWw7Zm9udC1mYW1pbHk6QXJpYWw7Y29sb3I6IzAxMDEwMTtmb250LXNpemU6MjBweDsiPjxhIGhyZWY9Imh0dHBzOi8vaW9nYW1lcy5zcGFjZSIgdGFyZ2V0PSJfYmxhbmsiPklPIEdhbWVzPC9hPjwvZm9udD48YnI+PC9kaXY+PC9jZW50ZXI+JzsNCgkgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZmVycmVyLmluY2x1ZGVzKCdwb2tpJykpIHsNCgkgICAgICAgICAgICAgIHJldHVybiAnPGNlbnRlcj48YnI+PGRpdiBzdHlsZT0idHJhbnNmb3JtOnRyYW5zbGF0ZSgnICsgJy01MCcgKyAncHgsJyArIHkgKyAncHgpOyB3aWR0aD03MCU7IHotaW5kZXg6IDEwMTsgdGV4dC1hbGlnbjpyaWdodDs+PGZvbnQgc3R5bGU9ImZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LWZhbWlseTpBcmlhbDtjb2xvcjojMDEwMTAxO2ZvbnQtc2l6ZToyMHB4OyI+Q2hlY2sgb3V0IG91ciBmcmllbmRzIGF0IDxhIGhyZWY9Imh0dHBzOi8vcG9raS5jb20iIHRhcmdldD0iX2JsYW5rIj5Qb2tpPC9hPjwvZm9udD48YnI+PC9kaXY+PC9jZW50ZXI+JzsNCgkgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZmVycmVyLmluY2x1ZGVzKCdzaWx2ZXInKSkgew0KCSAgICAgICAgICAgICAgcmV0dXJuICc8Y2VudGVyPjxicj48ZGl2IHN0eWxlPSJ0cmFuc2Zvcm06dHJhbnNsYXRlKCcgKyAnLTUwJyArICdweCwnICsgeSArICdweCk7IHdpZHRoPTcwJTsgei1pbmRleDogMTAxOyB0ZXh0LWFsaWduOnJpZ2h0Oz48Zm9udCBzdHlsZT0iZm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OkFyaWFsO2NvbG9yOiMwMTAxMDE7Zm9udC1zaXplOjIwcHg7Ij48YSBocmVmPSJodHRwczovL3NpbHZlcmdhbWVzLmNvbSIgdGFyZ2V0PSJfYmxhbmsiPlNpbHZlciBHYW1lczwvYT48L2ZvbnQ+PGJyPjwvZGl2PjwvY2VudGVyPic7DQoJICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZlcnJlciA9PSAnJykgew0KCSAgICAgICAgICAgICAgcmV0dXJuICc8Y2VudGVyPjxicj48ZGl2IHN0eWxlPSJ0cmFuc2Zvcm06dHJhbnNsYXRlKCcgKyAnLTUwJyArICdweCwnICsgeSArICdweCk7IHdpZHRoPTcwJTsgei1pbmRleDogMTAxOyB0ZXh0LWFsaWduOnJpZ2h0Oz48Zm9udCBzdHlsZT0iZm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OkFyaWFsO2NvbG9yOiMwMTAxMDE7Zm9udC1zaXplOjIwcHg7Ij48YSBocmVmPSJodHRwczovL2ZyZWVnYW1lcy5pby9nYW1lL3dyZXN0bGUtYnJvcyIgdGFyZ2V0PSJfYmxhbmsiPldyZXN0bGUgQnJvcyBhdCBGcmVlZ2FtZXMuaW88L2E+PGJyLz48YSBocmVmPSJodHRwczovL2NyYXp5Z2FtZXMuY29tIiB0YXJnZXQ9Il9ibGFuayI+Q3JhenkgR2FtZXM8L2E+PC9mb250Pjxicj48L2Rpdj48L2NlbnRlcj4nOw0KCSAgICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgICByZXR1cm4gJzxjZW50ZXI+PGJyPjxkaXYgc3R5bGU9InRyYW5zZm9ybTp0cmFuc2xhdGUoJyArICctNTAnICsgJ3B4LCcgKyB5ICsgJ3B4KTsgd2lkdGg9NzAlOyB6LWluZGV4OiAxMDE7IHRleHQtYWxpZ246cmlnaHQ7Pjxmb250IHN0eWxlPSJmb250LXdlaWdodDpub3JtYWw7Zm9udC1mYW1pbHk6QXJpYWw7Y29sb3I6IzAxMDEwMTtmb250LXNpemU6MjBweDsiPjxhIGhyZWY9Imh0dHBzOi8vZnJlZWdhbWVzLmlvL2dhbWUvd3Jlc3RsZS1icm9zIiB0YXJnZXQ9Il9ibGFuayI+V3Jlc3RsZSBCcm9zIGF0IEZyZWVnYW1lcy5pbzwvYT48L2ZvbnQ+PGJyPjwvZGl2PjwvY2VudGVyPic7DQoJICAgICAgICAgICAgfQ0KCSAgICAgICAgICAgIHJldHVybiAiIjsNCgkgICAgICAgICAgfQ0KCSAgICAgICAgICBkb2N1bWVudC53cml0ZShnZXRQYXJ0bmVyKDApKTsNCgkgICAgICAgIDwvc2NyaXB0Pg0KDQoJICAgICAgPC9kaXY+DQoJICAgICAgPGJyIC8+DQoJICAgICAgPGJyIC8+DQoNCgkgICAgICA8IS0tICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBhcnRuZXIgZGVmYXVsdHNob3cgaGlkZWNyYXp5Z2FtZXMiPg0KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSJodHRwczovL2lvZ2FtZXMuc3BhY2UvIiB0YXJnZXQ9Il9ibGFuayI+TW9yZSBJTyBHYW1lczwvYT4NCiAgICAgICAgICAgICAgICA8L2Rpdj4gLS0+DQoJICAgICAgPCEtLSAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwYXJ0bmVyICBkZWZhdWx0c2hvdyBoaWRlY3JhenlnYW1lcyI+DQogICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vc2lsdmVyZ2FtZXMuY29tLyIgdGFyZ2V0PSJfYmxhbmsiPlNpbHZlciBHYW1lczwvYT4NCiAgICAgICAgICAgICAgICA8L2Rpdj4gLS0+DQoJICAgIDwvZGl2Pg0KCSAgPC9kaXY+DQoJICA8ZGl2IGNsYXNzPSJzZWN0aW9uIj4NCgkgICAgPGRpdiBzdHlsZT0iZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IHJvdzsgZmxleC13cmFwOiB3cmFwOyBtYXJnaW46IDEwcHg7IHBhZGRpbmc6IDJweDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Ij4NCgkgICAgICA8ZGl2IGNsYXNzPSJwYXJ0bmVyIj4NCgkgICAgICAgIDwhLS1NaXJyb3JzL1Byb3hpZXM6IDxhIGhyZWY9Imh0dHBzOi8vd3Jlc3RsZWJyb3MuaW8vbWlycm9ycy5waHAiPldyZXN0bGUgQnJvcyBVbmJsb2NrZWQgLyBXcmVzdGxlQnJvcyBVbmJsb2NrZWQ8L2E+PGJyLz4tLT4NCgkgICAgICA8L2Rpdj4NCg0KCSAgICA8L2Rpdj4NCgkgIDwvZGl2Pg0KDQoJICA8L2Rpdj4NCgkgIDxzY3JpcHQ+DQoJICAgIHZhciBsYXN0UmVmcmVzaCA9IDA7DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkMShmb3JjZWFpcCA9IGZhbHNlKSB7DQoJICAgICAgY29uc29sZS5sb2coJ1Nob3dBZDEnKTsNCgkgICAgICBMb2FkVmlkZW8oKTsNCgkgICAgICBjb25zb2xlLmxvZygnbG9hZGluZyB2aWRlbyBhZCcpOw0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KDQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCA9PT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmVzdGxlYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgICBsLnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkgICAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCg0KCSAgICAgICAgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3Jlc3RsZWJyb3MtaW9fMTYweDYwMCcpOw0KCSAgICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgfQ0KDQoNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJyAmJiBmb3JjZWFpcCA9PSBmYWxzZSkgew0KCSAgICAgICAgY29uc29sZS5sb2coJ01TIFRvd2VyJyk7DQoJICAgICAgICAkbXNzdGFydC5zaG93RGlzcGxheUFkc0FzeW5jKCdyaWdodDoxNjB4NjAwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCcxNjB4MTAwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9ub2ZpbGwnKTsNCgkgICAgICAgICAgU2hvd0FkMSh0cnVlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgICAgJG1zc3RhcnQuc2hvd0Rpc3BsYXlBZHNBc3luYygnbGVmdDoxNjB4NjAwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCcxNjB4MTAwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9ub2ZpbGwnKTsNCgkgICAgICAgICAgU2hvd0FkMSh0cnVlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpOw0KCSAgICAgICAgdmFyIG1zID0gZC5nZXRUaW1lKCk7DQoJICAgICAgICBpZiAobXMgLSBsYXN0UmVmcmVzaCA+IDEwMDAwKSB7DQoJICAgICAgICAgIHdpbmRvdy5DcmF6eUdhbWVzLlNESy5iYW5uZXIucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJ3cmVzdGxlYnJvcy1pb18xNjB4NjAwIl0pOw0KCSAgICAgICAgICBsYXN0UmVmcmVzaCA9IG1zOw0KCSAgICAgICAgfQ0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBhaXBEaXNwbGF5VGFnLnJlZnJlc2goJ3dyZXN0bGVicm9zLWlvXzE2MHg2MDAnKTsNCgkgICAgICAgIGFpcERpc3BsYXlUYWcucmVmcmVzaCgnd3Jlc3RsZWJyb3MtaW9fMTYweDYwMF8yJyk7DQoNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIHZhciBsYXN0UmVmcmVzaDYgPSAwOw0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDYoZm9yY2VhaXAgPSBmYWxzZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCdTaG93QWQ2Jyk7DQoNCgkgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCAxMjAwKSByZXR1cm47DQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3Jlc3RsZWJyb3MtaW9fMzAweDI1MCcpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcgJiYgZm9yY2VhaXAgPT0gZmFsc2UpIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCJtcyBzdGFydCBzaG93YWQ2Iik7DQoJICAgICAgICAkbXNzdGFydC5zaG93RGlzcGxheUFkc0FzeW5jKCdyaWdodDozMDB4MjUwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCczMDB4MjUwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBjb25zb2xlLmxvZygic2hvd2FkNiBub2ZpbGwiKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdtc19iYW5uZXJfbm9maWxsJyk7DQoJICAgICAgICAgIFNob3dBZDYodHJ1ZSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cuQ3JhenlHYW1lcyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTsNCgkgICAgICAgIHZhciBtcyA9IGQuZ2V0VGltZSgpOw0KCSAgICAgICAgaWYgKG1zIC0gbGFzdFJlZnJlc2g2ID4gMTAwMDApIHsNCgkgICAgICAgICAgLy9obmRsZWQgYnkgdGhlIGZpcnN0IGJhbm5lciByZXF1ZXN0DQoJICAgICAgICAgIC8vd2luZG93LkNyYXp5R2FtZXMuU0RLLnJlcXVlc3RCYW5uZXIoW3tjb250YWluZXJJZDogJ3dyZXN0bGVicm9zLWlvXzMwMHgyNTAnLHNpemU6ICczMDB4MjUwJyx9XSk7DQoJICAgICAgICAgIC8vd2luZG93LkNyYXp5R2FtZXMuU0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsid3Jlc3RsZWJyb3MtaW9fMzAweDI1MCJdKTsNCgkgICAgICAgICAgbGFzdFJlZnJlc2g2ID0gbXM7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGFpcERpc3BsYXlUYWcucmVmcmVzaCgnd3Jlc3RsZWJyb3MtaW9fMzAweDI1MCcpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcpIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkJyk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgdmFyIGxhc3RSZWZyZXNoMiA9IDA7DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkMihmb3JjZWFpcCA9IGZhbHNlKSB7DQoJICAgICAgY29uc29sZS5sb2coJ1Nob3dBZDInKTsNCg0KCSAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHJldHVybjsNCg0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmVzdGxlYnJvcy1pb18zMDB4MjUwXzInKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcgJiYgZm9yY2VhaXAgPT0gZmFsc2UpIHsNCgkgICAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOw0KCSAgICAgICAgJG1zc3RhcnQuc2hvd0Rpc3BsYXlBZHNBc3luYygnbGVmdDozMDB4MjUwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdsZWZ0IDMwMHgyNTAgcmVxdWVzdGVkLicpDQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYmFubmVyX3Nob3duJyk7DQoJICAgICAgICB9KS5jYXRjaCh0aGVFcnJvciA9PiB7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYmFubmVyX25vZmlsbCcpOw0KCSAgICAgICAgICBTaG93QWQyKHRydWUpOw0KCSAgICAgICAgfSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93LkNyYXp5R2FtZXMgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7DQoJICAgICAgICB2YXIgbXMgPSBkLmdldFRpbWUoKTsNCgkgICAgICAgIGlmIChtcyAtIGxhc3RSZWZyZXNoMiA+IDEwMDAwKSB7DQoJICAgICAgICAgIC8vaG5kbGVkIGJ5IHRoZSBmaXJzdCBiYW5uZXIgcmVxdWVzdA0KCSAgICAgICAgICAvL3dpbmRvdy5DcmF6eUdhbWVzLlNESy5yZXF1ZXN0QmFubmVyKFt7Y29udGFpbmVySWQ6ICd3cmVzdGxlYnJvcy1pb18zMDB4MjUwXzInLHNpemU6ICczMDB4MjUwJyx9XSk7DQoJICAgICAgICAgIHdpbmRvdy5DcmF6eUdhbWVzLlNESy5iYW5uZXIucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJ3cmVzdGxlYnJvcy1pb18zMDB4MjUwIiwgIndyZXN0bGVicm9zLWlvXzMwMHgyNTBfMiJdKTsNCg0KCSAgICAgICAgICBsYXN0UmVmcmVzaDIgPSBtczsNCgkgICAgICAgIH0NCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgYWlwRGlzcGxheVRhZy5yZWZyZXNoKCd3cmVzdGxlYnJvcy1pb18zMDB4MjUwXzInKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDMoZm9yY2VhaXAgPSBmYWxzZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCdTaG93QWQzJyk7DQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3Jlc3RsZWJyb3MtaW9fNzI4eDkwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJyAmJiBmb3JjZWFpcCA9PSBmYWxzZSkgew0KCSAgICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7DQoJICAgICAgICAkbXNzdGFydC5zaG93RGlzcGxheUFkc0FzeW5jKCdib3R0b206NzI4eDkwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdib3R0b206NzI4eDkwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9ub2ZpbGwnKTsNCgkgICAgICAgICAgU2hvd0FkMyh0cnVlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgd2luZG93LkNyYXp5R2FtZXMuU0RLLmJhbm5lci5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbIndyZXN0bGVicm9zLWlvXzcyOHg5MCJdKTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgYWlwRGlzcGxheVRhZy5yZWZyZXNoKCd3cmVzdGxlYnJvcy1pb183Mjh4OTAnKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDQoZm9yY2VhaXAgPSBmYWxzZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCdTaG93QWQ0Jyk7DQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCAxMjAwKSByZXR1cm47DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyZXN0bGVicm9zLWlvX3BsYXllcl8zMDB4NjAwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCg0KCSAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnICYmIGZvcmNlYWlwID09IGZhbHNlKSB7DQoJICAgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgICAkbXNzdGFydC5zaG93RGlzcGxheUFkc0FzeW5jKCdib3R0b206NzI4eDkwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdib3R0b206NzI4eDkwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9ub2ZpbGwnKTsNCgkgICAgICAgICAgU2hvd0FkNCh0cnVlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgIH0NCgkgICAgICBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgd2luZG93LkNyYXp5R2FtZXMuU0RLLmJhbm5lci5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbIndyZXN0bGVicm9zLWlvX3BsYXllcl8zMDB4NjAwIl0pOw0KCSAgICAgICAgLy93aW5kb3cuQ3JhenlHYW1lcy5TREsucmVxdWVzdEJhbm5lcihbe2NvbnRhaW5lcklkOiAnd3Jlc3RsZWJyb3MtaW9fcGxheWVyXzMwMHg2MDAnLHNpemU6ICczMDB4NjAwJyx9XSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGFpcERpc3BsYXlUYWcucmVmcmVzaCgnd3Jlc3RsZWJyb3MtaW9fcGxheWVyXzMwMHg2MDAnKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDcoZm9yY2VhaXAgPSBmYWxzZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCdTaG93QWQ3Jyk7DQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCAxMjAwKSByZXR1cm47DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyZXN0bGVicm9zLWlvXzMwMHg2MDBfbScpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHJldHVybjsNCgkgICAgICBsLnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcgJiYgZm9yY2VhaXAgPT0gZmFsc2UpIHsNCgkgICAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICAgICRtc3N0YXJ0LnNob3dEaXNwbGF5QWRzQXN5bmMoJ3JpZ2h0OjMwMHg2MDAnKS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coJ3JpZ2h0OjMwMHg2MDAgcmVxdWVzdGVkLicpDQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYmFubmVyX3Nob3duJyk7DQoJICAgICAgICB9KS5jYXRjaCh0aGVFcnJvciA9PiB7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYmFubmVyX25vZmlsbCcpOw0KCSAgICAgICAgICBTaG93QWQ3KHRydWUpOw0KCSAgICAgICAgfSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93LkNyYXp5R2FtZXMgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICB3aW5kb3cuQ3JhenlHYW1lcy5TREsuYmFubmVyLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsid3Jlc3RsZWJyb3MtaW9fcGxheWVyXzMwMHg2MDAiXSk7DQoJICAgICAgICAvL3dpbmRvdy5DcmF6eUdhbWVzLlNESy5yZXF1ZXN0QmFubmVyKFt7Y29udGFpbmVySWQ6ICd3cmVzdGxlYnJvcy1pb19wbGF5ZXJfMzAweDYwMCcsc2l6ZTogJzMwMHg2MDAnLH1dKTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgYWlwRGlzcGxheVRhZy5yZWZyZXNoKCd3cmVzdGxlYnJvcy1pb18zMDB4NjAwX20nKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDgoZm9yY2VhaXAgPSBmYWxzZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCdTaG93QWQ4Jyk7DQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3Jlc3RsZWJyb3MtaW9fNzI4eDkwX20nKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnICYmIGZvcmNlYWlwID09IGZhbHNlKSB7DQoJICAgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgICAkbXNzdGFydC5zaG93RGlzcGxheUFkc0FzeW5jKCdib3R0b206NzI4eDkwJykudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdib3R0b206NzI4eDkwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9ub2ZpbGwnKTsNCgkgICAgICAgICAgU2hvd0FkOCh0cnVlKTsNCgkgICAgICAgIH0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgd2luZG93LkNyYXp5R2FtZXMuU0RLLmJhbm5lci5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbIndyZXN0bGVicm9zLWlvXzcyOHg5MCJdKTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgYWlwRGlzcGxheVRhZy5yZWZyZXNoKCd3cmVzdGxlYnJvcy1pb183Mjh4OTBfbScpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcpIFNlbmRFdmVudCgnZXZlbnQnLCAnbXNfYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkJyk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkOShmb3JjZWFpcCA9IGZhbHNlKSB7DQoJICAgICAgY29uc29sZS5sb2coJ1Nob3dBZDknKTsNCg0KCSAgICAgIGlmICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIHZhciBsID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmVzdGxlYnJvcy1pb185NzB4MjUwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJyAmJiBmb3JjZWFpcCA9PSBmYWxzZSkgew0KCSAgICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgICAgJG1zc3RhcnQuc2hvd0Rpc3BsYXlBZHNBc3luYygnYm90dG9tOjk3MHgyNTAnKS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coJ2JvdHRvbTo5NzB4MjUwIHJlcXVlc3RlZC4nKQ0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2Jhbm5lcl9zaG93bicpOw0KCSAgICAgICAgfSkuY2F0Y2godGhlRXJyb3IgPT4gew0KCSAgICAgICAgICBjb25zb2xlLmxvZygnYm90dG9tOjk3MHgyNTAgbm9maWxsJykNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdtc19iYW5uZXJfbm9maWxsJyk7DQoJICAgICAgICAgIFNob3dBZDkodHJ1ZSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cuQ3JhenlHYW1lcyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHdpbmRvdy5DcmF6eUdhbWVzLlNESy5iYW5uZXIucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJ3cmVzdGxlYnJvcy1pb185NzB4MjUwIl0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBhaXBEaXNwbGF5VGFnLnJlZnJlc2goJ3dyZXN0bGVicm9zLWlvXzk3MHgyNTAnKTsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2Jhbm5lcl9yZXF1ZXN0ZWQnKTsNCgkgICAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ21zX2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoNCg0KDQoNCg0KCSAgICBmdW5jdGlvbiByaWdodChzdHIsIGNocikgew0KCSAgICAgIHJldHVybiBzdHIuc2xpY2Uoc3RyLmxlbmd0aCAtIGNociwgc3RyLmxlbmd0aCk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTZXRDR0ludml0ZUxpbmsoKSB7DQoJICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuQ3JhenlHYW1lcyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHZhciBtZXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNnbGluayIpOw0KCSAgICAgICAgdmFyIGFTdHIgPSBtZXRhLnZhbHVlOw0KCSAgICAgICAgYVN0ciA9IHJpZ2h0KGFTdHIsIDgpOw0KCSAgICAgICAgdmFyIGFDR0xpbmsgPSB3aW5kb3cuQ3JhenlHYW1lcy5TREsuZ2FtZS5pbnZpdGVMaW5rKHsNCgkgICAgICAgICAgcm9vbUlkOiBhU3RyDQoJICAgICAgICB9KTsNCgkgICAgICAgIG1ldGEudmFsdWUgPSBhQ0dMaW5rOw0KCSAgICAgICAgbWV0YS5zZWxlY3QNCgkgICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdDb3B5JykNCgkgICAgICAgIGNvbnNvbGUubG9nKCJDT1BJRUQgQ0cgVVJMIik7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkQnJlYWsoKSB7DQoJICAgICAgLy9jaGVjayBpZiB0aGUgYWRzbGliIGlzIGxvYWRlZCBjb3JyZWN0bHkgb3IgYmxvY2tlZCBieSBhZGJsb2NrZXJzIGV0Yy4NCgkgICAgICBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgTWFpbi5Eb25lSW50ZXJzdGl0aWFsQWQoZmFsc2UpOw0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCg0KCSAgICAgIGlmICh0eXBlb2YgYWRwbGF5ZXIgPT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBNYWluLkRvbmVJbnRlcnN0aXRpYWxBZCh0cnVlKTsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgYWlwdGFnLmNtZC5wbGF5ZXIucHVzaChmdW5jdGlvbigpIHsNCgkgICAgICAgIGFkcGxheWVyLnN0YXJ0QWRCcmVhaygpOw0KCSAgICAgIH0pOw0KCSAgICB9DQoNCg0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3BlbmZsLWNvbnRlbnQiKS5hZGRFdmVudExpc3RlbmVyKCJ3aGVlbCIsIGRvU2Nyb2xsKTsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vcmUiKS5hZGRFdmVudExpc3RlbmVyKCJ3aGVlbCIsIGRvU2Nyb2xsKTsNCg0KCSAgICBmdW5jdGlvbiBkb1Njcm9sbChldmVudCkgew0KCSAgICAgIHdpbmRvdy5zY3JvbGwoMCwgd2luZG93LnNjcm9sbFkgKyBldmVudC5kZWx0YVkpOw0KCSAgICB9DQoNCg0KCSAgICAvKnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgDQoJICAgIAl2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcm9sbCcpOw0KCSAgICAJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgIT09ICd2aXNpYmxlJykgew0KCSAgICAJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgIAkJaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KQ0KCSAgICAJCXsNCgkgICAgCQkJLy9kb2N1bWVudC5hY3RpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQoJICAgIAkJCXdpbmRvdy5mb2N1cygpOw0KCSAgICAJCQl3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgCQl9DQoJICAgIAl9DQoJICAgIH0sIDEwMDApOyovDQoNCg0KCSAgICAvKgkJc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyANCgkgICAgCQkJdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyZXN0bGVicm9zLWlvXzE2MHg2MDAnKTsNCgkgICAgCQkJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgPT0gJ3Zpc2libGUnKSB7DQoJICAgIAkJCQlTaG93QWQ1KCk7DQoJICAgIAkJCX0NCgkgICAgCQl9LCAzMDAwMCk7DQoNCgkgICAgCQlzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IA0KCSAgICAJCQl2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3Jlc3RsZWJyb3MtaW9fMTYweDYwMF8yJyk7DQoJICAgIAkJCWlmKGwgIT0gbnVsbCAmJiB0eXBlb2YgbC5zdHlsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbC5zdHlsZS52aXNpYmlsaXR5ID09ICd2aXNpYmxlJykgew0KCSAgICAJCQkJU2hvd0FkMSgpOw0KCSAgICAJCQl9DQoJICAgIAkJfSwgMzIwMDApOyovDQoNCgkgICAgdmFyIHNpZCA9ICdrMGtrc3NqczVjYjh2OXZmNXM3MWdzZHNzMCcNCg0KCSAgICBmdW5jdGlvbiB1cGRhdGVTdGF0dXMoZnJvbUV2ZW50ID0gZmFsc2UpIHsNCgkgICAgICBjb25zdCByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCgkgICAgICB2YXIgYVN0ciA9ICJyZWNvcmRzZXNzaW9uLnBocD9zPSIgKyBzaWQ7DQoJICAgICAgaWYgKGZyb21FdmVudCA9PSB0cnVlKSBhU3RyID0gYVN0ciArICImZT0xIg0KCSAgICAgIHJlcS5vcGVuKCJHRVQiLCBhU3RyKTsNCgkgICAgICByZXEuc2VuZCgpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2VuZEV2ZW50KHRoZUV2ZW50LCB0aGVBY3Rpb24sIHRoZVBhcm1zID0gJycpIHsNCgkgICAgICBpZiAodGhlUGFybXMgPT0gJycpIHsNCgkgICAgICAgIGd0YWcodGhlRXZlbnQsIHRoZUFjdGlvbik7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIGd0YWcodGhlRXZlbnQsIHRoZUFjdGlvbiwgdGhlUGFybXMpOw0KCSAgICAgIH0NCgkgICAgICB1cGRhdGVTdGF0dXModHJ1ZSk7DQoJICAgICAgLy9jb25zb2xlLmxvZygiU2VuZGluZyBldmVudDogIiArIHRoZUV2ZW50ICsgIi8iICsgdGhlQWN0aW9uICsgIi8iICsgdGhlUGFybXMpOw0KCSAgICB9DQoJICAgIC8vc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7IHVwZGF0ZVN0YXR1cywgNCo2MCoxMDAwKTsJCQkNCgkgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7DQoJICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApOw0KCSAgICB9LCAyMDAwKTsNCgkgICAgdXBkYXRlU3RhdHVzKHRydWUpOw0KDQoJICAgIC8vCQlzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IA0KCSAgICAvLwkJCWNvbnNvbGUubG9nKCJhY3RpdmUgZWxlbWVudDoiICsgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5pZCk7DQoJICAgIC8vCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgLy8JCX0sIDEwMDApOw0KDQoJICAgIC8vc2V0SW50ZXJ2YWwoQ2xlYXJBZHMsIDIwMDApOwkJDQoNCgkgICAgZnVuY3Rpb24gRW1haWxTaWdudXAoKSB7DQoJICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzaWdudXAiKSB8fCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGVsZXRlbWUiKSkgcmV0dXJuOw0KCSAgICAgIGNvbnN0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpOw0KCSAgICAgIGlmcmFtZS5zcmMgPSAiaHR0cHM6Ly9ibHVld2l6YXJkLmNvbS9zdWJzY3JpYmUtdG8tYmJyb3MvIjsNCg0KCSAgICAgIC8vCQkJaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KCSAgICAgIGlmcmFtZS5zdHlsZS53aWR0aCA9ICI1NTBweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9ICIiICsgd2luZG93LmlubmVySGVpZ2h0IC0gMTAwICsgInB4IjsNCgkgICAgICBpZnJhbWUuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOw0KCSAgICAgIGlmcmFtZS5zdHlsZS50b3AgPSAiNTBweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlLmxlZnQgPSAiNTAlIjsNCgkgICAgICBpZnJhbWUuc3R5bGVbIm1hcmdpbi1sZWZ0Il0gPSAiLTIyNXB4IjsNCgkgICAgICAvL2lmcmFtZS5zdHlsZVsibWFyZ2luLXJpZ2h0Il0gPSAiLTI3NXB4IjsNCgkgICAgICBpZnJhbWUuc3R5bGVbIm1heC13aWR0aCJdID0gIjEwMCUiOw0KCSAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoImlkIiwgInNpZ251cCIpOw0KDQoJICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gR2FtZVBsYXlTdGFydCgpIHsNCgkgICAgICBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgY29uc29sZS5sb2coIkdhbWVQbGF5U3RhcnQiKTsNCgkgICAgICAgIHdpbmRvdy5DcmF6eUdhbWVzLlNESy5nYW1lLmdhbWVwbGF5U3RhcnQoKTsNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBHYW1lUGxheVN0b3AoKSB7DQoJICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuQ3JhenlHYW1lcyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCJHYW1lUGxheVN0b3AiKTsNCgkgICAgICAgIHdpbmRvdy5DcmF6eUdhbWVzLlNESy5nYW1lLmdhbWVwbGF5U3RvcCgpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIEhhcHB5VGltZSgpIHsNCgkgICAgICBpZiAodHlwZW9mIHdpbmRvdy5DcmF6eUdhbWVzICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgY29uc29sZS5sb2coImhhcHB5dGltZSIpOw0KCSAgICAgICAgd2luZG93LkNyYXp5R2FtZXMuU0RLLmdhbWUuaGFwcHl0aW1lKCk7DQoJICAgICAgfQ0KCSAgICB9DQoJICA8L3NjcmlwdD4NCg0KCTwvYm9keT4NCg0KCTwvaHRtbD4=";
