window.game = "DQoNCjwhRE9DVFlQRSBodG1sPg0KDQoNCjwhLS0gVWx0aW1hdGUgR2FtZSBTdGFzaCBmaWxlLS0+IA0KPCEtLSBGb3IgdGhlIHJlZ3VsYXJseSB1cGRhdGluZyBkb2MgZ28gdG8gaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xX0ZtSDNCbFNCUUk3RkdnQVFMNTktWlBlOGVDeHMzNXdlbDZKVXlWYUc4US8gLS0+DQoNCg0KDQo8aHRtbCBsYW5nPSJlbiI+PGhlYWQ+PHNjcmlwdCBhc3luYz0iIiBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZS1hbmFseXRpY3MuY29tL2FuYWx5dGljcy5qcyI+PC9zY3JpcHQ+PHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIGlkPSJhbmFseXRpY3MiIGFzeW5jPSIiIHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3N0Mzkvc2RrQG1haW4vZ2EuanMiPjwvc2NyaXB0PjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBhc3luYz0iIiBzcmM9Imh0dHBzOi8vaW1hc2RrLmdvb2dsZWFwaXMuY29tL2pzL3Nka2xvYWRlci9pbWEzLmpzIj48L3NjcmlwdD48c2NyaXB0IGlkPSJnYW1lbW9uZXRpemUtc2RrIiBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zdDM5L3Nka0BtYWluL3Nka2pzLmpzIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iLy93d3cuZ29vZ2xlLmNvbS9qc2FwaSI+PC9zY3JpcHQ+PHNjcmlwdD53aW5kb3cucGFyZW50Lm1hZUV4cG9ydEFwaXNfKCk7PC9zY3JpcHQ+DQoNCg0KPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiPg0KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iPg0KPHN0eWxlPmh0bWx7Ym94LXNpemluZzpib3JkZXItYm94fSosKjpiZWZvcmUsKjphZnRlcntib3gtc2l6aW5nOmluaGVyaXR9aHRtbCxib2R5e2hlaWdodDoxMDAlfWNhbnZhc3tkaXNwbGF5OmJsb2NrfWJvZHl7bWFyZ2luOjB9I3VuaXR5LWNvbnRhaW5lcnt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3Bvc2l0aW9uOnJlbGF0aXZlfSN1bml0eS1jYW52YXN7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtiYWNrZ3JvdW5kOiMyMzFGMjB9I2xvYWRpbmctY292ZXJ7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyfSN1bml0eS1sb2FkaW5nLWJhcntmbGV4OjEgMSBhdXRvO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXJ9I3VuaXR5LWxvZ297dGV4dC1hbGlnbjpjZW50ZXJ9I3VuaXR5LWxvZ28gaW1ne21heC13aWR0aDo4MCU7bWF4LWhlaWdodDo4MCV9I3VuaXR5LXByb2dyZXNzLWJhci1lbXB0eXt3aWR0aDo0MCU7aGVpZ2h0OjI0cHg7bWFyZ2luOjEwcHggMjBweCAyMHB4IDEwcHg7dGV4dC1hbGlnbjpsZWZ0O2JvcmRlcjoxcHggc29saWQgd2hpdGU7cGFkZGluZzoycHh9I3VuaXR5LXByb2dyZXNzLWJhci1mdWxse3dpZHRoOjA7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDp3aGl0ZX0ubGlnaHQgI3VuaXR5LXByb2dyZXNzLWJhci1lbXB0eXtib3JkZXItY29sb3I6YmxhY2t9LmxpZ2h0ICN1bml0eS1wcm9ncmVzcy1iYXItZnVsbHtiYWNrZ3JvdW5kOmJsYWNrfS5zcGlubmVyLC5zcGlubmVyOmFmdGVye2JvcmRlci1yYWRpdXM6NTAlO3dpZHRoOjVlbTtoZWlnaHQ6NWVtfS5zcGlubmVye21hcmdpbjoxMHB4O2ZvbnQtc2l6ZToxMHB4O3Bvc2l0aW9uOnJlbGF0aXZlO3RleHQtaW5kZW50Oi05OTk5ZW07Ym9yZGVyLXRvcDoxLjFlbSBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMik7Ym9yZGVyLXJpZ2h0OjEuMWVtIHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4yKTtib3JkZXItYm90dG9tOjEuMWVtIHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4yKTtib3JkZXItbGVmdDoxLjFlbSBzb2xpZCAjZmZmZmZmO3RyYW5zZm9ybTp0cmFuc2xhdGVaKDApO2FuaW1hdGlvbjpzcGlubmVyLXNwaW4gMS4xcyBpbmZpbml0ZSBsaW5lYXJ9QGtleWZyYW1lcyBzcGlubmVyLXNwaW57MCV7dHJhbnNmb3JtOnJvdGF0ZSgwZGVnKX0gMTAwJXt0cmFuc2Zvcm06cm90YXRlKDM2MGRlZyl9fTwvc3R5bGU+DQo8c3R5bGU+IGJvZHl7b3ZlcmZsb3c6aGlkZGVuOy13ZWJraXQtdG91Y2gtY2FsbG91dDpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmU7LW1zLXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6cmdiYSgwLDAsMCwwKX08L3N0eWxlPg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0Kd2luZG93LmNvbnNvbGUgPSB7DQogICAgbG9nOiBmdW5jdGlvbiAoKSB7fSwNCiAgICB3YXJuOiBmdW5jdGlvbiAoKSB7fSwNCiAgICBlcnJvcjogZnVuY3Rpb24gKCkge30sDQogICAgaW5mbzogZnVuY3Rpb24gKCkge30sDQogICAgZGVidWc6IGZ1bmN0aW9uICgpIHt9LA0KICAgIHRyYWNlOiBmdW5jdGlvbiAoKSB7fSwNCiAgICB0YWJsZTogZnVuY3Rpb24gKCkge30sDQogICAgYXNzZXJ0OiBmdW5jdGlvbiAoKSB7fSwNCn07DQo8L3NjcmlwdD48c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogICAgd2luZG93LlNES19PUFRJT05TID0gew0KICAgICAgICBnYW1lSWQ6ICJyMnR6cHk5Y2dybjJ1NHhnemM5ejB6YnR2eG0xNm1ieSIsDQogICAgICAgIG9uRXZlbnQ6IGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICBzd2l0Y2ggKGEubmFtZSkgew0KICAgICAgICAgICAgICAgIGNhc2UgIlNES19HQU1FX1BBVVNFIjoNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAiU0RLX0dBTUVfU1RBUlQiOg0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlICJTREtfUkVBRFkiOg0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQogICAgKGZ1bmN0aW9uIChhLCBiLCBjKSB7DQogICAgICAgIHZhciBkID0gYS5nZXRFbGVtZW50c0J5VGFnTmFtZShiKVswXTsNCiAgICAgICAgaWYgKCFhLmdldEVsZW1lbnRCeUlkKGMpKSB7DQogICAgICAgICAgICB2YXIgZSA9IGEuY3JlYXRlRWxlbWVudChiKTsNCiAgICAgICAgICAgIGUuaWQgPSBjOw0KICAgICAgICAgICAgZS5zcmMgPSAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3N0Mzkvc2RrQG1haW4vc2RranMuanMiOw0KICAgICAgICAgICAgZC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCBkKTsNCiAgICAgICAgfQ0KICAgIH0pKGRvY3VtZW50LCAic2NyaXB0IiwgImdhbWVtb25ldGl6ZS1zZGsiKTsNCjwvc2NyaXB0PjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+I2J1dHRvbiB7DQogIGRpc3BsYXk6bm9uZTsNCn0NCi5pbWdiX3ZpcyB7DQogIGFuaW1hdGlvbjogaW1nYi1hbmltYXRpb24gN3MgbGluZWFyOw0KfQ0KQGtleWZyYW1lcyBpbWdiLWFuaW1hdGlvbiB7DQogIDEwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOw0KICB9DQogIDIwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDEwMHB4KTsNCiAgfQ0KICA5MCUgew0KICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMDBweCk7DQogIH0NCiAgMTAwJSB7DQogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOw0KICB9DQp9PC9zdHlsZT48L2hlYWQ+DQo8Ym9keSBjbGFzcz0iZGFyayI+DQo8ZGl2IGlkPSJ1bml0eS1jb250YWluZXIiIGNsYXNzPSJ1bml0eS1kZXNrdG9wIj4NCjxjYW52YXMgaWQ9InVuaXR5LWNhbnZhcyIgc3R5bGU9ImN1cnNvcjogZGVmYXVsdDsiIHdpZHRoPSIxMzI0IiBoZWlnaHQ9Ijg3NSI+PC9jYW52YXM+DQo8L2Rpdj4NCjxkaXYgaWQ9ImxvYWRpbmctY292ZXIiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+DQo8ZGl2IGlkPSJ1bml0eS1sb2FkaW5nLWJhciI+DQo8ZGl2IGlkPSJ1bml0eS1wcm9ncmVzcy1iYXItZW1wdHkiIHN0eWxlPSIiPg0KPGRpdiBpZD0idW5pdHktcHJvZ3Jlc3MtYmFyLWZ1bGwiIHN0eWxlPSJ3aWR0aDogMTAwJTsiPjwvZGl2Pg0KPC9kaXY+DQo8ZGl2IGNsYXNzPSJzcGlubmVyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCg0KDQoNCg0KPHNjcmlwdD4NCiAgICAgICAgICAgICAgICBjb25zdCBoaWRlRnVsbFNjcmVlbkJ1dHRvbiA9ICIiOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJ1aWxkVXJsID0gImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC94YW5hLWNtZC9kZXZAOWFkNDdmOGYyMTg2NzA0NjJmY2JiY2M5OGRjZWIyNjY0MTc2OGFmNi9zcmMvYXBwL2FwaSI7DQogICAgICAgICAgICAgICAgY29uc3QgbG9hZGVyVXJsID0gYnVpbGRVcmwgKyAiL2xvYS5qcyI7DQogICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gew0KICAgICAgICAgICAgICAgICAgICBkYXRhVXJsOiBidWlsZFVybCArICIvc3RhYmQuanMiLA0KICAgICAgICAgICAgICAgICAgICBmcmFtZXdvcmtVcmw6IGJ1aWxkVXJsICsgIi9zdGFiZi5qcyIsDQogICAgICAgICAgICAgICAgICAgIGNvZGVVcmw6IGJ1aWxkVXJsICsgIi9zdGFidy5qcyIsDQogICAgICAgICAgICAgICAgc3RyZWFtaW5nQXNzZXRzVXJsOiAiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3hhbmEtY21kL2RldkA5YWQ0N2Y4ZjIxODY3MDQ2MmZjYmJjYzk4ZGNlYjI2NjQxNzY4YWY2L3NyYy9hcHAvYXBpL1N0cmVhbWluZ0Fzc2V0cyIsDQogICAgICAgICAgICAgICAgfTsNCg0KICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktY29udGFpbmVyIik7DQogIGNvbnN0IGNhbnZhcyAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN1bml0eS1jYW52YXMiKTsNCiAgY29uc3QgbG9hZGluZ0NvdmVyICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNsb2FkaW5nLWNvdmVyIik7DQogIGNvbnN0IHByb2dyZXNzQmFyRW1wdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktcHJvZ3Jlc3MtYmFyLWVtcHR5Iik7DQogIGNvbnN0IHByb2dyZXNzQmFyRnVsbCAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdW5pdHktcHJvZ3Jlc3MtYmFyLWZ1bGwiKTsNCiAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5zcGlubmVyIik7DQogIA0KICAoZnVuY3Rpb24oKXsNCiAgY29uc3QgX2FsZXJ0ID0gd2luZG93LmFsZXJ0Ow0KICB3aW5kb3cuYWxlcnQgPSBmdW5jdGlvbihtc2cpew0KICAgIGNvbnN0IHMgPSBTdHJpbmcobXNnIHx8ICIiKTsNCiAgICBpZiAocy5pbmNsdWRlcygicmVxdWVzdFBvaW50ZXJMb2NrIikgfHwgcy5pbmNsdWRlcygicG9pbnRlciBsb2NrIikpDQogICAgICByZXR1cm47DQogICAgdHJ5IHsgcmV0dXJuIF9hbGVydC5jYWxsKHdpbmRvdywgbXNnKTsgfSBjYXRjaCB7fQ0KICB9Ow0KfSkoKTsNCg0KKGZ1bmN0aW9uKCl7DQogIGNvbnN0IHBhdGNoID0gKHByb3RvKSA9PiB7DQogICAgaWYgKCFwcm90byB8fCAhcHJvdG8ucmVxdWVzdFBvaW50ZXJMb2NrKSByZXR1cm47DQogICAgY29uc3Qgb3JpZyA9IHByb3RvLnJlcXVlc3RQb2ludGVyTG9jazsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvdG8sICdyZXF1ZXN0UG9pbnRlckxvY2snLCB7DQogICAgICBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLA0KICAgICAgdmFsdWU6IGZ1bmN0aW9uKC4uLmFyZ3Mpew0KICAgICAgICB0cnkgeyByZXR1cm4gb3JpZy5hcHBseSh0aGlzLCBhcmdzKTsgfQ0KICAgICAgICBjYXRjaChlKXsgICByZXR1cm47IH0NCiAgICAgIH0NCiAgICB9KTsNCiAgfTsNCiAgcGF0Y2goRWxlbWVudC5wcm90b3R5cGUpOw0KICBpZiAod2luZG93LkhUTUxDYW52YXNFbGVtZW50KSBwYXRjaChIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGUpOw0KDQogIGNvbnN0IGV4aXRQTCA9IGRvY3VtZW50LmV4aXRQb2ludGVyTG9jayB8fCBkb2N1bWVudC53ZWJraXRFeGl0UG9pbnRlckxvY2sgfHwgZG9jdW1lbnQubW96RXhpdFBvaW50ZXJMb2NrOw0KICBpZiAoZXhpdFBMKSB7DQogICAgZG9jdW1lbnQuZXhpdFBvaW50ZXJMb2NrID0gZnVuY3Rpb24oLi4uYXJncyl7DQogICAgICB0cnkgeyByZXR1cm4gZXhpdFBMLmFwcGx5KGRvY3VtZW50LCBhcmdzKTsgfSBjYXRjaCB7IHJldHVybjsgfQ0KICAgIH07DQogIH0NCg0KICB0cnkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsICdwb2ludGVyTG9ja0VsZW1lbnQnLCB7IGdldDogKCkgPT4gbnVsbCwgY29uZmlndXJhYmxlOiB0cnVlIH0pOyB9IGNhdGNoIHt9DQp9KSgpOw0KDQp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgKGV2KSA9PiB7DQogIGNvbnN0IHMgPSBTdHJpbmcoZXY/LnJlYXNvbiB8fCAiIik7DQogIGlmIChzLmluY2x1ZGVzKCJyZXF1ZXN0UG9pbnRlckxvY2siKSB8fCBzLmluY2x1ZGVzKCJwb2ludGVyIGxvY2siKSkgZXYucHJldmVudERlZmF1bHQoKTsNCn0pOw0KDQp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoZXYpID0+IHsNCiAgY29uc3QgcyA9IFN0cmluZyhldj8ubWVzc2FnZSB8fCAiIik7DQogIGlmIChzLmluY2x1ZGVzKCJyZXF1ZXN0UG9pbnRlckxvY2siKSB8fCBzLmluY2x1ZGVzKCJwb2ludGVyIGxvY2siKSkgZXYucHJldmVudERlZmF1bHQoKTsNCn0pOw0KDQogIGlmICgvaVBob25lfGlQYWR8aVBvZHxBbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgY29udGFpbmVyLmNsYXNzTmFtZSA9ICJ1bml0eS1tb2JpbGUiOw0KICBsb2FkaW5nQ292ZXIuc3R5bGUuZGlzcGxheSA9ICIiOw0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjb250ZXh0bWVudSIsIGUgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTsNCiAgZnVuY3Rpb24gRm9jdXNHYW1lKCl7IHdpbmRvdy5mb2N1cygpOyB0cnl7IGNhbnZhcy5mb2N1cygpOyB9Y2F0Y2h7fSB9DQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIEZvY3VzR2FtZSk7DQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgIEZvY3VzR2FtZSk7DQoNCiAgbGV0IG15R2FtZUluc3RhbmNlLCBTdGFydFVuaXR5SW5zdGFuY2U7DQoNCiAgdmFyIGVudmlyb25tZW50RGF0YSA9ICdubyBkYXRhJzsNCiAgd2luZG93LmVudmlyb25tZW50RGF0YSA9IGVudmlyb25tZW50RGF0YTsNCiAgdmFyIHJldmlld0RhdGEgPSAnZmFsc2UnOw0KDQogIGxldCBjbG91ZFNhdmVzICAgPSAnbm8gZGF0YSc7DQogIGxldCBwYXltZW50c0RhdGEgPSAnbm8gZGF0YSc7DQogIGxldCBwbGF5ZXJEYXRhICAgPSAnbm8gZGF0YSc7DQogIGxldCBwbGF5ZXIgPSBudWxsLCBwYXltZW50cyA9IG51bGwsIGluaXRHYW1lID0gZmFsc2UsIG5vd0Z1bGxBZE9wZW4gPSBmYWxzZTsNCiAgbGV0IHNka1JlYWR5ID0gZmFsc2U7DQpsZXQgX3BlbmRpbmdTYXZlID0gbnVsbDsNCg0KICBsZXQgbGFzdEFkVGltZSA9IDA7DQogIGZ1bmN0aW9uIGNhblNob3dBZCgpeyByZXR1cm4gRGF0ZS5ub3coKSAtIGxhc3RBZFRpbWUgPiAzMDAwMDsgfQ0KDQpmdW5jdGlvbiBTYXZlQ2xvdWQoanNvbkRhdGEsIGZsdXNoKSB7DQogIGlmICghcGxheWVyIHx8ICFzZGtSZWFkeSkgeyBfcGVuZGluZ1NhdmUgPSB7IGpzb25EYXRhLCBmbHVzaCB9OyByZXR1cm47IH0NCiAgdHJ5IHsgcGxheWVyLnNldERhdGEoeyBzYXZlczpbanNvbkRhdGFdIH0sIGZsdXNoKTsgfSBjYXRjaCB7fQ0KfQ0KDQpmdW5jdGlvbiBMb2FkQ2xvdWQoKSB7DQogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gew0KICAgIHRyeSB7DQogICAgICBpZiAoIXBsYXllcikgew0KICAgICAgICBjbG91ZFNhdmVzID0gJ25vIGRhdGEnOw0KICAgICAgICBzZW5kWUcoJ1NldExvYWRTYXZlcycsICdubyBkYXRhJyk7DQogICAgICAgIHJldHVybiByZXNvbHZlKCdubyBkYXRhJyk7DQogICAgICB9DQogICAgICBwbGF5ZXIuZ2V0RGF0YShbJ3NhdmVzJ10pLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIGNvbnN0IHJlcyA9IChkYXRhICYmIGRhdGEuc2F2ZXMpID8gSlNPTi5zdHJpbmdpZnkoZGF0YS5zYXZlcykgOiAnbm8gZGF0YSc7DQogICAgICAgIGNsb3VkU2F2ZXMgPSByZXM7DQogICAgICAgIHNlbmRZRygnU2V0TG9hZFNhdmVzJywgcmVzKTsNCiAgICAgICAgcmVzb2x2ZShyZXMpOw0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICBjbG91ZFNhdmVzID0gJ25vIGRhdGEnOw0KICAgICAgICBzZW5kWUcoJ1NldExvYWRTYXZlcycsICdubyBkYXRhJyk7DQogICAgICAgIHJlc29sdmUoJ25vIGRhdGEnKTsNCiAgICAgIH0pOw0KICAgIH0gY2F0Y2ggew0KICAgICAgY2xvdWRTYXZlcyA9ICdubyBkYXRhJzsNCiAgICAgIHNlbmRZRygnU2V0TG9hZFNhdmVzJywgJ25vIGRhdGEnKTsNCiAgICAgIHJlc29sdmUoJ25vIGRhdGEnKTsNCiAgICB9DQogIH0pOw0KfQ0KDQoNCmZ1bmN0aW9uIEluaXRQYXltZW50cyhzZW5kYmFjayl7DQogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSk9PnsNCiAgICB0cnl7DQogICAgICBjb25zdCBwcm9kdWN0SUQgICAgICAgICAgPSBbJ3N0YXJ0ZXJfcGFjaycsICdtZWdhX3BhY2snXTsNCiAgICAgIGNvbnN0IHRpdGxlICAgICAgICAgICAgICA9IFsnU3RhcnRlciBQYWNrJywgICdNZWdhIFBhY2snXTsNCiAgICAgIGNvbnN0IGRlc2NyaXB0aW9uICAgICAgICA9IFsnMTAwayBjb2lucyArIDEuNWsgY3J5c3RhbHMnLCAnMjUwayBjb2lucyArIDVrIGNyeXN0YWxzJ107DQogICAgICBjb25zdCBpbWFnZVVSSSAgICAgICAgICAgPSBbJycsICcnXTsNCiAgICAgIGNvbnN0IHByaWNlICAgICAgICAgICAgICA9IFsnMC4wMCcsICcwLjAwJ107DQogICAgICBjb25zdCBwcmljZVZhbHVlICAgICAgICAgPSBbMCwgMF07DQogICAgICBjb25zdCBwcmljZUN1cnJlbmN5Q29kZSAgPSBbJ1VTRCcsJ1VTRCddOw0KICAgICAgY29uc3QgY3VycmVuY3lJbWFnZVVSTCAgID0gWycnLCAnJ107DQogICAgICBjb25zdCBjb25zdW1lZCAgICAgICAgICAgPSBbdHJ1ZSwgdHJ1ZV07DQoNCiAgICAgIGNvbnN0IGpzb25QYXltZW50cyA9IHsNCiAgICAgICAgaWQ6IHByb2R1Y3RJRCwNCiAgICAgICAgdGl0bGUsDQogICAgICAgIGRlc2NyaXB0aW9uLA0KICAgICAgICBpbWFnZVVSSSwNCiAgICAgICAgcHJpY2UsDQogICAgICAgIHByaWNlVmFsdWUsDQogICAgICAgIHByaWNlQ3VycmVuY3lDb2RlLA0KICAgICAgICBjdXJyZW5jeUltYWdlVVJMLA0KICAgICAgICBjb25zdW1lZCwNCiAgICAgICAgbGFuZ3VhZ2U6ICdlbicNCiAgICAgIH07DQoNCiAgICAgIHBheW1lbnRzRGF0YSA9IEpTT04uc3RyaW5naWZ5KGpzb25QYXltZW50cyk7DQogICAgICBzZW5kWUcoJ1BheW1lbnRzRW50cmllcycsIHBheW1lbnRzRGF0YSk7DQogICAgICByZXNvbHZlKHBheW1lbnRzRGF0YSk7DQogICAgfWNhdGNoKGUpew0KICAgICAgcGF5bWVudHNEYXRhID0gJ25vIGRhdGEnOw0KICAgICAgc2VuZFlHKCdQYXltZW50c0VudHJpZXMnLCBwYXltZW50c0RhdGEpOw0KICAgICAgcmVzb2x2ZShwYXltZW50c0RhdGEpOw0KICAgIH0NCiAgfSk7DQp9DQoNCmZ1bmN0aW9uIEZ1bGxBZFNob3coKSB7DQogIGlmICghY2FuU2hvd0FkKCkpIHsgc2VuZFlHKCdDbG9zZUludGVyQWR2JywgJ2ZhbHNlJyk7IHJldHVybjsgfQ0KDQogIHRyeSB7DQogICAgaWYgKG5vd0Z1bGxBZE9wZW4pIHJldHVybjsNCiAgICBub3dGdWxsQWRPcGVuID0gdHJ1ZTsNCiAgICBsYXN0QWRUaW1lID0gRGF0ZS5ub3coKTsNCg0KICAgIHNlbmRZRygnT3BlbkludGVyQWR2Jyk7DQoNCiAgICBpZiAodHlwZW9mIHNkayAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHNkay5zaG93QmFubmVyID09PSAnZnVuY3Rpb24nKSB7DQogICAgICBzZGsuc2hvd0Jhbm5lcigpOw0KICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgIG5vd0Z1bGxBZE9wZW4gPSBmYWxzZTsNCiAgICAgICAgc2VuZFlHKCdDbG9zZUludGVyQWR2JywgJ3RydWUnKTsNCiAgICAgICAgRm9jdXNHYW1lKCk7DQogICAgICB9LCAzMDAwKTsNCiAgICB9IGVsc2Ugew0KICAgICAgbm93RnVsbEFkT3BlbiA9IGZhbHNlOw0KICAgICAgc2VuZFlHKCdDbG9zZUludGVyQWR2JywgJ2ZhbHNlJyk7DQogICAgICBGb2N1c0dhbWUoKTsNCiAgICB9DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBub3dGdWxsQWRPcGVuID0gZmFsc2U7DQogICAgc2VuZFlHKCdFcnJvckludGVyQWR2Jyk7IA0KICAgIHNlbmRZRygnQ2xvc2VJbnRlckFkdicsICdmYWxzZScpOw0KICAgIEZvY3VzR2FtZSgpOw0KICB9DQp9DQoNCmZ1bmN0aW9uIFJld2FyZGVkU2hvdyhpZCkgew0KICBpZiAoIWNhblNob3dBZCgpKSB7DQogICAgc2VuZFlHKCdSZXdhcmRVbmF2YWlsYWJsZScpOw0KICAgIHNlbmRZRygnQ2xvc2VSZXdhcmRlZEFkdicpOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIHRyeSB7DQogICAgbGFzdEFkVGltZSA9IERhdGUubm93KCk7DQogICAgc2VuZFlHKCdPcGVuUmV3YXJkZWRBZHYnKTsgDQoNCiAgICBpZiAodHlwZW9mIHNkayAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHNkay5zaG93QmFubmVyID09PSAnZnVuY3Rpb24nKSB7DQogICAgICBzZGsuc2hvd0Jhbm5lcigpOw0KICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgIHNlbmRZRygnUmV3YXJkQWR2JywgaWQpOw0KICAgICAgICBzZW5kWUcoJ0Nsb3NlUmV3YXJkZWRBZHYnLCAndHJ1ZScpOw0KICAgICAgICBGb2N1c0dhbWUoKTsNCiAgICAgIH0sIDMwMDApOw0KICAgIH0gZWxzZSB7DQogICAgICBzZW5kWUcoJ1Jld2FyZEFkdicsIGlkKTsNCiAgICAgIHNlbmRZRygnQ2xvc2VSZXdhcmRlZEFkdicsICd0cnVlJyk7DQogICAgICBGb2N1c0dhbWUoKTsNCiAgICB9DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBzZW5kWUcoJ0Vycm9yUmV3YXJkZWRBZHYnKTsNCiAgICBzZW5kWUcoJ0Nsb3NlUmV3YXJkZWRBZHYnLCAnZmFsc2UnKTsNCiAgICBGb2N1c0dhbWUoKTsNCiAgfQ0KfQ0KDQogIGNvbnN0IEZPUkNFRF9MQU5HID0gJ2VuJzsNCiAgdHJ5IHsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmF2aWdhdG9yLCAnbGFuZ3VhZ2UnLCAgeyBnZXQ6ICgpID0+ICdlbi1VUycsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9KTsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmF2aWdhdG9yLCAnbGFuZ3VhZ2VzJywgeyBnZXQ6ICgpID0+IFsnZW4tVVMnLCdlbiddLCBjb25maWd1cmFibGU6IHRydWUgfSk7DQogIH0gY2F0Y2goZSl7DQogICAgdHJ5IHsgbmF2aWdhdG9yLl9fZGVmaW5lR2V0dGVyX18oJ2xhbmd1YWdlJywgICgpPT4nZW4tVVMnKTsgfSBjYXRjaHt9DQogICAgdHJ5IHsgbmF2aWdhdG9yLl9fZGVmaW5lR2V0dGVyX18oJ2xhbmd1YWdlcycsICgpPT5bJ2VuLVVTJywnZW4nXSk7IH0gY2F0Y2h7fQ0KICB9DQogIHRyeSB7IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5sYW5nID0gJ2VuJzsgfSBjYXRjaHt9DQoNCiAgd2luZG93LllhR2FtZXMgPSB7DQogICAgaW5pdDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKChmdW5jdGlvbigpew0KICAgICAgY29uc3QgaXNNID0gL0FuZHJvaWR8aVBob25lfGlQYWR8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7DQogICAgICBjb25zdCBvYmogPSB7DQogICAgICAgIGVudmlyb25tZW50OiB7IGkxOG46eyBsYW5nOkZPUkNFRF9MQU5HLCB0bGQ6J2NvbScgfSwgYXBwOnsgaWQ6J3N0dWIuYXBwLmlkJyB9LCBicm93c2VyOnsgbGFuZzpGT1JDRURfTEFORyB9LCBwYXlsb2FkOm51bGwgfSwNCiAgICAgICAgZGV2aWNlSW5mbzogIHsgdHlwZTppc00/J21vYmlsZSc6J2Rlc2t0b3AnLCBpc01vYmlsZTooKT0+aXNNLCBpc0Rlc2t0b3A6KCk9PiFpc00sIGlzVGFibGV0OigpPT4vaVBhZHxUYWJsZXQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLCBpc1RWOigpPT5mYWxzZSB9LA0KICAgICAgICBzY3JlZW46ICAgICAgeyBmdWxsc2NyZWVuOnsgc3RhdHVzOidvZmYnLCByZXF1ZXN0KCl7IHRoaXMuc3RhdHVzPSdvbic7IH0gfSB9LA0KICAgICAgICBhZHY6IHsNCiAgICAgICAgICBzaG93RnVsbHNjcmVlbkFkdih7Y2FsbGJhY2tzfT17fSl7DQogICAgICAgICAgICB0cnl7IGNhbGxiYWNrcz8ub25PcGVuPy4oKTsgfWNhdGNoe30NCiAgICAgICAgICAgIHRyeXsgSW50ZXJBZHZTaG93KCk7IH1jYXRjaHt9DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57IHRyeXsgY2FsbGJhY2tzPy5vbkNsb3NlPy4odHJ1ZSk7IH1jYXRjaHt9IH0sMzAwKTsNCiAgICAgICAgICB9LA0KICAgICAgICAgIHNob3dSZXdhcmRlZFZpZGVvKHtjYWxsYmFja3N9PXt9KXsNCiAgICAgICAgICAgIHRyeXsgY2FsbGJhY2tzPy5vbk9wZW4/LigpOyB9Y2F0Y2h7fQ0KICAgICAgICAgICAgc2V0VGltZW91dCgoKT0+eyB0cnl7IGNhbGxiYWNrcz8ub25SZXdhcmRlZD8uKCk7IGNhbGxiYWNrcz8ub25DbG9zZT8uKCk7IH1jYXRjaHt9IH0sMzAwKTsNCiAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGZlYXR1cmVzOiB7IExvYWRpbmdBUEk6IHsgcmVhZHkoKXsgICB9IH0gfSwNCiAgICAgICAgc2VydmVyVGltZTogKCkgPT4gRGF0ZS5ub3coKSwNCiAgICAgICAgZmVlZGJhY2s6IHsNCiAgICAgICAgICBjYW5SZXZpZXc6ICAgICAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyB2YWx1ZTpmYWxzZSB9KSwNCiAgICAgICAgICByZXF1ZXN0UmV2aWV3OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBmZWVkYmFja1NlbnQ6ZmFsc2UgfSkNCiAgICAgICAgfSwNCiAgICAgICAgYXV0aDogeyBvcGVuQXV0aERpYWxvZzogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCkgfSwNCmdldFBsYXllcjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCgoKSA9PiB7DQogIGNvbnN0IEFQUF9LRVkgPSAneWcyX2Nsb3VkXycgKyAobG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lKTsNCiAgbGV0IGNhY2hlOw0KICB0cnkgeyBjYWNoZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oQVBQX0tFWSkgfHwgJ3t9Jyk7IH0gY2F0Y2ggeyBjYWNoZSA9IHt9OyB9DQogIGZ1bmN0aW9uIHBlcnNpc3QoKXsgdHJ5IHsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oQVBQX0tFWSwgSlNPTi5zdHJpbmdpZnkoY2FjaGUpKTsgfSBjYXRjaCB7fSB9DQoNCiAgcmV0dXJuIHsNCiAgICBpc0F1dGhvcml6ZWQ6ICAgKCkgPT4gdHJ1ZSwNCiAgICBnZXRNb2RlOiAgICAgICAgKCkgPT4gJ2Z1bGwnLA0KICAgIGdldE5hbWU6ICAgICAgICAoKSA9PiAnR3Vlc3QnLA0KICAgIGdldFBob3RvOiAgICAgICAoKSA9PiAnJywNCiAgICBnZXRVbmlxdWVJRDogICAgKCkgPT4gJ2d1ZXN0XycgKyAobG9jYXRpb24uaG9zdCB8fCAnbG9jYWwnKSwNCiAgICBnZXRQYXlpbmdTdGF0dXM6KCkgPT4gJ3Vua25vd24nLA0KDQogICAgc2V0RGF0YTogKG9iaiwgZmx1c2gpID0+IHsNCiAgICAgIGlmIChvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgY2FjaGUgPSB7IC4uLmNhY2hlLCAuLi5vYmogfTsNCiAgICAgICAgaWYgKGZsdXNoICE9PSBmYWxzZSkgcGVyc2lzdCgpOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0RGF0YTogKGtleXMpID0+IFByb21pc2UucmVzb2x2ZSgNCiAgICAgIEFycmF5LmlzQXJyYXkoa2V5cykgJiYga2V5cy5sZW5ndGgNCiAgICAgICAgPyBrZXlzLnJlZHVjZSgoYWNjLGspPT57IGFjY1trXT1jYWNoZVtrXTsgcmV0dXJuIGFjYzsgfSwge30pDQogICAgICAgIDogeyAuLi5jYWNoZSB9DQogICAgKQ0KICB9Ow0KfSkoKSksDQogICAgICAgIGdldFBheW1lbnRzOiAgICAgKCkgPT4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdwYXltZW50cy11bmF2YWlsYWJsZScpKSwNCiAgICAgICAgZ2V0TGVhZGVyYm9hcmRzOiAoKSA9PiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ2xlYWRlcmJvYXJkcy11bmF2YWlsYWJsZScpKSwNCiAgICAgIH07DQogICAgICB3aW5kb3cueXNkayA9IG9iajsgDQogICAgICByZXR1cm4gb2JqOw0KICAgIH0pKCkpDQogIH07DQoNCiAgZnVuY3Rpb24gc2VuZFlHKG1ldGhvZCwgYXJnKXsNCiAgICB0cnl7IGFyZz09PXVuZGVmaW5lZCA/IG15R2FtZUluc3RhbmNlPy5TZW5kTWVzc2FnZSgnWUcySW5zdGFuY2UnLCBtZXRob2QpDQogICAgICAgICAgICAgICAgICAgICAgICAgOiBteUdhbWVJbnN0YW5jZT8uU2VuZE1lc3NhZ2UoJ1lHMkluc3RhbmNlJywgbWV0aG9kLCBTdHJpbmcoYXJnKSk7IH1jYXRjaHt9DQogICAgdHJ5eyBhcmc9PT11bmRlZmluZWQgPyBteUdhbWVJbnN0YW5jZT8uU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCBtZXRob2QpDQogICAgICAgICAgICAgICAgICAgICAgICAgOiBteUdhbWVJbnN0YW5jZT8uU2VuZE1lc3NhZ2UoJ1lhbmRleEdhbWUnLCBtZXRob2QsIFN0cmluZyhhcmcpKTsgfWNhdGNoe30NCiAgfQ0KICBmdW5jdGlvbiBMb2dTdHlsZWRNZXNzYWdlKG1zZywgc3R5bGUpeyB0cnl7IGNvbnNvbGUubG9nKCclYycrKG1zZz8/JycpLCBzdHlsZXx8J2NvbG9yOiNGRkRGNzM7YmFja2dyb3VuZDojNDU0NTQ1Jyk7IH1jYXRjaHsgY29uc29sZS5sb2cobXNnKTsgfSB9DQoNCiAgZnVuY3Rpb24gUmVxdWVzdGluZ0Vudmlyb25tZW50RGF0YSgpew0KICAgIGNvbnN0IGlzTSA9IC9BbmRyb2lkfGlQaG9uZXxpUGFkfGlQb2QvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOw0KICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh7DQogICAgICBsYW5ndWFnZTogRk9SQ0VEX0xBTkcsIGRvbWFpbjonY29tJywNCiAgICAgIGRldmljZVR5cGU6IGlzTT8nbW9iaWxlJzonZGVza3RvcCcsDQogICAgICBpc01vYmlsZTppc00sIGlzRGVza3RvcDohaXNNLCBpc1RhYmxldDovaVBhZHxUYWJsZXQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLCBpc1RWOmZhbHNlLA0KICAgICAgYXBwSUQ6J3N0dWIuYXBwLmlkJywgYnJvd3Nlckxhbmc6Rk9SQ0VEX0xBTkcsIHBheWxvYWQ6bnVsbCwgcGxhdGZvcm06bmF2aWdhdG9yLnBsYXRmb3JtLCBicm93c2VyOidPdGhlcicNCiAgICB9KTsNCiAgICBlbnZpcm9ubWVudERhdGEgPSBqc29uOw0KICAgIHdpbmRvdy5lbnZpcm9ubWVudERhdGEgPSBqc29uOw0KICAgIHNlbmRZRygnU2V0RW52aXJEYXRhJywganNvbik7DQogIH0NCg0KYXN5bmMgZnVuY3Rpb24gSW5pdFBsYXllcigpew0KICB0cnl7DQogICAgY29uc3QgcCA9IGF3YWl0IHlzZGsuZ2V0UGxheWVyKCk7DQogICAgcGxheWVyID0gcDsNCiAgICBjb25zdCBhdXRoSnNvbiA9IHsNCiAgICAgIHBsYXllckF1dGg6J3Jlc29sdmVkJywNCiAgICAgIHBsYXllck5hbWU6cC5nZXROYW1lKCksDQogICAgICBwbGF5ZXJJZDpwLmdldFVuaXF1ZUlEKCksDQogICAgICBwbGF5ZXJQaG90bzpwLmdldFBob3RvKCdtZWRpdW0nKSB8fCAnbnVsbCcsDQogICAgICBwYXlpbmdTdGF0dXM6cC5nZXRQYXlpbmdTdGF0dXMoKQ0KICAgIH07DQogICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGF1dGhKc29uKTsNCiAgICBwbGF5ZXJEYXRhID0gZGF0YTsNCiAgICBzZW5kWUcoJ1NldEF1dGgnLCBkYXRhKTsNCiAgfWNhdGNoew0KICAgIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeSh7DQogICAgICBwbGF5ZXJBdXRoOidyZWplY3RlZCcsIHBsYXllck5hbWU6J3VuYXV0aG9yaXplZCcsDQogICAgICBwbGF5ZXJJZDondW5hdXRob3JpemVkJywgcGxheWVyUGhvdG86J251bGwnLCBwYXlpbmdTdGF0dXM6J3Vua25vd24nDQogICAgfSk7DQogICAgcGxheWVyRGF0YSA9IGRhdGE7DQogICAgc2VuZFlHKCdTZXRBdXRoJywgZGF0YSk7DQogIH0NCn0NCg0KZnVuY3Rpb24gZmxhc2dzRGF0YSgpIHt9DQpmdW5jdGlvbiBZRzJJbnN0YW5jZShtZXRob2QsIGFyZyl7IHNlbmRZRyhtZXRob2QsIGFyZyk7IH0NCmZ1bmN0aW9uIFBheW1lbnRzKCkge30NCmZ1bmN0aW9uIEJ1eVBheW1lbnRzKGlkKSB7DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKHBheW1lbnRzICE9IG51bGwpIHsNCiAgICAgICAgICAgIHBheW1lbnRzLnB1cmNoYXNlKGlkKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICBMb2dTdHlsZWRNZXNzYWdlKCdQdXJjaGFzZSBTdWNjZXNzJyk7DQogICAgICAgICAgICAgICAgQ29uc3VtZVB1cmNoYXNlKGlkLCB0cnVlKTsNCiAgICAgICAgICAgICAgICBGb2N1c0dhbWUoKTsNCiAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1B1cmNoYXNlIEZhaWxlZCcsIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgWUcySW5zdGFuY2UoJ09uUHVyY2hhc2VGYWlsZWQnLCBpZCk7DQogICAgICAgICAgICAgICAgRm9jdXNHYW1lKCk7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQplbHNlIHsNCiAgTG9nU3R5bGVkTWVzc2FnZSgnUGF5bWVudHMgPT0gbnVsbCcpOw0KICBzZW5kWUcoJ09uUHVyY2hhc2VGYWlsZWQnLCBpZCk7DQp9DQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdDUkFTSCBCdXkgUGF5bWVudHM6ICcsIGUubWVzc2FnZSk7DQogICAgICAgIFlHMkluc3RhbmNlKCdPblB1cmNoYXNlRmFpbGVkJywgaWQpOw0KICAgICAgICBGb2N1c0dhbWUoKTsNCiAgICB9DQp9DQogIGZ1bmN0aW9uIEludGVyQWR2U2hvdygpeyB0cnl7IEZ1bGxBZFNob3coKTsgfWNhdGNoe30gfQ0KICBmdW5jdGlvbiBSZXdhcmRlZEFkdlNob3coaWQpeyB0cnl7IFJld2FyZGVkU2hvdyhpZCk7IH1jYXRjaHt9IH0NCiAgZnVuY3Rpb24gSW5pdFJldmlldygpeyByZXZpZXdEYXRhID0gJ2ZhbHNlJzsgfQ0KICBmdW5jdGlvbiBSZXZpZXcoKXt9DQoNCmZ1bmN0aW9uIFNldExlYWRlcmJvYXJkKG5hbWUsIHNjb3JlLCBleHRyYURhdGEpIHsNCiAgdHJ5IHsNCiAgICBjb25zdCBrZXkgPSAnbGJfJyArIFN0cmluZyhuYW1lIHx8ICdkZWZhdWx0Jyk7DQogICAgY29uc3QgdmFsID0gTnVtYmVyKHNjb3JlKSB8fCAwOw0KDQogICAgbGV0IGJlc3QgPSAwOw0KICAgIHRyeSB7IGJlc3QgPSBOdW1iZXIobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSB8fCAnMCcpOyB9IGNhdGNoIHt9DQogICAgaWYgKHZhbCA+IGJlc3QpIHsNCiAgICAgIHRyeSB7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgU3RyaW5nKHZhbCkpOyB9IGNhdGNoIHt9DQogICAgfQ0KICB9IGNhdGNoIHt9DQp9DQoNCmZ1bmN0aW9uIEdldExlYWRlcmJvYXJkKG5hbWVMQiwgcXVhbnRpdHlUb3AsIHF1YW50aXR5QXJvdW5kLCBwaG90b1NpemUsIGF1dGgpIHsNCiAgdHJ5IHsNCiAgICBjb25zdCBwYXlsb2FkID0gew0KICAgICAgdGVjaG5vTmFtZTogU3RyaW5nKG5hbWVMQiB8fCAnJyksDQogICAgICBpc0RlZmF1bHQ6IGZhbHNlLA0KICAgICAgaXNJbnZlcnRTb3J0T3JkZXI6IGZhbHNlLA0KICAgICAgZGVjaW1hbE9mZnNldDogMCwNCiAgICAgIHR5cGU6ICdudW1lcmljJywNCiAgICAgIGVudHJpZXM6ICdubyBkYXRhJywNCiAgICAgIHJhbmtzOiBbXSwNCiAgICAgIHBob3RvczogW10sDQogICAgICBuYW1lczogW10sDQogICAgICBzY29yZXM6IFtdLA0KICAgICAgdW5pcXVlSURzOiBbXSwNCiAgICAgIGV4dHJhRGF0YUFycmF5OiBbXQ0KICAgIH07DQoNCiAgICBzZW5kWUcoJ0xlYWRlcmJvYXJkRW50cmllcycsIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTsNCiAgfSBjYXRjaCB7fQ0KfQ0KICANCiAgd2luZG93Ll9Jbml0RW52aXJvbm1lbnREYXRhX2pzID0gZnVuY3Rpb24oKXsgdHJ5eyBSZXF1ZXN0aW5nRW52aXJvbm1lbnREYXRhKCk7IH1jYXRjaHt9IH07DQogIHdpbmRvdy5fSW5pdFBsYXllcl9qcyAgICAgICAgICA9IGZ1bmN0aW9uKCl7IHRyeXsgSW5pdFBsYXllcigpOyB9Y2F0Y2h7fSB9Ow0KICB3aW5kb3cuX0xvYWRDbG91ZF9qcyAgICAgICAgICAgPSBmdW5jdGlvbigpeyB0cnl7IExvYWRDbG91ZCgpOyB9Y2F0Y2h7fSB9Ow0KICB3aW5kb3cuX0ludGVyQWR2U2hvd19qcyAgICAgICAgPSBmdW5jdGlvbigpeyB0cnl7IEludGVyQWR2U2hvdygpOyB9Y2F0Y2h7fSB9Ow0KICB3aW5kb3cuX1Jld2FyZGVkQWR2U2hvd19qcyAgICAgPSBmdW5jdGlvbihpZCl7IHRyeXsgUmV3YXJkZWRBZHZTaG93KGlkKTsgfWNhdGNoe30gfTsNCiAgd2luZG93Ll9PcGVuQXV0aERpYWxvZ19qcyAgICAgID0gZnVuY3Rpb24oKXsgdHJ5eyBPcGVuQXV0aERpYWxvZygpOyB9Y2F0Y2h7fSB9Ow0KICB3aW5kb3cuX0luaXRQYXltZW50c19qcyA9IGZ1bmN0aW9uICgpIHsNCiAgdHJ5IHsNCiAgICBwYXltZW50c0RhdGEgPSAnbm8gZGF0YSc7DQogICAgc2VuZFlHKCdQYXltZW50c0VudHJpZXMnLCAnbm8gZGF0YScpOw0KICB9IGNhdGNoIHt9DQp9Ow0KDQooYXN5bmMgZnVuY3Rpb24oKXsNCiAgdHJ5eyBhd2FpdCB3aW5kb3cuWWFHYW1lcy5pbml0KCk7IH1jYXRjaHt9DQogIGNvbnN0IHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsNCiAgcy5zcmMgPSBsb2FkZXJVcmw7DQogIHMub25sb2FkID0gKCkgPT4gew0KICAgIFN0YXJ0VW5pdHlJbnN0YW5jZSA9IGZ1bmN0aW9uKCl7DQogICAgICBjcmVhdGVVbml0eUluc3RhbmNlKGNhbnZhcywgY29uZmlnLCAocCk9PnsNCiAgICAgICAgc3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICBwcm9ncmVzc0JhckVtcHR5LnN0eWxlLmRpc3BsYXkgPSAiIjsNCiAgICAgICAgcHJvZ3Jlc3NCYXJGdWxsLnN0eWxlLndpZHRoID0gYCR7MTAwKnB9JWA7DQogICAgICB9KS50aGVuKCh1KT0+ew0KICAgICAgICBteUdhbWVJbnN0YW5jZSA9IHU7DQogICAgICAgIGxvYWRpbmdDb3Zlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KDQogICAgICAgIChhc3luYyBmdW5jdGlvbiBib290c3RyYXAoKXsNCiAgICAgICAgICB0cnl7DQogICAgICAgICAgICBSZXF1ZXN0aW5nRW52aXJvbm1lbnREYXRhKCk7DQogICAgICAgICAgICBhd2FpdCBJbml0UGxheWVyKCk7DQogICAgICAgICAgICBhd2FpdCBMb2FkQ2xvdWQoKTsNCgkJCWF3YWl0IEluaXRQYXltZW50cygpOw0KICAgICAgICAgIH1jYXRjaHt9DQogICAgICAgICAgc2RrUmVhZHkgPSB0cnVlOw0KICAgICAgICAgIGlmIChfcGVuZGluZ1NhdmUpIHsNCiAgICAgICAgICAgIHRyeSB7IHBsYXllci5zZXREYXRhKHsgc2F2ZXM6W19wZW5kaW5nU2F2ZS5qc29uRGF0YV0gfSwgX3BlbmRpbmdTYXZlLmZsdXNoKTsgfSBjYXRjaCB7fQ0KICAgICAgICAgICAgX3BlbmRpbmdTYXZlID0gbnVsbDsNCiAgICAgICAgICB9DQogICAgICAgICAgc2VuZFlHKCdJbml0U0RLQ29tcGxldGUnKTsNCiAgICAgICAgfSkoKTsNCg0KICAgICAgfSkuY2F0Y2goKGUpPT57IGNvbnNvbGUuZXJyb3IoZSk7IH0pOw0KICAgIH07DQogICAgU3RhcnRVbml0eUluc3RhbmNlKCk7DQogIH07DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocyk7DQp9KSgpOw0KDQogIGZ1bmN0aW9uIEdldFBheW1lbnRzKCl7IGNvbnNvbGUud2FybigiR2V0UGF5bWVudHMgaXMgbm90IGltcGxlbWVudGVkIik7IHJldHVybiBQcm9taXNlLnJlc29sdmUoIm5vIGRhdGEiKTsgfQ0KICBmdW5jdGlvbiBHZXRMZWFkZXJib2FyZFNjb3JlcygpIHt9DQogIGZ1bmN0aW9uIENvbnN1bWVQdXJjaGFzZXMoKSB7ICAgfQ0KICBmdW5jdGlvbiBPcGVuQXV0aERpYWxvZygpeyBpZihteUdhbWVJbnN0YW5jZSl7IG15R2FtZUluc3RhbmNlLlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywnR2V0RGF0YUludm9rZScpOyB9IH0NCiAgZnVuY3Rpb24gSW5pdEdhbWUoKXsgaW5pdEdhbWU9dHJ1ZTsgaWYobm93RnVsbEFkT3BlbikgbXlHYW1lSW5zdGFuY2U/LlNlbmRNZXNzYWdlKCdZYW5kZXhHYW1lJywnT3BlbkZ1bGxBZCcpOyB9DQogIGZ1bmN0aW9uIEdhbWVSZWFkeUFQSSgpe30NCjwvc2NyaXB0PjxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gveGFuYS1jbWQvZGV2QDlhZDQ3ZjhmMjE4NjcwNDYyZmNiYmNjOThkY2ViMjY2NDE3NjhhZjYvc3JjL2FwcC9hcGkvbG9hLmpzIj48L3NjcmlwdD4NCg0KPC9zY3JpcHQ+PC9ib2R5PjwvaHRtbD4=";
