window.game = "PCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KPCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQogICAgPGhlYWQ+DQogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+DQogICAgICAgIDx0aXRsZT5UZXJyaXRvcmlhbC5pbzwvdGl0bGU+DQogICAgICAgIDxtZXRhIG5hbWU9ImRlc2NyaXB0aW9uIiBjb250ZW50PSJUZXJyaXRvcmlhbC5pbyAtIFRoZSBBcnQgb2YgQ29ucXVlc3QiPg0KICAgICAgICA8bWV0YSBuYW1lPSJrZXl3b3JkcyIgY29udGVudD0idGVycml0b3JpYWwuaW8sIHRlcnJpdG9yaWFsLCB0ZXJyaXRvcmlhbCBnYW1lLCBjb25xdWVzdCBnYW1lLCBjb25xdWVyIGdhbWUsIHRlcnJpdG9yeSBnYW1lIj4NCiAgICAgICAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJEYXZpZCBUc2NoYWNoZXIiPg0KICAgICAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBtYXhpbXVtLXNjYWxlPTEiPg0KICAgICAgICA8c3R5bGU+DQogICAgICAgICAgICBodG1sLCBib2R5IHsNCiAgICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7DQogICAgICAgICAgICAgICAgbWFyZ2luOiAwOw0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IGJsYWNrOw0KICAgICAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgKiB7DQogICAgICAgICAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYSB7DQogICAgICAgICAgICAgICAgY29sb3I6IHJnYigyMjUsIDIyNSwgMjU1KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgPC9zdHlsZT4NCiAgICA8L2hlYWQ+DQogICAgPGJvZHk+DQogICAgICAgIDxjYW52YXMgaWQ9ImNhbnZhc0EiIHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4Ij48L2NhbnZhcz4NCiAgICAgICAgPHNjcmlwdD4NCiAgICAgICAgICAgICJ1c2Ugc3RyaWN0IjsNCiAgICAgICAgICAgIChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgUyA9IFsiZGl2IiwgIjEwMCUiLCAi4qyF77iPICIsICJhYnNvbHV0ZSIsICJjYW52YXMiLCAibm9uZSIsICJpbmhlcml0IiwgInJnYigiLCAicmdiYSgiLCAiYXV0byIsICJjZW50ZXIiLCAiPGJyPiIsICIwLjc1ZW0iLCAiICAgIiwgInNwYW4iLCAiaGlkZGVuIiwgImZsZXgiLCAiMWVtIiwgIkRhdGEiLCAiMC44ZW0iLCAiIC8gIiwgInRlcnJpdG9yaWFsLmlvIiwgImlucHV0IiwgImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFEQUFBQUFLQVFNQUFBRElMVThQQUFBQUJsQk1WRVVBQUFELy8vK2wyWi9kQUFBQU9rbEVRVlFJMTJQNDhlZlBINXYvREVEeVQ4MS9oak1IRGh4SWtXQTRBcVYrL1BnQnBmNUpnT1dBMUIwZ2RVeUM0Y2VmQTMrQTFBY3dCUUFsR3l1MXJlVzFaZ0FBQUFCSlJVNUVya0pnZ2c9PSIsICJjbGljayIsICIwLjVlbSIsICInIHRhcmdldD0nX2JsYW5rJz4iLCAidW5kZWZpbmVkIiwgInByZSIsICI8L2E+IiwgInNjcm9sbCIsICJwb2ludGVyIiwgInBhc3N3b3JkIiwgIm1pZGRsZSIsICJmdW5jdGlvbiIsICJicmVhay13b3JkIiwgImJvbGQiLCAiVmFsdWUiLCAiRXNjYXBlIiwgIkVudGVyIiwgIjEuNWVtIiwgIjAuNmVtIiwgIjAuNGVtIiwgInRleHQiLCAic3RyaW5nIiwgInJnYmEoMCwwLDAsMC44KSIsICJudW1iZXIiLCAibm93cmFwIiwgIm1vdXNlbGVhdmUiLCAiaW5saW5lLWJsb2NrIiwgImZvY3VzIiwgImJsdXIiLCAiU3BhY2UiLCAiUmVwb3J0IiwgIlBsYXllciAiLCAiTm9TdGFjayIsICI8YSBocmVmPSciLCAiNTAlIiwgIjEuMmVtIiwgIjEuMGVtIiwgIjBweCIsICIwLjNlbSIsICIwLjBlbSAwLjllbSIsICIgdm90ZWQgd2l0aCAiLCAiICDigKIgIiwgIiAgIEdvbGQ6ICIsICLwn5SEIFJlbG9hZCIsICJ3aGVlbCIsICJ1bmRlcmxpbmUiLCAidG9wIiwgInRsczciLCAic2Fucy1zZXJpZiIsICJyZ2JhKDE0MCwxMCwxMCwwLjc1KSIsICJyZ2JhKDEwMCwwLDAsMC44KSIsICJyZ2JhKDEwLDE0MCwxMCwwLjc1KSIsICJyZ2JhKDAsMTAwLDAsMC44KSIsICJyZ2JhKDAsIiwgInJnYigxMCwyMjAsMTApIiwgInByZS13cmFwIiwgInBsYWNlaG9sZGVyIiwgIm1vdXNlb3ZlciIsICJtb3VzZW91dCIsICJsb25nIiwgImxvZ28iLCAibG9hZGluZyIsICJrZXlkb3duIiwgIml0YWxpYyAiLCAiZmlsZSIsICJlcnJvciIsICJlbi1VUyIsICJkYXRhOmltYWdlL3BuZztiYXNlNjQsIiwgImJyZWFrLWFsbCIsICJibHVyKDRweCkiLCAiYXJlbmEiLCAiYWNjb3VudCIsICJhY2NlcHQiLCAiX2JsYW5rIiwgIltSZWRhY3RlZCBNZXNzYWdlXSIsICJTZWVkIiwgIlJlbG9hZCIsICJQYXRyZW9uIiwgIkludGVyZXN0IiwgIkdvbGQgU2VpenVyZSIsICJFbG8gRGVkdWN0aW9uIiwgIkJvdCAiLCAiQmF0dGxlIFJveWFsZSIsICJCYWNrIiwgIkFyaWFsIEJsYWNrLCBzYW5zLXNlcmlmIiwgIkByb29tIiwgIjF2MSIsICIxLjRlbSIsICIxIE1pbnV0ZSIsICIxIEhvdXIiLCAiMSBEYXkiLCAiMDAwIiwgIjAuNGVtIDBlbSIsICIwLjJlbSIsICIwLjAyZW0gYnJvd24iLCAiLiBEdXJhdGlvbjogeCIsICIsMCwwLjg1KSIsICIgc29saWQgd2hpdGU7fSIsICIgUmFuazogIiwgIiAvIDE2MCIsICIgLT4gIl07DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGI7DQogICAgICAgICAgICAgICAgICAgIHZhciBjOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoU1s4OF0sIGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBlLmxpbmVubyArICIgIiArIGUuY29sbm8gKyAifCIgKyBmKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZXJmb3JtYW5jZS5tZW1vcnkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5wdXNoKE1hdGguZmxvb3IocGVyZm9ybWFuY2UubWVtb3J5LmpzSGVhcFNpemVMaW1pdCAvIDEwMDAwMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2goTWF0aC5mbG9vcihwZXJmb3JtYW5jZS5tZW1vcnkudG90YWxKU0hlYXBTaXplIC8gMTAwMDAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChNYXRoLmZsb29yKHBlcmZvcm1hbmNlLm1lbW9yeS51c2VkSlNIZWFwU2l6ZSAvIDEwMDAwMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYyArICJ8IiArIGcuam9pbigiICIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYyArICJ8UiIgKyBoLmkgKyAiLCIgKyBoLmogKyAiLCIgKyBoLmsudG9GaXhlZCgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IGMgKyAifCIgKyBlLm1lc3NhZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwgJiYgbC5tID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBsLm4gKyAifCIgKyBvLnAuam9pbigiLCIpICsgInwiICsgYzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUubGluZW5vIDwgNDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9ICJXaGF0IGhhcHBlbmVkPyBQbGVhc2Ugc2VuZCB1cyBhIGRldGFpbGVkIGVtYWlsIHRvIGRhdmlkdHNjaGFjaGVyQGdtYWlsLmNvbSBzbyB3ZSBjYW4gZml4IHRoaXMgZXJyb3IhIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciArPSAiPGJyPkVycm9yIE1lc3NhZ2U6ICIgKyBjOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDQsIDUsIG5ldyB2KCLwn6SWIEJlZXAgQm9vcCEgQW4gZXJyb3Igb2NjdXJyZWQuIixyLHRydWUsW25ldyB3KCJDbG9zZSIsZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS56KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoU1s5OV0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5hMigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICldKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAiU0V8IiArIGMgKyAifCIgKyBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiID0gbmV3IFdlYlNvY2tldCgid3NzOi8vdGVycml0b3JpYWwuaW8vczUyLyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYi5vbm9wZW4gPSBhMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIub25jbG9zZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWUuZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU1s1NV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhY2sgPSBlLmVycm9yLnN0YWNrOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFjayB8fCAhc3RhY2subGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNbNTVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1ID0gbmV3IFJlZ0V4cCgiOihbMC05XSspOihbMC05XSspIiwiZyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IGE1LmV4ZWMoc3RhY2spKSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBhcnNlSW50KG1hdGNoWzFdLCAxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBhcnNlSW50KG1hdGNoWzJdLCAxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNbNTVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKCIgIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWIgfHwgYi5yZWFkeVN0YXRlICE9PSBiLk9QRU4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IG5ldyBhNigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hNygxICsgNiArIDIgKyAxICsgMSArIDEgKyA3ICogMjI4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDYsIDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyLCBhMCA/IGEwLmlkIDogMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIGwuYTkgPyAxIDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIGwuYUEgPyAxIDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIGwgPyBsLm0gOiAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBjLmxlbmd0aCAmJiBhQiA8IDIyODsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoNywgYy5jaGFyQ29kZUF0KGFCKSAlIDEyOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiLnNlbmQoaS5hQyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYi5vbmNsb3NlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIub25vcGVuID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFNbODhdLCBkKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgYSgpOw0KICAgICAgICAgICAgICAgIHZhciBsOw0KICAgICAgICAgICAgICAgIHZhciBhRDsNCiAgICAgICAgICAgICAgICB2YXIgYUU7DQogICAgICAgICAgICAgICAgdmFyIGFGOw0KICAgICAgICAgICAgICAgIHZhciBhRzsNCiAgICAgICAgICAgICAgICB2YXIgYUg7DQogICAgICAgICAgICAgICAgdmFyIGFJOw0KICAgICAgICAgICAgICAgIHZhciBhSjsNCiAgICAgICAgICAgICAgICB2YXIgYUs7DQogICAgICAgICAgICAgICAgdmFyIGFMOw0KICAgICAgICAgICAgICAgIHZhciBhTTsNCiAgICAgICAgICAgICAgICB2YXIgYU47DQogICAgICAgICAgICAgICAgdmFyIGFPOw0KICAgICAgICAgICAgICAgIHZhciBhUDsNCiAgICAgICAgICAgICAgICB2YXIgYVE7DQogICAgICAgICAgICAgICAgdmFyIGFSOw0KICAgICAgICAgICAgICAgIHZhciBhUzsNCiAgICAgICAgICAgICAgICB2YXIgYVQ7DQogICAgICAgICAgICAgICAgdmFyIGFVOw0KICAgICAgICAgICAgICAgIHZhciBhVjsNCiAgICAgICAgICAgICAgICB2YXIgYVc7DQogICAgICAgICAgICAgICAgdmFyIGFYOw0KICAgICAgICAgICAgICAgIHZhciBhWTsNCiAgICAgICAgICAgICAgICB2YXIgYVo7DQogICAgICAgICAgICAgICAgdmFyIGFhOw0KICAgICAgICAgICAgICAgIHZhciBhYjsNCiAgICAgICAgICAgICAgICB2YXIgYWM7DQogICAgICAgICAgICAgICAgdmFyIGFkOw0KICAgICAgICAgICAgICAgIHZhciBhZTsNCiAgICAgICAgICAgICAgICB2YXIgYWY7DQogICAgICAgICAgICAgICAgdmFyIGFnOw0KICAgICAgICAgICAgICAgIHZhciBhaDsNCiAgICAgICAgICAgICAgICB2YXIgYWk7DQogICAgICAgICAgICAgICAgdmFyIGFqOw0KICAgICAgICAgICAgICAgIHZhciBhazsNCiAgICAgICAgICAgICAgICB2YXIgYWw7DQogICAgICAgICAgICAgICAgdmFyIGFtOw0KICAgICAgICAgICAgICAgIHZhciBhbjsNCiAgICAgICAgICAgICAgICB2YXIgYW87DQogICAgICAgICAgICAgICAgdmFyIGFwOw0KICAgICAgICAgICAgICAgIHZhciBhcTsNCiAgICAgICAgICAgICAgICB2YXIgYXI7DQogICAgICAgICAgICAgICAgdmFyIGF0Ow0KICAgICAgICAgICAgICAgIHZhciBhdTsNCiAgICAgICAgICAgICAgICB2YXIgYXY7DQogICAgICAgICAgICAgICAgdmFyIGF3Ow0KICAgICAgICAgICAgICAgIHZhciBoOw0KICAgICAgICAgICAgICAgIHZhciBheDsNCiAgICAgICAgICAgICAgICB2YXIgYXk7DQogICAgICAgICAgICAgICAgdmFyIGF6Ow0KICAgICAgICAgICAgICAgIHZhciBiMDsNCiAgICAgICAgICAgICAgICB2YXIgYjE7DQogICAgICAgICAgICAgICAgdmFyIGIyOw0KICAgICAgICAgICAgICAgIHZhciBiMzsNCiAgICAgICAgICAgICAgICB2YXIgYjQ7DQogICAgICAgICAgICAgICAgdmFyIGI1Ow0KICAgICAgICAgICAgICAgIHZhciBiNjsNCiAgICAgICAgICAgICAgICB2YXIgYjc7DQogICAgICAgICAgICAgICAgdmFyIGI4Ow0KICAgICAgICAgICAgICAgIHZhciBiOTsNCiAgICAgICAgICAgICAgICB2YXIgYkE7DQogICAgICAgICAgICAgICAgdmFyIGJCOw0KICAgICAgICAgICAgICAgIHZhciBiQzsNCiAgICAgICAgICAgICAgICB2YXIgYkQ7DQogICAgICAgICAgICAgICAgdmFyIGJFOw0KICAgICAgICAgICAgICAgIHZhciBiRjsNCiAgICAgICAgICAgICAgICB2YXIgYkc7DQogICAgICAgICAgICAgICAgdmFyIGJIOw0KICAgICAgICAgICAgICAgIHZhciBiSTsNCiAgICAgICAgICAgICAgICB2YXIgYko7DQogICAgICAgICAgICAgICAgdmFyIGJLOw0KICAgICAgICAgICAgICAgIHZhciBiTDsNCiAgICAgICAgICAgICAgICB2YXIgYk07DQogICAgICAgICAgICAgICAgdmFyIGJOOw0KICAgICAgICAgICAgICAgIHZhciBiTzsNCiAgICAgICAgICAgICAgICB2YXIgYlA7DQogICAgICAgICAgICAgICAgdmFyIGJROw0KICAgICAgICAgICAgICAgIHZhciBiUjsNCiAgICAgICAgICAgICAgICB2YXIgYlM7DQogICAgICAgICAgICAgICAgdmFyIHQ7DQogICAgICAgICAgICAgICAgdmFyIGJUOw0KICAgICAgICAgICAgICAgIHZhciBiVTsNCiAgICAgICAgICAgICAgICB2YXIgYlY7DQogICAgICAgICAgICAgICAgdmFyIGJXOw0KICAgICAgICAgICAgICAgIHZhciBiWDsNCiAgICAgICAgICAgICAgICB2YXIgYlk7DQogICAgICAgICAgICAgICAgdmFyIGJaOw0KICAgICAgICAgICAgICAgIHZhciBiYTsNCiAgICAgICAgICAgICAgICB2YXIgYmI7DQogICAgICAgICAgICAgICAgdmFyIGJjOw0KICAgICAgICAgICAgICAgIHZhciBiZDsNCiAgICAgICAgICAgICAgICB2YXIgYmU7DQogICAgICAgICAgICAgICAgdmFyIGJmOw0KICAgICAgICAgICAgICAgIHZhciBiZzsNCiAgICAgICAgICAgICAgICB2YXIgYTA7DQogICAgICAgICAgICAgICAgdmFyIGJoOw0KICAgICAgICAgICAgICAgIHZhciBiaTsNCiAgICAgICAgICAgICAgICB2YXIgYmo7DQogICAgICAgICAgICAgICAgdmFyIG87DQogICAgICAgICAgICAgICAgdmFyIGJrOw0KICAgICAgICAgICAgICAgIHZhciBibDsNCiAgICAgICAgICAgICAgICB2YXIgYm07DQogICAgICAgICAgICAgICAgdmFyIGJuOw0KICAgICAgICAgICAgICAgIHZhciBibzsNCiAgICAgICAgICAgICAgICB2YXIgYnA7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYnEoYnIpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGwgJiYgIWJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYnMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBidCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYksgPSBuZXcgYnUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJKID0gbmV3IGJ2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOSA9IG5ldyBidygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkEgPSBuZXcgYngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEID0gbmV3IGJ5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiNiA9IG5ldyBieigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkUgPSBuZXcgYzAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJGID0gbmV3IGMxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRSA9IG5ldyBjMigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYgPSBuZXcgYzMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHID0gbmV3IGM0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSCA9IG5ldyBjNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUkgPSBuZXcgYzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKID0gbmV3IGM3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSyA9IG5ldyBjOCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUwgPSBuZXcgYzkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNID0gbmV3IGNBKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTiA9IG5ldyBjQigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU8gPSBuZXcgY0MoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFQID0gbmV3IGNEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUSA9IG5ldyBjRSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVIgPSBuZXcgY0YoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTID0gbmV3IGNHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVCA9IG5ldyBjSCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVUgPSBuZXcgY0koKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFWID0gbmV3IGNKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVyA9IG5ldyBjSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVggPSBuZXcgY0woKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFZID0gbmV3IGNNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhWiA9IG5ldyBjTigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWEgPSBuZXcgY08oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFiID0gbmV3IGNQKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhYyA9IG5ldyBjUSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWsgPSBuZXcgY1IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFsID0gbmV3IGNTKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhbSA9IG5ldyBjVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQgPSBuZXcgY1UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFlID0gbmV3IGNWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhaCA9IG5ldyBjVygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYgPSBuZXcgY1goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnID0gbmV3IGNZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhaSA9IG5ldyBjWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXkgPSBuZXcgY2EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFqID0gbmV3IGNiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhbyA9IG5ldyBjYygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXAgPSBuZXcgY2QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFxID0gbmV3IGNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBheiA9IG5ldyBjZigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXggPSBuZXcgY2coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuID0gbmV3IGNoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhciA9IG5ldyBjaSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXQgPSBuZXcgY2ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF1ID0gbmV3IGNrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoID0gbmV3IGNsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdiA9IG5ldyBjbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXcgPSBuZXcgY24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIwID0gbmV3IGNvKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiMSA9IG5ldyBjcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjIgPSBuZXcgY3EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIzID0gbmV3IGNyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiNCA9IG5ldyBjcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjUgPSBuZXcgY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI3ID0gbmV3IGN1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOCA9IG5ldyBjdigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkIgPSBuZXcgY3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDID0gbmV3IGE2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRCA9IG5ldyBjeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkcgPSBuZXcgY3koKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJIID0gbmV3IGN6KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiSSA9IG5ldyBkMCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkwgPSBuZXcgZDEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJNID0gbmV3IGQyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiTiA9IG5ldyBkMygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk8gPSBuZXcgZDQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJQID0gbmV3IGQ1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUSA9IG5ldyBkNigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIgPSBuZXcgZDcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJTID0gbmV3IGQ4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0ID0gbmV3IGQ5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiVCA9IG5ldyBkQSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTAgPSBuZXcgZEIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBuZXcgZEMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJoID0gbmV3IGREKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaSA9IG5ldyBkRSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmYgPSBuZXcgZEYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJnID0gbmV3IGRHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiWiA9IG5ldyBkSCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmEgPSBuZXcgZEkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJVID0gbmV3IGRKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiViA9IG5ldyBkSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmMgPSBuZXcgZEwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJkID0gbmV3IGRNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZSA9IG5ldyBkTigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmogPSBuZXcgZE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJiID0gbmV3IGRQKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBvID0gbmV3IGRRKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiayA9IG5ldyBkUigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmwgPSBuZXcgZFMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtID0gbmV3IGRUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBibyA9IG5ldyBkVSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnAgPSBuZXcgZFYoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkVygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoLmRZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjYuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI2LmRaKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiVyA9IG5ldyBkYSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlcuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiVS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXouZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJFLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJYID0gbmV3IGRiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5kYygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJiLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiVi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlkgPSBuZXcgZGQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF4LmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhZS5kZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlQuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFvLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhYS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVQuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFpLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiSS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWIuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIuYTcoMiwgMTQwNzEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoNSwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJILmRnKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5kaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaC5kaSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJzKCk7DQogICAgICAgICAgICAgICAgICAgIGRXKCk7DQogICAgICAgICAgICAgICAgICAgIGwubSA9IDE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRDKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRqID0gMTA5NzsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uID0gMjA3MzsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yVmVyc2lvbiA9IDk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGsgPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gKGJLLmRtKHRoaXMubiwgMTApICUgMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG4gPSAiMjkgTWFyIDIwMjUgWyIgKyBiSy5kbSh0aGlzLm4sIDEwMDApICsgIi4iICsgKGRsIDwgMTAgPyAiMCIgOiAiIikgKyBkbCArICIuIiArICh0aGlzLm4gJSAxMCkgKyAiXSI7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE5ID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihTWzIxXSkgPj0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUEgPSBkcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgJSAxMDI0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZHAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkcigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGRzID0gW0woMCksIEwoMSksIEwoMiksIEwoMyksIEwoNCksIEwoNSksIEwoNildOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZHQgPSBbMTAwLCA2MCwgMzAsIDE1LCA2LCAxXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGR1ID0gW1swLCAwLCAwLCAwLCAwXSwgWzAsIDEsIDEsIDEsIDFdLCBbMSwgMiwgMSwgMSwgMV0sIFsxLCAzLCAyLCAxLCAyXSwgWzEsIDQsIDIsIDIsIDNdLCBbMSwgNCwgMywgMywgNF0sIFsxLCA1LCAzLCAzLCA1XV07DQogICAgICAgICAgICAgICAgICAgIHZhciBkdiA9IFsiIGtpY2tlZCAiLCAiIG11dGVkICIsICIgcmVkYWN0ZWQgdGhlIHVzZXJuYW1lIG9mICIsICIgZGVkdWN0ZWQgeCBmcm9tICIsICIgc2VpemVkIHggZnJvbSAiLCAiIHJlcG9ydGVkICJdOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZHcgPSBbIktpY2siLCAiTXV0ZSIsICJVc2VybmFtZSBSZWRhY3Rpb24iLCBTWzEwM10sIFNbMTAyXSwgU1s1M11dOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZHggPSBbIi4iLCBTWzExOF0sIFNbMTE4XSwgIi4iLCAiLiIsICIuIFJlYXNvbjogeCJdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmR5ID0gW1siIiwgIiIsICIiXSwgWyIyMCBTZWNvbmRzIiwgU1sxMTFdLCAiNSBNaW51dGVzIiwgU1sxMTJdLCBTWzExM11dLCBbU1sxMTFdLCBTWzExMl0sIFNbMTEzXV0sIFsiMC4xIEVsbyBQb2ludHMiLCAiMC4yIEVsbyBQb2ludHMiLCAiMC4zIEVsbyBQb2ludHMiXSwgWyIwLjUgR29sZCIsICIxIEdvbGQiLCAiMiBHb2xkIiwgIjUgR29sZCIsICIxMCBHb2xkIl0sIFsiQmFkIFVzZXJuYW1lIiwgIkNoZWF0aW5nIG9yIEV4cGxvaXRpbmciLCAiSW5hcHByb3ByaWF0ZSBDb250ZW50IiwgIkJ1bGx5aW5nIG9yIEhhcmFzc21lbnQiXV07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZHogPSBmdW5jdGlvbihpZCwgZTAsIGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIgPSB0aGlzLmUyKGUwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiArKGR1W2FCXVtpZF0gPiBlMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmUyID0gZnVuY3Rpb24oZTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBkdC5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTAgPj0gZHRbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHQubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lMyA9IGZ1bmN0aW9uKGUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHNbdGhpcy5lMihlMCldOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lNCA9IGZ1bmN0aW9uKGlkLCBlNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGR2W2lkXS5yZXBsYWNlKG5ldyBSZWdFeHAoIngiLCJnIiksIGU1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZTYgPSBmdW5jdGlvbihpZCwgZTUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkeFtpZF0ucmVwbGFjZShuZXcgUmVnRXhwKCJ4IiwiZyIpLCBlNSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmU3ID0gZnVuY3Rpb24oaWQsIGU4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHdbaWRdICsgKHRoaXMuZHlbaWRdW2U4XS5sZW5ndGggPyAoIiAoIiArIHRoaXMuZHlbaWRdW2U4XSArICIpIikgOiAiIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkQSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lOSA9IG5ldyBlQSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5lQigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lQyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJpLmVELmRhdGFbMTYwXS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVBKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZUUgPSAxMDAwICogMjA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGIDwgZUUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSAyMi41ICogNjAgKiAxMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZUUgPSBiZS5lRiArIGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwuZGsgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5lRyhNYXRoLmZsb29yKGRsKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjVCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lSCA9IG5ldyBlSSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlSSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lSiA9IGZ1bmN0aW9uKGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJSLmVMKGJSLmVNKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5kYXRhLnBhc3NhYmxlTW91bnRhaW5zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZU4gPSBhYy5lTyhlSyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZVAoYUQuZVEsIGVOKSAmJiAhdGhpcy5lUihhRC5lUSwgZU4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVMgPSBlVChiTC5lVShlSykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVTID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVYgPSBiTC5lVyhlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZVgoZVYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVTOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllciA9IGFjLmVZKGVWKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IGFELmVRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZVoocGxheWVyLCBhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWEgPSBmdW5jdGlvbihwbGF5ZXIsIGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBiTC5lVyhlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjLmViKGVLKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTi5lY1swXSA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy5lWShlSykgIT09IGJOLmVjWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gZWYoZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmVQKHBsYXllciwgZWVbYUJdKSAmJiAhdGhpcy5lUihwbGF5ZXIsIGVlW2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJOLmVoWzBdID0gYk4uZWhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZWYoZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBsb29wOiBmb3IgKHZhciBlaiA9IDM7IGVqID49IDA7IGVqLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWsgPSBlSyArIGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWwoZWspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IGFjLmVPKGVrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVlLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSBlZVthQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJOLmVoW2VlLmxlbmd0aF0gPSBlazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWUucHVzaChpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVUKGVtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBiTC5lbyhlbSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBiTC5lcShlbSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF4ID0gTWF0aC5tYXgoYlIuZXIsIGJSLmVzKSAtIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXQgPSBtYXggKiBtYXg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBldyA9IDA7IGV3IDwgbWF4OyBldysrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVTID0gZGcoZW4sIGVwLCBldyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4ID0gYkwuZXkoZW4sIGVwLCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4IDwgZXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYgPSBlUzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXQgPSBleDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFldSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gTWF0aC5mbG9vcihNYXRoLnNxcnQoZXgpKSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXY7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZGcoZW4sIGVwLCBldykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8PSBldzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gLTE7IGV6IDwgMjsgZXogKz0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmMCA9IC0xOyBmMCA8IDI7IGYwICs9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYxID0gMDsgZjEgPCAyOyBmMSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gZjIoZW4gKyBmMSAqIGV6ICogYUIgKyAoMSAtIGYxKSAqIGYwICogZXcsIGVwICsgZjEgKiBmMCAqIGV3ICsgKDEgLSBmMSkgKiBleiAqIGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVLOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGYyKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTC5mMyhlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVMgPSBiTC5mNChlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gYkwuZVcoZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmViKGVLKSAmJiBhYy5mNShlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVQID0gZnVuY3Rpb24ocGxheWVyLCBlTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY2ID0gYWcuZjZbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGY2Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmNyA9IE1hdGgubWF4KGJLLmRtKGVnLCAxMiksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCICs9IGY3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVWID0gZjZbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWsgPSBlViArIGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVsKGVrKSAmJiBlTiA9PT0gYWMuZU8oZWspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZVIgPSBmdW5jdGlvbihwbGF5ZXIsIGVOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjYgPSBhZy5mNltwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZjYubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVYgPSBmNlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlayA9IGVWICsgZWlbZWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWwoZWspICYmIGVOID09PSBhYy5lTyhlaykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc2VsZi5haUNvbW1hbmQ3NDYgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZjggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGY4ID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkICE9PSAxIHx8IGEwLmRuIDwgMTQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiSS5mOSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkMygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mQSA9IG5ldyBVaW50MTZBcnJheSgyKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mQiA9IG5ldyBVaW50MTZBcnJheSgyKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mQyA9IG5ldyBJbnQzMkFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZEID0gbmV3IFVpbnQzMkFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZFID0gbmV3IFVpbnQzMkFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZGID0gbmV3IFVpbnQ4QXJyYXkoNCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZkcgPSBuZXcgVWludDhBcnJheSg0KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5laCA9IG5ldyBVaW50MzJBcnJheSg0KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mSCA9IG5ldyBVaW50MzJBcnJheSg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lYyA9IG5ldyBVaW50MzJBcnJheSg4KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mSSA9IG5ldyBVaW50MTZBcnJheSgxNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZkogPSBuZXcgVWludDE2QXJyYXkoNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mSyA9IG5ldyBVaW50MTZBcnJheSg1MTIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZMID0gbmV3IFVpbnQxNkFycmF5KDUxMik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZk0gPSBmdW5jdGlvbihnLCBmTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ1swXSA9IGZOOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZPID0gZnVuY3Rpb24oZywgZk4sIGZQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnWzBdID0gZk47DQogICAgICAgICAgICAgICAgICAgICAgICBnWzFdID0gZlA7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZlEgPSBmdW5jdGlvbihnLCBmTiwgZlAsIGZSKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnWzBdID0gZk47DQogICAgICAgICAgICAgICAgICAgICAgICBnWzFdID0gZlA7DQogICAgICAgICAgICAgICAgICAgICAgICBnWzJdID0gZlI7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZlMgPSBmdW5jdGlvbihnLCBmTiwgZlAsIGZSLCBmVCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ1swXSA9IGZOOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ1sxXSA9IGZQOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ1syXSA9IGZSOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ1szXSA9IGZUOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgZlU7DQogICAgICAgICAgICAgICAgdmFyIGZWOw0KICAgICAgICAgICAgICAgIHZhciBmVzsNCiAgICAgICAgICAgICAgICB2YXIgZlg7DQogICAgICAgICAgICAgICAgdmFyIGZZOw0KICAgICAgICAgICAgICAgIHZhciBmWjsNCiAgICAgICAgICAgICAgICB2YXIgZmE7DQogICAgICAgICAgICAgICAgdmFyIGZiOw0KICAgICAgICAgICAgICAgIHZhciBmYzsNCiAgICAgICAgICAgICAgICB2YXIgZmQ7DQogICAgICAgICAgICAgICAgdmFyIGZlOw0KICAgICAgICAgICAgICAgIHZhciBmZjsNCiAgICAgICAgICAgICAgICB2YXIgZmc7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZmgoKSB7DQogICAgICAgICAgICAgICAgICAgIGZhID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZmIgPSAyMDQ4Ow0KICAgICAgICAgICAgICAgICAgICBmYyA9IG5ldyBVaW50MzJBcnJheSg0ICogZmIpOw0KICAgICAgICAgICAgICAgICAgICBmZCA9IDA7DQogICAgICAgICAgICAgICAgICAgIGZlID0gbmV3IFVpbnQzMkFycmF5KGZiKTsNCiAgICAgICAgICAgICAgICAgICAgZmYgPSBuZXcgVWludDhBcnJheShiUi5lciAqIGJSLmVzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZmkocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgIGZWID0gcGxheWVyOw0KICAgICAgICAgICAgICAgICAgICBmZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBmaigpOw0KICAgICAgICAgICAgICAgICAgICBmaygpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFkLmZsKGZWKSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZC5mbShmViwgYUIpID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZlUgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChmZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm8oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmbygpIHsNCiAgICAgICAgICAgICAgICAgICAgZnAoKTsNCiAgICAgICAgICAgICAgICAgICAgZnEoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZm4oKSB7DQogICAgICAgICAgICAgICAgICAgIGZaID0gYWQuZnIoZlYsIGZVKTsNCiAgICAgICAgICAgICAgICAgICAgZlcgPSBhZC5mcyhmViwgZlUpOw0KICAgICAgICAgICAgICAgICAgICBmWCA9IGFkLmZ0KGZWLCBmVSk7DQogICAgICAgICAgICAgICAgICAgIGZ1KCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChmYSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZnYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdygpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoIWZ4KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZ2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnkoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZngoKSB7DQogICAgICAgICAgICAgICAgICAgIGZZID0gYksuZG0oZlcsIGZhKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZZID4gYUQuZnopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICghZlgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgZzAgPSBmYSAqICgxICsgYUQuZnopOw0KICAgICAgICAgICAgICAgICAgICBmVyArPSBiOS5nMS5nMihmViwgZzAgLSBmVyk7DQogICAgICAgICAgICAgICAgICAgIGZZID0gYksuZG0oZlcsIGZhKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZ3KCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBmYSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZmW2JLLmRtKGZjW2FCXSwgNCldID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmdigpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFkLmZsKGZWKSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUYuZzMoZlYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGI5LmcxLmc0KGZWLCBmVyk7DQogICAgICAgICAgICAgICAgICAgIGJjLmc1KGZWLCBmVyAtIGRsLCAxMik7DQogICAgICAgICAgICAgICAgICAgIGFkLmc2KGZWLCBmVSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZqKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gZlY7DQogICAgICAgICAgICAgICAgICAgIHZhciBnNyA9IGFnLmc3Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBNYXRoLm1pbihnN1twbGF5ZXJdLmxlbmd0aCwgZmIpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZzkgPSBmZTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGc5W2c4KytdID0gZzdbcGxheWVyXVthQl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZmQgPSBnODsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZmsoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFnLmc3W2ZWXS5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWIoYWcuZzdbZlZdW2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy5nQShhZy5nN1tmVl1bYUJdLCBmVik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYWcuZzdbZlZdID0gW107DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZ1KCkgew0KICAgICAgICAgICAgICAgICAgICBmYSA9IDA7DQogICAgICAgICAgICAgICAgICAgIGlmIChmWiA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdCKCk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnQygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdDKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZ0QsIGdFLCBlaiwgYUI7DQogICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGZkIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gZmVbYUJdICsgZWlbZWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdFID0gYksuZG0oZ0QsIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZltnRV0gPT09IDAgJiYgYWMuZ0YoZ0QpICYmIGFjLmVZKGdEKSA9PT0gZlopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmZbZ0VdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmNbZmErK10gPSBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ0IoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBnRCwgZ0UsIGVqLCBhQjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZmQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBmZVthQl0gKyBlaVtlal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0UgPSBiSy5kbShnRCwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZmW2dFXSA9PT0gMCAmJiBhYy5lWChnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmZbZ0VdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmNbZmErK10gPSBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZnkoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChnRygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnSCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZaICE9PSBhRC5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdJKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmdigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdJKCkgew0KICAgICAgICAgICAgICAgICAgICBnSigpOw0KICAgICAgICAgICAgICAgICAgICBnSyhhZy5nTFtmWl0pOw0KICAgICAgICAgICAgICAgICAgICBnSyhhZy5nTVtmWl0pOw0KICAgICAgICAgICAgICAgICAgICBpZiAoYlIuZUwoYlIuZU0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnSyhhZy5mNltmWl0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGdOKGFnLmc3W2ZaXSk7DQogICAgICAgICAgICAgICAgICAgIGdPKGFnLmdNW2ZaXSk7DQogICAgICAgICAgICAgICAgICAgIGdPKGFnLmY2W2ZaXSk7DQogICAgICAgICAgICAgICAgICAgIGdQKCk7DQogICAgICAgICAgICAgICAgICAgIGdRKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdIKCkgew0KICAgICAgICAgICAgICAgICAgICBmZyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGFkLmdSKGZWLCBmVSwgZlcpOw0KICAgICAgICAgICAgICAgICAgICBhZC5nUyhmViwgZlUpOw0KICAgICAgICAgICAgICAgICAgICBhZy5nVFtmVl0gKz0gZmE7DQogICAgICAgICAgICAgICAgICAgIGdVKCk7DQogICAgICAgICAgICAgICAgICAgIGdWKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdHKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZlogPT09IGFELmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ1coKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdYKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZ1kgPSBmYSAqIGFELmZ6Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgZ1ogPSBnYSgpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZ2IgPSBnYygpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZ2QgPSBnWSArIDIgKiBnWiArIGdiOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZ2UgPSBmWSAqIGZhOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZ2UgPiBnZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZlcgLT0gZ2Q7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5nNShmViwgZ2QsIDEzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdmKGdkIC0gZ1ksIGdiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZYICYmIGdiID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZlcgLT0gZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2UgKz0gYjkuZzEuZzIoZlYsIGdkIC0gZ2UgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYy5nNShmViwgZ2UsIDEzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZihnZSAtIGdZLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZXIC09IGdlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmMuZzUoZlYsIGdlLCAxMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBnZihnZSAtIGdZLCBnYik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2YoZ2UsIGdiKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChnYiA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZSA8PSBnYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJjLmc1KGZaLCBnZSwgMTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkLmdnKGZaLCBmViwgZ2IgLSBnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuZ2coZlosIGZWLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdlIC09IGdiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGdlID0gYksuZG0oZ2UsIDIpOw0KICAgICAgICAgICAgICAgICAgICBnZSA9IE1hdGgubWluKGFnLmdoW2ZaXSwgZ2UpOw0KICAgICAgICAgICAgICAgICAgICBiYy5nNShmWiwgZ2UsIDEzKTsNCiAgICAgICAgICAgICAgICAgICAgYWcuZ2hbZlpdIC09IGdlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnYygpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFkLmdpKGZaLCBmVik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdhKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksuZG0oZmEgKiBhZy5naFtmWl0sIDEgKyBiSy5kbSgxMCAqIGFnLmdUW2ZaXSwgMTYpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ1coKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBnaiA9IGZhICogYUQuZno7DQogICAgICAgICAgICAgICAgICAgIGZXIC09IGdqOw0KICAgICAgICAgICAgICAgICAgICBiYy5nNShmViwgZ2osIDEzKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdWKCkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGZhIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZzdbZlZdLnB1c2goZmNbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdMW2ZWXS5wdXNoKGZjW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhYy5nQShmY1thQl0sIGZWKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkOCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdsID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nbSA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ2sgPSBlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdsID0gZXA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmduID0gZnVuY3Rpb24oZ28pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCB8fCBhTS5ncSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMCkgJiYgIWI5LmcxLmdyKDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVIuZ3QoZ2ssIGdsKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSLmd1ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFQLmd0KGdrLCBnbCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBndihnbyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBndihnbykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBndyA9IGJMLmd4KGdrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBneSA9IGJMLmd6KGdsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlUyA9IGJMLmY0KGd3LCBneSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBiTC5lVyhlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJMLmgwKGd3LCBneSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjLmViKGVLKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3LmgyLmgzKGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWwoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGg0ID0gYW0uZUguZUooZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVYgPSBiTC5lVyhoNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoNSA9IGFjLmVYKGVWKSA/IGFELmVkIDogYWMuZVkoZVYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oNihhUi5oNygpLCBoNCwgaDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuaDgoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJNLmg5LmhBKGFELmVRLCBlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaEIoYVIuaDcoKSwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ28pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0uaDkuaEEoYUQuZVEsIGVTKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oQihhUi5oNygpLCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaEMoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3LmgyLmhEKGFSLmg3KCksIGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhFKGFELmVRLCBhRC5lZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjAuaEYoYUQuZWQsIGFSLmg3KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYk0uaDkuaEEoYUQuZVEsIGVTKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oQihhUi5oNygpLCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllciA9IGFjLmVZKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IGFELmVRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlWihwbGF5ZXIsIGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTS5oOS5oQShhRC5lUSwgZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3LmgyLmhCKGFSLmg3KCksIGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhHKGFELmVRLCBwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaEQoYVIuaDcoKSwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaEUoYUQuZVEsIHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiMC5oRihwbGF5ZXIsIGFSLmg3KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiTS5oOS5oQShhRC5lUSwgZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaEIoYVIuaDcoKSwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaEggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCB8fCBhTS5ncSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBhRC5lUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3MoZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWQuZmwoZ0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnIDwgMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhJKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhKID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoSyA9IGFkLmZzKGdELCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMTsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoTCA9IGFkLmZzKGdELCBhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhMIDwgaEspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBoTDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaEogPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oRChhUi5oNygpLCBhZC5mcihnRCwgaEopKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE0gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCB8fCBhTS5ncSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3MoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncigxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdi5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXYuaE8oYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaFAoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdi5oUShhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oTSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaEkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBhRC5lUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoQyhnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oRChhUi5oNygpLCBhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0wgPSBhZy5nTDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGdMW2dEXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBoUyA9IDM7IGhTID49IDA7IGhTLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhUID0gZ0xbZ0RdWyhhQiArIGhSKSAlIGVnXSArIGVpW2hTXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmdGKGhUKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhVID0gYWMuZVkoaFQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhVICE9PSBnRCAmJiAoIWFELmhWIHx8IGVaKGdELCBoVSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaEQoYVIuaDcoKSwgaFUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoVyhoWCwgc2l6ZSwgaFksIGhaLCBmb250KSB7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBoYSwgaGI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGMgPSAwLjI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gaFg7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaFg7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5mb250ID0gc2l6ZSArIGZvbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC50ZXh0QWxpZ24gPSBTWzEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnRleHRCYXNlbGluZSA9IFNbMzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZmlsbFN0eWxlID0gInJlZCI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBoWS5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsVGV4dChoWVthQl0sIDAuNSAqIGhYLCAwLjUgKiBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoYSA9IGhkLmdldEltYWdlRGF0YSgwLCAwLCBoWCwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGIgPSBoZShoYSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGIgPiAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhjID0gKGhiIC0gKDAuNSAqIGhYKSArIDAuMSAqIHNpemUpIC8gc2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChoYywgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaGUoaGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZTA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSBoYS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGVqLmxlbmd0aCAtIDQ7IGFCID49IDA7IGFCIC09IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMCA9IGVqW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTAgPj0gaFopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoYUIgLyAoNCAqIGhYKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkMSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZiA9IG5ldyBJbnQxNkFycmF5KDQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhnID0gbmV3IEludDE2QXJyYXkoNCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGZbMF0gPSAtYlIuZXI7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhmWzFdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGZbMl0gPSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGZbM10gPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhnW2FCXSA9IDQgKiB0aGlzLmhmW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGggPSBmdW5jdGlvbihoNCwgaGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoaiA9IHRoaXMuZW8oaGkpIC0gdGhpcy5lbyhoNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGsgPSB0aGlzLmVxKGhpKSAtIHRoaXMuZXEoaDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhsID0gKGhqID4+PiAzMSkgPDwgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBobSA9IGhrID4+PiAzMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBobiA9IChNYXRoLmFicyhoaikgLSBNYXRoLmFicyhoaykpID4+PiAzMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoNSArIGhsICsgKDEgLSBobCkgKiAoMSAtIChobSA8PCAxKSkgKiBobikgJiAzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5obyA9IGZ1bmN0aW9uKGg0LCBoaSwgaFMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBocDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoUyAlIDIgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBocCA9ICgodGhpcy5lbyhoaSkgLSB0aGlzLmVvKGg0KSkgPj4+IDMxKSA8PCAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaFMgKyAoMSAtIGhTKSAqICgxIC0gaHApICsgNCkgJiAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaHAgPSAoKHRoaXMuZXEoaGkpIC0gdGhpcy5lcShoNCkpID4+PiAzMSkgPDwgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoaFMgKyAoMiAtIGhTKSAqICgxIC0gaHApICsgNCkgJiAzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ocSA9IGZ1bmN0aW9uKGdELCBlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBmOCwgaGksIGhyLCBoczsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodCA9IGFnLmdNW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGh0Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYlIuZXI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHUgPSB0aGlzLmVvKGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodiA9IHRoaXMuZXEoZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVtID0gaHRbMF0gPj4gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW4gPSB0aGlzLmV5KGh1LCBodiwgZW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaSA9IGh0W2FCXSA+PiAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyID0gaHUgLSAoaGkgJSBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBocyA9IGh2IC0gfn4oKGhpICsgMC41KSAvIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gaHIgKiBociArIGhzICogaHM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4IDwgbWluKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbSA9IGhpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaHcgPSBmdW5jdGlvbihwbGF5ZXIsIGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZVgoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYXllciA9PT0gYWMuZVkoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmV5ID0gZnVuY3Rpb24oZ3csIGd5LCBlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ3cgLT0gdGhpcy5lbyhlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBneSAtPSB0aGlzLmVxKGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBndyAqIGd3ICsgZ3kgKiBneTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaHggPSBmdW5jdGlvbihoeSwgaHosIGkwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTEgPSB0aGlzLmkyKGh5KSAtIHRoaXMuaTMoaTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGk0ID0gdGhpcy5pNShoeikgLSB0aGlzLmk2KGkwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnNxcnQoaTEgKiBpMSArIGk0ICogaTQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pNyA9IGZ1bmN0aW9uKGg0LCBoaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkxID0gdGhpcy5lbyhoNCkgLSB0aGlzLmVvKGhpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpNCA9IHRoaXMuZXEoaDQpIC0gdGhpcy5lcShoaSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KGkxICogaTEgKyBpNCAqIGk0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaTggPSBmdW5jdGlvbihoNCwgaGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpMSA9IHRoaXMuZW8oaDQpIC0gdGhpcy5lbyhoaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTQgPSB0aGlzLmVxKGg0KSAtIHRoaXMuZXEoaGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkxICogaTEgKyBpNCAqIGk0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pOSA9IGZ1bmN0aW9uKGlBLCBpQiwgaUMsIGlEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpQSAtPSBpQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlCIC09IGlEOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlBICogaUEgKyBpQiAqIGlCOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pRSA9IGZ1bmN0aW9uKGdELCBpRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJLLmRtKGlGICogYWcuZ2hbZ0RdLCAxMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaTIgPSBmdW5jdGlvbihoeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE2ICogKGh5ICsgaUcpIC8gaUg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmk1ID0gZnVuY3Rpb24oaHopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNiAqIChoeiArIGlJKSAvIGlIOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pSiA9IGZ1bmN0aW9uKGVqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTYgKiBlaiAvIGlIOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5neCA9IGZ1bmN0aW9uKGh5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoaHkgKyBpRykgLyBpSCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd6ID0gZnVuY3Rpb24oaHopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKChoeiArIGlJKSAvIGlIKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaDAgPSBmdW5jdGlvbihndywgZ3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBndyA+PSAxICYmIGd5ID49IDEgJiYgZ3cgPCBiUi5lciAtIDEgJiYgZ3kgPCBiUi5lcyAtIDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVvID0gZnVuY3Rpb24oZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlUyAlIGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcSA9IGZ1bmN0aW9uKGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksuZG0oZVMsIGJSLmVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZjQgPSBmdW5jdGlvbihndywgZ3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBneSAqIGJSLmVyICsgZ3c7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlLID0gZnVuY3Rpb24oZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmYzKHRoaXMuZW8oZVMpLCB0aGlzLmVxKGVTKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmYzID0gZnVuY3Rpb24oZ3csIGd5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3cgPiAwICYmIGd3IDwgYlIuZXIgLSAxICYmIGd5ID4gMCAmJiBneSA8IGJSLmVzIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZVcgPSBmdW5jdGlvbihlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVTIDw8IDI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVVID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSyA+PiAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pTCA9IGZ1bmN0aW9uKGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChiUi5lciAqIHRoaXMuZXEoZVMpKSAqIDI1NikgKyAodGhpcy5lbyhlUykgPDwgNCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlNID0gZnVuY3Rpb24oZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlMKGVTKSArIDggKyAoYlIuZXIgPDwgNyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlOID0gZnVuY3Rpb24oaTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiUi5lciAqICh0aGlzLmk2KGkwKSA+PiA0KSArICh0aGlzLmkzKGkwKSA+PiA0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaU8gPSBmdW5jdGlvbihpMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVTID0gdGhpcy5pTihpMCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuZW8oZVMpID4+IDUpICsgYk0uaVAuaVEgKiAodGhpcy5lcShlUykgPj4gNSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmkzID0gZnVuY3Rpb24oaTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpMCAlIChiUi5lciA8PCA0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaTYgPSBmdW5jdGlvbihpMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJLLmRtKGkwLCBiUi5lciA8PCA0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaVIgPSBmdW5jdGlvbihlUywgaFMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlUyArIHRoaXMuaGZbaFNdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pUyA9IGZ1bmN0aW9uKGVLLCBoUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVLICsgdGhpcy5oZ1toU107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlUID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mNCgoYWcuaVVbcGxheWVyXSArIGFnLmlWW3BsYXllcl0pID4+IDEsIChhZy5pV1twbGF5ZXJdICsgYWcuaVhbcGxheWVyXSkgPj4gMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlZID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mNChheC5pWihhZy5pVVtwbGF5ZXJdLCBhZy5pVltwbGF5ZXJdKSwgYXguaVooYWcuaVdbcGxheWVyXSwgYWcuaVhbcGxheWVyXSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2goKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaWEgPSBuZXcgaWIoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pYyA9IG5ldyBpZSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlnID0gbmV3IGloKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybWFuY2UgPSBuZXcgaWkoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5paiA9IG5ldyBpaygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlsID0gbmV3IGltKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW8gPSBuZXcgaXAoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pYS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pZy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pai5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtYW5jZS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pYS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gaWsoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpcjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGlzID0gODsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ID0gbmV3IFVpbnQxNkFycmF5KGlzKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaXIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdSA9IGZ1bmN0aW9uKHBsYXllciwgaXYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmVjWzFdID0gYWcuZzdbcGxheWVyXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk4uZWNbMF0gPT09IGFELmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWouaXcocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5peChwbGF5ZXIsIGJOLmVjWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTi5lY1sxXSA9PT0gMCAmJiBhZy5nN1twbGF5ZXJdLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXYgJiYgYk4uZWNbMV0gPT09IGFnLmc3W3BsYXllcl0ubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJOLmVjWzBdID09PSBhRC5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLml5W3BsYXllcl0rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuaXpbcGxheWVyXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmowID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbi5pbC5qMVtwbGF5ZXJdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGoyKGJOLmVjWzFdLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuajMocGxheWVyLCBiTi5mRFswXSwgYk4uZWNbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYuajQocGxheWVyLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmo1ID0gZnVuY3Rpb24ocGxheWVyLCBqNiwgZWcsIGhLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgajcgPSBiSy5kbSgxMiAqIGFnLmdoW3BsYXllcl0sIDEwMjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaEsgLT0gaEsgPj0gYksuZG0oYWcuZ2hbcGxheWVyXSwgMikgPyBqNyA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBqMihlZywgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFkLmozKHBsYXllciwgaEssIGo2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdoW3BsYXllcl0gLT0gaEsgKyBqNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGLmo0KHBsYXllciwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5peCA9IGZ1bmN0aW9uKHBsYXllciwgajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgaFM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhZy5nTFtwbGF5ZXJdLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuajgoYWcuZ0xbcGxheWVyXVthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaFMgPSAzOyBoUyA+PSAwOyBoUy0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZ0YoYWcuZ0xbcGxheWVyXVthQl0gKyBlaVtoU10pICYmIGFjLmVZKGFnLmdMW3BsYXllcl1bYUJdICsgZWlbaFNdKSA9PT0gajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1twbGF5ZXJdLnB1c2goYWcuZ0xbcGxheWVyXVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gajIoc2l6ZSwgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFnLmc3W3BsYXllcl0ubGVuZ3RoIC0gMTsgYUIgPj0gc2l6ZTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmo5KGFnLmc3W3BsYXllcl1bYUJdLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXcgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhZy5nTFtwbGF5ZXJdLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuajgoYWcuZ0xbcGxheWVyXVthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGhTID0gMzsgaFMgPj0gMDsgaFMtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVYKGFnLmdMW3BsYXllcl1bYUJdICsgZWlbaFNdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLmc3W3BsYXllcl0ucHVzaChhZy5nTFtwbGF5ZXJdW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpBID0gZnVuY3Rpb24ocGxheWVyLCBqQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBleiwgaFMsIGhVOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWcuZ0xbcGxheWVyXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHAgPSBlZyA+PSAyNTYgPyAxMiA6IGVnID49IDMyID8gNiA6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgakMgPSBlZyAtIDEgLSBheC5qRChocCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3A6IGZvciAoYUIgPSBqQzsgYUIgPj0gMDsgYUIgLT0gaHApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGhTID0gMzsgaFMgPj0gMDsgaFMtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoVSA9IGFjLmVYKGFnLmdMW3BsYXllcl1bYUJdICsgZWlbaFNdKSA/IGFELmVkIDogYWMuZVkoYWcuZ0xbcGxheWVyXVthQl0gKyBlaVtoU10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaFUgPT09IGFELmVkIHx8IChhYy5nRihhZy5nTFtwbGF5ZXJdW2FCXSArIGVpW2hTXSkgJiYgaFUgIT09IHBsYXllciAmJiAoakIgfHwgZVoocGxheWVyLCBoVSkpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IGlyIC0gMTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdFtlel0gPT09IGhVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGxvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRbaXJdID0gaFU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKytpciA+PSBpcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlyID4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuakUgPSBmdW5jdGlvbihwbGF5ZXIsIGpCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGhTLCBoVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaXIgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFnLmdMW3BsYXllcl0ubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaFMgPSAzOyBoUyA+PSAwOyBoUy0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhVID0gYWMuZVgoYWcuZ0xbcGxheWVyXVthQl0gKyBlaVtoU10pID8gYUQuZWQgOiBhYy5lWShhZy5nTFtwbGF5ZXJdW2FCXSArIGVpW2hTXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoVSA9PT0gYUQuZWQgfHwgKGFjLmdGKGFnLmdMW3BsYXllcl1bYUJdICsgZWlbaFNdKSAmJiBoVSAhPT0gcGxheWVyICYmIChqQiB8fCBlWihwbGF5ZXIsIGhVKSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdFtpcisrXSA9IGhVOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpGID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGlyIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdFthQl0gPT09IGFELmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlyLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjAgPSBhQjsgZjAgPCBpcjsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRbZjBdID0gaXRbZjAgKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpHID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGlyIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZC5qSChwbGF5ZXIsIGl0W2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXItLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IGFCOyBmMCA8IGlyOyBmMCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdFtmMF0gPSBpdFtmMCArIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlyID09PSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qSSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGlyIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS5qSihpdFthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaksgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBpciAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmpKKGl0W2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRbYUJdID0gaXRbLS1pcl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlyID4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuakwgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgak0gPSBpdFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqTiA9IGFnLmdoW2pNXSArIGFkLmdpKGpNLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGlyIC0gMTsgYUIgPj0gMTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYwID0gYWcuZ2hbaXRbYUJdXSArIGFkLmdpKGl0W2FCXSwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjAgPCBqTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqTSA9IGl0W2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgak4gPSBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gak07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpPID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgalAgPSBpdFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpciA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBqUDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqUSA9IGJLLmRtKChhZy5pVltwbGF5ZXJdICsgYWcuaVVbcGxheWVyXSksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpSID0gYksuZG0oKGFnLmlYW3BsYXllcl0gKyBhZy5pV1twbGF5ZXJdKSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXcgPSBqUyhqUSAtIGJLLmRtKChhZy5pVltqUF0gKyBhZy5pVVtqUF0pLCAyKSkgKyBqUyhqUiAtIGJLLmRtKChhZy5pWFtqUF0gKyBhZy5pV1tqUF0pLCAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gaXIgLSAxOyBhQiA+PSAxOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGpTKGpRIC0gYksuZG0oKGFnLmlWW2l0W2FCXV0gKyBhZy5pVVtpdFthQl1dKSwgMikpICsgalMoalIgLSBiSy5kbSgoYWcuaVhbaXRbYUJdXSArIGFnLmlXW2l0W2FCXV0pLCAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPCBldykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpQID0gaXRbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBqUDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMualQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqVSA9IGl0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpWID0galVbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2ggPSBhZy5naDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqVyA9IGdoW2pWXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gaXIgLSAxOyBhQiA+PSAxOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0galVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IGdoW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjAgPiBqVykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqViA9IGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqVyA9IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBqVjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMualggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdFtheC5qRChpcildOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gaW0oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuajEgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuajEuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMualkgPSBmdW5jdGlvbihwbGF5ZXIsIGhLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFkLmpaKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgamEgPSBhZS5qYihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpjID0gYUUuaEtbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqYyA+PSAzICYmIGpjIDwgNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhLID0gTWF0aC5tYXgoYWcuZ2hbcGxheWVyXSAtIGphLCBoSyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgamQgPSBhZy5nTVtwbGF5ZXJdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqZSA9IGFnLmdMW3BsYXllcl0ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDMwICogYWcuZ1RbcGxheWVyXSA+IGFELmpmICYmIGpnW3BsYXllcl0gPCAxMCAmJiBqZCA+PSAxMDAgKiBqZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFLmpoKHBsYXllciwgMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgamkocGxheWVyLCBoSywgamMsIGphKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWplIHx8IChqZCAmJiAoamQgPCBqZSAmJiAhYXguakQoMTApIHx8IGpkID49IDEwMCAqIGplICYmIGF4LmpEKDMpIHx8ICFheC5qRCg4KSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJNLmpqLmlxKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGprKHBsYXllciwgaEssIGpjKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGppKHBsYXllciwgaEssIGpjLCBqYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWwuajFbcGxheWVyXSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgajY7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW4uaWouakEocGxheWVyLCBmYWxzZSkgfHwgYW4uaWouakUocGxheWVyLCBmYWxzZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW4uaWouakcocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbi5pai5qRigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpsKHBsYXllciwgaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqbShwbGF5ZXIsIGFELmVkLCBqYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF4LmpuKGFFLmpvW2pjXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgajYgPSBhbi5pai5qTChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqcChwbGF5ZXIsIGhLLCBqNiwgamMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbi5pai5qSSgpICYmIGF4LmpuKGFFLmpxW2pjXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlqLmpLKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpjID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqcChwbGF5ZXIsIGhLLCBhbi5pai5qWCgpLCBqYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgajYgPSBhbi5pai5qTyhwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqcChwbGF5ZXIsIGhLLCBqNiwgamMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqbShwbGF5ZXIsIGo2LCBqYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJNLmpqLmlxKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW4uaW8uaXEocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlsLmoxW3BsYXllcl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAganIocGxheWVyLCBoSywgamMsIGphKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBqbShwbGF5ZXIsIGo2LCBqYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpjID49IDMgJiYgYmUuanMoKSA+IDIxNDIgJiYgKGo2ID09PSBhRC5lZCB8fCBhZy5naFtqNl0gPCBiSy5kbShhZy5naFtwbGF5ZXJdLCAyMCkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUUuamgocGxheWVyLCAyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ganIocGxheWVyLCBoSywgamMsIGphKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGYwLCBmMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZSA9IGJmLmVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp0ID0gZWVbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqdCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnaCA9IGFnLmdoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp1ID0gZ2hbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnVCA9IGFnLmdUOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYXllciA8IGFELmp2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBqdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqdSA8IGdUW3BsYXllcl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoamMgPT09IDUgJiYganUgPCBqYSB8fCBqYyA9PT0gNCAmJiBqdSA8IGJLLmRtKGphLCAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp4ID0gYWwuang7DQogICAgICAgICAgICAgICAgICAgICAgICBhQiA9IGF4LmpEKGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqMSA9IGFuLmlsLmoxOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IDA7IGYwIDwgZWc7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMSA9IGp4WyhmMCArIGFCKSAlIGVnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoajFbZjFdID09PSAxICYmIGVlW2YxXSA9PT0ganQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuankuanoocGxheWVyLCBmMSwgaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGprKHBsYXllciwgaEssIGpjKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFuLmlqLmpBKHBsYXllciwgdHJ1ZSkgJiYgIWFuLmlqLmpFKHBsYXllciwgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbi5pby5pcShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbi5pai5qRyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuLmlqLmpGKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqbChwbGF5ZXIsIGhLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXguam4oYUUuam9bamNdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpwKHBsYXllciwgaEssIGFuLmlqLmpMKHBsYXllciksIGpjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoamMgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqcChwbGF5ZXIsIGhLLCBhbi5pai5qVCgpLCBqYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuLmlqLmpJKCkgJiYgYXguam4oYUUuanFbamNdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlqLmpLKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoamMgPT09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqcChwbGF5ZXIsIGhLLCBhbi5pai5qWCgpLCBqYyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAganAocGxheWVyLCBoSywgYW4uaWouak8ocGxheWVyKSwgamMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGpwKHBsYXllciwgaEssIGo2LCBqYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpjID49IDMgJiYgamMgPCA2ICYmIGJLLmRtKGFnLmdoW3BsYXllcl0sIDgpID4gYWcuZ2hbajZdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBNYXRoLm1heChiSy5kbSgxMSAqIGFnLmdoW2o2XSwgNSksIGJLLmRtKGFnLmdoW3BsYXllcl0sIDEwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhZy5nN1twbGF5ZXJdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlqLml4KHBsYXllciwgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWouajUocGxheWVyLCBqNiwgZWcsIGhLKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBqbChwbGF5ZXIsIGhLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgajYgPSBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFnLmc3W3BsYXllcl0ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWouaXcocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nN1twbGF5ZXJdLmxlbmd0aCAhPT0gZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbi5pai5qNShwbGF5ZXIsIGo2LCBlZywgaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMyKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgazAgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBrMSA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBrMiA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBrMyA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oSyA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGs0ID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGs1ID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rNiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuanEgPSBbOTcsIDk0LCA3MCwgNDAsIDIwLCAwLCAxMDBdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLms3ID0gWzUwMCwgNDUwLCA0MDAsIDMwMCwgODAsIDUwLCAxMDBdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpvID0gWzAsIDAsIDUsIDI1LCA1MCwgMTAwLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rOCA9IFs2MCwgNzQsIDExMiwgMjAwLCAyNTYsIDUxMiwgNTEyXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rOSA9IFsxLCAyLCAzLCA0LCA2LCA4LCAxXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rQSA9IFs1MDAsIDQ1MCwgNDAwLCAzMDAsIDgwLCA1MCwgMTAwXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rNiA9IFtMKDcpLCBMKDgpLCBMKDkpLCBMKDEwKSwgTCgxMSksIEwoMTIpLCAiSCBCb3QiXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGswLmZpbGwoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBrMS5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgazIuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGszLmZpbGwoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhLLmZpbGwoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBrNC5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgazUuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrQiA9IGFELmp2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rRCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga0YgPSBhRC5rQyA9PT0gOCA/IDEgOiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRC5rRyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oS1thQiArIGtCXSA9IGtGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmtHIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhUID0gYUIgKyBrQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaEtbaFRdID0gYUQuZGF0YS5ib3REaWZmaWN1bHR5RGF0YVtoVF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmtHIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaFQgPSBhQiArIGtCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oS1toVF0gPSBhRC5kYXRhLmJvdERpZmZpY3VsdHlUZWFtW2JmLmtIW2JmLmVlW2hUXV1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhRC5kYXRhLmJvdERpZmZpY3VsdHlUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrSSA9IHRoaXMuazYubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQua0cgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhLW2FCICsga0JdID0gYUIgJSBrSTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtJID0gYUQuZGF0YS5ib3REaWZmaWN1bHR5VmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRC5rRyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaEtbYUIgKyBrQl0gPSBrSTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGtCOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oS1thQl0gPSA2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQuZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhLW2FCXSA8PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGszW2FCXSA9IDU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs0W2FCXSA9IGs1W2FCXSA9IDEwNDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhLW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazFbYUJdID0gOTgwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazJbYUJdID0gOTgwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaEtbYUJdID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMVthQl0gPSA5ODA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMlthQl0gPSA5MjA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrNFthQl0gPSBrNVthQl0gPSAxMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazFbYUJdID0gODI1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazJbYUJdID0gNzUwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtKKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhLW2FCXSA8PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGszW2FCXSA9IDEgKyBheC5qRCgyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhLW2FCXSA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazFbYUJdID0gazJbYUJdID0gNTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazRbYUJdID0gazVbYUJdID0gMTAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs1W2FCXSA9IDI1MCArIGF4LmpEKDE1MDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgazRbYUJdID0gNTAwICsgYXguakQoNTAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsxW2FCXSA9IDMwMCArIGF4LmpEKDIwMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMlthQl0gPSAxMDAgKyBheC5qRCgyMDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtKKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhLW2FCXSA8PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs0W2FCXSA9IDEwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs1W2FCXSA9IDEwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGszW2FCXSA9IDM1ICsgYXguakQoMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMVthQl0gPSAzMDAgKyBheC5qRCgyMDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMlthQl0gPSA1MCArIGF4LmpEKDEwMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtKKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs0W2FCXSA9IGs1W2FCXSA9IDgwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrM1thQl0gPSA1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsxW2FCXSA9IDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsyW2FCXSA9IDI1MDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrSihhQik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmtEID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBheS5rSzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrQiA9IGFELmp2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlSyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhLW2FCICsga0JdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gMDsgZjAgPCA2OyBmMCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGVLICsgYXkua0xbZjBdIC0gMTsgYUIgPj0gZUs7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oS1thQiArIGtCXSA9IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlSyArPSBheS5rTFtmMF07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBrSihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgazBbYUJdID0gMSArIGJLLmRtKGs0W2FCXSAqIGF4LnJhbmRvbSgpLCAxMCAqIGF4LnZhbHVlKDEwMCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuamggPSBmdW5jdGlvbihnRCwgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGswW2dEXSA9IE1hdGgubWluKHZhbHVlLCBrMFtnRF0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoLS1rMFtnRF0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrTShnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBrTShnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAga04oZ0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWwualkoZ0QsIGJLLmRtKGsxW2dEXSAqIGFnLmdoW2dEXSwgMTAwMCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtOKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoazRbZ0RdICE9PSBrNVtnRF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrNFtnRF0gKz0gazRbZ0RdIDwgazVbZ0RdID8gMyA6IC0zOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsxW2dEXSAhPT0gazJbZ0RdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgazFbZ0RdICs9IGsxW2dEXSA8IGsyW2dEXSA/IGszW2dEXSA6IC1rM1tnRF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgazFbZ0RdID0gTWF0aC5hYnMoazFbZ0RdIC0gazJbZ0RdKSA8PSBrM1tnRF0gPyBrMltnRF0gOiBrMVtnRF07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBrMFtnRF0gPSBiSy5kbShrNFtnRF0sIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmtPID0gZnVuY3Rpb24oZ0QsIGc4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBrNFtnRF0gPSBrNVtnRF0gPSBnODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGloKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIga1AgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBrUC5maWxsKGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqNiA9IGtRKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBrUihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJOLmZCWzBdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtTID0gYkwuaVkocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrVCA9IGtVKHBsYXllciwga1MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtWID0ga1coa1QsIGtTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrViA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0ua1gua1kocGxheWVyLCBrVikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga1oocGxheWVyLCBrUywga1QsIGo2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGthID0ga2IocGxheWVyLCBrUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2EgPiAwICYmIGJNLmtYLmtZKHBsYXllciwga2EpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga1oocGxheWVyLCBrUywgYWMuZVkoa2EgPDwgMiksIGo2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGtWID0ga1coajYsIGtTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrViA+IDAgJiYgYk0ua1gua1kocGxheWVyLCBrVikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtSKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtjID0gYWwuang7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhbC5qdzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWluKGtkLCAoa2QgPCAxNyAmJiBheC5qRCgyMCkgPT09IDUpID8gMSA6IDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGF4LmpEKGtkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSSA9IGJOLmZJOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdNID0gYWcuZ007DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ga2NbKGFCICsgZ0UpICUga2RdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnRCAhPT0gcGxheWVyICYmIGdNW2dEXS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZklbZzgrK10gPSBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiTi5mQlswXSA9IGc4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtVKHBsYXllciwga1MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJOLmZCWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZJID0gYk4uZkk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2UgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZiA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0gZklbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZVoocGxheWVyLCBnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldyA9IGJMLmk4KGtTLCBiTC5pVChnRCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZSA9PT0gLTEgfHwgZXcgPCBrZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZSA9IGV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZiA9IGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBrVyhrVCwga1MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrVCA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnTSA9IGFnLmdNW2tUXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGdNLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWluKGtkLCAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2YgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtlID0gYkwuaTgoZ01ba2ZdID4+IDIsIGtTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoVCA9IGF4LmpEKGtkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXcgPSBiTC5pOChnTVtoVF0gPj4gMiwga1MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldyA8IGtlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtlID0gZXc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtmID0gaFQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdNW2tmXSA+PiAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtiKHBsYXllciwga1MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJOLmZCWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZJID0gYk4uZkk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2cgPSBrUDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBmSVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGo2ID0ga2dbZ0RdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqNiA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEua2goajYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBqNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlWihwbGF5ZXIsIGo2KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZklbZ0UrK10gPSBqNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZCWzBdID0gZ0U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ0UgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrVCA9IGtVKHBsYXllciwga1MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtXKGtULCBrUyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ga1EocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgajYgPSBrUFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGo2ID09PSBhRC5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEua2goajYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga1BbcGxheWVyXSA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBqNjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBrWihwbGF5ZXIsIGtTLCBqNiwga2kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChraSA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrUFtwbGF5ZXJdID0gajY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtqID0gYkwuaVQoajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtrID0gYkwuaVQoa2kpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJMLmk4KGtTLCBraikgPCBiTC5pOChrUywga2spKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga1BbcGxheWVyXSA9IGo2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlwKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJSLmVMKGJSLmVNKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZGF0YS5wYXNzYWJsZU1vdW50YWlucykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5mNltwbGF5ZXJdLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrbChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ga2wocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga20gPSBrbihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGttID09PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAga28ocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrcCA9IGtxKGttLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrcCA9PT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrcihwbGF5ZXIsIGttLmlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGtzKHBsYXllciwga3ApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ga3IocGxheWVyLCBlTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYW4uaWEua3Q7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBhbi5pYS5lRFtheC5qRChlZyldIDw8IDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGF4LmpEKDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlSyArPSBlaVtlal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVsKGVLKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZU8oZUspID09PSBlTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga3MocGxheWVyLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZUs6IGVLLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEOiBhRC5lZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYy5lWChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtuKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY2ID0gYWcuZjZbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGY2Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmNyA9IE1hdGgubWF4KGJLLmRtKGVnLCAxMiksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTAgPSBheC5qRChlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCICs9IGY3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVWID0gZjZbKGFCICsgZTApICUgZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWsgPSBlViArIGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVsKGVrKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlSzogZWssDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGFjLmVPKGVrKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRDogcGxheWVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ga28ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIganggPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqdyA9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gTWF0aC5taW4oancsIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGF4LmpEKGp3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSSA9IGJOLmZJOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY2ID0gYWcuZjY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ganhbKGFCICsgZ0UpICUganddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnRCAhPT0gcGxheWVyICYmIGY2W2dEXS5sZW5ndGggJiYgZVoocGxheWVyLCBnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZklbZzgrK10gPSBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiTi5mQlswXSA9IGc4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtxKGVOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBiTi5mQlswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSSA9IGJOLmZJOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGt1ID0ga24oZklbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3UgPT09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrdS5pZCA9PT0gZU4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGt1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGtzKHBsYXllciwga3UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoSyA9IGI5LmcxLmt2KHBsYXllciwgYUUua0FbYUUuaEtbcGxheWVyXV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZzdbcGxheWVyXS5wdXNoKGt1LmVLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFkLmozKHBsYXllciwgaEssIGt1LmdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGLmo0KHBsYXllciwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gaWUoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlUyA9IGt3KHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZVMgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJNLmtYLmtZKHBsYXllciwgZVMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ga3cocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhbi5pYS5rdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IE1hdGgubWluKGVnLCBhbi5wZXJmb3JtYW5jZS5reCA/IGVnIDogMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVEID0gYW4uaWEuZUQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgakMgPSBiSy5kbShheC5yYW5kb20oKSAqIGVnLCBheC52YWx1ZSgxMDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gakMgKyBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBreSA9IGF4LmlaKGFnLmlVW3BsYXllcl0sIGFnLmlWW3BsYXllcl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGt6ID0gYXguaVooYWcuaVdbcGxheWVyXSwgYWcuaVhbcGxheWVyXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2YgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldyA9IGJMLmk5KDAsIDAsIGJSLmVyLCBiUi5lcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGpDOyBhQiA8IGU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0UgPSBhQiAlIGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsMCA9IGJMLmV5KGt5LCBreiwgZURbZ0VdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobDAgPCBldykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IGwwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZiA9IGdFOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZURba2ZdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlpKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmt4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5reCA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5reCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbDEoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGwyKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBsMSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5qcygpICUgMzAgIT09IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuZzEubDMoODApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW4ucGVyZm9ybWFuY2Uua3ggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGwyKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbDQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGw1KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbDQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbDYgPSBiZy5sNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiZi5rSFtsNl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiZy5sOChsNik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGJOLmZKOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYk4uZkJbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbDkgPSBNYXRoLm1pbigxMDAgKyAoZWcgLSAxKSAqIDEwLCA0MDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUUua08oZ1thQl0sIGw5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBsNSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFLmtPKGxBWzBdLCAxMDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGliKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbEIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbEMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbEQgPSAzMDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBsRSA9IDMwMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGxGID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rdCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZUQgPSBuZXcgVWludDMyQXJyYXkoNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbEIgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgbEMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rdCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBsRiA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxHKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobEIgPj0gbEQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsSCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGxJKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBsSCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsSiA9IGFuLmlhLmt0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSAzNTAgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobEYgIT09IGxKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxGID0gbEo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5qSihsQVswXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSAxMiAhPT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmxLKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhbi5pYS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxHKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYW4uaWEua3Q7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlRCA9IGFuLmlhLmVEOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSAzNSAhPT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlZyA8IGVELmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYy5lWChlRFthQl0gPDwgMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWctLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZURbYUJdID0gZURbZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlhLmt0ID0gZWc7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWcgPCBlRC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbEkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxMID0gaSAtIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBsTCAqIChiUi5lcyAtIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxNID0gbEQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUQgPSBhbi5pYS5lRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFuLmlhLmt0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxOID0gZUQubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdFID0gTWF0aC5taW4obEMgKyBsTSAqICgoMSArIDE5ICogYW4ucGVyZm9ybWFuY2Uua3gpICogbEUpLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gbEM7IGFCIDwgZ0U7IGFCICs9IGxNKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gNCAqIChhQiAlIGxMICsgKGJLLmRtKGFCLCBsTCkgKyAxKSAqIGkgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZVgoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVEW2tkXSA9IGVLID4+IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZCA9PT0gbE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCICs9IGxNOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsQyA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxDID49IGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbEIrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsQyA9IGxCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWEua3QgPSBrZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsTygpIHsNCiAgICAgICAgICAgICAgICAgICAgYU4uaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYWYuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYVcubFAoKTsNCiAgICAgICAgICAgICAgICAgICAgYXoueS5pcSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsUSgpIHsNCiAgICAgICAgICAgICAgICAgICAgYjAuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYUcuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYWUuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYjMuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYUYuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYW4uaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYk0ueS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhbC5sUigpOw0KICAgICAgICAgICAgICAgICAgICBhVi5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBheS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBiVS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhZi5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhZi5sUygpOw0KICAgICAgICAgICAgICAgICAgICBhVy5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBiTy5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhVS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhUC5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhTi5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBiNC5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhUi5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhdi5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBiYy5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBiZy5pcSgpOw0KICAgICAgICAgICAgICAgICAgICBhei55LmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGF6LmxULmlxKCk7DQogICAgICAgICAgICAgICAgICAgIHQuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYjguaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgYmUuaXEoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gbFUoKSB7DQogICAgICAgICAgICAgICAgICAgIGFILmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGFYLmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGFRLmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGF1LmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGJCLmlxKCk7DQogICAgICAgICAgICAgICAgICAgIGF3LmxWKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxXKCkgew0KICAgICAgICAgICAgICAgICAgICBhVi5sWChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIGFQLmxYKCk7DQogICAgICAgICAgICAgICAgICAgIGFXLmxYKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgYVUubFgoKTsNCiAgICAgICAgICAgICAgICAgICAgYVIubFgoKTsNCiAgICAgICAgICAgICAgICAgICAgYXYubFgoKTsNCiAgICAgICAgICAgICAgICAgICAgYWYubFgoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBiZy5sWSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsWigpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFmLmxYKGZhbHNlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGF6LnkuaXEoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYzMoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBsYTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGxiOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbGM7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxhID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxiID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxjID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBsYSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGNbbGJbYUJdXSA9PT0gNjQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGQobGJbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxjW2xiW2FCXV0tLSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZChsYlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaShsYlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nVFtsQVswXV0gPj0gMTYwMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGUoMTYwMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuZ1RbbEFbMF1dID49IDMwMDAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZSgzMDAwMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGxmKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBsZShsZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBsYSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGNbbGJbYUJdXSA9PT0gMCAmJiBhZy5nVFtsYlthQl1dID49IGxnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpKGxiW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxmKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5raChhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5saFs3XSA9IE1hdGgubWF4KGFnLmdUW2FELmVRXSwgYmMubGhbN10pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxkKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxjW3BsYXllcl0gPT09IDY0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGNbcGxheWVyXSA9IDY7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGFnLmdUW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRsIDwgMTAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsY1twbGF5ZXJdID0gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRsIDwgMTAwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGNbcGxheWVyXSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkbCA8IDYwMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxjW3BsYXllcl0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxjW3BsYXllcl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmczID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXosIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGxhIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IGxiW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gYUI7IGV6IDwgbGE7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxiW2V6XSA9IGxiW2V6ICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuajQgPSBmdW5jdGlvbihwbGF5ZXIsIGxpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGxhIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IGxiW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbGJbbGErK10gPSBwbGF5ZXI7DQogICAgICAgICAgICAgICAgICAgICAgICBsY1twbGF5ZXJdID0gbGkgPyAyIDogNjQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjNCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNpemU7DQogICAgICAgICAgICAgICAgICAgIHZhciBqajsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IGFELmtHOw0KICAgICAgICAgICAgICAgICAgICAgICAgamogPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp2ID0gYUQuanY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFELmtHIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpqW2FCXSA9IGp2ICsgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsaigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sayA9IGZ1bmN0aW9uKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBqaltzaXplKytdID0gZ0Q7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBsaigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gc2l6ZSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbampbYUJdXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbShhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRS5pcShqalthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxtKGV6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzaXplLS07DQogICAgICAgICAgICAgICAgICAgICAgICBqaltlel0gPSBqaltzaXplXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjNSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGxuOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbG87DQogICAgICAgICAgICAgICAgICAgIHZhciBscDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGxxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbHI7DQogICAgICAgICAgICAgICAgICAgIHZhciBsczsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGx0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgbHU7DQogICAgICAgICAgICAgICAgICAgIHZhciBsdjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGx3Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgbHg7DQogICAgICAgICAgICAgICAgICAgIHZhciBseTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGx6Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgbTAgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG0xID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG0yKGU4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBseSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgbHogPSAzMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxyID0gbHogLyBlODsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxuID0gMSAvIChlOCAvIGx6IC8gNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBscyA9IChoLmkgLyAyICsgaUcpIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICBsdCA9IChoLmogLyAyICsgaUkpIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICBsdSA9IGlIOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMubTMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubTQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0yKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tNSgwLCAwLCBiUi5lciAtIDEsIGJSLmVzIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmgxICYmICFhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubTYoYUQuZVEsIDMwMDAsIHRydWUsIDAuMyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm03ID0gZnVuY3Rpb24ocGxheWVyLCBtOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbTkoYk0uaDkubUEocGxheWVyLCBtOCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbTkoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVMgPSBiTC5pTihiTS55Lm1CW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUMgPSBiTC5lbyhlUykgLSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtRCA9IGJMLmVxKGVTKSAtIDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUgubTUobUMsIG1ELCBtQyArIDE5LCBtRCArIDE5KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm02ID0gZnVuY3Rpb24ocGxheWVyLCBlOCwgbUUsIHpvb20pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5tRiB8fCAobTAgJiYgIW1FICYmIG0xKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nVFtwbGF5ZXJdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbTkoYk0uaDkubUcocGxheWVyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVMubUggPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0xID0gbUU7DQogICAgICAgICAgICAgICAgICAgICAgICBtMihlOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBtSShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbUooem9vbSwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG0wID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFxLm1LKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1MID0gZnVuY3Rpb24oZTgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCB8fCBhRC5tRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFTLm1IID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBtMSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbTIoZTgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbU0oMCwgMCwgYlIuZXIgLSAxLCBiUi5lcyAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbU4oNyAvIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbTAgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXEubUsoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG1JKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgbHYgPSAoYWcuaVVbcGxheWVyXSArIGFnLmlWW3BsYXllcl0gKyAxKSAvIDI7DQogICAgICAgICAgICAgICAgICAgICAgICBsdyA9IChhZy5pV1twbGF5ZXJdICsgYWcuaVhbcGxheWVyXSArIDEpIC8gMjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBtSih6b29tLCBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpMSA9IGFnLmlWW3BsYXllcl0gLSBhZy5pVVtwbGF5ZXJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpNCA9IGFnLmlYW3BsYXllcl0gLSBhZy5pV1twbGF5ZXJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleiA9IGguaSAvIGkxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwID0gaC5qIC8gaTQ7DQogICAgICAgICAgICAgICAgICAgICAgICBseCA9IGV6IDwgZjAgPyBleiA6IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gem9vbSAhPT0gMCA/IHpvb20gOiAoaTEgPCAyMCAmJiBpNCA8IDIwKSA/IDAuNSA6IDAuOTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGx4ICo9IG1POw0KICAgICAgICAgICAgICAgICAgICAgICAgbU4oNyAvIDgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG1OKGU1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoTWF0aC5sb2cobHggLyBsdSkpIDwgMC4xMjUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBseCA9IGU1ICogbHU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbU0obUMsIG1ELCBtUCwgbVEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGx2ID0gKG1DICsgbVAgKyAxKSAvIDI7DQogICAgICAgICAgICAgICAgICAgICAgICBsdyA9IChtRCArIG1RICsgMSkgLyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkxID0gbVAgLSBtQyArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTQgPSBtUSAtIG1EICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleiA9IGguaSAvIGkxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwID0gaC5qIC8gaTQ7DQogICAgICAgICAgICAgICAgICAgICAgICBseCA9IDAuOSAqIChleiA8IGYwID8gZXogOiBmMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tNSA9IGZ1bmN0aW9uKG1DLCBtRCwgbVAsIG1RKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtTShtQywgbUQsIG1QLCBtUSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpSCA9IGx4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYVMubVIobHYsIGguaSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVMubVMobHcsIGguaiAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYloubVQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubVUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtMCAmJiBtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG0wID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1WKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBtVigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsbyA8IDAuNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChscSA8IGxyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxxICs9IGxyICogbG47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxwID0gbG87DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG8gPiAxIC0gbHApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbHEgLT0gbHIgKiBsbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbHEgPSBscSA8IGxyICogbG4gPyBsciAqIGxuIDogbHE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSBseSA+PSBiZS5lRiA/IGJlLmVGIC0gMSA6IGx5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVqID0gYmUuZUYgLSBseTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlaiA+IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvICs9IGxxICogZWogLyBsejsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbyA9IGxvID4gMSA/IDEgOiBsbzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGx5ID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbVcgPSBpSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtWCA9IGlHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ZID0gaUk7DQogICAgICAgICAgICAgICAgICAgICAgICBpSCA9IGx1ICogKE1hdGgucG93KChseCAvIGx1KSwgbG8pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtWiA9IGlIIC8gbVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWEgPSBsdSAqIChNYXRoLnBvdygobHggLyBsdSksICgxIC0gbG8pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWIgPSAxIC0gKChtYSAtIGx1KSAvIChseCAtIGx1KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUy5tUihscyArIG1iICogKGx2IC0gbHMpLCBoLmkgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTLm1TKGx0ICsgbWIgKiAobHcgLSBsdCksIGguaiAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuem9vbShtWiwgKG1YICogbVogLSBpRykgLyAoMSAtIG1aKSwgKG1ZICogbVogLSBpSSkgLyAoMSAtIG1aKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiWi5tVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvID49IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtMCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhLm1jID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBieCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGYxID0gYjkuY29sb3I7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWQgPSBmMS5tZSgwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZiA9IGYxLm1nKDAsIDAsIDAsIDAuNyk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWggPSBmMS5tZygwLCAwLCAwLCAwLjUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1pID0gZjEubWcoMCwgMCwgMCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWogPSBmMS5tZygwLCAwLCAwLCAwLjc1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tayA9IGYxLm1nKDAsIDAsIDAsIDAuNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWwgPSBmMS5tZygwLCAwLCAwLCAwLjM1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tbSA9IGYxLm1lKDI1NSwgMjU1LCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1uID0gZjEubWcoMjU1LCAyNTUsIDI1NSwgMC4zKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tbyA9IGYxLm1nKDI1NSwgMjU1LCAyNTUsIDAuNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXAgPSBmMS5tZygyNTUsIDI1NSwgMjU1LCAwLjQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1xID0gZjEubWcoMjU1LCAyNTUsIDI1NSwgMC4yNSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXIgPSBmMS5tZygyNTUsIDI1NSwgMjU1LCAwLjg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tcyA9IGYxLm1nKDI1NSwgMjU1LCAyNTUsIDAuNzUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm10ID0gZjEubWcoMjU1LCAyNTUsIDI1NSwgMC4xNSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXUgPSBmMS5tZygyNTUsIDI1NSwgMjU1LCAwLjExKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tdiA9IGYxLm1lKDEyOCwgMTI4LCAxMjgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm13ID0gZjEubWcoNjQsIDY0LCA2NCwgMC43NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXggPSBmMS5tZyg4OCwgODgsIDg4LCAwLjgzKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5teSA9IGYxLm1nKDYwLCA2MCwgNjAsIDAuODUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm16ID0gZjEubWcoODAsIDYwLCA2MCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubjAgPSBmMS5tZSgxNzAsIDE3MCwgMTcwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uMSA9IGYxLm1lKDIwMCwgMjM1LCAyNDUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm4yID0gZjEubWUoMzAsIDI1NSwgMzApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm4zID0gZjEubWUoMCwgMjAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uNCA9IGYxLm1lKDEyOCwgMjU1LCAxMjgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm41ID0gZjEubWcoMTAsIDY1LCAxMCwgMC43NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubjYgPSBmMS5tZygwLCAyNTUsIDAsIDAuNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubjcgPSBmMS5tZygwLCAyNTUsIDAsIDAuNSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubjggPSBmMS5tZygwLCAyMDAsIDAsIDAuNSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubjkgPSBmMS5tZygwLCAxMDAsIDAsIDAuNzUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5BID0gZjEubWcoMCwgNjAsIDAsIDAuOCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubkIgPSBmMS5tZygwLCAyNTUsIDAsIDAuMyk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubkMgPSBmMS5tZygwLCAxODAsIDAsIDAuNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubkQgPSBmMS5tZygwLCAxMjAsIDAsIDAuODUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5FID0gZjEubWUoMCwgMTIwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uRiA9IGYxLm1nKDAsIDcwLCAwLCAwLjg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uRyA9IGYxLm1lKDE5MCwgMjMwLCAxOTApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5IID0gZjEubWUoMCwgMjU1LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uSSA9IGYxLm1lKDI1NSwgMTIwLCAxMjApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5KID0gZjEubWUoMjU1LCAxNjAsIDE2MCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubksgPSBmMS5tZSgyNTUsIDcwLCA3MCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubkwgPSBmMS5tZSgyMzAsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5NID0gZjEubWcoMjIwLCAwLCAwLCAwLjYpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5OID0gZjEubWcoMjU1LCAxMDAsIDEwMCwgMC44KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uTyA9IGYxLm1nKDEwMCwgMCwgMCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMublAgPSBmMS5tZyg2MCwgMCwgMCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMublEgPSBmMS5tZygyMDAsIDAsIDAsIDAuNik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMublIgPSBmMS5tZygxMjAsIDAsIDAsIDAuODUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5TID0gZjEubWUoMjU1LCA3MCwgMTApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5UID0gZjEubWUoMjMwLCAxOTAsIDE5MCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMublUgPSBmMS5tZSgyNTUsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5WID0gZjEubWUoMjU1LCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5XID0gZjEubWcoNjAsIDAsIDYwLCAwLjg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uWCA9IGYxLm1nKDAsIDYwLCA2MCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMublkgPSBmMS5tZygxMCwgNjAsIDYwLCAwLjkpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5aID0gZjEubWcoMCwgOTYsIDk2LCAwLjc1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYSA9IGYxLm1lKDAsIDI1NSwgMjU1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYiA9IGYxLm1lKDE2MCwgMTYwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5jID0gZjEubWcoMCwgNDAsIDkwLCAwLjc1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZCA9IGYxLm1nKDAsIDAsIDI1NSwgMC42KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZSA9IGYxLm1lKDIwMCwgMjAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5mID0gZjEubWUoMjU1LCAxMjAsIDEwMCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmcgPSBmMS5tZygyNTUsIDI1NSwgMCwgMC41KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uaCA9IGYxLm1nKDI1NSwgMjU1LCAxNTAsIDAuMik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmkgPSBmMS5tZSgyNTUsIDI1NSwgMCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmogPSBmMS5tZSgyNTUsIDI1NSwgMjAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uayA9IGYxLm1nKDIwMCwgMjAwLCAwLCAwLjYpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5sID0gZjEubWcoMTQwLCAxMjAsIDAsIDAuNzUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5tID0gZjEubWcoMTgwLCAxNjAsIDQwLCAwLjc1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ubiA9IGYxLm1nKDcwLCA1MCwgMjAsIDAuODUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5vID0gZjEubWcoMzAsIDMwLCAwLCAwLjg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ucCA9IGYxLm1nKDYwLCA2MCwgMCwgMC44NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubnEgPSBmMS5tZygyNTUsIDE0MCwgMCwgMC43NSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubnIgPSBmMS5tZyg3MCwgNDAsIDAsIDAuODUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5zID0gZjEubWUoMjIwLCAxMjAsIDApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm50ID0gZjEubWcoMjU1LCAyMDAsIDgwLCAwLjg1KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5udSA9IGYxLm1lKDI1NSwgMTUwLCAxMjApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm52ID0gZjEubWcoMCwgMCwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubncgPSBmMS5tZygyNTUsIDI1NSwgMjU1LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ueCA9IGYxLm1nKDI1NCwgMjU0LCAyNTQsIDApOw0KICAgICAgICAgICAgICAgICAgICBmMSA9IG51bGw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGN1KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmgyID0gbmV3IG55KCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZzEgPSBuZXcgbnooKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vMCA9IG5ldyBvMSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm8yID0gbmV3IG8zKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuankgPSBuZXcgbzQoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gbnkoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaDMgPSBmdW5jdGlvbihlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAuaDMoYUQuZVEsIGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoubzUubzYoZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oRCA9IGZ1bmN0aW9uKGlGLCBqNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAuaEQoYUQuZVEsIGlGLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm81Lm83KGlGLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm84ID0gZnVuY3Rpb24oaUYsIG85KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5vQShhRC5lUSwgaUYsIG85KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoubzUub0IoaUYsIG85KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaEIgPSBmdW5jdGlvbihpRiwgZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLmhCKGFELmVRLCBpRiwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJNLmg5LmhBKGFELmVRLCBlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vQyhpRiwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vRCA9IGZ1bmN0aW9uKG04LCBlUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAub0QoYUQuZVEsIG04LCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYk0uaDkub0UoYUQuZVEsIG04LCBlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vRihtOCwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vRyA9IGZ1bmN0aW9uKGo2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5vRyhhRC5lUSwgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vSChqNik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9JID0gZnVuY3Rpb24ob0opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLm9LKGFELmVRLCBvSik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm81Lm9MKG9KKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaFAgPSBmdW5jdGlvbihvTSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAuaFAoYUQuZVEsIG9NKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoubzUub04ob00pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vTyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAub08oYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vUCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oTSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAuaE0oYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vQygxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaDYgPSBmdW5jdGlvbihpRiwgZVMsIGo2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5oNihhRC5lUSwgaUYsIGVTLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm81Lm9RKGlGLCBlUywgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gbzQoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuanogPSBmdW5jdGlvbihwbGF5ZXIsIG85LCBoSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5vUihwbGF5ZXIsIGhLLCBvOSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZS5vOChwbGF5ZXIsIG85KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvOSA8IGFELmp2ICYmIGF4LnJhbmRvbSgpIDwgYXgudmFsdWUoMTApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW4uaWwuajFbbzldID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub1MgPSBmdW5jdGlvbihwbGF5ZXIsIG85LCBoSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5vVChoSywgbzkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmMuZzUocGxheWVyLCBoSywgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLmc0KG85LCBiTi5mRFswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5vVShwbGF5ZXIsIG85KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLm9WKG85LCBiTi5mRFswXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBueigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vVyA9IGZ1bmN0aW9uKG9KLCBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLm9JKGFELmVRLCBwbGF5ZXIsIG9KKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm81Lm9YKG9KLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vWSA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ub1oocGxheWVyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm81Lm9hKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9iID0gZnVuY3Rpb24ob2MsIHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ub2Qob2MsIHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5vZShvYywgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSB8fCBhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lm9oLm9nKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBvMygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKGFDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQsIGZOLCBtVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmRYKGFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmUxICs9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICBtVSA9IDggKiBiRy5zaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGJHLmUxICsgOCA8PSBtVSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYkcub2koNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZk4gPSBiRy5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vaihpZCwgZk4sIGJHLm9pKDIyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9qKGlkLCBmTiwgYkcub2koMTApLCBiRy5vaSgxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vaihpZCwgZk4sIGJHLm9pKDEwKSwgYkcub2koOSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vaihpZCwgZk4sIGJHLm9pKDEwKSwgYkcub2koMjIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2ooaWQsIGZOLCBiRy5vaSgxMCksIGJHLm9pKDIyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9qKGlkLCBmTiwgYkcub2koMTApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2ooaWQsIGZOLCBiRy5vaSgxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vaihpZCwgZk4sIGJHLm9pKDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9qKGlkLCBmTiwgYkcub2koMjApLCBiRy5vaSgyMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2ooaWQsIGZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9rID0gW107DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2wgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb24gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9vID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3EgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSA1MTI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uICs9IGFnLmxsW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbyArPSBhZy5nVFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3AgKz0gYWcuZ2hbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9xICs9IGJNLnkub3RbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgb3IgKz0gYk0ueS5vdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9zICs9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgb20gPSBvbiArIG9vICsgb3EgKyBvciArIG9zOw0KICAgICAgICAgICAgICAgICAgICAgICAgb20gPSAob3AgJSAxMDczNzQxODI0KSAqIDQgKyBvbSAlIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rLnB1c2gob20pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vaiA9IGZ1bmN0aW9uKGlkLCBmTiwgZlAsIGZSKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5oMyhmTiwgZlApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLmhEKGZOLCBmUCwgZlIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLm9BKGZOLCBmUCwgZlIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLmhCKGZOLCBmUCwgZlIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLm9EKGZOLCBmUCwgZlIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLm9HKGZOLCBmUCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzAub0soZk4sIGZQKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5oUChmTiwgZlApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLm9PKGZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMC5vdihmTik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8wLmg2KGZOLCBmUCA+PiAxMCwgZlIsIGZQICUgMTAyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBvMSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oMyA9IGZ1bmN0aW9uKHBsYXllciwgZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJMLmlLKGVTKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDAsIHBsYXllciwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQub3kuajMocGxheWVyLCBlUyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhEID0gZnVuY3Rpb24ocGxheWVyLCBpRiwgajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLm96KHBsYXllciwgajYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5wMChwbGF5ZXIsIGlGLCAxMiwgMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLnAxKHBsYXllciwgajYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl2ID0gYWQuakgocGxheWVyLCBiTi5lY1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWl2ICYmICFhZC5qWihwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWcucDJbcGxheWVyXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjgub3cub3goMSwgcGxheWVyLCBpRiwgYk4uZWNbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbi5pai5pdShwbGF5ZXIsIGl2KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLnAzKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5wNChwbGF5ZXIsIGlGKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuLmlqLmowKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9BID0gZnVuY3Rpb24ocGxheWVyLCBpRiwgbzkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5veihwbGF5ZXIsIG85KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEucDUocGxheWVyLCBvOSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLm9SKHBsYXllciwgYjkuZzEuaUUocGxheWVyLCBpRiksIG85KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDIsIHBsYXllciwgaUYsIG85KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFlLm84KHBsYXllciwgbzkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oQiA9IGZ1bmN0aW9uKHBsYXllciwgaUYsIGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdyKDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVTID09PSAwICYmIGlGID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oTShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYkwuaUsoZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJNLnkub3UgPT09IGJNLnkuazkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0ueS5vdFtwbGF5ZXJdID09PSBiTS55LnA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmdNW3BsYXllcl0ubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5wMChwbGF5ZXIsIGlGLCAzMiwgMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJNLmtYLmtZKHBsYXllciwgZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmMucDcocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDMsIHBsYXllciwgaUYsIGVTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLnAzKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBiay5wOC5oQihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk0ueS5wOShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vRCA9IGZ1bmN0aW9uKHBsYXllciwgbTgsIGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdyKDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTC5pSyhlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJNLmg5LnBBKHBsYXllciwgbTgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTS5rWC5wQihlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5veCg0LCBwbGF5ZXIsIG04LCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5nMS5wQyhwbGF5ZXIsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmMuZzUocGxheWVyLCBiTi5mRFsxXSwgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmsucDgub0QocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJNLnkub0QoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub0cgPSBmdW5jdGlvbihwbGF5ZXIsIGo2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdyKDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgajYgPSBNYXRoLm1pbihqNiwgYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZC5qSChwbGF5ZXIsIGo2KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDUsIHBsYXllciwgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQucEQocGxheWVyLCBqNik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9LID0gZnVuY3Rpb24ocGxheWVyLCBvSikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncigxKSAmJiAhYjkuZzEuZ3IoMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBvSiA9IGJLLnBFKG9KLCAwLCAxMDIzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDYsIHBsYXllciwgb0opOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYucEYocGxheWVyLCAwLCBvSik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhQID0gZnVuY3Rpb24ocGxheWVyLCBvTSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdi5oTyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYjgub3cub3goNywgcGxheWVyLCBvTSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdi5wRyhwbGF5ZXIsIG9NKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub08gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMCkgJiYgIWI5LmcxLmdyKDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhTS5wSChwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYjgub3cub3goOCwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJQLm9PKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm92ID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5veCg5LCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlAub3YocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE0gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXYuaFEocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDMsIHBsYXllciwgMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdi5oTShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oNiA9IGZ1bmN0aW9uKHBsYXllciwgaUYsIGVTLCBqNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncigxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3MocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEub3oocGxheWVyLCBqNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLnAxKHBsYXllciwgajYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTC5pSyhlUykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFtLmVILmVhKHBsYXllciwgZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZC5qSChwbGF5ZXIsIGJOLmVjWzBdKSAmJiAhYWQualoocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93Lm94KDEwLCBwbGF5ZXIsIChpRiA8PCAxMCkgKyBiTi5lY1swXSwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhLID0gYjkuZzEua3YocGxheWVyLCBpRik7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1twbGF5ZXJdLnB1c2goYk4uZWhbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuajMocGxheWVyLCBoSywgYk4uZWNbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYuajQocGxheWVyLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJjLnBJKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBwSigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wSyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgocEwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLmhlaWdodCA9IFNbOV07DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5wYWRkaW5nID0gU1syNV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wTSA9IGZ1bmN0aW9uKHBOLCBtYXJnaW5Ub3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImgyIik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS50ZXh0Q29udGVudCA9IHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUubWFyZ2luID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUubWFyZ2luQm90dG9tID0gU1s0MV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFyZ2luVG9wKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUubWFyZ2luVG9wID0gbWFyZ2luVG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUuZm9udFNpemUgPSBTWzExMF07DQogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZS5zdHlsZS5vdmVyZmxvd1dyYXAgPSBTWzM1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucEwuYXBwZW5kQ2hpbGQodGl0bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRpdGxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wTyA9IGZ1bmN0aW9uKHBOLCBtYXJnaW5Cb3R0b20pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInAiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBQLnRleHRDb250ZW50ID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICBwUC5zdHlsZS5mb250U2l6ZSA9IFNbMTJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFAuc3R5bGUubGluZUhlaWdodCA9IFNbNThdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFAuc3R5bGUubWFyZ2luQm90dG9tID0gbWFyZ2luQm90dG9tIHx8ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucEwuYXBwZW5kQ2hpbGQocFApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBQOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wUSA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcFIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwIik7DQogICAgICAgICAgICAgICAgICAgICAgICBwUi50ZXh0Q29udGVudCA9IHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFIuc3R5bGUuZm9udFNpemUgPSBTWzE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBSLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBSLnN0eWxlLndoaXRlU3BhY2UgPSBTWzc4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBSLnN0eWxlLm92ZXJmbG93V3JhcCA9IFNbMzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wTC5hcHBlbmRDaGlsZChwUik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcFI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBTID0gZnVuY3Rpb24ocFQsIGZvbnRTaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcEwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuaW5uZXJIVE1MID0gcFQ7DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5mb250U2l6ZSA9IGZvbnRTaXplIHx8IFNbMTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUubGluZUhlaWdodCA9IFNbNThdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wTC5hcHBlbmRDaGlsZChwTCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcEw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBVID0gZnVuY3Rpb24ocFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwVyA9IHBWLnBXOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcFcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBMLmFwcGVuZENoaWxkKHBXW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBYID0gZnVuY3Rpb24ocFkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucEsucHVzaChwWSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBMLmFwcGVuZENoaWxkKHBZLmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBZOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHRoaXMucEsubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucEtbYUJdLnJlc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBLW2FCXS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCh0aGlzLnBMKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcFoocGEsIHBiKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBwTCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGMgPSBwTDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZCA9IHBiOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLm1heFdpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnN0eWxlLmxpbmVIZWlnaHQgPSBTWzQwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnN0eWxlLm92ZXJmbG93WCA9IFNbMTVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuc3R5bGUub3ZlcmZsb3dZID0gU1s5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBwYi5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTC5hcHBlbmRDaGlsZChwYlthQl0ucEwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuYXBwZW5kQ2hpbGQocEwpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHBlKHBmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAuMjUgKiBiOS5wZy5waCgwLjYpICogaC5waTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChNYXRoLmZsb29yKHBmIC8gaSksIDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwaigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBrKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBwaigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IHBiLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiW2FCXS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBwaygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgcGwsIGosIGdFLCBlajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZiA9IGguayAqIHBMLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBtID0gbmV3IEZsb2F0NjRBcnJheShwZShwZikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBuID0gYmIucG47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG8gPSAocGYgLSAocG0ubGVuZ3RoICsgMSkgKiBiYi5nYXApIC8gKHBtLmxlbmd0aCAqIGguayk7DQogICAgICAgICAgICAgICAgICAgICAgICBwbS5maWxsKHBuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IHBiLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqID0gcGJbYUJdLnBMOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsID0gZWouc3R5bGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGI5LnBwLm1pbihwbSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0UgPSBwbS5pbmRleE9mKGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsLnRvcCA9IGI5LnBnLnBxKGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsLmxlZnQgPSBiOS5wZy5wcShwbiArIGdFICogKHBvICsgcG4pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbC53aWR0aCA9IGI5LnBnLnBxKHBvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihlaiwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG1bZ0VdICs9IGVqLm9mZnNldEhlaWdodCArIDMgKiBwbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLmhlaWdodCA9IGI5LnBnLnBxKGI5LnBwLm1heChwbSkgLSAyICogcG4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHcocHMsIHB0LCBwdSwgcHYsIHB3KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBweCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbiA9IHB4Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLnB5ID0gcHQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucHogPSBwdTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoc2VsZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcHguaW5uZXJIVE1MID0gcHM7DQogICAgICAgICAgICAgICAgICAgICAgICBweC5zdHlsZS5jb2xvciA9IHB3ID8gYkEubmkgOiBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LnN0eWxlLnVzZXJTZWxlY3QgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHguc3R5bGUub3V0bGluZSA9IFNbNV07DQogICAgICAgICAgICAgICAgICAgICAgICBweC5zdHlsZS5vdmVyZmxvd1dyYXAgPSBTWzM1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucTEocHUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHguc3R5bGUuYm9yZGVyID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LnN0eWxlLmZvbnQgPSBTWzZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xMigwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LnN0eWxlLnBhZGRpbmcgPSAiMGVtIDAuM2VtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4Lm9uY2xpY2sgPSBxMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LmFkZEV2ZW50TGlzdGVuZXIoU1s4MF0sIHE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LmFkZEV2ZW50TGlzdGVuZXIoU1s4MV0sIHE1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LmFkZEV2ZW50TGlzdGVuZXIoU1s1MF0sIHE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LmFkZEV2ZW50TGlzdGVuZXIoU1s1MV0sIHE2KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnEyID0gZnVuY3Rpb24ocTcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxOCA9IDEuMSAtIE1hdGgubWluKDAuMDEgKiBwcy5sZW5ndGgsIDAuNikgKyAwLjIgKiBxNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHB4LnN0eWxlLmZvbnRTaXplID0gcTgudG9GaXhlZCgxKSArICJlbSI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnExID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjEgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMSA9IGJBLm15Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB2ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMSA9IGJBLm15Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5weiA9IHB1ID0gZjE7DQogICAgICAgICAgICAgICAgICAgICAgICBweC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBmMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHE0KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJJLnE5KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcUEgPSBiOS5jb2xvci5xQihwdSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocHYgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFBWzBdID4gMCAmJiBxQVswXSA8IDI1NSAmJiBxQVswXSA9PT0gcUFbMV0gJiYgcUFbMF0gPT09IHFBWzJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBweC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiOS5jb2xvci5xQyhwdSwgKHFBWzNdICYmIHFBWzNdIDwgMTIwKSA/IDE1MCA6IDUwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxQSA9IGI5LmNvbG9yLnFCKHB1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocUFbMF0gPT09IHFBWzFdICYmIHFBWzBdID09PSBxQVsyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFEID0gcHQodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFxRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxRSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHFEID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHE0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHE2KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwdTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxNSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFFKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHFFKGVqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlai5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLmJsdXIoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcUYocUcsIHBhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBwTDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwTCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5kaXNwbGF5ID0gImdyaWQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICJyZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoOS41ZW0sIDFmcikpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLm92ZXJmbG93WSA9IFNbOV07DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5ncmlkQXV0b1Jvd3MgPSAiNS4zZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUubWF4SGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFIKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcUgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgcUcubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbYUJdLnEyKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBMLmFwcGVuZENoaWxkKHFHW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuYXBwZW5kQ2hpbGQocEwpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBxRy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihxR1thQl0uYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLmdhcCA9IHBMLnN0eWxlLnBhZGRpbmcgPSBiOS5wZy5wcShiYi5wbik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBxSShxSiwgcUssIHFMKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaiA9IE1hdGgubWluKGI5LnBnLnBoKHFMIHx8IDAuNSkgKiBxSlsxXSAqIGgucGksIGguaiAtIDIgKiBiYi5nYXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gTWF0aC5taW4odGhpcy5qICogKHFKWzBdIC8gcUpbMV0pLCBoLmkgLSAyICogYmIuZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaiA9IHFKWzFdICogdGhpcy5pIC8gcUpbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuID0gYmIuZ2FwICsgcUtbMF0gKiAoaC5pIC0gdGhpcy5pIC0gMiAqIGJiLmdhcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gYmIuZ2FwICsgcUtbMV0gKiAoaC5qIC0gdGhpcy5qIC0gMiAqIGJiLmdhcCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFNID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbiArIDAuNSAqIHRoaXMuaTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHFOKHFPLCBxUCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgcVEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcVIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcVMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcVQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFVID0gbmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGUxOiAtMQ0KICAgICAgICAgICAgICAgICAgICB9LDAscVcscVgpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcVk7DQogICAgICAgICAgICAgICAgICAgIHZhciBxWiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBxYSA9IDE7DQogICAgICAgICAgICAgICAgICAgIHZhciBxYiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBxYyA9IDEwNDg1NzU7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKHNlbGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucVUuZS5xZCA9IDEyNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLnRvcCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLmxlZnQgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBxUS5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBxUS5zdHlsZS5vdmVyZmxvd1ggPSBTWzE1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLm92ZXJmbG93WSA9IFNbOV07DQogICAgICAgICAgICAgICAgICAgICAgICBxUS5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1rOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVEuYWRkRXZlbnRMaXN0ZW5lcihTWzMwXSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWIgPSBxUS5zY3JvbGxUb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFiIDwgcVEuc2Nyb2xsSGVpZ2h0IC0gcVEuY2xpZW50SGVpZ2h0IC0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxYSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWEgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVIuc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVMuc3R5bGUud2lkdGggPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xVS5lLnNldEF0dHJpYnV0ZShTWzc5XSwgTCgxMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xVS5lLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucVUuZS5zdHlsZS50b3AgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFVLmUuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucVUuZS5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xVS5lLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1oOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xVS5lLnN0eWxlLnRleHRBbGlnbiA9IFNbMTBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVkgPSBuZXcgdyhMKDE0KSxxVyk7DQogICAgICAgICAgICAgICAgICAgICAgICBxWS5idXR0b24udG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVkuYnV0dG9uLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFZLmJ1dHRvbi5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVkucTEoYkEubncpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVQgPSBuZXcgcWUoIjEyNyIscVkuYnV0dG9uLDEsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxUS5hcHBlbmRDaGlsZChxUik7DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5hcHBlbmRDaGlsZChzZWxmLnFVLmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVMuYXBwZW5kQ2hpbGQocVkuYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxVygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFPKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxVC5xZi50ZXh0Q29udGVudCA9IDEyNzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxWChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBxVC5xZi50ZXh0Q29udGVudCA9IDEyNyAtIGUudGFyZ2V0LnZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFnID0gZnVuY3Rpb24ocWgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFjID0gMTA0ODU3NTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFSLnRleHRDb250ZW50ID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXFoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFpID0gYm0ueS5xalswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxayA9IGJtLnkucWxbcWldOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFtID0gcWsucW07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBxbS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgakMgPSBxYyA9PT0gMTA0ODU3NSA/IDAgOiAoZWcgLSAoKHFrLnFuIC0gcWMgKyAxMDQ4NTc1KSAlIDEwNDg1NzUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFjID0gcWsucW47DQogICAgICAgICAgICAgICAgICAgICAgICBqQyA9IE1hdGgubWF4KGpDLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqQyA+PSBlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxbyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gakM7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxcChxbywgYm0ucXEucXIocW1bYUJdLCBibS5xcS5xcyhxbVthQl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBxUi5hcHBlbmRDaGlsZChxbyk7DQogICAgICAgICAgICAgICAgICAgICAgICBxdCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdSA9IGZ1bmN0aW9uKHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxbyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFwKHFvLCByKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFSLmFwcGVuZENoaWxkKHFvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHF0KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxcChxbywgcFkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcFkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5xdiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBxby5hcHBlbmRDaGlsZChibS5xdy50cmFuc2Zvcm0ocFkpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxdChicikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcVEuc2Nyb2xsVG9wID0gcVEuc2Nyb2xsSGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChicikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFRLnNjcm9sbFRvcCA9IHFiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKHBhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYS5hcHBlbmRDaGlsZChxUSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYS5hcHBlbmRDaGlsZChxUyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZShwYSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24ocGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnJlbW92ZUNoaWxkKHFRKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnJlbW92ZUNoaWxkKHFTKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24ocGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFaID0gcGEgPyBwYS5vZmZzZXRIZWlnaHQgOiBxWjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxeSA9IGI5LnBnLnF6KDAuMDQsIDAuNzUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIwID0gTWF0aC5tYXgocXksIHFaIC0gcXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIxID0gaC5pIC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIyID0gMC43ICogcjE7DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS50b3AgPSBiOS5wZy5wcShxWiAtIHF5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFTLnN0eWxlLmhlaWdodCA9IGI5LnBnLnBxKHF5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFRLnN0eWxlLnRvcCA9IGI5LnBnLnBxKHFaIC0gcXkgLSByMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxUS5zdHlsZS5oZWlnaHQgPSBiOS5wZy5wcShyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihxUSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFVLmUuc3R5bGUud2lkdGggPSBiOS5wZy5wcShyMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFVLmUuc3R5bGUuZm9udFNpemUgPSBxWS5idXR0b24uc3R5bGUuZm9udFNpemUgPSBiOS5wZy5wcSgwLjUgKiBxeSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcih0aGlzLnFVLmUsIDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVkuYnV0dG9uLnN0eWxlLmxlZnQgPSBiOS5wZy5wcShyMik7DQogICAgICAgICAgICAgICAgICAgICAgICBxWS5idXR0b24uc3R5bGUud2lkdGggPSBiOS5wZy5wcShyMSAtIHIyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByMyA9IDAuMzg1ICogcXk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuYTEucjQoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIzICo9IDAuOCAtIChoLmkgPiBoLmopICogMC4xMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHFSLnN0eWxlLm1hcmdpbkxlZnQgPSBxUi5zdHlsZS5tYXJnaW5SaWdodCA9IGI5LnBnLnBxKDAuNSAqIHIzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFSLnN0eWxlLmZvbnRTaXplID0gYjkucGcucHEocjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcXQoMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcjUocjYsIHBzLCByNykgew0KICAgICAgICAgICAgICAgICAgICBwcyA9IHBzIHx8IEwoMTUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwIik7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSAocjYudmFsdWUgPyAi8J+fqSAiIDogIuKsnCAiKSArIHBzOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5tYXJnaW4gPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFNbMjVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5jdXJzb3IgPSBTWzMxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcihTWzI0XSwgY2xpY2spOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNsaWNrKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gMSAtIHI2LnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0Q29udGVudCA9ICh2YWx1ZSA/ICLwn5+pICIgOiAi4qycICIpICsgcHM7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocjYuZTEgIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KHI2LmUxLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHI2LnZhbHVlID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByNyAmJiByNyh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZFgodGhpcy5lKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gckEocGEsIHBUKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBwTCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGMgPSBwTDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYS5zdHlsZS5vdmVyZmxvd1ggPSBTWzE1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnN0eWxlLm92ZXJmbG93WSA9IFNbOV07DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5pbm5lckhUTUwgPSBwVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLmFwcGVuZENoaWxkKHBMKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUucGFkZGluZyA9IGI5LnBnLnBxKGJiLnBuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLnN0eWxlLmxpbmVIZWlnaHQgPSBiOS5wZy5wcShiOS5wZy5xeigwLjAzNSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gckIockMpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lID0gcEw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuckQgPSByQzsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSByQy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5oZWlnaHQgPSAiMi43ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUubWFyZ2luVG9wID0gU1s0MV07DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5ib3JkZXIgPSBTWzZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByQ1thQl0uc3R5bGUudmVydGljYWxBbGlnbiA9IFNbNjldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJDW2FCXS5zdHlsZS53aWR0aCA9ICgxMDAgLyBlZykudG9GaXhlZCgyKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByQ1thQl0uc3R5bGUuaGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByQ1thQl0uc3R5bGUuZm9udFNpemUgPSBTWzEyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTC5hcHBlbmRDaGlsZChyQ1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSByQy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHJDW2FCXSwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiByRShyRiwgcHUsIHJHKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucEwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFHID0gckY7DQogICAgICAgICAgICAgICAgICAgIHZhciBySCA9IDA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKHJJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBySS5wTC5zdHlsZS5oZWlnaHQgPSBySS5wTC5zdHlsZS5tYXhIZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHJGLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJGW2FCXS5xMShwdSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgckZbYUJdLmJ1dHRvbi5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJGW2FCXS5idXR0b24uc3R5bGUucGFkZGluZyA9IFNbNjJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJJLnBMLmFwcGVuZENoaWxkKHJGW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24ocGEsIHJKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSByRi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJHKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAxOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHJGW2FCXS5idXR0b24sIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBySyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJLICs9IHJGW2FCXS5idXR0b24ub2Zmc2V0V2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBySCA9IHBhLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJKICYmIHJLIDwgckgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByRlthQl0uYnV0dG9uLnN0eWxlLndpZHRoID0gKDEwMCAqIHJGW2FCXS5idXR0b24ub2Zmc2V0V2lkdGggLyBySykudG9GaXhlZCgyKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJGW2FCXS5idXR0b24uc3R5bGUud2lkdGggPSBTWzldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghckopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZShwYSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gckwoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImhyIik7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUubWFyZ2luQm90dG9tID0gZS5zdHlsZS5tYXJnaW5Ub3AgPSAiMC42NWVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUubWFyZ2luTGVmdCA9IGUuc3R5bGUubWFyZ2luUmlnaHQgPSAiLTQlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUuYm9yZGVyID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIodGhpcy5lLCA4LCBiQS5tdik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzLmUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiByTSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJOID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJPID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJQID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJRLCByUjsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5wb2ludGVyRXZlbnRzID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLnpJbmRleCA9ICI1IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLm1heFdpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbihlbiwgZXAsIHBOLCByUywgclQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA9PT0gZXAgJiYgZW4gPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSByUTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcCA9IHJSOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByUSA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJSID0gZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgclAgPSByUzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJPID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByVSA9IGguaSAvIGguazsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLndoaXRlU3BhY2UgPSBTWzI4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnRleHRDb250ZW50ID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihyTiwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5mb250ID0gYjkucGcuclYoMCwgYjkucGcucXooMC4wMTUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLnBhZGRpbmcgPSAiMC4zZW0gMC42ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUubGVmdCA9IGVuICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLnRvcCA9IFNbNjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChyTik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHAgPSBlbiArIHJOLm9mZnNldFdpZHRoIC0gclU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHAgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJXID0gZW4gLSBocDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5sZWZ0ID0gclcgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyVyA8IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUud2hpdGVTcGFjZSA9IFNbNzhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLnRvcCA9IChlcCAtIHJOLm9mZnNldEhlaWdodCArIHJQICogYmIuclgpICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbihyWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJZICYmIHJQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByTyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHJOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgcTAoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcVYoclosIHR5cGUsIHJhLCByYikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMjJdKTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZS50eXBlID0gdHlwZSA/IFNbNDZdIDogU1s0M107DQogICAgICAgICAgICAgICAgICAgICAgICBlLmlkID0gU1syMl0gKyAodC55LnJjKyspOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS52YWx1ZSA9IHJaLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLnVzZXJTZWxlY3QgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5vdXRsaW5lID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUucmVzaXplID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUuYm9yZGVyID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1mOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5mb250U2l6ZSA9IFNbMTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5wYWRkaW5nID0gIjAuMWVtIDAuMmVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcihTWzUwXSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5yZCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoU1s1MV0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgucmQtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoclouZTEgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KHJaLmUxLCBlLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcigia2V5cHJlc3MiLCBmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFNbMzldKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyWi5lMSAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KHJaLmUxLCBlLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmJsdXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5hZGRFdmVudExpc3RlbmVyKFNbMjJdLCBmdW5jdGlvbihwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYihwWSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZFgodGhpcy5lKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcmUocGEsIGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZGF0YS5yZi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIHZhciByZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciByaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciByaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciByaiA9IG5ldyBBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYiA9IG5ldyBBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgIHZhciByayA9IG5ldyBBcnJheShkYXRhLnJsLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBybSA9IGI5LmNvbG9yLm1nKDcwLCA3MCwgMCwgMC4zNSk7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuc3R5bGUuZGlzcGxheSA9IFNbMTZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuc3R5bGUuZmxleERpcmVjdGlvbiA9ICJjb2x1bW4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmguc3R5bGUub3ZlcmZsb3dYID0gU1sxNV07DQogICAgICAgICAgICAgICAgICAgICAgICByaC5zdHlsZS5vdmVyZmxvd1kgPSBTWzldOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmguYWRkRXZlbnRMaXN0ZW5lcihTWzMwXSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ybiA9IHRoaXMuc2Nyb2xsVG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBybygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBybygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiwgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmYgPSBkYXRhLnJmOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gZWcgPyByZlswXS5sZW5ndGggOiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByalthQl0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJqW2FCXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBycChhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmpbYUJdLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByalthQl0uc3R5bGUuZGlzcGxheSA9IFNbMTZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiW2FCXSA9IG5ldyBBcnJheShrZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXogPSAwOyBleiA8IGtkOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiW2FCXVtlel0gPSBlaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnN0eWxlLmRpc3BsYXkgPSBTWzE2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouc3R5bGUuanVzdGlmeUNvbnRlbnQgPSBTWzEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouc3R5bGUud29yZEJyZWFrID0gU1s5MV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnN0eWxlLnBhZGRpbmcgPSBTWzExNV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnN0eWxlLndpZHRoID0gZGF0YS5ycVtlel0gKyAiJSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmlubmVySFRNTCA9IHJmW2FCXVtlel0uZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZlthQl1bZXpdLmRsID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5uYW1lID0gIiIgKyBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnN0eWxlLmNvbG9yID0gYkEubmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBybTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmFkZEV2ZW50TGlzdGVuZXIoU1s4MF0sIHFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmFkZEV2ZW50TGlzdGVuZXIoU1s4MV0sIHJyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzKGVqLCByZlthQl1bZXpdLnJ0LCByZlthQl1bZXpdLnJ1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByalthQl0uYXBwZW5kQ2hpbGQoZWopOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJnLnN0eWxlLmRpc3BsYXkgPSBTWzE2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGI5LmNvbG9yLm1nKDAsIDEyMCwgMCwgMC4zNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCByay5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBya1thQl0gPSBlaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouc3R5bGUuZGlzcGxheSA9IFNbMTZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gU1sxMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouc3R5bGUud29yZEJyZWFrID0gU1s5MV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouc3R5bGUucGFkZGluZyA9IFNbMTE1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5zdHlsZS53aWR0aCA9IGRhdGEucnFbYUJdICsgIiUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmlubmVySFRNTCA9IGRhdGEucmxbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJnLmFwcGVuZENoaWxkKGVqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBycyhlaiwgcnQsIHJ1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocnUgPT09IDIxNDc0ODM2NDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlai5hZGRFdmVudExpc3RlbmVyKFNbMjRdLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMzAsIHJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiRy5kWChiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBybTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5ydiwgbmV3IHJ3KDI1LHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBiRS5yeS5yeihiRS5yeS5zMCg1KSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1OiBydQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHFDKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiOS5jb2xvci5xQyhybSwgMTYwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBycigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcm07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcUgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaS5hcHBlbmRDaGlsZChyalthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmguYXBwZW5kQ2hpbGQocmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuYXBwZW5kQ2hpbGQocmcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGEuYXBwZW5kQ2hpbGQocmgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHJwKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUIgJSAyID09PSAxID8gYjkuY29sb3IubWcoMTMwLCAxMzAsIDEzMCwgMC4zNSkgOiBiQS5tbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBrKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBwaygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZXo7DQogICAgICAgICAgICAgICAgICAgICAgICBwYS5zdHlsZS5mb250ID0gYjkucGcuclYoMCwgYjkucGcuczEoMC4wMjYsIDAuNSwgMC4wMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgcmsubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIocmtbYUJdLCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHJnLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgczIgPSByZy5vZmZzZXRXaWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzMyA9IHJpLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGg1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgcmsubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaDUgPSAwLjAxICogZGF0YS5ycVthQl0gKiBzMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBya1thQl0uc3R5bGUud2lkdGggPSAoMTAwICogaDUgLyBzMikudG9GaXhlZCgyKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGRhdGEucmZbMF0ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihyalthQl0sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSAxOyBleiA8IGtkOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHBiW2FCXVtlel0sIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyaC5ybikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJoLnNjcm9sbFRvcCA9IHJoLnJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHM0KCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgczUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgczYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgczcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcmkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgcUcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHM4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgczk7DQogICAgICAgICAgICAgICAgICAgIHZhciBkdyA9IFtMKDE2KSwgTCgxNyksIEwoMTgpLCBMKDE5KSwgTCgyMCksIEwoMjEpLCBMKDIyKV07DQogICAgICAgICAgICAgICAgICAgIHZhciBzQSA9IFsxLCAyLCAzLCAwLCA5LCAxMCwgMTFdOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM1LnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM2LnN0eWxlLndpZHRoID0gIjI1JSI7DQogICAgICAgICAgICAgICAgICAgICAgICBzNi5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgczYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYkEubWk7DQogICAgICAgICAgICAgICAgICAgICAgICBzNy5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBzNy5zdHlsZS53aWR0aCA9ICI3NSUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgczcuc3R5bGUuaGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM3LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1pOw0KICAgICAgICAgICAgICAgICAgICAgICAgczcuc3R5bGUudG9wID0gczcuc3R5bGUucmlnaHQgPSBiOS5wZy5wcSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNCKHM3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJpLnN0eWxlLmhlaWdodCA9IHJpLnN0eWxlLm1heEhlaWdodCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5XKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5YKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5QKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5BKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5yKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5wKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxRy5wdXNoKG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNDKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5yKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBzOCA9IG5ldyBBcnJheShxRy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHFHLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHW2FCXS5idXR0b24uc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM4W2FCXSA9IFtuZXcgc0QoZHdbYUJdLHFHW2FCXS5idXR0b24sMC4yNSwwLjQ1KSwgbmV3IHNEKCIiLHFHW2FCXS5idXR0b24sMC41MywwLjg0LDEpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1thQl0uYnV0dG9uLnN0eWxlLmhlaWdodCA9IHFHW2FCXS5idXR0b24uc3R5bGUubWF4SGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1thQl0uYnV0dG9uLnRvcCA9IGI5LnBnLnBxKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpLmFwcGVuZENoaWxkKHFHW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgczcuYXBwZW5kQ2hpbGQocmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgczUuYXBwZW5kQ2hpbGQoczYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgczUuYXBwZW5kQ2hpbGQoczcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNDKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgMCwgbmV3IHJ3KDIxLHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRTogc0FbYUJdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNHOiAxMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yOSh0Lnkuc0gpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzNSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHM1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucjkgPSBmdW5jdGlvbihzSCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNJID0gWzMsIDAsIDEsIDIsIDQsIDUsIDZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHFHLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gc0hbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBpID8gaSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM4W3NJW2FCXV1bMV0ucWYudGV4dENvbnRlbnQgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gYjkucGcuc0soMC4wODUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLm1pbig0ICogaiwgaC5pIC0gMiAqIHNKKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHFHLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNMKHM1LCBzSiwgaC5qIC0gc0ogLSBqLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHM1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHM2LCA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnIC0gMTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHFHW2FCXS5idXR0b24sIDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzOFthQl1bMF0ucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgczhbYUJdWzFdLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uZW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uYnV0dG9uLnN0eWxlLmxlZnQgPSBiOS5wZy5wcShxR1swXS5lbik7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5idXR0b24uc3R5bGUud2lkdGggPSBiOS5wZy5zTSgxLjcgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAxOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbYUJdLmVuID0gcUdbYUIgLSAxXS5lbiArIHFHW2FCIC0gMV0uYnV0dG9uLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHW2FCXS5idXR0b24uc3R5bGUubGVmdCA9IGI5LnBnLnBxKHFHW2FCXS5lbik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXM5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYi5zTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgczkgPSBhYi5nZXQoMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM5LnN0eWxlLndpZHRoID0gIjI0JSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgczkuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM2LmFwcGVuZENoaWxkKHM5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHM5LnN0eWxlLmxlZnQgPSBiOS5wZy5wcSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM5LnN0eWxlLnRvcCA9ICI3JSI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoczcuc08pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzNy5zY3JvbGxMZWZ0ID0gczcuc087DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzUChzUSwgc1IsIHNTLCBzVCwgcU8sIHFQKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBzVSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzViA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzVyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzWCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzWSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzWiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBzYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1sxNF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgc2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNlID0gbmV3IHFOKHFPLHFQKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZiA9IG5ldyBzZyhxUCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2ggPSBbc1EsIHNSLCBzUywgc1RdOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMChzZWxmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS50b3AgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUud2lkdGggPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUuaGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1sOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiSS5xOSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUuYmFja2Ryb3BGaWx0ZXIgPSBTWzkyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS53ZWJraXRCYWNrZHJvcEZpbHRlciA9IFNbOTJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc1Yuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Yuc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Yuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLnN0eWxlLmRpc3BsYXkgPSBTWzE2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLnN0eWxlLmFsaWduSXRlbXMgPSBTWzEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW3NXLCBzWCwgc1ksIHNkXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbYUJdLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXS5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbYUJdLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5zQihnW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzWi5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBzWi5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1ouc3R5bGUud2lkdGggPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1ouc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICBzYS5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBzYS5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Euc3R5bGUud2lkdGggPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Iuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Iuc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Iuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNiLnN0eWxlLmhlaWdodCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBzYi5zdHlsZS53aWR0aCA9IFNbNTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Iuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYkEubjg7DQogICAgICAgICAgICAgICAgICAgICAgICBzYy5pbm5lckhUTUwgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNjLnN0eWxlLnRvcCA9IFNbNTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Muc3R5bGUubGVmdCA9IFNbNTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Muc3R5bGUudHJhbnNmb3JtID0gInRyYW5zbGF0ZSgtNTAlLCAtNTAlKSI7DQogICAgICAgICAgICAgICAgICAgICAgICBzaSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZi5zaG93KHNaKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLmFwcGVuZENoaWxkKHNqKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1cuYXBwZW5kQ2hpbGQoc1EucEwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1guYXBwZW5kQ2hpbGQoc1IucEwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1kuYXBwZW5kQ2hpbGQoc1MucEwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2EuYXBwZW5kQ2hpbGQoc2IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2EuYXBwZW5kQ2hpbGQoc2MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2QuYXBwZW5kQ2hpbGQoc1QucEwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1YpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1gpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1kpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1opOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc2EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc2QpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNqKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaDEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNrLnRleHRDb250ZW50ID0gTCgyMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzay5zdHlsZS5tYXJnaW4gPSAiMCBhdXRvIDAuMTVlbSBhdXRvIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNrLnN0eWxlLndlYmtpdFRleHRTdHJva2UgPSBTWzExN107DQogICAgICAgICAgICAgICAgICAgICAgICBzay5zdHlsZS5mb250RmFtaWx5ID0gU1sxMDddOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2suc3R5bGUuZm9udFNpemUgPSBTWzZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2suc3R5bGUuZm9udFdlaWdodCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2s7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zbCA9IGZ1bmN0aW9uKHNtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAoc20gLyAxMCkudG9GaXhlZCgxKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNiLnN0eWxlLndpZHRoID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICBzYy5pbm5lckhUTUwgPSBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc24gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2YucXgoc1opOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZS5zaG93KHNaKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc28gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2UucXgoc1opOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZi5zaG93KHNaKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc3AgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzVjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzVSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oc3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzciA9IDEgLSAwLjQgKiBhMC5hMS5yNCgpICogKGguaSA+IDEuNiAqIGguaik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3MgPSBiOS5wZy5xeihzciAqIDAuMDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ID0gaC5qID4gaC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1ID0gYjkucGcucXooc3IgKiAwLjA3ICsgMC4wMyAqIHN0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdiA9IGI5LnBnLnF6KDAuMDQgKyAwLjAyICogc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN3ID0gYjkucGcucXooc3IgKiAwLjAyICsgMC4wMSAqIHN0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzeCA9IGI5LnBnLnF6KDAuMDI1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigwLCBzeCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3IgPCAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN5ID0gYjkucGcuclYoMCwgc3IgKiBzeCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc1cuc3R5bGUuZm9udCA9IHN5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNZLnN0eWxlLmZvbnQgPSBzeTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZC5zdHlsZS5mb250ID0gc3k7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Euc3R5bGUuZm9udCA9IHN5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNYLnN0eWxlLmZvbnQgPSBzeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLnN0eWxlLmhlaWdodCA9IGI5LnBnLnBxKHNzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNWLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigwLCAwLjcyICogc3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIoc1YsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1cuc3R5bGUudG9wID0gYjkucGcucHEoc3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1cuc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEoc3UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIoc1csIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1guc3R5bGUuZm9udCA9IGI5LnBnLnJWKDAsIHNyICogYjkucGcucXooMC4wMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1guc3R5bGUudG9wID0gYjkucGcucHEoc3MgKyBzdSk7DQogICAgICAgICAgICAgICAgICAgICAgICBzWC5zdHlsZS5oZWlnaHQgPSBiOS5wZy5wcShzdik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihzWCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBzWS5zdHlsZS50b3AgPSBiOS5wZy5wcShzcyArIHN1ICsgc3YpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1kuc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEoc3UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIoc1ksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1ouc3R5bGUudG9wID0gYjkucGcucHEoc3MgKyBzdSArIHN2ICsgc3UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1ouc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEoaC5qIC8gaC5rIC0gc3MgLSAzICogc3UgLSBzdiAtIHN3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNhLnN0eWxlLnRvcCA9IGI5LnBnLnBxKGguaiAvIGguayAtIHN1IC0gc3cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Euc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEoc3cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIoc2EsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2Muc3R5bGUuZm9udCA9IGI5LnBnLnJWKDAsIDAuOCAqIHN3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNkLnN0eWxlLnRvcCA9IGI5LnBnLnBxKGguaiAvIGguayAtIHN1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNkLnN0eWxlLmhlaWdodCA9IGI5LnBnLnBxKHN1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHNkLCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNRLnJlc2l6ZShzVyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzUi5yZXNpemUoc1cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1MucmVzaXplKHNXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNULnJlc2l6ZShzVyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlLnJlc2l6ZShzWik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2YucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gc2cocVApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNVID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNaID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS50b3AgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUud2lkdGggPSBzVS5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUub3ZlcmZsb3dYID0gU1sxNV07DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS5vdmVyZmxvd1kgPSBTWzldOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICBzWi5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNaLnN0eWxlLm1hcmdpbiA9IFNbNDJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQoc1opOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNaLnRleHRDb250ZW50ID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBibS5zei5xeCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxbyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0MCA9IGJtLnkucWpbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdDEgPSBibS50MS50Mlt0MF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdDMgPSBibS50MS50M1t0MF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgdDEubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdDQocW8sIHQxW2FCXSwgYUIgPCB0MywgdDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc1ouYXBwZW5kQ2hpbGQocW8pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdDQocW8sIHBZLCB0NSwgdDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxZiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1sxNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYudGV4dENvbnRlbnQgPSAodDUgPyAi8J+foiAiIDogIuKaqiAiKSArIGJtLnFxLnQ2KHBZLCB0MCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5jb2xvciA9IGJtLnFxLnQ3KHBZLnQ4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLmN1cnNvciA9IFNbMzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUubWFyZ2luID0gIjAuMmVtIDAuMmVtIDAuMmVtIDAuMmVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLndpZHRoID0gcWYuc3R5bGUubWF4V2lkdGggPSB0MCA9PT0gMiA/ICIxMGVtIiA6ICI5ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUuaGVpZ2h0ID0gcWYuc3R5bGUubWF4SGVpZ2h0ID0gU1sxMTBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUud2hpdGVTcGFjZSA9IFNbNDddOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUub3ZlcmZsb3cgPSBTWzE1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLnRleHRPdmVyZmxvdyA9ICJlbGxpcHNpcyI7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLmRpc3BsYXkgPSBTWzQ5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnFxLnQ5KHBZKSAmJiAocWYuc3R5bGUudGV4dERlY29yYXRpb24gPSBTWzY4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5vbmNsaWNrID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFQKGUsIHBZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgICAgICFiSS5xOSgpICYmIChxZi5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS5zei50QShlLCBwWSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcW8uYXBwZW5kQ2hpbGQocWYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKHBhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwYS5hcHBlbmRDaGlsZChzVSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24ocGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhLnJlbW92ZUNoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzWi5zdHlsZS5mb250U2l6ZSA9IGI5LnBnLnBxKGI5LnBnLnF6KDAuMDIsIDAuMykpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgcTAoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gdEIodEMpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNVID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHFTID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHREID0gW107DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLnpJbmRleCA9ICIzIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLnJpZ2h0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVMuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVMuc3R5bGUuaGVpZ2h0ID0gU1s5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFTLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFTLnN0eWxlLmxlZnQgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS5vdmVyZmxvd1dyYXAgPSBTWzM1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLmFwcGVuZENoaWxkKHFTKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCA0OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0uc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHREW2FCXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0uc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0uc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHREW2FCXS5zdHlsZS5kaXNwbGF5ID0gU1sxNl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gU1sxMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLnN0eWxlLmFsaWduSXRlbXMgPSBTWzEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0uc3R5bGUudXNlclNlbGVjdCA9IFNbNV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLnN0eWxlLm91dGxpbmUgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHREW2FCXS5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0udEUgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLm9uY2xpY2sgPSB0QzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLm9ubW91c2VvdmVyID0gcTQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHREW2FCXS5vbm1vdXNlb3V0ID0gcTU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNVLmFwcGVuZENoaWxkKHREW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0RFswXS50ZXh0Q29udGVudCA9ICLil4AiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdERbMV0udGV4dENvbnRlbnQgPSAi4pa2IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHREWzNdLnRleHRDb250ZW50ID0gIuKcliI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yOSA9IGZ1bmN0aW9uKHRGLCB0Rykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdERbMl0udGV4dENvbnRlbnQgPSAodEYgKyAxKSArIFNbMjBdICsgdEc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxNCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiSS5xOSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiOS5jb2xvci5xQyhiQS5taSwgNTApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHE1KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbihwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcVMuYXBwZW5kQ2hpbGQoYm0ucXcudHJhbnNmb3JtKGJtLnFxLnFyKHBZLCBibS5xcS5xcyhwWSkpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IGI5LnBnLnF6KDAuMDMsIDAuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS53aWR0aCA9ICgxMCAqIGopICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigxLCAwLjc1ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihzVSwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxUy5zdHlsZS50b3AgPSBqICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFTLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigwLCAwLjU1ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihxUywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS5oZWlnaHQgPSAoaiArIHFTLm9mZnNldEhlaWdodCkgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDM7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcih0RFthQl0sIDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHREW1swLCAxLCAzXVthQl1dLnN0eWxlLndpZHRoID0gKDIgKiBqKSArICJweCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA0OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLnN0eWxlLmhlaWdodCA9IGogKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHREW2FCXSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0RFsyXS5zdHlsZS53aWR0aCA9ICg0ICogaikgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdERbMV0uc3R5bGUubGVmdCA9ICgyICogaikgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdERbMl0uc3R5bGUubGVmdCA9ICg0ICogaikgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdERbM10uc3R5bGUubGVmdCA9ICg4ICogaikgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50SCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0ub25jbGljayA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdERbYUJdLm9ubW91c2VvdmVyID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0RFthQl0ub25tb3VzZW91dCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVID0gcVMgPSB0RCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0SSh0Qykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgck4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHE1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5jb2xvciA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUuekluZGV4ID0gIjMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUucmlnaHQgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS50b3AgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5kaXNwbGF5ID0gU1sxNl07DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5qdXN0aWZ5Q29udGVudCA9IFNbMTBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUuYWxpZ25JdGVtcyA9IFNbMTBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgck4uc3R5bGUudXNlclNlbGVjdCA9IFNbNV07DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5vdXRsaW5lID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLm9uY2xpY2sgPSB0QzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLm9ubW91c2VvdmVyID0gcTQ7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5vbm1vdXNlb3V0ID0gcTU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkkucTkoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGI5LmNvbG9yLnFDKGJBLm1pLCA1MCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnI5ID0gZnVuY3Rpb24odEcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnRleHRDb250ZW50ID0gdEc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQock4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gYjkucGcucXooMC4wMywgMC41KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLndpZHRoID0gKDIgKiBqKSArICJweCI7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5zdHlsZS5oZWlnaHQgPSBqICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigxLCAwLjc1ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihyTiwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihyTiwgMik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRIID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByTi5vbmNsaWNrID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLm9ubW91c2VvdmVyID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJOLm9ubW91c2VvdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChyTik7DQogICAgICAgICAgICAgICAgICAgICAgICByTiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0SihyRikgew0KICAgICAgICAgICAgICAgICAgICB2YXIgc1UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB2YXIgdEsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMF0pOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVuID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciByTyA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucUcgPSByRjsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgckYubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IHFlKCIiICsgKDEgKyBhQiksckZbYUJdLmJ1dHRvbiwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1Uuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNVLnN0eWxlLmhlaWdodCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5zdHlsZS56SW5kZXggPSAiNSI7DQogICAgICAgICAgICAgICAgICAgICAgICB0Sy5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICB0TCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYXBwZW5kQ2hpbGQodEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1UuYWRkRXZlbnRMaXN0ZW5lcihTWzI0XSwgdE0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRNKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYm0udE4ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0TCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0TyA9ICgxMDAgLyByRi5sZW5ndGgpLnRvRml4ZWQoMikgKyAiJSI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgckYubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgckZbYUJdLmJ1dHRvbi5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgckZbYUJdLmJ1dHRvbi5zdHlsZS5oZWlnaHQgPSByRlthQl0uYnV0dG9uLnN0eWxlLm1heEhlaWdodCA9IHRPOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJGW2FCXS5idXR0b24uc3R5bGUucGFkZGluZyA9IFNbNjJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRLLmFwcGVuZENoaWxkKHJGW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKGVuLCBlcCwgdFApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMCwgMF07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByTyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuID0gZW47DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB0USh0aGlzLCB0UCk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghck8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByTyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBzVS5yZW1vdmVFdmVudExpc3RlbmVyKFNbMjRdLCB0TSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNVKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRRKHNlbGYsIHRQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGI5LnBnLnF6KDAuMTYsIDAuNyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IHJGLmxlbmd0aCAqIGkgLyAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRSID0gaC5pIC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRTID0gaC5qIC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gTWF0aC5taW4oMSwgTWF0aC5taW4odFIgLyBpLCB0UyAvIGopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgKj0gbU87DQogICAgICAgICAgICAgICAgICAgICAgICBqICo9IG1POw0KICAgICAgICAgICAgICAgICAgICAgICAgdFAgJiYgKHNlbGYuZW4gKz0gYjkucGcucXooMC4wMywgMC41KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVuID0gYksucEUoc2VsZi5lbiwgMCwgdFIgLSBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZXAgPSBiSy5wRShzZWxmLmVwLCAwLCB0UyAtIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdEsuc3R5bGUubGVmdCA9IHNlbGYuZW4gKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdEsuc3R5bGUudG9wID0gc2VsZi5lcCArICJweCI7DQogICAgICAgICAgICAgICAgICAgICAgICB0Sy5zdHlsZS53aWR0aCA9IGkgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdEsuc3R5bGUuaGVpZ2h0ID0gaiArICJweCI7DQogICAgICAgICAgICAgICAgICAgICAgICB0Sy5zdHlsZS5mb250ID0gYjkucGcuclYoMCwgMC4zNCAqIGogLyByRi5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIodEssIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAxOyBhQiA8IHJGLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnByKHJGW2FCXS5idXR0b24sIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHEwKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRUKHJaLCB0VSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBXID0gW107DQogICAgICAgICAgICAgICAgICAgIHZhciB0ViA9IHRoaXMucFc7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRXOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcloudFgubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFcudGV4dENvbnRlbnQgPSAi4pqqICIgKyByWi50WFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFcuc3R5bGUubWFyZ2luID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRXLm5hbWUgPSAiIiArIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRXLnN0eWxlLmN1cnNvciA9IFNbMzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRXLnN0eWxlLmZvbnRTaXplID0gU1sxN107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFcuYWRkRXZlbnRMaXN0ZW5lcihTWzI0XSwgY2xpY2spOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRWLnB1c2godFcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdFZbcloudmFsdWVdLnRleHRDb250ZW50ID0gdFZbcloudmFsdWVdLnRleHRDb250ZW50LnJlcGxhY2UoIuKaqiIsICLwn5+iIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2xpY2soKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgdFYubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFZbYUJdLnRleHRDb250ZW50ID0gdFZbYUJdLnRleHRDb250ZW50LnJlcGxhY2UoIvCfn6IiLCAi4pqqIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRDb250ZW50ID0gdGhpcy50ZXh0Q29udGVudC5yZXBsYWNlKCLimqoiLCAi8J+foiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gcGFyc2VJbnQodGhpcy5uYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyWi5lMSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoclouZTEsIGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0VSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRVKGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0WSh0aXRsZSwgdFosIHRhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBzNSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB0YiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciByaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB0YyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciB0ZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1swXSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGUgPSByaTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZiA9IHRaOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM1LnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM1LnN0eWxlLnRvcCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM1LnN0eWxlLmxlZnQgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBzNS5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBzNS5zdHlsZS5oZWlnaHQgPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGIuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGIuc3R5bGUudG9wID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGIuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRiLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRiLnN0eWxlLmRpc3BsYXkgPSBTWzE2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRiLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJBLm1pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuc3R5bGUubGVmdCA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRjLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNCKHRjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRkLnN0eWxlLmhlaWdodCA9IHRkLnN0eWxlLm1heEhlaWdodCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICByaS5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICByaS5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICByaS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRnKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxSCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRnKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHRaLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRaW2FCXS5idXR0b24uc3R5bGUuaGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WlthQl0uYnV0dG9uLnN0eWxlLnBhZGRpbmcgPSBTWzYyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxSCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCB0Wi5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZC5hcHBlbmRDaGlsZCh0WlthQl0uYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRiLmFwcGVuZENoaWxkKHRoKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuYXBwZW5kQ2hpbGQodGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHM1LmFwcGVuZENoaWxkKHJpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzNS5hcHBlbmRDaGlsZCh0Yik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgczUuYXBwZW5kQ2hpbGQodGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHRoKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaDEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpLnRleHRDb250ZW50ID0gdGl0bGU7DQogICAgICAgICAgICAgICAgICAgICAgICB0aS5zdHlsZS5tYXJnaW4gPSBTWzldOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGkuc3R5bGUuZm9udFNpemUgPSAodGl0bGUubGVuZ3RoID4gMjAgJiYgaC5qID4gaC5pKSA/ICIxLjhlbSIgOiAiMi4zZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGkuc3R5bGUud2Via2l0VGV4dFN0cm9rZSA9IFNbMTE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpLnN0eWxlLmZvbnRGYW1pbHkgPSBTWzEwN107DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGEgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhICE9PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoczUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGogPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByMCA9IGI5LnBnLnF6KDAuMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXkgPSBiOS5wZy5xeigwLjA4ICsgMC4wNCAqIChoLnRrIDwgMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRsID0gaC5qIC8gaC5rIC0gcjAgLSBxeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcjA6IHIwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF5OiBxeSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bDogdGwNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKHJKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB0Wi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG0gPSB0aGlzLnRqKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcjAgPSB0bS5yMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxeSA9IHRtLnF5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGIuc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEocjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIodGIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuc3R5bGUudG9wID0gYjkucGcucHEoaC5qIC8gaC5rIC0gcXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuc3R5bGUuaGVpZ2h0ID0gYjkucGcucHEocXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcucHIodGMsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmkuc3R5bGUudG9wID0gYjkucGcucHEocjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmkuc3R5bGUuaGVpZ2h0ID0gcmkuc3R5bGUubWF4SGVpZ2h0ID0gYjkucGcucHEodG0udGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGIuc3R5bGUuZm9udCA9IGI5LnBnLnJWKDAsIGI5LnBnLnF6KDAuMDIsIDAuMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGMuc3R5bGUuZm9udCA9IGI5LnBnLnJWKDAsIGI5LnBnLnF6KDAuMDIsIDAuNykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmkuc3R5bGUuZm9udCA9IGI5LnBnLnJWKDAsIGI5LnBnLnF6KDAuMDIsIDAuNykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcih0WlthQl0uYnV0dG9uLCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBySyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJLICs9IHRaW2FCXS5idXR0b24ub2Zmc2V0V2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAockogJiYgcksgPCB0Yy5vZmZzZXRXaWR0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0WlthQl0uYnV0dG9uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLndpZHRoID0gKDEwMCAqIHRaW2FCXS5idXR0b24ub2Zmc2V0V2lkdGggLyBySykudG9GaXhlZCgyKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0WlthQl0uYnV0dG9uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLndpZHRoID0gU1s5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGMuc08pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Yy5zY3JvbGxMZWZ0ID0gdGMuc087DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG0gPSB0aGlzLnRqKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBoLms7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIGYxICogdG0ucjAsIGguaSwgZjEgKiB0bS50bCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBxZSh0cCwgdHEsIHRyLCB0cykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzE0XSk7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKHNlbGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYudGV4dENvbnRlbnQgPSB0cDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xZi5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUuYm90dG9tID0gIjAuMDZlbSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUudG9wID0gIjAuMTJlbSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFmLnN0eWxlLmxlZnQgPSBTWzExNl07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUucmlnaHQgPSBTWzExNl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFmLnN0eWxlLmZvbnRTaXplID0gU1s0MV07DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFmLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xZi5zdHlsZS53aGl0ZVNwYWNlID0gU1syOF07DQogICAgICAgICAgICAgICAgICAgICAgICB0cS5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7DQogICAgICAgICAgICAgICAgICAgICAgICB0cS5zdHlsZS5vdmVyZmxvdyA9IFNbMTVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHEuYXBwZW5kQ2hpbGQoc2VsZi5xZik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcTAodGhpcyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNEKHRwLCB0cSwgdHQsIHR1LCB0dikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzE0XSk7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKHNlbGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYudGV4dENvbnRlbnQgPSB0cDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFmLnN0eWxlLm1hcmdpbiA9ICIwLjFlbSAwLjZlbSI7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnFmLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHYgJiYgKHNlbGYucWYuc3R5bGUuZm9udFdlaWdodCA9IFNbMzZdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucWYuc3R5bGUud2hpdGVTcGFjZSA9IFNbNDddOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5xZi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRxLmFwcGVuZENoaWxkKHNlbGYucWYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFmLnN0eWxlLmZvbnRTaXplID0gKCh0dSAtIHR0KSAqIHRxLm9mZnNldEhlaWdodCkudG9GaXhlZCgxKSArICJweCI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCh0aGlzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gdHcodHgsIHR5LCB0eiwgdTApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lID0gdTE7DQogICAgICAgICAgICAgICAgICAgIHZhciB1MiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdTEuc2V0QXR0cmlidXRlKCJpZCIsICJ0ZXh0QXJlYSIgKyAodC55LnJjKyspKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLnNldEF0dHJpYnV0ZSgiYXV0b2NvbXBsZXRlIiwgIm9mZiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEuc2V0QXR0cmlidXRlKFNbNzldLCB0eCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zdHlsZS50b3AgPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zdHlsZS5sZWZ0ID0gIjAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUud2lkdGggPSBTWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUuaGVpZ2h0ID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLnN0eWxlLnVzZXJTZWxlY3QgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUub3V0bGluZSA9IFNbNV07DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zdHlsZS5yZXNpemUgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUuYm9yZGVyID0gU1s1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiQS5tZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxLnN0eWxlLmZvbnRTaXplID0gU1sxN107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEucm93cyA9IDY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUucGFkZGluZyA9ICIwLjI1ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MS5zdHlsZS5wYWRkaW5nID0gIjAuNDVlbSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEuc3R5bGUuZm9udFNpemUgPSBTWzU4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxLmFkZEV2ZW50TGlzdGVuZXIoU1syMl0sIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHooZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5hZGRFdmVudExpc3RlbmVyKFNbNTBdLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnJkKys7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLmFkZEV2ZW50TGlzdGVuZXIoU1s1MV0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgucmQtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcih1MSwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnUzID0gZnVuY3Rpb24odTQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLnZhbHVlID0gdTQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnU1ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdTEudmFsdWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnU2ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHUxLnZhbHVlID0gIiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnU3ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodTIgJiYgbmF2aWdhdG9yLmNsaXBib2FyZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxLnNlbGVjdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHUxLnZhbHVlKS5jYXRjaChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB1OCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdTgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB1MS5zZWxlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCJjb3B5Iik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZEUoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucHkgPSBuZXcgdTkoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lRCA9IG5ldyB1QSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnI4ID0gbmV3IHVCKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IG5ldyB1QygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVELmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAobmV3IHVEKCkpLmRYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB1QSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gW107DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDAsIDEsIDAsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMSwgMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDMsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoNCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1Rig1LCAyLCBTWzcxXSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSg2LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDcsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoOCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSg5LCAxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDExLCAxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEyLCAyLCBuYXZpZ2F0b3IubGFuZ3VhZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUcoMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEwMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMDEsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTAyLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEwMywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMDQsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTA1LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEwNiwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEwOSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMTAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTExKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDExMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTE0LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDExNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMTYsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTE3LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDExOCwgMiwgIiIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTE5LCAxLCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEyMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMjEsIDEsIH5+KE1hdGgucmFuZG9tKCkgKiAyNjIxNDQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDEyMiwgMiwgU1s1NF0gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTI0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEyNSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMjYsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTI3LCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEyOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMjkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEzMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTMzLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEzNCwgMCwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxMzUsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTM2LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDEzNyk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxMzgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTM5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE0MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTQyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE0Myk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTQ1LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE0Nik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTQ4LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE0OSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNTAsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUYoMTUxLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE1MiwgMCwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNTMsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTU0LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVGKDE1NSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB1RigxNTYsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTU3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVFKDE1OCk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxNTkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTYwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVHKDE4MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB1RSgxODAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdUUoMTgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucjkgPSBmdW5jdGlvbihlMSwgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtlMV0udmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudUggPSBmdW5jdGlvbihlMSwgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucjkoZTEsIHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnB5LnNhdmUoZTEsIFN0cmluZyh2YWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucHkuc2F2ZShlMSwgU3RyaW5nKHRoaXMuZGF0YVtlMV0uZG4pLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudUkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IHRoaXMuZGF0YS5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRhW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5weS5zYXZlKGFCLCBTdHJpbmcodGhpcy5kYXRhW2FCXS52YWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5weS5zYXZlKGFCLCBTdHJpbmcodGhpcy5kYXRhW2FCXS5kbiksIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudUogPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcih0aGlzLmRhdGFbZTFdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudUsgPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh0aGlzLmRhdGFbZTFdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHVFKGFCLCB0eXBlLCB1TCwgZG4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELmRhdGEucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IGFCLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdUwgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1TDogdUwgfHwgMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbjogZG4gfHwgMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdUYoYUIsIHR5cGUsIHVMLCBkbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogYUIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdUwgfHwgIiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdUw6IHVMIHx8ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRuOiBkbiB8fCAwDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB1RyhtVSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGJpLmVELmRhdGEubGVuZ3RoOyBhQiA8IG1VOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YS5wdXNoKG51bGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHU5KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVNID0gZnVuY3Rpb24oZTEsIGRuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKHRoaXMudU4oZTEsIGRuKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVOID0gZnVuY3Rpb24oZTEsIGRuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLnVPKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYTAudU8uZ2V0SXRlbSgoZG4gPyAidiIgOiAiZCIpICsgZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYTAuaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCA9IGEwLnVQLmxvYWRTdHJpbmcoKGRuID8gMTAwMCA6IDIwMDApICsgZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhMC5pZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYTAudVFbKGRuID8gInYiIDogImQiKSArIGUxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZjggfHwgZjgubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVSID0gZnVuY3Rpb24oZWcsIHVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVUID0gdVMgPyAiZSIgOiAibCI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAudU8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChhMC51Ty5nZXRJdGVtKHVUICsgYUIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYTAuaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdVUgPSB1UyA/IDUwMDAgOiAzMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChhMC51UC5sb2FkU3RyaW5nKHVVICsgYUIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEwLmlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5wdXNoKGEwLnVRW3VUICsgYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uKGUxLCB2YWx1ZSwgZG4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1ViA9IChkbiA/ICJ2IiA6ICJkIikgKyBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC51TyAmJiBiaS5lRC5kYXRhWzE0MF0udmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVPLnNldEl0ZW0odVYsIHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVAuc2F2ZVN0cmluZygoZG4gPyAxMDAwIDogMjAwMCkgKyBlMSwgdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVRW3VWXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVXLnBvc3RNZXNzYWdlKHVWICsgIiAiICsgdmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51WCA9IGZ1bmN0aW9uKGcsIHVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1VCA9IHVTID8gImUiIDogImwiOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLnVPICYmIGJpLmVELmRhdGFbMTQwXS52YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51Ty5zZXRJdGVtKHVUICsgYUIsIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEwLmlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVVID0gdVMgPyA1MDAwIDogMzAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51UC5zYXZlU3RyaW5nKHVVICsgYUIsIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEwLmlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVFbdVQgKyBhQl0gPSBnW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVcucG9zdE1lc3NhZ2UodVQgKyBhQiArICIgIiArIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB1RCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdVkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHVaKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB1WSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYmkuZUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzJdLmRuID09PSAwICYmIChoLmogPiBoLmkgfHwgYTAuaWQgIT09IDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVsyXS52YWx1ZSA9IGRhdGFbMl0udUwgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbMTAwXS5kbiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbMTAwXS52YWx1ZSA9IGRhdGFbMTAwXS51TCA9IChhMC5pZCA9PT0gMCA/IFNbNTRdIDogYTAuaWQgPT09IDEgPyAiQW5kcm9pZCBVc2VyICIgOiAiaU9TIFVzZXIgIikgKyBNYXRoLmZsb29yKDEwMDAgKiBNYXRoLnJhbmRvbSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB1WigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGJpLmVELmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBkYXRhLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbYUJdICYmIGRhdGFbYUJdLmRuID09PSBiaS5weS51TShhQiwgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBiaS5weS51TihhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbYUJdLnZhbHVlID0gZjggPT09IG51bGwgPyBkYXRhW2FCXS51TCA6IChkYXRhW2FCXS50eXBlID09PSAyID8gZjggOiBOdW1iZXIoZjgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gdUMoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudWEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYmkuZUQuZGF0YVsxMTBdLnZhbHVlLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELmRhdGFbMTA2XS52YWx1ZSA9IGJpLmVELmRhdGFbMTEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDExMCwgIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51YigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51YiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBiaS5lRC5kYXRhWzExNl0udmFsdWUuc3BsaXQoIjsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnLmxlbmd0aCAlIDIgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnBvcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZy51bnNoaWZ0KGJpLmVELmRhdGFbMTA2XS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBnLnVuc2hpZnQoYmkuZUQuZGF0YVsxMDVdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAyOyBhQiA8IGcubGVuZ3RoOyBhQiArPSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdbYUJdID09PSBnWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuc3BsaWNlKGFCLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVjID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIgKz0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVjLnB1c2goZ1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdWQoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5lRC5kYXRhWzExN10udmFsdWUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YVsxMTddLnRYID0gdWM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVlID0gZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELmRhdGFbMTE3XS50WC5zcGxpY2UoZTEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YVsxMTddLnZhbHVlID0gTWF0aC5taW4oZTEsIGJpLmVELmRhdGFbMTE3XS50WC5sZW5ndGggLSAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gYmkuZUQuZGF0YVsxMTZdLnZhbHVlLnNwbGl0KCI7Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBnLnNwbGljZSgyICogZTEsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdWQoZyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVmID0gZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gYmkuZUQuZGF0YVsxMTZdLnZhbHVlLnNwbGl0KCI7Iik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBnWzIgKiBlMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGdbMiAqIGUxICsgMV0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB1ZChnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMTYsICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdWcgPSBnWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAxOyBhQiA8IGcubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWcgKz0gIjsiICsgZ1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMTYsIHVnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVoID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBiSy5wRShiaS5lRC5kYXRhWzEyMV0udmFsdWUsIC0xLCAyNjIxNDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4ID09PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gfn4oTWF0aC5yYW5kb20oKSAqIDI2MjE0NCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB1QigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yOSA9IGZ1bmN0aW9uKGUxLCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpLmVELmRhdGFbZTFdLnZhbHVlID09PSB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELnVIKGUxLCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmRpKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguZGkoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudWkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmRpKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudWogPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYmkuZUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDEwMDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5lRC51SChhQiwgZGF0YVthQl0udUwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnVpKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoLmRpKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjYuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudWsgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYmkuZUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBkYXRhLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5lRC5yOShhQiwgZGF0YVthQl0udUwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudWwgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IGJpLmVEOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDEyODsgYUIgPCAxMzU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMC51SChhQiwgZjAuZGF0YVthQl0udUwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51bSA9IGZ1bmN0aW9uKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEwOSwgZGF0YS5ydSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDcsIGRhdGEudW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA4LCBkYXRhLnVvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDExMiwgZGF0YS51cCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMTEsIGRhdGEudXEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTEzLCBkYXRhLnVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEzNSwgZGF0YS51cyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMzYsIGRhdGEudXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTM3LCBkYXRhLnV1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEzOCwgZGF0YS51dik7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMzksIGRhdGEudXcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTQxLCBkYXRhLnV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE0MiwgZGF0YS51eSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxNDMsIGRhdGEudXopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTQ0LCBkYXRhLnYwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMxKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJ5ID0gbmV3IHYxKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudjIgPSBuZXcgdjMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52NCA9IG5ldyB2NSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJ5LmRYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB2MygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52NiA9IGZ1bmN0aW9uKHNpemUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2NyA9IGJHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBzaXplOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUodjcub2koMTYpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZy5qb2luKCIiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudjggPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocE4ubGVuZ3RoID4gMjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE4uc3Vic3RyaW5nKDAsIDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHYxKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgdjkgPSBuZXcgVWludDhBcnJheSg3OCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHY5WzUwXSA9IDM3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgMTA7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2OVthQiArIDNdID0gYUIgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgMjY7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2OVthQiArIDIwXSA9IGFCICsgMTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdjlbYUIgKyA1Ml0gPSBhQiArIDM4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52QSA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE4udHJpbSgpLnJlcGxhY2UobmV3IFJlZ0V4cCgiW15hLXpBLVowLTlfXFwtXSIsImciKSwgIi0iKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudkIgPSBmdW5jdGlvbihwTiwgc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSB0aGlzLnZBKHBOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5sZW5ndGggPiBzaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOLnN1YnN0cmluZygwLCBzaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwTi5sZW5ndGggPCBzaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSAiLSIgKyBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudkMgPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZEID0gdjk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBwTi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IG5ldyBVaW50OEFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbYUJdID0gdkRbcE4uY2hhckNvZGVBdChhQikgLSA0NV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudkUgPSBmdW5jdGlvbih2Rikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoNiAqIHZGLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZHKHZGKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmRYKGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudkcgPSBmdW5jdGlvbih2Rikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gdkYubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBiQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoNiwgdkZbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudkggPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52Ryh0aGlzLnZDKHBOKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZJID0gZnVuY3Rpb24ocE4sIHNpemUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudkcodGhpcy52Qyh0aGlzLnZCKHBOLCBzaXplKSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52SiA9IGZ1bmN0aW9uKHBOLCBzaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHRoaXMudkModGhpcy52QihwTiwgc2l6ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtTyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGcubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ICs9IG1PICogZ1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbU8gKj0gNjQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB2SygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGksIGo7DQogICAgICAgICAgICAgICAgICAgIHZhciB2TDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52TSA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIHZOLCBlZywga2QsIGdELCB2TywgdlAsIHZROw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHY3ID0gYkc7DQogICAgICAgICAgICAgICAgICAgICAgICBiRi5yeS52RShiRi5yeS52QyhwTikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudlIudlNbYlIuZU1dLmkgPSBiUi5lciA9IGkgPSB2Ny5vaSgxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52Ui52U1tiUi5lTV0uaiA9IGJSLmVzID0gaiA9IHY3Lm9pKDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZMID0gWy1pLCAtMSwgaSwgMV07DQogICAgICAgICAgICAgICAgICAgICAgICB2VCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWcgPSB2Ny5vaSgxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2TiA9IHY3Lm9pKDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdk8gPSB2VShpICogaiAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IHY3Lm9pKHZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IHY3Lm9pKHZPKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2UCA9IHY3Lm9pKDEpID09PSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZRID0gdjcub2koMSkgPT09IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdlYoa2QsIGdELCB2UCwgdlEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdlcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLnB1dEltYWdlRGF0YShiUi52WSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52YS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdlQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52YiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52Yi53aWR0aCA9IGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudmIuaGVpZ2h0ID0gYlIuZXM7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WCA9IGJSLnZiLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WSA9IGJSLnZjID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZZID0gYlIudlguZ2V0SW1hZ2VEYXRhKDAsIDAsIGJSLmVyLCBiUi5lcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52YyA9IGJSLnZZLmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wcC52ZChiUi52Yyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdlYoa2QsIGdELCB2UCwgdlEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZWo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdjcgPSBiRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZSA9IGJSLnZjOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZmID0gZ0Q7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmcgPSBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmkgPSAxICsgdlA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmogPSAyIC0gdlA7DQogICAgICAgICAgICAgICAgICAgICAgICB2ZVtnRCA8PCAyXSA9IHZpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwga2Q7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlaiA9IHY3Lm9pKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gdmsoZ0QsIGVqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmVbZ0QgPDwgMl0gPT09IHZpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aCAlIDIgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZsKHZnLCB2aCArIDIgKiB2USArIDMsIHZqLCB2USwgdmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0QgPDwgMl0gPSB2aTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmwoZ0QsIGVqLCB2aiwgdlEsIHZlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bCh2ZywgZWosIHZqLCB2USwgdmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZnID0gZ0Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmggPSBlajsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2ayhnRCwgMCkgPT09IHZmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmwoZ0QsIDAsIHZqLCB2USwgdmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZsKHZmLCAwLCB2aiwgdlEsIHZlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmsoZ0QsIDEpID09PSB2Zikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZsKGdELCAwLCB2aiwgdlEsIHZlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bCh2ZiwgMiwgdmosIHZRLCB2ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2QgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2bCh2ZiwgMCwgdmosIHZRLCB2ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmwodmYsIDIsIHZqLCB2USwgdmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZsKGg1LCBlaiwgdmosIHZRLCB2ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZtID0gdmsoaDUsIChlaiArIDEgKyAyICogdlEpICYgMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZuKGg1LCB2bSkgJiYgdmVbdm0gPDwgMl0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVt2bSA8PCAyXSA9IHZqOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZuKGg1LCB2bSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKHZvKGg1KSAtIHZvKHZtKSkgPiAxIHx8IE1hdGguYWJzKHZwKGg1KSAtIHZwKHZtKSkgPiAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZvKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ0QgJSBpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZwKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoZ0QgKyAwLjUpIC8gaSkgJSBqOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZrKGdELCBlaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdEICsgdkxbZWpdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZXKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuLCBlcCwgaFQsIHZxLCB2ciwgdnM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmUgPSBiUi52YzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2dCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdnUgPSBiUi52Ui52U1tiUi5lTV0udnU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdnYgPSBiUi52Ui52U1tiUi5lTV0udnY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gMDsgZXAgPCBqOyBlcCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnEgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZyID0gdnQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSAwOyBlbiA8IGk7IGVuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaFQgPSA0ICogZXAgKiBpICsgNCAqIGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPj0gdnMgJiYgdmVbaFRdID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnIgPSB2ZVtoVF0gPT09IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodnEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2cSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2ciAhPT0gdnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnQgPSB2cjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnMgPSBlbiArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodnIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2hUXSA9IHZ2WzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAxXSA9IHZ2WzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAyXSA9IHZ2WzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAzXSA9IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2hUXSA9IHZ1WzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAxXSA9IHZ1WzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAyXSA9IHZ1WzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbaFQgKyAzXSA9IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB2NSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52TSA9IGZ1bmN0aW9uKHZ3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdjcgPSBiRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaXplID0gdjcub2kodncpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZ4ID0gNyArIDkgKiB2Ny5vaSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgc2l6ZTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHY3Lm9pKHZ4KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGcuam9pbigiIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjNigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJRLCByUiwgdnksIHZ6LCB3MCwgdzEsIHcyLCB3MywgdzQsIHc1Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3NSA9IG5ldyBBcnJheSgxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB3MyA9IDY7DQogICAgICAgICAgICAgICAgICAgICAgICB3MCA9IDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdnkgPSBiSy5kbShiUi5lciwgdzApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdnogPSBiSy5kbShiUi5lcywgdzApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdzEgPSBiSy5kbSgoYlIuZXIgLSB3MCAqIHZ5KSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB3MiA9IGJLLmRtKChiUi5lcyAtIHcwICogdnopLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBhRC5qdjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3NCA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3NigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5sbFt3NF0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnNwYXduaW5nVHlwZSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuc3Bhd25pbmdUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdzcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3OCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3OSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmMubGhbN10gPSBhZy5nVFthRC5lUV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3NygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3QSA9IGFELndBOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3NCA9IHdBOyB3NCA8IGFELmVkOyB3NCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodzQgPSAoYUQuaDEgPyBhRC5qdiA6IDApOyB3NCA8IHdBOyB3NCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdCKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDID0gdzEgKyByUSAqIHcwICsgYksuZG0odzAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0QgPSB3MiArIHJSICogdzAgKyBiSy5kbSh3MCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdFKHdDLCB3RCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQud0YgPSB3NDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZjAgPSB3NDsgZjAgPCB3QTsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdzQgPSBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3OCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3RyA9IGFELndIOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC53SSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdHKys7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAod0cgPCAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBhRC5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpDID0gKGFELmgxID8gYUQuanYgOiAwKSArIGRhdGEudGVhbVBsYXllckNvdW50WzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1VID0gYUQud0Y7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0ogPSBuZXcgVWludDMyQXJyYXkod0cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdLID0gbmV3IFVpbnQzMkFycmF5KHdHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3TCA9IG5ldyBVaW50MTZBcnJheSh3Ryk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd00gPSBuZXcgVWludDE2QXJyYXkod0cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVUgPSBhZy5pVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpVyA9IGFnLmlXOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlWID0gYWcuaVY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVggPSBhZy5pWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSyA9IGJOLmZLOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZMID0gYk4uZkw7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGpDOyBhQiA8IG1VOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZktbYUJdID0gKGlVW2FCXSArIGlWW2FCXSkgPj4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmTFthQl0gPSAoaVdbYUJdICsgaVhbYUJdKSA+PiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGpDOyBhQiA8IG1VOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gZWVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdKW2lkXSArPSBmS1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0tbaWRdICs9IGZMW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrSCA9IGJmLmtIOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgd0c7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSBNYXRoLm1heChkYXRhLnRlYW1QbGF5ZXJDb3VudFtrSFthQl1dLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3TFthQl0gPSBiSy5kbSh3SlthQl0sIGc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3TVthQl0gPSBiSy5kbSh3S1thQl0sIGc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3TiA9IGJmLndOOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdPID0gYmYud087DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd1AgPSBiZi53UDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSiA9IGJOLmZKOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgNTEyOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZkpbYUJdID0gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlMCA9IDA7IGUwIDwgMiArICh3RyA+PSA0KTsgZTArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBqQzsgYUIgPCBtVTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaDUgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdRID0gZkpbaDVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd1IgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXcgPSBiSy53UyhmS1t3UV0gLSB3TFsxXSwgZkxbd1FdIC0gd01bMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IDI7IGV6IDwgd0c7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3VCA9IGJLLndTKGZLW3dRXSAtIHdMW2V6XSwgZkxbd1FdIC0gd01bZXpdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3VCA8IGV3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXcgPSB3VDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3UiA9IGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3VSA9IGVlW2g1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdSID09PSB3VSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUwID09PSAyICYmIHdHID49IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3ViA9IE1hdGgubWF4KCh3UiArIDEpICUgd0csIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdXID0gYksud1MoZktbd1FdIC0gd0xbd1ZdLCBmTFt3UV0gLSB3TVt3Vl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IDE7IGV6IDwgd0c7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3VCA9IGJLLndTKGZLW3dRXSAtIHdMW2V6XSwgZkxbd1FdIC0gd01bZXpdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod1QgPiBldyAmJiB3VCA8IHdXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdXID0gd1Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdWID0gZXo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdWICE9PSB3VSAmJiBiSy53Uyh3TFt3VV0gLSB3TFt3Vl0sIHdNW3dVXSAtIHdNW3dWXSkgPCBiSy53Uyh3TFt3VV0gLSB3TFt3Ul0sIHdNW3dVXSAtIHdNW3dSXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3UiA9IHdWOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3WCA9IGtIW3dSXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdZID0gd09bd1hdICsgKGFELmgxID8gMCA6IHdQW3dYXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2bSA9IHdOW3dZXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdaID0gZkpbdm1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2EgPSB3T1t3WCArIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IGJLLndTKGZLW3daXSAtIHdMW3dVXSwgZkxbd1pdIC0gd01bd1VdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZjEgPSB3WSArIDE7IGYxIDwgd2E7IGYxKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3YiA9IHdOW2YxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3YyA9IGZKW3diXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdUID0gYksud1MoZktbd2NdIC0gd0xbd1VdLCBmTFt3Y10gLSB3TVt3VV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdUIDwgZXcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IHdUOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZtID0gd2I7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZtIDwgakMgfHwgdm0gPj0gbVUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdaID0gZkpbdm1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Slt3VV0gKz0gZktbd1pdIC0gZktbd1FdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3S1t3VV0gKz0gZkxbd1pdIC0gZkxbd1FdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3Slt3Ul0gKz0gZktbd1FdIC0gZktbd1pdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3S1t3Ul0gKz0gZkxbd1FdIC0gZkxbd1pdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnOCA9IGRhdGEudGVhbVBsYXllckNvdW50W2tIW3dVXV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdMW3dVXSA9IGJLLmRtKHdKW3dVXSwgZzgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3TVt3VV0gPSBiSy5kbSh3S1t3VV0sIGc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZzggPSBkYXRhLnRlYW1QbGF5ZXJDb3VudFt3WF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdMW3dSXSA9IGJLLmRtKHdKW3dSXSwgZzgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3TVt3Ul0gPSBiSy5kbSh3S1t3Ul0sIGc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZkpbaDVdID0gd1o7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZKW3ZtXSA9IHdROw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHdkKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd2QoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZkogPSBiTi5mSjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpVSA9IGFnLmlVOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlXID0gYWcuaVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVYgPSBhZy5pVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpWCA9IGFnLmlYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdUID0gYWcuZ1Q7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2UgPSBhZy53ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnTCA9IGFnLmdMOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdNID0gYWcuZ007DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjYgPSBhZy5mNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCA1MTI7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2YgPSBmSlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdmID09PSBhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coaVUsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coaVcsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coaVYsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coaVgsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coZ1QsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2cod2UsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coZ0wsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coZ00sIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2coZjYsIGFCLCB3Zik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2goYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoKHdmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmSlthQl0gPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IHdmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGZKW2pdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChnRSAhPT0gYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGdFOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRSA9IGZKW2dFXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZkpbal0gPSB3ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3aChwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpVSA9IGFnLmlVOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlXID0gYWcuaVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVYgPSBhZy5pVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpWCA9IGFnLmlYOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXAgPSBpV1twbGF5ZXJdOyBlcCA8PSBpWFtwbGF5ZXJdOyBlcCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZW4gPSBpVVtwbGF5ZXJdOyBlbiA8PSBpVltwbGF5ZXJdOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlSyA9IGFjLndpKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWMuZ0YoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuajgoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy5nQShlSywgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLndqKGVLLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHdnKGcsIHNGLCBzRykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gZ1tzRl07DQogICAgICAgICAgICAgICAgICAgICAgICBnW3NGXSA9IGdbc0ddOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ1tzR10gPSBkbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3OSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3QSA9IGFELndBOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3NCA9IHdBOyB3NCA8IGFELmVkOyB3NCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodzQgPSAoYUQuaDEgPyBhRC5qdiA6IDApOyB3NCA8IHdBOyB3NCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdrKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3QigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3QyA9IHcxICsgclEgKiB3MCArIGJLLmRtKHcwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdEID0gdzIgKyByUiAqIHcwICsgYksuZG0odzAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3RSh3Qywgd0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQud0YgPSB3NDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmMCA9IHc0OyBmMCA8IHdBOyBmMCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc0ID0gZjA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3QigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3bCgpIHx8IHdtKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd2soKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3Bhd25pbmdEYXRhID0gYUQuZGF0YS5zcGF3bmluZ0RhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0MgPSBzcGF3bmluZ0RhdGFbMiAqIHc0XSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0QgPSBzcGF3bmluZ0RhdGFbMiAqIHc0ICsgMV0gKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdDID4gMyAmJiB3QyA8IGJSLmVyIC0gNSAmJiB3RCA+IDMgJiYgd0QgPCBiUi5lcyAtIDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWIoYWMud2kod0MsIHdEKSkgJiYgd24od0MgKyAzLCB3RCArIDMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdFKHdDICsgMSwgd0QgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHdsKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgODsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJRID0gYksuZG0odnkgKiBheC5yYW5kb20oKSwgYXgudmFsdWUoMTAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgclIgPSBiSy5kbSh2eiAqIGF4LnJhbmRvbSgpLCBheC52YWx1ZSgxMDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod28oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd20oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTEsIGk0LCBleiwgd0QsIGYwLCB3QzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkxID0gYksuZG0odnkgKiBheC5yYW5kb20oKSwgYXgudmFsdWUoMTAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpNCA9IGJLLmRtKHZ6ICogYXgucmFuZG9tKCksIGF4LnZhbHVlKDEwMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IDQwOyBleiA+PSAxOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3RCA9IHZ6IC0gZXo7IHdEID49IDA7IHdEIC09IDQwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJSID0gKHdEICsgaTQpICUgdno7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjAgPSA0MDsgZjAgPj0gMTsgZjAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3QyA9IHZ5IC0gZjA7IHdDID49IDA7IHdDIC09IDQwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgclEgPSAod0MgKyBpMSkgJSB2eTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod28oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd28oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QsIHdwLCB3cTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYXAgPSBiSy5kbSgodzAgLSB3MyksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdyID0gdzIgKyByUiAqIHcwICsgZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdzID0gdzEgKyByUSAqIHcwICsgZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3cCA9IHdyICsgdzMgLSAxOyB3cCA+PSB3cjsgd3AtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAod3EgPSB3cyArIHczIC0gMTsgd3EgPj0gd3M7IHdxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBhYy53aSh3cSwgd3ApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjLmViKGdEKSB8fCBhYy5qOChnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHdFKHdDLCB3RCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHd0KHdDIC0gMiwgd0QgLSAyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB3NigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmxsW3c0XSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nVFt3NF0gPSBhZy53ZVt3NF0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZzdbdzRdID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nTFt3NF0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdNW3c0XSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZjZbdzRdID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5pVVt3NF0gPSBhZy5pV1t3NF0gPSBhZy5pVlt3NF0gPSBhZy5pWFt3NF0gPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHd0KHdDLCB3RCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWcubGxbdzRdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmlVW3c0XSA9IHdDICsgMTA7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5pV1t3NF0gPSB3RCArIDEwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVhbdzRdID0gYWcuaVZbdzRdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCwgYUIsIHd1LCB3djsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAod3UgPSB3Qzsgd3UgPCB3QyArIDQ7IHd1KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHd2ID0gd0Q7IHd2IDwgd0QgKyA0OyB3disrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgod3UgPiB3QyAmJiB3dSA8IHdDICsgMykgfHwgKHd2ID4gd0QgJiYgd3YgPCB3RCArIDMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IGFjLndpKHd1LCB3dik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZWIoZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVVbdzRdID0gTWF0aC5taW4od3UsIGFnLmlVW3c0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVZbdzRdID0gTWF0aC5tYXgod3UsIGFnLmlWW3c0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVdbdzRdID0gTWF0aC5taW4od3YsIGFnLmlXW3c0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVhbdzRdID0gTWF0aC5tYXgod3YsIGFnLmlYW3c0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdzVbYWcuZ1RbdzRdXSA9IGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdUW3c0XSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLndqKGdELCB3NCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy53ZVt3NF0gPSBhZy5nVFt3NF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYWcuZ1RbdzRdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy53dyh3NVthQl0sIHc0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy5nQSh3NVthQl0sIHc0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuZ0xbdzRdLnB1c2godzVbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnd4KHc1W2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWMuZ0EodzVbYUJdLCB3NCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdNW3c0XS5wdXNoKHc1W2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy53eSh3NVthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmdBKHc1W2FCXSwgdzQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5mNlt3NF0ucHVzaCh3NVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnd6ID0gZnVuY3Rpb24oajYsIHgwLCB4MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCB3Qywgd0Q7DQogICAgICAgICAgICAgICAgICAgICAgICB3NCA9IGo2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgMjA7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHdDID0geDAgKyBhQjsgd0MgPj0geDAgLSBhQjsgd0MtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHdEID0geDEgKyBhQjsgd0QgPj0geDEgLSBhQjsgd0QtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdDID09PSB4MCArIGFCIHx8IHdDID09PSB4MCAtIGFCIHx8IHdEID09PSB4MSArIGFCIHx8IHdEID09PSB4MSAtIGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdDID4gMyAmJiB3QyA8IGJSLmVyIC0gNSAmJiB3RCA+IDMgJiYgd0QgPCBiUi5lcyAtIDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmViKGFjLndpKHdDLCB3RCkpICYmIHduKHdDICsgMywgd0QgKyAzKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmdUW3c0XSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3dCh3QyAtIDEsIHdEIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHgyKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdELCByUSwgclI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHJRID0gYWcuaVZbdzRdOyByUSA+PSBhZy5pVVt3NF07IHJRLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHJSID0gYWcuaVhbdzRdOyByUiA+PSBhZy5pV1t3NF07IHJSLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSAoclIgKiBiUi5lciArIHJRKSAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy54Myh3NCwgZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy54NChnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5nVFt3NF0tLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLng1ID0gZnVuY3Rpb24oajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHc0ID0gajY7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAod0IoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3QyA9IHcxICsgclEgKiB3MCArIGJLLmRtKHcwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0QgPSB3MiArIHJSICogdzAgKyBiSy5kbSh3MCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0Uod0MsIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHduKHdDLCB3RCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdELCB3cSwgd3A7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHdwID0gd0Q7IHdwID4gd0QgLSA2OyB3cC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh3cSA9IHdDOyB3cSA+IHdDIC0gNjsgd3EtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IGFjLndpKHdxLCB3cCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5qOChnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHg2KCkgew0KICAgICAgICAgICAgICAgICAgICBhci54NygpOw0KICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oaUgsIDAsIDAsIGlILCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgdG8uaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gaUggPCAzOw0KICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYlIudmIsIGFTLng4KCksIGFTLng5KCkpOw0KICAgICAgICAgICAgICAgICAgICBiTy54QS50bigpOw0KICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoeEIsIGFTLng4KCksIGFTLng5KCkpOw0KICAgICAgICAgICAgICAgICAgICBhci50bigpOw0KICAgICAgICAgICAgICAgICAgICBiTS50bigpOw0KICAgICAgICAgICAgICAgICAgICBhZi50bigpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoYUQubUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJnLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQi50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdC50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGFOLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFWLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFSLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGJCLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGF2LnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFXLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFTLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFRLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGJnLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFVLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFQLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFNLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFMLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGFYLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGJkLnRuKCk7DQogICAgICAgICAgICAgICAgICAgIGF1LnRuKCk7DQogICAgICAgICAgICAgICAgICAgIHQudG4oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geEMoeEQsIGksIGopIHsNCiAgICAgICAgICAgICAgICAgICAgeEQuY2xlYXJSZWN0KDAsIDAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tajsNCiAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaSwgaik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHhFKHhELCBpLCBqLCB4Rikgew0KICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaSwgeEYpOw0KICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCB4Riwgaik7DQogICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGkgLSB4RiwgMCwgeEYsIGopOw0KICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBqIC0geEYsIGksIHhGKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geEcoeEQsIGVuLCBlcCwgaFgsIHhGLCBnRCwgeEgpIHsNCiAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgIHZhciBzMiA9IE1hdGguZmxvb3IoaFggKiBnRCk7DQogICAgICAgICAgICAgICAgICAgIHMyICs9IChzMiAtIHhGKSAlIDI7DQogICAgICAgICAgICAgICAgICAgIHZhciBzMyA9IE1hdGguZmxvb3IoKHMyIC0geEYpIC8gMik7DQogICAgICAgICAgICAgICAgICAgIHZhciB4SSA9IE1hdGguZmxvb3IoKGhYIC0gczIpIC8gMik7DQogICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGVuICsgeEksIGVwICsgeEkgKyBzMywgczIsIHhGKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHhIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChlbiArIHhJICsgczMsIGVwICsgeEksIHhGLCBzMik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geEooKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyAhPT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhLKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhMID0gZnVuY3Rpb24oeE0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbG8gPSBhRC5kYXRhLmVsbzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBocCA9IChlbG9beE1dIC0gZWxvWzEgLSB4TV0pIC8gMTA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeE4gPSA4IC8gKDEgKyBNYXRoLnBvdygyLCBocCAvIDMyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4TiA9IE1hdGguZmxvb3IoMTAgKiB4TiArIDAuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeE8gPSBlbG9beE1dICsgKDEgKyBhRC54UCkgKiB4TiArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFEgPSB0aGlzLnhSKHhPKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4UyA9IHRoaXMueFIoZWxvWzEgLSB4TV0gLSB4Tik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeE0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi54VCh4USwgeFMsIFtTWzc0XSwgU1s3Ml1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFQoeFMsIHhRLCBbU1s3Ml0sIFNbNzRdXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcueFVbeE1dIDwgMTAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhWID0gKCgoMSArIGFELnhQKSAqICh4TyA+PiAxKSkgLyAxMDApLnRvRml4ZWQoMik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeE0gPT09IGFELmVRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoNjQwLCBMKDI0LCBbeFZdKSwgNDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoNjQwLCBMKDI1LCBbYWcueFhbeE1dLCB4Vl0pLCA0MCwgMCwgYkEubW0sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54UiA9IGZ1bmN0aW9uKGVsbykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZWxvID0gYksucEUoZWxvLCAwLCAxNjAwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxvID09PSAxNjAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiVW5rbm93biI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGVsbyAvIDEwKS50b0ZpeGVkKDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2IoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXcgPSBuZXcgeFkoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52ZSA9IG5ldyB4WigpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB4WigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oTiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbUMsIG1ELCBnYXAsIGhYLCB4YTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHhiID0gMTA7DQogICAgICAgICAgICAgICAgICAgIHZhciB4YyA9IDE7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueGQgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54ZSA9IDEwMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHhmID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHhnID0gbmV3IEFycmF5KDkpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeGggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHhpID0gW107DQogICAgICAgICAgICAgICAgICAgIHZhciB4aiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciB4ayA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciB4bCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciB4bSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4biA9IFswLCAxLCAyLCA0LCA3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCA2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IHhuLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IHhuW2FCXSA9PT0gNiA/IGJBLm5DIDogYkEubWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54ZC5wdXNoKGI5LmNhbnZhcy54byhhYi5nZXQoMyksIHhuW2FCXSwgY29sb3IpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGFqLnF3LnhwOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGkucHVzaChhai5xdy54cSAtIGFqLnF3LnhwICsgYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgYWoucXcueHI7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aS5wdXNoKGFqLnF3LnhzICsgYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHh0ID0gYWoucXcueHUoYkoueHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgeHQubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGkucHVzaCh4dFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgeHYoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHh2KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gYmkuZUQuZGF0YVsxMjBdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBwTi5zcGxpdCgiLCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGcubGVuZ3RoICE9PSAxOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDk7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeGdbYUJdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb0o6IDEwMjQgLSA5ICsgYUIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gcGFyc2VJbnQoZ1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gKGY4ID49IDAgJiYgZjggPCBhai5xdy54cSkgPyBmOCA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYxID0gcGFyc2VJbnQoZ1thQiArIDldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMSA9IChmMSA+PSAwICYmIGYxIDwgMTAwMCkgPyBmMSA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGdbYUJdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvSjogZjgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGswOiBmMQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geHcoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB4aCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhmID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgOTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aC5wdXNoKHhnW2FCXS5vSik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSA0OSAqIHhmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleiA9IGYwIC0gNDk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV6ID49IHhpLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV6ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjAgPSA0OTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjAgPSBNYXRoLm1pbihmMCwgeGkubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleiA9IGYwIC0gNDk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGV6OyBhQiA8IGYwOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoLnB1c2goeGlbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB4aC5wdXNoKDEwMjQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHh4KG9KKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGdbYUJdLmswID0gTWF0aC5mbG9vcih4Z1thQl0uazAgKiAwLjk5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDk7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob0ogPT09IHhnW2FCXS5vSikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4Z1thQl0uazAgPSBNYXRoLm1pbih4Z1thQl0uazAgKyAzMCwgOTk5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHhnLnNwbGljZSg1LCAwLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb0o6IG9KLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGswOiBNYXRoLm1heCh4Z1s0XS5rMCwgMzApDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhnLnBvcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeHkoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB4eSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhnLnNvcnQoZnVuY3Rpb24oZXosIGYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYwLmswIC0gZXouazA7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9ICIiICsgeGdbMF0ub0o7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gIiwiICsgeGdbYUJdLm9KOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgOTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9ICIsIiArIHhnW2FCXS5rMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELnVIKDEyMCwgcE4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKGt5LCBreiwgeHopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhqID0ga3k7DQogICAgICAgICAgICAgICAgICAgICAgICB4ayA9IGt6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgeGYgPSB4eiB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB4dygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc4ID0geGgubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaFggPSBNYXRoLmZsb29yKChhMC5hMS5yNCgpID8gMC4wNzUgOiAwLjA0NjgpICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICBnYXAgPSBNYXRoLmZsb29yKGhYIC8gMyk7DQogICAgICAgICAgICAgICAgICAgICAgICB4YSA9IGhYICsgZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgeGwgPSB4YiAqIHhhOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhsID4gaC5pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGwgPSBoLmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGEgPSB4bCAvIHhiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhYID0gMyAqIHhhIC8gNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXAgPSB4YSAtIGhYOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgeGMgPSBiSy5kbShnOCwgeGIpICsgISEoZzggJSB4Yik7DQogICAgICAgICAgICAgICAgICAgICAgICB4bSA9IHhjICogeGE7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeG0gPiBoLmopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4bSA9IGguajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4YSA9IHhtIC8geGM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaFggPSAzICogeGEgLyA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcCA9IHhhIC0gaFg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeTAgPSAwLjUgKiBnYXA7DQogICAgICAgICAgICAgICAgICAgICAgICBtQyA9IE1hdGgubWluKE1hdGgubWF4KGt5IC0gMC41ICogeGwgKyB5MCwgeTApLCBoLmkgLSB4bCArIHkwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1EID0gTWF0aC5taW4oTWF0aC5tYXgoa3ogLSAwLjUgKiB4bSArIHkwLCB5MCksIGguaiAtIHhtICsgeTApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGt5LCBreiwgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy55MShreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gYksucEUoYksuZG0oa3kgLSBtQyArIDAuNSAqIGdhcCwgeGEpLCAwLCB4YiAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxICs9IHhiICogYksucEUoYksuZG0oa3ogLSBtRCArIDAuNSAqIGdhcCwgeGEpLCAwLCB4YiAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA+PSB4aC5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvSiA9IHhoW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob0ogPT09IDEwMjQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93KHhqLCB4aywgeGYgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHh4KG9KKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5vSShvSik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuZzEub1cob0osIHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55MSA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEoa3kgPCBtQyAtIDAuNSAqIGdhcCB8fCBreiA8IG1EIC0gMC41ICogZ2FwIHx8IGt5ID49IG1DICsgeGwgLSAwLjUgKiBnYXAgfHwga3ogPj0gbUQgKyB4bSAtIDAuNSAqIGdhcCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KG1DIC0gMC41ICogZ2FwLCBtRCAtIDAuNSAqIGdhcCwgeGwsIHhtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoVCA9IDAuNSAqIGJiLnkyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYmIueTI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VTdHlsZSA9IHRvLmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlUmVjdChtQyAtIDAuNSAqIGdhcCArIGhULCBtRCAtIDAuNSAqIGdhcCArIGhULCB4bCAtIDIgKiBoVCwgeG0gLSAyICogaFQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHhoLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueTMoeGhbYUJdLCB0bywgbUMgKyAoYUIgJSB4YikgKiB4YSwgbUQgKyBiSy5kbSgoYUIpLCB4YikgKiB4YSwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnkzID0gZnVuY3Rpb24ob0osIGhkLCBlbiwgZXAsIGhYKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAob0ogPj0gMTAyNCAtIGFqLnF3LnhwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gaFggLyB0aGlzLnhlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybShlSywgMCwgMCwgZUssIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKHRoaXMueGRbb0ogLSAxMDI0ICsgYWoucXcueHBdLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKGhkLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZShoZCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5mb250ID0gYjkucGcuclYoMCwgMC44OSAqIGhYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmZpbGxUZXh0KGFqLnF3Lnk0KG9KKSwgZW4gKyAwLjUgKiBoWCwgZXAgKyAoMC41NiArICgwLjM1IC0gYjkucGcueTUpKSAqIGhYKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHhZKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVtb2ppcyA9IFsi8J+lsCIsICLwn5iOIiwgIvCfmJgiLCAi8J+YnCIsICLwn6SXIiwgIvCfpbMiLCAi8J+YhyIsICLwn5iKIiwgIvCfpbEiLCAi8J+ZhCIsICLwn6SUIiwgIvCfpboiLCAi8J+YoSIsICLwn5itIiwgIvCfmLEiLCAi8J+YniIsICLwn5KAIiwgIvCfkbkiLCAi8J+RiyIsICLwn5mPIiwgIvCfkY8iLCAi8J+SqiIsICLwn5mL4oCN4pmC77iPIiwgIvCfpKbigI3imYLvuI8iLCAi4qyG77iPIiwgIuKeoe+4jyIsICLirIfvuI8iLCAi4qyF77iPIiwgIvCfkYAiLCAi4p2k77iPIiwgIvCfkpQiLCAi8J+SpSIsICLwn5SlIiwgIvCfqqYiLCAi8J+lhyIsICLwn6WIIiwgIvCfpYkiLCAi8J+Olu+4jyIsICLwn4+FIiwgIvCfkZEiLCAi8J+OiSIsICLwn5KvIiwgIuKcne+4jyIsICLimKrvuI8iLCAi8J+Vie+4jyIsICLimLjvuI8iLCAi4pyh77iPIiwgIuKYpu+4jyIsICLimpvvuI8iXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54cCA9IDEzOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhyID0gdGhpcy5lbW9qaXMubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhzID0gNjc2Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhxID0gMTAyNDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55NiA9IHRoaXMuZW1vamlzLmluZGV4T2YoIvCfkoAiKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55NyA9IHRoaXMueTYgKyAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnk4ID0gdGhpcy5lbW9qaXMuaW5kZXhPZigi8J+lhyIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnk5ID0gdGhpcy5lbW9qaXMuaW5kZXhPZigi8J+YiiIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnk0ID0gZnVuY3Rpb24oZjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmOCA8IHRoaXMueHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSg1NTM1NiwgNTY4MDYgKyBiSy5kbShmOCwgMjYpLCA1NTM1NiwgNTY4MDYgKyBmOCAlIDI2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVtb2ppc1tNYXRoLm1pbihmOCAtIHRoaXMueHMsIHRoaXMueHIgLSAxKV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnh1ID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHBOLmxlbmd0aCAtIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhsID0gcE4uY2hhckNvZGVBdChhQikgLSA1NjgwNjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG0gPSBwTi5jaGFyQ29kZUF0KGFCICsgMikgLSA1NjgwNjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGwgPj0gMCAmJiBobCA8IDI2ICYmIGhtID49IDAgJiYgaG0gPCAyNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2goMjYgKiBobCArIGhtKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIgKz0gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueUEgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4IDwgdGhpcy54czsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueUIgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4ID49IDEwMjQgLSB0aGlzLnhwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55QyA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjggPj0gdGhpcy54cyAmJiBmOCA8IHRoaXMueHMgKyB0aGlzLnk3Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYzAoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucnkgPSBuZXcgeUQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52MiA9IG5ldyB5RSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnY0ID0gbmV3IHlGKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucnkuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHlFKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZIID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHBOLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYkM7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDE2LCBwTi5jaGFyQ29kZUF0KGFCKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB5RCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHlHID0gbmV3IFVpbnQ4QXJyYXkoNjQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB5R1swXSA9IDQ1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgeUdbMzddID0gOTU7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCAxMDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlHW2FCICsgMV0gPSA0OCArIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgMjY7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5R1thQiArIDExXSA9IDY1ICsgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeUdbYUIgKyAzOF0gPSA5NyArIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zMCA9IGZ1bmN0aW9uKHlIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdjcgPSBiRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2RiA9IG5ldyBVaW50OEFycmF5KHlIKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCB5SDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZGW2FCXSA9IHY3Lm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZGOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yeiA9IGZ1bmN0aW9uKHZGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB2Ri5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeUkgPSB5RzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSh5SVt2RlthQl1dKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZy5qb2luKCIiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueUogPSBmdW5jdGlvbih2YWx1ZSwgeUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5SSA9IHlHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCB5SzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHlJWyh2YWx1ZSA+PiAoKHlLIC0gMSAtIGFCKSAqIDYpKSAmIDYzXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGcuam9pbigiIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjOCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHlMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeU07DQogICAgICAgICAgICAgICAgICAgIHZhciB5TjsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geU8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB5TCA9IFszMiwgNjUsIDE5MSwgOTEzLCA5MzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgeU0gPSBbNjQsIDEyNywgNjg4LCA5MzAsIDExNTVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgeU4gPSBuZXcgQXJyYXkoeUwubGVuZ3RoICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgeU4ubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeU5bYUJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IGFCIC0gMTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5TlthQl0gKz0geU1bZXpdIC0geUxbZXpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB5TygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnY4ID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBOLmluZGV4T2YoU1sxMDRdKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5pbmRleE9mKCJbQm90XSAiKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5UChwTiwgMywgMjApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geVAocE4sIHlRLCB5Uikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBwTi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPCB5USB8fCBlZyA+IHlSKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlTID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYxID0gcE4uY2hhckNvZGVBdChhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeVMgKz0gKChmMSA+PSA2NSAmJiBmMSA8PSA5MCkgfHwgKGYxID49IDEwNDAgJiYgZjEgPD0gMTA3MSkpID8gMSA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHlUKGYxKSA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5UyA+IDMgJiYgeVMgPiBNYXRoLmZsb29yKGVnIC8gMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnlVID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcE4ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYxID0gcE4uY2hhckNvZGVBdChhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0geVQoZjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaCh5TltnRF0gKyBmMSAtIHlMW2dEXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudk0gPSBmdW5jdGlvbihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYxLCBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjAgPSAxOyBmMCA8IHlOLmxlbmd0aDsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1thQl0gPCB5TltmMF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYxID0geUxbZjAgLSAxXSArIGdbYUJdIC0geU5bZjAgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB5VChmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSB5TC5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID49IHlMW2FCXSAmJiBmMSA8IHlNW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMueVYgPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSB0aGlzLnlVKHBOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBnW2FCXSA8IDEwID8gIjAwIiA6IGdbYUJdIDwgMTAwID8gIjAiIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGdbYUJdLnRvU3RyaW5nKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnlXID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gbmV3IEFycmF5KE1hdGguZmxvb3IocE4ubGVuZ3RoIC8gMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHBOLmxlbmd0aDsgYUIgKz0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbTWF0aC5mbG9vcihhQiAvIDMpXSA9IHBhcnNlSW50KHBOLnN1YnN0cmluZyhhQiwgYUIgKyAzKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52TShnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueVggPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW3BOLmxlbmd0aF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBwTi5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IHBOLmNoYXJDb2RlQXQoYUIpIC0gNDg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBwTi5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgPT09IHBOLmxlbmd0aCAtIDEgfHwgZ1thQl0gKiAxMCArIGdbYUIgKyAxXSA+IDUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBnW2FCXS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gZ1thQl0gKiAxMCArIGdbYUIgKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZjggKyAoZjggPCAyNiA/IDY1IDogNzEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55WSA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgcE4ubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjEgPSBwTi5jaGFyQ29kZUF0KGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPj0gNDggJiYgZjEgPCA1OCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShmMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA+PSA2NSAmJiBmMSA8IDc1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAiMCIgKyAoZjEgLSA2NSkudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYxID49IDc1ICYmIGYxIDwgOTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IChmMSAtIDY1KS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjEgPj0gOTcgJiYgZjEgPCAxMjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IChmMSAtIDcxKS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnlaID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHBOLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSwgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMSA9IHBOLmNoYXJDb2RlQXQoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA8IDU4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChwTlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYxIDwgOTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjEgLT0gNjU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjEgLT0gNzE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChTdHJpbmcoYksuZG0oZjEsIDEwKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChTdHJpbmcoZjEgLSAxMCAqIGJLLmRtKGYxLCAxMCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gZy5sZW5ndGggLSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZGID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIgKz0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZGW2YxKytdID0gcGFyc2VJbnQoZ1thQl0gKyBnW2FCICsgMV0gKyBnW2FCICsgMl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZGOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55YSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBlMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5YiA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgNjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwID0gNDggKyBheC5yYW5kb20oKSAlIDM2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwICs9IGUwID49IDU4ID8gMzkgOiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHliICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHliOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geUYoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueVUgPSBmdW5jdGlvbihwTiwgdncsIHljKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeWQgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHBOLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gcE4uY2hhckNvZGVBdChhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWQucHVzaChmOCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXgobWF4LCBmOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdnggPSBtYXggPCAxMjggPyA3IDogMTY7DQogICAgICAgICAgICAgICAgICAgICAgICB5Yy5hOCh2dywgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeWMuYTgoMSwgKyh2eCA9PT0gMTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeWMuYTgodngsIHlkW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkNigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55ZSA9IG5ldyB5ZigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdCA9IG5ldyB5ZygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmg5ID0gbmV3IHloKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueWkgPSBuZXcgeWooKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55ayA9IG5ldyB5bCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnltID0gbmV3IHluKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0LmRYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB5aCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55byA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeXAgPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5cSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0geXBbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS55cihnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXEucHVzaChnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHlxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55cyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJmLmtIW2FELnl0XSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnl1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiZy5sOChhRC55dCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeXEgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJOLmZCWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZKID0gYk4uZko7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBmSlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLnlyKGdEKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5cS5wdXNoKGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geXE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnl1ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBsQVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS55cihnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueXYgPSBmdW5jdGlvbih5cSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0geXEubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnVCA9IGFnLmdUOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGwgKz0gZ1RbeXFbYUJdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHlmKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnl3ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeXgoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELnl5ID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHl6KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnowID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeXgoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELnl5ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHl6KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB5eCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYXYuejIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELnoxID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELnozID0gYUQuejQ7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geXooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiUS55ay56NSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVguc2hvdyhhRC56NiA9PT0gMSwgZmFsc2UsIGFELno2ID09PSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJRLnJlc3VsdC56NSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlEueW0uaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJRLnlpLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi56Nyh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLno4KDI0Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi56OCg5NTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uejgoOTU3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFWLmxYKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVcubFgodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdi5sWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkIuejkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmdwICYmIGJlLnpBLnpCKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBiYS56QygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geWooKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC55eSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnpEKDAsIDU5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSC5tTCgyNzAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgekUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6RigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyA9PT0gOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgekgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpGKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELno2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4uekQoYUQuekksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi56RCgxIC0gYUQuZVEsIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuekoueEwoYUQuekkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUgubTYoYUQuekksIDI3MDAsIGZhbHNlLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB6RSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6SyA9IGJmLmtIW2FELnl0XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6TCA9IGJmLnpNW3pLXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRLnpOKEwoMjYsIFt6TF0pLCAyLCAxLCAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54VygwLCBMKDI3LCBbekxdKSwgNDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFILm1MKDI3MDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpHKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uek8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFILm1MKDI3MDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpIKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uelAoYUQuekkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUgubTYoYUQuekksIDI3MDAsIGZhbHNlLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB5bigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJRLnJlc3VsdC56USA9PT0gMCB8fCBiUS5yZXN1bHQueXEubGVuZ3RoID09PSAwIHx8IGFELmtDID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmdzKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6UigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgelMgPSB6VCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgelUoelMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnl5ID09PSAyIHx8IGFELmtDID49IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB6Vih6Uyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpXID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgelggPSBhZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZiA9IGFELmVROw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpYLnpZW3ZmXSA9PT0gMCB8fCB6WC5pelt2Zl0gPCAxIHx8IDIgKiB6WC5wMlt2Zl0gPiAzICogKHpYLml5W3ZmXSArIHpYLml6W3ZmXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB6UigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gelooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0ogPSBNYXRoLmZsb29yKGFnLnhVW2FELmVRXSAvIDUwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNKID0gTWF0aC5taW4oc0osIDQwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc0ogLyAxMDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gelIoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0ogPSB6WigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNKID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoNDQwLCBMKDI4LCBbc0oudG9GaXhlZCgyKV0pLCA0MCwgMCwgYkEubjQsIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpUKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoNTIwLCBMKDI5KSwgNDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5cSA9IGJRLnJlc3VsdC55cTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHlxLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnVCA9IGFnLmdUOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IHlxW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRDogZ0QsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiBnVFtnRF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGcuc29ydCggKGV6LCBmMCkgPT4gZjAuZGwgLSBlei5kbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgek0gPSBhZy54WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGJRLnJlc3VsdC56YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGJRLnJlc3VsdC56UTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpiID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgelMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaEwgPSBnW2FCXS5kbCAqIHNKIC8gKDEwMCAqIGRsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgemMgPSB6TVtnW2FCXS5nRF0gKyAiOiAiICsgaEwudG9GaXhlZCgyKSArIFNbMTNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpiICs9IHpjOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnW2FCXS5nRCA9PT0gYUQuZVEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgelMgPSBoTDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCID4gMiAmJiBlZyAhPT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9ICIoIiArIEwoMzAsIFtlZyAtIDNdKSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gemM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54Vyg1NjAsIGI5LnpkLnplKHBOKSwgNDAsIDAsIGJBLm40LCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6Uykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDU4MCwgTCgzMSwgW3pTLnRvRml4ZWQoMikgKyAiICsgIiArIHpaKCkudG9GaXhlZCgyKV0pLCA0MCwgMCwgYkEubjQsIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiOS5nMS5ncyhhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6UigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHpTOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpVKHpTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgIT09IDcgJiYgYUQua0MgIT09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELno2ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoNjAwLCBMKDMyLCBbelMudG9GaXhlZCgyKV0pLCA0MCwgMCwgYkEubW0sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHpWKHpTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeXEgPSBiUS5yZXN1bHQueXE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB5cS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgemYgPSBhZy56ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnVCA9IGFnLmdUOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpnID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBsb29wOiBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSB5cVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpoID0gYjkuemQuemkoemZbZ0RdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoemggPT09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6aiA9IGdUW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmMCA9IHpnLmxlbmd0aCAtIDE7IGYwID49IDA7IGYwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpoID09PSB6Z1tmMF0ubmFtZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemdbZjBdLmRsICs9IHpqOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemdbZjBdLmcucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0Q6IGdELA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiB6ag0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpnLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB6aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGw6IHpqLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnOiBbew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0Q6IGdELA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGw6IHpqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoemcubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgemcuc29ydCggKGV6LCBmMCkgPT4gZjAuZGwgLSBlei5kbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHpnWzBdLmc7DQogICAgICAgICAgICAgICAgICAgICAgICBnLnNvcnQoIChleiwgZjApID0+IGYwLmRsIC0gZXouZGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHprID0gIlsiICsgemdbMF0ubmFtZSArICJdIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGJRLnJlc3VsdC56UTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6bCA9IDggKiA2NCAqIHNKIC8gKDEwMCAqIDQgKiA2NTUzNik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54VygwLCBMKDMzLCBbemssIHpsLnRvRml4ZWQoNCldKSwgNDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZEID0gemdbMF0uZGw7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgem0gPSAxMDAwMCAqIHpsOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwga2Q7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1thQl0uZ0QgPT09IGFELmVRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDYwMCwgTCgzNCwgWyh6bSAqIGdbYUJdLmRsIC8gKDEwICogdkQpKS50b0ZpeGVkKDIpXSksIDQwLCAwLCBiQS5tbSwgYkEubWosIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDY0MCwgTCgzNSwgWygwLjIgKiB6UykudG9GaXhlZCgyKSwgemtdKSwgNDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDcyMCwgTCgzNikgKyBiSi56biwgNzM2LCAwLCBiQS5tbSwgYkEubkEsIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geWcoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuem8gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55cSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56YSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpRID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHpwKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24genAockkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC55eSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJJLnlxID0gYlEuaDkueW8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJJLnlxID0gYlEuaDkueXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBySS55cSA9IGJRLmg5Lnl1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgckkuem8gPSBiaC56cS56cigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgckkuemEgPSBNYXRoLm1heCgxLCBiUS5oOS55dihySS55cSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjcuZzEub2coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgckkuelEgPSAxMDAgKiBiUS5yZXN1bHQuem8gKiAoMSArIGFELnhQKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB6cygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJRLnJlc3VsdC56USA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24geWwoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC55eSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELno2ID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB6dCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24genQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuZzEuakooMCkgfHwgYWcubGxbMF0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuekkgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYjkuZzEuakooMSkgfHwgYWcubGxbMV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuekkgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELnpJID0gKyhhZy5nVFsxXSA+IGFnLmdUWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuejYgPSArKGFELnpJID09PSBhRC5lUSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGw2ID0gYmcuenUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC55dCA9IGw2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZi5rSFtsNl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuejYgPSArKGJmLmVlW2FELmVRXSA9PT0gbDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuekkgPSBsQVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELno2ID0gKyhhRC56SSA9PT0gYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRCKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kbiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudU8gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVQID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51USA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudVcgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExID0gbmV3IHp2KCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHp3KHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgengodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB6eSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHp5KHNlbGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1TzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmlkICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1TyA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF1Tykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVPLnNldEl0ZW0oU1s3MF0sICIxIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdU8ucmVtb3ZlSXRlbShTWzcwXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudU8gPSB1TzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB6dyhzZWxmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEFuZHJvaWQgPT09IFNbMjddKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBBbmRyb2lkLmdldFZlcnNpb24gIT09IFNbMzRdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG4gPSBBbmRyb2lkLmdldFZlcnNpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkbiA8IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kbiA9IGRuOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pZCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnVQID0gQW5kcm9pZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB6eChzZWxmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG13SU9TZGF0YVggPT09IFNbMjddKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF3aW5kb3cud2Via2l0IHx8ICF3aW5kb3cud2Via2l0Lm1lc3NhZ2VIYW5kbGVycyB8fCAhd2luZG93LndlYmtpdC5tZXNzYWdlSGFuZGxlcnMuaW9zQ29tbWFuZEEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmlkID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudVEgPSBtd0lPU2RhdGFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi51VyA9IHdpbmRvdy53ZWJraXQubWVzc2FnZUhhbmRsZXJzLmlvc0NvbW1hbmRBOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG4gPSBzZWxmLnVRWyJ2ZXJzaW9uIl07DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRuID0gZG4gPyBOdW1iZXIoZG4pIDogMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB6digpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56eiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgudWooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnVrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmNsb3NlKDAsIDMyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLnVPKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVPLmNsZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVQLnNhdmVTdHJpbmcoMTk5LCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVcucG9zdE1lc3NhZ2UoImNsZWFyIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwMCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVcucG9zdE1lc3NhZ2UoInNob3dDb25zZW50Rm9ybSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVQLnNldFN0YXRlKDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTAxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucjQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiaS5lRC51SigyKSA9PT0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTAyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLmVELnVIKDEwMiwgcE4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSA9IGZ1bmN0aW9uKGEwMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkICE9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmRuID49IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51UC5zZXRTdGF0ZShhMDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEwNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSAmJiBhMC5kbiA+PSA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVAuc2V0U3RhdGUoNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTA0ID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTA0LnNlYXJjaFBhcmFtcy5zZXQoInYiLCAiIiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYTA0LnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRjID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgIT09IDEgfHwgYTAuZG4gPCAxNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVQLnNhdmVTdHJpbmcoMjMsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUwpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lQiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVAucHJlcGFyZUFkKCIxNjg4NDQxNDA1Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmRuID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVXLnBvc3RNZXNzYWdlKCJwcmVwYXJlIGFkIDE3NzAyNTEzOTEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51Vy5wb3N0TWVzc2FnZSgibG9hZEFkcyAxNzcwMjUxMzkxIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lRyA9IGZ1bmN0aW9uKGRsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuZG4gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVcucG9zdE1lc3NhZ2UoInNob3cgYWQgIiArIGRsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51Vy5wb3N0TWVzc2FnZSgic2hvd0FkIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkID09PSAyICYmIGEwLmRuIDwgMjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgMSwgbmV3IHYoIkFwcCBVcGRhdGUgUmVxdWlyZWQiLCJBIG5ldyBpT1MgYXBwIHZlcnNpb24gd2l0aCBidWcgZml4ZXMgaGFzIGJlZW4gcHVibGlzaGVkLjxicj5QbGVhc2UgZG93bmxvYWQgdGhlIG5ldyBUZXJyaXRvcmlhbC5pbyBhcHAgdmVyc2lvbiBmb3IgaU9TOjxicj48YSBocmVmPSciICsgYkouYTA1ICsgU1syNl0gKyBiSi5hMDUgKyBTWzI5XSx0cnVlLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5SKV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRRKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnAgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMDYgPSBmdW5jdGlvbihhMDcsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucC5wdXNoKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQucnYgPT09IDggJiYgYTA3ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IDQyMTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTA4KGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSAhPT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBBKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IDQ0ODApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwQigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg0LCAwLCBuZXcgdihMKDM4KSxhMEMoZSksdHJ1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTAzID0gYWEuYTA5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAzID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IDQyMTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTA4KGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlICE9PSA0MjE1ICYmIGUgIT09IDQ1MTYgJiYgZSAhPT0gNDUyNyAmJiBlICE9PSA0NTI3ICYmIGUgIT09IDQ1MzMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVouYTBEKGEwNyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJtLmEwRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDcgIT09IGF6LnkuYTBGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEwMyA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDcgPT09IGF6LnkuYTBHICYmICFhRC5rRSAmJiBhRC56MSA9PT0gMSAmJiAhYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4uYTBIKEwoMzksIFtlXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEwSShlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBKID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wLnB1c2goZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmtFICYmIGFELnoxID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmEwSChMKDM5LCBbZV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBJKGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IDMyNjg7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnAucHVzaChlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwSyhlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwQigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnVsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgMCwgbmV3IHYoTCg0MCksTCg0MSksdHJ1ZSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwOChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMEsoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgNSwgbmV3IHYoIvCfmoAgTmV3IEdhbWUgVXBkYXRlIiwiVGhlIGdhbWUgaGFzIGJlZW4gdXBkYXRlZCEgUGxlYXNlIHJlbG9hZCB0aGUgZ2FtZS4iLHRydWUsW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoU1s2Nl0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuYTIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxiQS5uOSldKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBJKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwSyhlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg0LCA1LCBuZXcgdihMKDM4KSxhMEMoZSksdHJ1ZSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwQyhlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiIFsiICsgZSArICJdIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID09PSAzMjQ5IHx8IGUgPT09IDEwMDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIk5vIEludGVybmV0IC8gTm8gU2VydmVyIFJlc3BvbnNlIiArIHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IDQ1MjcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlBsYXllciBhbHJlYWR5IGluIGxvYmJ5IiArIHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IDQ1MzApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkxvYmJ5IFRpbWVvdXQiICsgcE47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PT0gNDUyOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiTG9iYnkgS2ljazogQW5vdGhlciBsb2dpbiBkZXRlY3RlZC4iICsgcE47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PT0gNDU0MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiWW91IGhhdmUgYmVlbiBraWNrZWQuIiArIHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJVbmtub3duIGVycm9yIiArIHBOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwSyhlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMEEoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnkueigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwQShlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTAzID0gYWEuYTA5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAzID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hME0oZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJtLmEwRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJtLnRIKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZShhei55LmEwRiwgMzI1Nik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEwMyA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmEwTih0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEwTywgYTBQOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTBRID0gLTE1MDAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTBSID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBTID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFQgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIGd0LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2l2ZTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGEwVywgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NpdmU6IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwVi5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgYTBYLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2l2ZTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoU1syNF0sIGNsaWNrLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2l2ZTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoU1s0OF0sIGEwWSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NpdmU6IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwVi5hZGRFdmVudExpc3RlbmVyKFNbNjddLCBhMFosIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzaXZlOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hzdGFydCIsIGEwYSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NpdmU6IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwVi5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCBhMGIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzaXZlOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hlbmQiLCBhMGMsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzaXZlOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hjYW5jZWwiLCBhMGQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzaXZlOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuYWRkRXZlbnRMaXN0ZW5lcigiZHJhZ292ZXIiLCBhMGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoImRyb3AiLCBhMGYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLmFkZEV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgYTBnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNvbnRleHRtZW51IiwgYTBoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoU1s4NV0sIGEwaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsIGEwaik7DQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ2aXNpYmlsaXR5Y2hhbmdlIiwgYTBrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCByZXNpemUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZ3QoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBSID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwbShlLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYTBuKGF6LnkuYTBHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwbyhNYXRoLmZsb29yKGguayAqIGUuY2xpZW50WCksIE1hdGguZmxvb3IoaC5rICogZS5jbGllbnRZKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBhKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwUSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hMG4oYXoueS5hMEcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudG91Y2hlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBPID0gTWF0aC5mbG9vcihoLmsgKiBlLnRvdWNoZXNbMF0uY2xpZW50WCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBQID0gTWF0aC5mbG9vcihoLmsgKiBlLnRvdWNoZXNbMF0uY2xpZW50WSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdC5hMGEoZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBvKGEwTywgYTBQKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBvKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC5ndChlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWEuZ3QoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkIuYTBwKGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmQuZ3QoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhWC5ndChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFMLmEwcShlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFQLmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU0uZ3QoZW4sIGVwKSA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2Lmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkkuYTByKGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTC5hMHMoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwciA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJCLmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVi5ndChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVMuZ3QoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTi5ndChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMFcoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBSID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwbShlLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwdChNYXRoLmZsb29yKGguayAqIGUuY2xpZW50WCksIE1hdGguZmxvb3IoaC5rICogZS5jbGllbnRZKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBiKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwUSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudG91Y2hlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBPID0gTWF0aC5mbG9vcihoLmsgKiBlLnRvdWNoZXNbMF0uY2xpZW50WCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTBQID0gTWF0aC5mbG9vcihoLmsgKiBlLnRvdWNoZXNbMF0uY2xpZW50WSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdC5hMGIoZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTB0KGEwTywgYTBQKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTB0KGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC5hMFcoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFhLmEwVyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJTLmdtKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmQuYTBXKGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTS5hMFcoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTC5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUwuYTBXKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmd1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmEwVyhlbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhVi5hMFcoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUy5tSCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUy5hMFcoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMFkoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTB1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYS5jbGljaygtMTAyNCwgLTEwMjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFULnFnKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVYuYTB2KC0xMDI0LCAtMTAyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTS5hMFcoLTEwMjQsIC0xMDI0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSLmEwdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVMubUggPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMFgoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTB4KE1hdGguZmxvb3IoaC5rICogZS5jbGllbnRYKSwgTWF0aC5mbG9vcihoLmsgKiBlLmNsaWVudFkpLCBlLmJ1dHRvbiA9PT0gMik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkkuYTBVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkkuYTBVID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNsaWNrKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMGwoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEwbShlLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMGMoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTBRID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBhMG0oZSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlLnRvdWNoZXMgJiYgZS50b3VjaGVzLmxlbmd0aCA+IDAgJiYgYUQuejEgIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5tSCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdC5hMHkoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEweChhME8sIGEwUCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJJLmEwVSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJJLmEwVSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMGQoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTBRID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBhMG0oZSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMHgoYTBPLCBhMFAsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiSS5hMFUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiSS5hMFUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBlKGUpIHt9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwZihlKSB7fQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMGcoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEweChlbiwgZXAsIGEweikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTB1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYS5jbGljayhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFWLmEwdihlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmQuYTB2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUi5hMHcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTLm1IID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUwuY2xpY2soZW4sIGVwLCBhMHopKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTS5hMFgoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMHUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwdSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwWihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTBsKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhMG0oZSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmEwbihhei55LmEwRyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBNYXRoLmZsb29yKGguayAqIGUuY2xpZW50WCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBNYXRoLmZsb29yKGguayAqIGUuY2xpZW50WSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFZID0gZS5kZWx0YVk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5kZWx0YU1vZGUgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YVkgKj0gMTY7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwWihlbiwgZXAsIGRlbHRhWSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYS5hMFooZW4sIGVwLCBkZWx0YVkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVi5hMFooZW4sIGVwLCBkZWx0YVkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmExMChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmEwWihkZWx0YVkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVMuYTBaKGVuLCBlcCwgZGVsdGFZKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMGgoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTBtKGUsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwbShlLCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwICYmICh0LmhOKCkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGExMSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFhLmEwOSgpID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGExMSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUwIDwgMC45OTkgfHwgZTAgPiAxLjAwMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMGkoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwbCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGgucmQgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBlLmNvZGU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvZGUgfHwgIWNvZGUubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJXLmYxKGNvZGUsIDE4KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLmExMigzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgMjIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXEuYTEyKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCAyMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcS5hMTIoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJXLmYxKGNvZGUsIDI0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLmExMigyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgMTApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVIuYTEzKDMxIC8gMzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCA4KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSLmExMygzMiAvIDMxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUi5hMTMoNyAvIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCA0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSLmExMyg4IC8gNyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJXLmYxKGNvZGUsIDE0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5hMFooTWF0aC5mbG9vcihoLmkgLyAyKSwgTWF0aC5mbG9vcihoLmogLyAyKSwgLTIwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCAxNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVMuYTBaKE1hdGguZmxvb3IoaC5pIC8gMiksIE1hdGguZmxvb3IoaC5qIC8gMiksIDIwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCAwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuejEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUy5nbihmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJXLmYxKGNvZGUsIDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC56MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJTLmduKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCAyNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELnoxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlMuaEgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgMjgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC56MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJTLmhNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBqKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMGwoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoLnJkID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5lRiA8IDQwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZS5jb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2RlIHx8ICFjb2RlLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSBTWzM5XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmExNCgxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IFNbNTJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuYTE0KDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0uYTBFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJtLnROLmExNChjb2RlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSBTWzM4XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiSS5mOSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgIT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTE0KGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSBTWzM4XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJJLmY5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJXLmYxKGNvZGUsIDE4KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLmExNSgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgMjIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXEuYTE1KDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiVy5mMShjb2RlLCAyMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcS5hMTUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJXLmYxKGNvZGUsIDI0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLmExNSgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlcuZjEoY29kZSwgMTIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkIuYTE2KCFhRC5tRik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IFNbNTJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC56MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNLmdxICYmIGFNLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmdwICYmIGJCLmExOChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBrKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gU1sxNV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYkIuYTE5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhRC5rRSAmJiAhYU0uZ3EgJiYgIWFELmgxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEwbCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMFEgKyAxNTAwMCA+IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTFBID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTBsKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnE5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWEwUiB8fCBhMFEgPiAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVzaXplKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaC5hMUIoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmY5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hMTQoMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFhLmEwOSgpID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELm1GKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJCLmExNihmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJkLmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJkLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFaLmExQygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGJ3KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBnID0gbmV3IGExRCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBwID0gbmV3IGExRSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmcxID0gbmV3IGExRigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpkID0gbmV3IGExRygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhEID0gbmV3IGExSCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExSSA9IG5ldyBhMUooKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBuZXcgYTFLKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBuZXcgYTFMKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTFNID0gbmV3IGExTigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBnLnVpKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUUoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudmQgPSBmdW5jdGlvbihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnLmZpbGwoMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExTyA9IGZ1bmN0aW9uKGcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMVAgPSBmdW5jdGlvbihobCwgYTFRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG0gPSBiTi5mRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDM7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBobVthQl0gPSBhMVEgKiBobFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaG07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExUiA9IGZ1bmN0aW9uKGhsLCBobSwgYTFTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHAgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgMzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhwICs9IE1hdGguYWJzKGhsW2FCXSAtIGhtW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaHAgPj0gYTFTOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMVQgPSBmdW5jdGlvbihobCwgYTFVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCAzOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGxbYUJdID0gYksucEUoaGxbYUJdICsgYTFVLCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMVYgPSBmdW5jdGlvbihnLCBzRiwgc0cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNGID0gc0YgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNHID0gc0cgfHwgKGcubGVuZ3RoIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFXID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gc0Y7IGFCIDw9IHNHOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFXICs9IGdbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGExVzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTFYID0gZnVuY3Rpb24oZywgYTFZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXosIGFCLCBhMVo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMWEgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBlZyAtIDE7IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMVogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMVkoZ1thQl0pIDwgYTFZKGdbYTFaXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExWiA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFhLnB1c2goZ1thMVpdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2ExWl0gPSBnW2VnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnBvcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGExYTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWluID0gZnVuY3Rpb24oZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmOCA9IGdbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gTWF0aC5taW4oZjgsIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWF4ID0gZnVuY3Rpb24oZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmOCA9IGdbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDE7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCA9IE1hdGgubWF4KGY4LCBnW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExYiA9IGZ1bmN0aW9uKGcsIGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnOCArPSBnW2FCXSA+IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMWMgPSBmdW5jdGlvbihhMWQsIGExZSwgbWluKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhMWVbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGVnIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMWRbYUJdIDwgbWluKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExZFthQl0gPSBhMWRbZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGExZVswXSA9IGVnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMWYgPSBmdW5jdGlvbihnLCBlZywgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbYUJdIC09IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMWcgPSBmdW5jdGlvbihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZ1thQl0gIT09IFNbNDRdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTFoID0gZnVuY3Rpb24ocE4sIGcsIGExaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZy5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNKID0gcE4uc3BsaXQoIiwiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWluKHNKLmxlbmd0aCwgZy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0gPSBNYXRoLm1pbihwYXJzZUludChzSlthQl0pLCBhMWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMWogPSBmdW5jdGlvbihwTiwgZywgcWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGcuZmlsbCgiIik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0ogPSBwTi5zcGxpdCgiXCIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWluKHNKLmxlbmd0aCwgMiAqIGcubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoVCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDE7IGFCIDwgZWc7IGFCICs9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2hUKytdID0gc0pbYUJdLnNsaWNlKDAsIHFkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTFrID0gZnVuY3Rpb24oZywgZzgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnOCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFXID0gdGhpcy5hMVYoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMVcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLmZpbGwoYksuZG0oZzgsIGVnKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IGJLLmRtKGc4ICogZ1thQl0sIGExVyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTFXID0gdGhpcy5hMVYoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTFXID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1sxXSA9IGc4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoVCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYTFXKysgPCBnOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhUID0gKGhUICsgMSkgJSBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1toVF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1toVF0rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExbCA9IGZ1bmN0aW9uKGcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmOCA9IGdbZWcgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gZWcgLSAyOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdbYUJdICE9PSBmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUIgKyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMW0gPSBmdW5jdGlvbihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFXID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExVyArPSBnW2FCXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTFXOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMW4gPSBmdW5jdGlvbihhMW8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYTFvLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBnLmNvbmNhdChhMW9bYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYTFLKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhvID0gZnVuY3Rpb24oYTFwLCBlMSwgYTFxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFggPSBhMXAuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExciA9IGI5LnBnLnZUKGhYLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSBiOS5wZy5nZXRDb250ZXh0KGExcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhMXMoaFgsIGhkLCBhMXEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKGExcCwgLWUxICogaFgsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGExcjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGExcyhpLCBoZCwgYTFxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsU3R5bGUgPSBhMXE7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmFyYyhpIC8gMiwgaSAvIDIsIGkgKiAwLjQ3LCAwLCAyICogTWF0aC5QSSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMXQgPSBmdW5jdGlvbihhMXUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoWCA9IGExdS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTF1LndpZHRoICE9PSBoWCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMXU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSBiOS5wZy5nZXRDb250ZXh0KGExdSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGEgPSBoZC5nZXRJbWFnZURhdGEoMCwgMCwgaFgsIGhYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmExSS5hMXYoaGEuZGF0YSwgaFgsIGhYLCAwLjkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQucHV0SW1hZ2VEYXRhKGhhLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMXU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUwoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTF3ID0gZnVuY3Rpb24oZjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbKGY4ID4+IDEyKSAmIDYzLCAoZjggPj4gNikgJiA2MywgZjggJiA2M107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExeCA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHRoaXMuYTF3KGY4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAzOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0gPSB+fig0LjA1ICogZ1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExeSA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHRoaXMuYTF4KGY4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOS5jb2xvci5tZShnWzBdLCBnWzFdLCBnWzJdKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTF6ID0gZnVuY3Rpb24oZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDM7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IH5+KGdbYUJdIC8gNC4wNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGdbMF0gPDwgMTIpICsgKGdbMV0gPDwgNikgKyBnWzJdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZSA9IGZ1bmN0aW9uKGUwLCBzSiwgZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzddICsgZTAgKyAiLCIgKyBzSiArICIsIiArIGYwICsgIikiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZyA9IGZ1bmN0aW9uKGUwLCBzSiwgZjAsIGV6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU1s4XSArIGUwICsgIiwiICsgc0ogKyAiLCIgKyBmMCArICIsIiArIGV6LnRvRml4ZWQoMykgKyAiKSI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFCID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gZjEuc3BsaXQoIigiKVsxXS5zcGxpdCgiLCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZGID0gYk4uZkY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgMzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZGW2FCXSA9IHBhcnNlSW50KGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnLmxlbmd0aCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZGWzNdID0gMjU1ICogcGFyc2VGbG9hdChnWzNdLnNsaWNlKDAsIC0xKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZGWzNdID0gMjU1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZGOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xQyA9IGZ1bmN0aW9uKGEyMCwgZWopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGEyMC5zbGljZShhMjAuaW5kZXhPZigiKCIpICsgMSwgYTIwLmluZGV4T2YoIikiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHBOLnNwbGl0KCIsIik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZkYgPSBiTi5mRjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAzOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZkZbYUJdID0gYksucEUocGFyc2VJbnQoZ1thQl0udHJpbSgpLCAxMCkgKyBlaiwgMCwgMjU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnLmxlbmd0aCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1lKGZGWzBdLCBmRlsxXSwgZkZbMl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhID0gcGFyc2VGbG9hdChnWzNdLnRyaW0oKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IGFscGhhID09PSAwID8gMC4zIDogYWxwaGE7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tZyhmRlswXSwgZkZbMV0sIGZGWzJdLCBhbHBoYSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyMSA9IGZ1bmN0aW9uKGcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9ICIjIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAzOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gZ1thQl0udG9TdHJpbmcoMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IGUwLmxlbmd0aCA9PT0gMSA/ICgiMCIgKyBlMCkgOiBlMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTIyID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5sZW5ndGggPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJBLm1kOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gcGFyc2VJbnQocE4uc2xpY2UoMSwgMyksIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IHBhcnNlSW50KHBOLnNsaWNlKDMsIDUpLCAxNik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSBwYXJzZUludChwTi5zbGljZSg1LCA3KSwgMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWUoZTAsIHNKLCBmMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUgoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTIzID0gZnVuY3Rpb24ocE4sIGZvbnQsIG1heFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9udCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBmb250Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB0by5tZWFzdXJlVGV4dChwTikud2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8PSBtYXhXaWR0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMjQgPSAiLi4uIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gcE4ubGVuZ3RoIC0gMTsgYUIgPj0gMTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4uc3Vic3RyaW5nKDAsIGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gdG8ubWVhc3VyZVRleHQocE4gKyBhMjQpLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDw9IG1heFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTiArIGEyNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTI0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYTFOKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYTI1ID0gWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMjYgPSBmdW5jdGlvbihlRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyNywgYTI4LCBnRTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IChuZXcgRGF0ZShlRi5nZXRUaW1lKCkgLSAxMDAwICogNjAgKiBlRi5nZXRUaW1lem9uZU9mZnNldCgpKSkudG9VVENTdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5sZW5ndGggPCAxMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gcE4uc3Vic3RyaW5nKDUsIHBOLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMjcgPSBlRi5nZXRUaW1lem9uZU9mZnNldCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEyNyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEyOCA9IGJLLmRtKE1hdGguYWJzKGEyNyksIDYwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEyOCA9IChhMjcgPCAwID8gIisiIDogIi0iKSArIGEyODsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdFID0gTWF0aC5hYnMoYTI3KSAlIDYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdFID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOICsgYTI4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOICsgYTI4ICsgIjoiICsgKGdFIDwgMTAgPyAiMCIgOiAiIikgKyBnRTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTI5ID0gZnVuY3Rpb24oZUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGVGLnRvVVRDU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocE4ubGVuZ3RoIDwgMTIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTJBKGVGKSArICIsICIgKyBwTi5zdWJzdHJpbmcoNSwgcE4ubGVuZ3RoIC0gNCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMkEoZUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMjVbZUYuZ2V0VVRDRGF5KCldOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGExRCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEyQiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueTUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnVpID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBiaS5lRC5kYXRhWzVdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTJCID0gInB4ICIgKyBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmOCAhPT0gU1s3MV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMkIgKz0gIiwgc2Fucy1zZXJpZiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnk1ID0gaFcoMzIsIDMyLCBbImEiLCAiYiIsICJtIl0sIDIwMCwgYTJCKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudlQgPSBmdW5jdGlvbihpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjEud2lkdGggPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjEuaGVpZ2h0ID0gajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uKGNhbnZhcywgYWxwaGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IGFscGhhDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW1hZ2VEYXRhID0gZnVuY3Rpb24oeEQsIGksIGopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4RC5nZXRJbWFnZURhdGEoMCwgMCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJWID0gZnVuY3Rpb24odHlwZSwgc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IHNpemUudG9GaXhlZCgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpemUgKyBhMkI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gImJvbGQgIiArIHNpemUgKyBhMkI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gImxpZ2h0ZXIgIiArIHNpemUgKyBhMkI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU1s4Nl0gKyBzaXplICsgYTJCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJvYmxpcXVlICIgKyBzaXplICsgYTJCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJzbWFsbC1jYXBzICIgKyBzaXplICsgYTJCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gInNtYWxsLWNhcHMgYm9sZCAiICsgc2l6ZSArIGEyQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dEFsaWduID0gZnVuY3Rpb24oaGQsIGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC50ZXh0QWxpZ24gPSAibGVmdCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQudGV4dEFsaWduID0gU1sxMF07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnRleHRBbGlnbiA9ICJyaWdodCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRCYXNlbGluZSA9IGZ1bmN0aW9uKGhkLCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQudGV4dEJhc2VsaW5lID0gU1szM107DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQudGV4dEJhc2VsaW5lID0gImJvdHRvbSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnRleHRCYXNlbGluZSA9IFNbNjldOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wciA9IGZ1bmN0aW9uKGUsIGNvZGUsIGNvbG9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSB0aGlzLnBxKGJiLnJYKSArICIgc29saWQgIiArIChjb2xvciB8fCBiQS5tbSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb2RlID0gY29kZSB8fCA1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLmJvcmRlciA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5ib3JkZXJMZWZ0ID0gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLmJvcmRlckJvdHRvbSA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdHlsZS5ib3JkZXJSaWdodCA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0eWxlLmJvcmRlclRvcCA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zTCA9IGZ1bmN0aW9uKGUsIGVuLCBlcCwgaSwgaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsID0gZS5zdHlsZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBsLmxlZnQgPSB0aGlzLnNNKGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBsLnRvcCA9IHRoaXMuc00oZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGwud2lkdGggPSB0aGlzLnNNKGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGwuaGVpZ2h0ID0gdGhpcy5zTShqKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucGggPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDEgKyBmOCAqIGEwLmExLnI0KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF6ID0gZnVuY3Rpb24obU8sIGdFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbU8gKiB0aGlzLnBoKGdFID09PSB1bmRlZmluZWQgPyAwLjUgOiBnRSkgKiBoLnBpIC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zSyA9IGZ1bmN0aW9uKG1PLCBnRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1PICogdGhpcy5waChnRSA9PT0gdW5kZWZpbmVkID8gMC41IDogZ0UpICogaC5waTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuczEgPSBmdW5jdGlvbihtTywgZ0UsIGEyQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyRCA9IHRoaXMucGgoZ0UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEyRCAqIE1hdGgubWluKG1PICogaC5waSwgYTJDICogaC5pKSAvIGguazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucHEgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4LnRvRml4ZWQoMSkgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zTSA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hMkUoZjgpLnRvRml4ZWQoMSkgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMkUgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4IC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMkYgPSBmdW5jdGlvbihybCwgYTJHKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiPHVsPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBybC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9ICI8bGk+IiArIHJsW2FCXSArICI6IDxhIGhyZWY9JyIgKyBhMkdbYUJdICsgU1syNl0gKyBhMkdbYUJdICsgIjwvYT48L2xpPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwTiArPSAiPC91bD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMkggPSBmdW5jdGlvbihhMkkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzU2XSArIGEySSArIFNbMjZdICsgYTJJICsgU1syOV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEySiA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEySyA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGUudGV4dENvbnRlbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuemQuYTJMKGRsLCAi4pyUIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwubGVuZ3RoID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50ZXh0Q29udGVudCA9ICLinJQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRleHRDb250ZW50ID0gZGwgKyAiIOKclCI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSBkbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1lYXN1cmVUZXh0ID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0by5tZWFzdXJlVGV4dChwTikud2lkdGg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNCID0gZnVuY3Rpb24oYTJNKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMk0uc3R5bGUub3ZlcmZsb3dYID0gU1s5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEyTS5zdHlsZS5vdmVyZmxvd1kgPSBTWzE1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEyTS5zdHlsZS53aGl0ZVNwYWNlID0gU1s0N107DQogICAgICAgICAgICAgICAgICAgICAgICBhMk0uYWRkRXZlbnRMaXN0ZW5lcihTWzY3XSwgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhlLmRlbHRhWSkgPCBNYXRoLmFicyhlLmRlbHRhWCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgKz0gZS5kZWx0YVk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zTyA9IHRoaXMuc2Nyb2xsTGVmdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEyTS5hZGRFdmVudExpc3RlbmVyKFNbMzBdLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNPID0gdGhpcy5zY3JvbGxMZWZ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUYoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3IgPSBmdW5jdGlvbihhMDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDMgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUQuejEgPT09IDEgJiYgYUQuaDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAzID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFELnoxID09PSAxICYmICFhRC5oMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRC56MSA9PT0gMjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3MgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhZy5sbFtwbGF5ZXJdICE9PSAwICYmIGFnLmEyTltwbGF5ZXJdICE9PSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMk8gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIgPT09IGFELmVRICYmIGFnLmEyTltwbGF5ZXJdICE9PSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sSyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp3ID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoancgPCAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFnLmdUW2xBWzFdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiZy5hMlAoKSA+IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyUSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp3ID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoancgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMuakoobEFbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbDYgPSBiZy5sNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp4ID0gYWwuang7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGp4W2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWVbZ0RdID09PSBsNiAmJiAhdGhpcy5qSihnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyUiA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllciA9PT0gYUQuZVE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpKID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyID49IGFELmp2IHx8IGFnLmEyTltwbGF5ZXJdID09PSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5raCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFnLmxsW3BsYXllcl0gIT09IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnlyID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyIDwgYUQuanY7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm96ID0gZnVuY3Rpb24oYTJTLCBhMlQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMlMgIT09IGEyVDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZzQgPSBmdW5jdGlvbihwbGF5ZXIsIGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmOCA9IHRoaXMuYTJVKHBsYXllciwgZjgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZ2hbcGxheWVyXSArPSBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5hMlZbcGxheWVyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW4gPSBNYXRoLm1pbihhZy5hMlZbcGxheWVyXSwgYWcuZ2hbcGxheWVyXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcuYTJWW3BsYXllcl0gLT0gbWluOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdoW3BsYXllcl0gLT0gbWluOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMlUgPSBmdW5jdGlvbihwbGF5ZXIsIGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJXID0gYWcuZ2hbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gTWF0aC5taW4oZjgsIGFnLmdUW3BsYXllcl0gKiBhRC5hMlggLSBhMlcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBNYXRoLm1pbihmOCwgYUQuYTJZIC0gYTJXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChmOCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnAwID0gZnVuY3Rpb24ocGxheWVyLCBpRiwgYTJaLCBhMmEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMlcgPSBhZy5naFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhLID0gYksuZG0oYTJXICogKGlGICsgMSksIDEwMjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyYiA9IGJLLmRtKGEyWiAqIGEyVywgMTAyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoSyA9IE1hdGgubWluKGhLLCBhMlcgLSBhMmIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhLID0gYjMuYTJjKHBsYXllciwgaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkRbMF0gPSBoSzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZEWzFdID0gYTJiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhLID49IGEyYTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub1IgPSBmdW5jdGlvbihwbGF5ZXIsIG9BLCBvOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyVyA9IGFnLmdoW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJiID0gYksuZG0oNjQgKiBhMlcsIDEwMjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgb0EgPSBNYXRoLm1pbihvQSwgYTJXIC0gYTJiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMmQgPSB0aGlzLmEyZShvQSk7DQogICAgICAgICAgICAgICAgICAgICAgICBvQSAtPSBhMmQ7DQogICAgICAgICAgICAgICAgICAgICAgICBhMmIgKz0gYTJkOw0KICAgICAgICAgICAgICAgICAgICAgICAgb0EgPSB0aGlzLmEyVShvOSwgb0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkRbMF0gPSBvQTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZEWzFdID0gYTJiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9BID49IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9UID0gZnVuY3Rpb24ob0EsIG85KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJkID0gdGhpcy5hMmUob0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgb0EgLT0gYTJkOw0KICAgICAgICAgICAgICAgICAgICAgICAgb0EgPSB0aGlzLmEyVShvOSwgb0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkRbMF0gPSBvQTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZEWzFdID0gYTJkOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9BID49IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlFID0gZnVuY3Rpb24ocGxheWVyLCBhMmYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiSy5kbShhZy5naFtwbGF5ZXJdICogKGEyZiArIDEpLCAxMDI0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTJlID0gZnVuY3Rpb24oYTJnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksuZG0oTWF0aC5tYXgoMjE0MiAtIGJlLmpzKCksIDApICogYTJnLCAyMTQyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucEMgPSBmdW5jdGlvbihwbGF5ZXIsIGEyWikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyYiA9IGJLLmRtKGEyWiAqIGFnLmdoW3BsYXllcl0sIDEwMjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkRbMV0gPSBhMmI7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5naFtwbGF5ZXJdIC09IGEyYjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZzIgPSBmdW5jdGlvbihwbGF5ZXIsIGEyaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwID0gYWcuZ2hbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMmggPD0gZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5naFtwbGF5ZXJdIC09IGEyaDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTJoOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZ2hbcGxheWVyXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZk4gPSBhMmggLSBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmUCA9IDUgKiAoZk4gPj4gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSBhZy5hMlZbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmUiA9IGVqICsgZlA7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5nNShwbGF5ZXIsIGZQIC0gZk4sIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmUiA8PSBhRC5hMmkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5hMlZbcGxheWVyXSA9IGZSOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMmg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5hMlZbcGxheWVyXSA9IGFELmEyaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJjLmc1KHBsYXllciwgZlIgLSBhRC5hMmksIDE4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMmg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmt2ID0gZnVuY3Rpb24ocGxheWVyLCBpRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdoID0gYWcuZ2g7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJXID0gZ2hbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoSyA9IGJLLmRtKGEyVyAqIChpRiArIDEpLCAxMDI0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMmIgPSBNYXRoLm1heChiSy5kbShhMlcsIDEwKSwgMTAwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoSyA9IE1hdGgubWluKGhLLCBhMlcgLSBhMmIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhLIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdoW3BsYXllcl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEyYiA9IE1hdGgubWluKDEwMDAsIGEyVyArIGFELmEyaSAtIGFnLmEyVltwbGF5ZXJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTi5mRFsxXSA9IGEyYjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5hMlZbcGxheWVyXSArPSBhMmIgLSBhMlc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiTi5mRFsxXSA9IGEyYjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoSyA9IGIzLmEyYyhwbGF5ZXIsIGhLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGdoW3BsYXllcl0gLT0gYTJiICsgaEs7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaEs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnAzID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5naFtwbGF5ZXJdIC09IGJOLmZEWzBdICsgYk4uZkRbMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnAxID0gZnVuY3Rpb24ocGxheWVyLCBqNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgajYgPSBNYXRoLm1pbihqNiwgYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGo2IDwgYUQuZWQgJiYgYWcubGxbajZdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajYgPSBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmVjWzBdID0gajY7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gajYgPT09IGFELmVkIHx8IGVaKHBsYXllciwgajYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wNSA9IGZ1bmN0aW9uKHBsYXllciwgbzkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFtvOV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWVaKHBsYXllciwgbzkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMmogPSBmdW5jdGlvbihwbGF5ZXIsIGEyaykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEybCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJtID0gbEE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gYTJtW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuakooZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKythMmwgPiBhMmspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubDMgPSBmdW5jdGlvbihnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEybiA9IGJnLmEybygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMm4gPSBhZy5nVFtsQVswXV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTJuID49IGJLLmRtKGdEICogYUQuamYsIDEwMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEycCA9IGZ1bmN0aW9uKGY4LCBtaW4sIG1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoYksucEUoaXNOYU4oZjgpID8gMCA6IE51bWJlcihmOCksIG1pbiwgbWF4KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUooKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTJxID0gZnVuY3Rpb24oY2FudmFzLCBhMnIsIGEycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBjYW52YXMud2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IGNhbnZhcy5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBiOS5wZy52VChpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IGI5LnBnLmdldENvbnRleHQoZjEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKGNhbnZhcywgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGEgPSBoZC5nZXRJbWFnZURhdGEoMCwgMCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBhMnIoaGEuZGF0YSwgaSwgaiwgYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnB1dEltYWdlRGF0YShoYSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEydCA9IGZ1bmN0aW9uKHZlLCBpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlbiA9IGkgLSAxOyBlbiA+PSAwOyBlbi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXAgPSBqIC0gMTsgZXAgPj0gMDsgZXAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIgPSA0ICogKGVuICsgZXAgKiBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbYUIgKyAzXSA9IHZlW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbYUJdID0gdmVbYUIgKyAxXSA9IHZlW2FCICsgMl0gPSAyNTU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMnUgPSBmdW5jdGlvbih2ZSwgaSwgaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZW4gPSBpIC0gMTsgZW4gPj0gMDsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVwID0gaiAtIDE7IGVwID49IDA7IGVwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCID0gNCAqIChlbiArIGVwICogaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2ZVthQiArIDFdID4gdmVbYUIgKyAyXSArIDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDNdID0gdmVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbYUIgKyAxXSA9IHZlW2FCICsgMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEydiA9IGZ1bmN0aW9uKHZlLCBpLCBqLCBhMnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYXAgPSBNYXRoLmZsb29yKE1hdGgubWluKGksIGopICogYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVuID0gMDsgZW4gPCBpOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXAgPSAwOyBlcCA8IGo7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgZ2FwIHx8IGVwIDwgZ2FwIHx8IGVuID49IGkgLSBnYXAgfHwgZXAgPj0gaiAtIGdhcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCID0gNCAqIChlbiArIGVwICogaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDNdID0gMjU1IC0gMjU1ICogKHZlW2FCICsgMV0gLSB2ZVthQl0pIC8gKDI1NSAtIHZlW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEydyA9IGZ1bmN0aW9uKHZlLCBpLCBqLCBhMnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVuID0gaSAtIDE7IGVuID49IDA7IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IGogLSAxOyBlcCA+PSAwOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiA9IDQgKiAoZW4gKyBlcCAqIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQl0gPSBhMnNbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2FCICsgMV0gPSBhMnNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2FCICsgMl0gPSBhMnNbMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMnggPSBmdW5jdGlvbih2ZSwgaSwgaiwgYTJzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2FwID0gTWF0aC5mbG9vcihpICogYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVuID0gMDsgZW4gPCBpOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXAgPSAwOyBlcCA8IGo7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgZ2FwIHx8IGVwIDwgZ2FwIHx8IGVuID49IGkgLSBnYXAgfHwgZXAgPj0gaiAtIGdhcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCID0gNCAqIChlbiArIGVwICogaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQl0gPSB2ZVthQiArIDFdID0gdmVbYUIgKyAyXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyeSA9IGZ1bmN0aW9uKHZlLCBpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwLCBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSBpIC0gMTsgZW4gPj0gMDsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBqIC0gMTsgZXAgPj0gMDsgZXAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQiA9IDQgKiAoZW4gKyBlcCAqIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmVbYUIgKyAxXSA+IDIwMCAmJiB2ZVthQiArIDFdIC0gMjAgPiB2ZVthQl0gJiYgdmVbYUIgKyAxXSAtIDIwID4gdmVbYUIgKyAyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZlW2FCXSArIHZlW2FCICsgMl0gPCA0MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2FCICsgM10gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDNdID0gdmVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2FCXSA9IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDFdID0gMjU1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2FCICsgMl0gPSAyNTU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmVbYUJdIDwgNTAgJiYgdmVbYUIgKyAxXSA8IDUwICYmIHZlW2FCICsgMl0gPCA1MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZlW2FCXSArIHZlW2FCICsgMV0gKyB2ZVthQiArIDJdIDwgNTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDNdID0gMTgwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQiArIDNdID0gMTgwICsgTWF0aC5mbG9vcig3NSAqICh2ZVthQl0gKyB2ZVthQiArIDFdICsgdmVbYUIgKyAyXSAtIDUwKSAvIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyeiA9IGZ1bmN0aW9uKHZlLCBpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwLCBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSBpIC0gMTsgZW4gPj0gMDsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBqIC0gMTsgZXAgPj0gMDsgZXAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQiA9IDQgKiAoZW4gKyBlcCAqIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmVbYUIgKyAxXSA+IHZlW2FCXSArIDIwICYmIHZlW2FCICsgMV0gPiB2ZVthQiArIDJdICsgMjAgJiYgdmVbYUJdICsgdmVbMl0gPCA0MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbYUIgKyAzXSA9IDI1NSAtIHZlW2FCICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVthQl0gPSB2ZVthQiArIDFdID0gdmVbYUIgKyAyXSA9IHZlW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTF2ID0gZnVuY3Rpb24odmUsIGksIGosIGEycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gaSA+PiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZW4gPSAwOyBlbiA8IGk7IGVuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IDA7IGVwIDwgajsgZXArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5zcXJ0KChlbiAtIGUwKSAqIChlbiAtIGUwKSArIChlcCAtIGUwKSAqIChlcCAtIGUwKSkgPiBhMnMgKiBlMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbNCAqIChlbiArIGVwICogaSkgKyAzXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhMUcoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueUogPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBhMzAsIGEzMSwgYTMyLCBhMzM7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjggPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICItIiArIHRoaXMueUooTWF0aC5hYnMoZjgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmOCA8IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjgudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEzMCA9IE1hdGguZmxvb3IoTWF0aC5sb2coZjggKyAwLjUpIC8gTWF0aC5sb2coMTApKSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBhMzEgPSBNYXRoLmZsb29yKChhMzAgLSAxKSAvIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTMyID0gZjgudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzMyA9IGEzMi5zdWJzdHJpbmcoYTMwIC0gMywgYTMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAxOyBhQiA8IGEzMTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEzMyA9IGEzMi5zdWJzdHJpbmcoYTMwIC0gMyAqIChhQiArIDEpLCBhMzAgLSAzICogYUIpICsgIiAiICsgYTMzOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEzMi5zdWJzdHJpbmcoMCwgYTMwIC0gMyAqIChhMzEpKSArICIgIiArIGEzMzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTM0ID0gZnVuY3Rpb24oZ0QsIGEzMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChnRCkudG9GaXhlZChhMzApICsgIiUiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMzUgPSBmdW5jdGlvbihmOCwgYTM2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjgudG9GaXhlZChiSy5wRShNYXRoLmZsb29yKChhMzYgPT09IHVuZGVmaW5lZCA/IDMgOiBhMzYpIC0gTWF0aC5sb2cxMChNYXRoLm1heChmOCwgMSkpKSwgMCwgOCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMzcgPSBmdW5jdGlvbihmOCwgbU8sIGEzMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChmOCAqIG1PKS50b0ZpeGVkKGEzMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnppID0gZnVuY3Rpb24odXNlcm5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlViwgZWs7DQogICAgICAgICAgICAgICAgICAgICAgICBlViA9IHVzZXJuYW1lLmluZGV4T2YoIlsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlViA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVrID0gdXNlcm5hbWUuaW5kZXhPZigiXSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVrIC0gZVYgPiAxICYmIGVrIC0gZVYgPD0gNyArIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlcm5hbWUuc3Vic3RyaW5nKGVWICsgMSwgZWspLnRvVXBwZXJDYXNlKCkudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzOCA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXogPSBNYXRoLmZsb29yKDAuNSAqIHBOLmxlbmd0aCArIDAuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbVUgPSBNYXRoLmZsb29yKDAuNSAqIChleiAtIDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBtVTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gLTE7IGYwIDwgMjsgZjAgKz0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBleiArIGYwICogYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTltmMV0gPT09ICIgIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0aGlzLnplKHBOLnN1YnN0cmluZygwLCBmMSkpLCB0aGlzLmEzOShwTi5zdWJzdHJpbmcoZjEpKV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3BOLnN1YnN0cmluZygwLCBleiksIHBOLnN1YnN0cmluZyhleildOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMzkgPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcE4ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBOW2FCXSAhPT0gIiAiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTi5zdWJzdHJpbmcoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuemUgPSBmdW5jdGlvbihwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcE4ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocE5bYUJdICE9PSAiICIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOLnN1YnN0cmluZygwLCBhQiArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNBID0gZnVuY3Rpb24ocE4sIGEzQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOLnNwbGl0KCIoIilbMF0gKyAiKPCfp4ggIiArIGEzQi50b0ZpeGVkKDIpICsgIikiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydHNXaXRoID0gZnVuY3Rpb24ocE4sIGEzQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOLnN1YnN0cmluZygwLCBhM0MubGVuZ3RoKSA9PT0gYTNDOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMkwgPSBmdW5jdGlvbihwTiwgYTNDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBwTi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE4uc3Vic3RyaW5nKGVnIC0gYTNDLmxlbmd0aCwgZWcpID09PSBhM0M7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzRCA9IGZ1bmN0aW9uKGcsIGEzRSwgYTNGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGcubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzRiA9IGEzRiB8fCAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IGEzRiArIGdbYUJdICsgYTNGICsgIiwiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoYUIgKyAxKSAlIGEzRSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiArPSAiXG4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IGEzRiArIGdbZWddICsgYTNGOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0cgPSBmdW5jdGlvbihwTiwgaGwsIGhtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE4ucmVwbGFjZShuZXcgUmVnRXhwKGhsLCJnIiksIGhtKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEzSCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qMyA9IGZ1bmN0aW9uKHBsYXllciwgZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSS53eihwbGF5ZXIsIGJMLmVvKGVTKSwgYkwuZXEoZVMpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmtFICYmIHRoaXMuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmgxID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYUQuanY7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbYUJdICE9PSAwICYmIGFnLmdUW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSS54NShhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2FELmVRXSAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJjLmxoWzddID0gYWcuZ1RbYUQuZVFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJjLmxoWzhdID0gYWcuZ2hbYUQuZVFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSLmEzSSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXLmEzSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUgubTUoYWcuaVVbYUQuZVFdIC0gNSwgYWcuaVdbYUQuZVFdIC0gNSwgYWcuaVZbYUQuZVFdICsgNSwgYWcuaVhbYUQuZVFdICsgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1LmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYLnNob3coZmFsc2UsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5hM0soMTgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTNMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5sWCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJPLnkuYTNNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQub3kgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmEuYTNOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhLmEzTygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBieSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZCA9IDUxMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMlkgPSAxNTAwMDAwMDAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzUCA9IDEwMDAwMDAwMDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTJpID0gNTAwMDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNRID0gNTEyOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZ6ID0gMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lUSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuanYgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLno0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rRyA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndBID0gNTEyOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndGID0gNTEyOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyWCA9IDE1MDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rRSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3AgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnoxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qZiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubUYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oMSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNSID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oViA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndIID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy53SSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMua0MgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhQID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5veSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuekogPSBuZXcgeEooKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1MgPSAzMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55eSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejYgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpJID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55dCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IG5ldyBhM1QoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1UgPSBuZXcgYTNWKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNXID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1ggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJRLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLno0ID0gdGhpcy5qdiA9IHRoaXMuZGF0YS5odW1hbkNvdW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rRSA9IHRoaXMuejQgPT09IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1GID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdwID0gdGhpcy5kYXRhLmlzUmVwbGF5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rQyA9IHRoaXMuZGF0YS5nYW1lTW9kZSA9PT0gMCA/IFs3LCAxMCwgOF1bdGhpcy5kYXRhLmJhdHRsZVJveWFsZU1vZGVdIDogdGhpcy5kYXRhLmlzWm9tYmllTW9kZSA/IDkgOiAodGhpcy5kYXRhLm51bWJlclRlYW1zIC0gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnhQID0gdGhpcy5kYXRhLmlzQ29udGVzdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaFYgPSB0aGlzLmtDIDwgNyB8fCB0aGlzLmtDID09PSA5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rQyA9ICh0aGlzLmtDID09PSAxMCAmJiB0aGlzLmtFKSA/IDcgOiB0aGlzLmtDOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rQyA9ICh0aGlzLmtDID09PSA4ICYmIHRoaXMuanYgIT09IDIpID8gNyA6IHRoaXMua0M7DQogICAgICAgICAgICAgICAgICAgICAgICBheS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53SCA9IHRoaXMuZGF0YS5udW1iZXJUZWFtczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kYXRhLnRlYW1QbGF5ZXJDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud0kgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhWICYmIHRoaXMua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLnRlYW1QbGF5ZXJDb3VudCA9IG5ldyBVaW50MTZBcnJheSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLnRlYW1QbGF5ZXJDb3VudC5maWxsKDEsIDEsIHRoaXMud0ggKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNVLmEzWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53SSA9ICsodGhpcy5kYXRhLnRlYW1QbGF5ZXJDb3VudFswXSA+IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1MgPSB0aGlzLmp2IDw9IDIgPyAzMCA6IHRoaXMuanYgPD0gNTAgPyA0MCA6IDUwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1IgPSB0aGlzLmgxID0gdGhpcy5kYXRhLnNlbGVjdGFibGVTcGF3bjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3kgPSB0aGlzLmgxID8gbmV3IGEzSCgpIDogbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsLmRrID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53QSA9IHRoaXMuanY7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud0EgPSB0aGlzLmRhdGEucGxheWVyQ291bnQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndGID0gdGhpcy53QTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua0cgPSB0aGlzLndBIC0gdGhpcy5qdjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuejMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lUSA9IHRoaXMuZGF0YS5zZWxlY3RlZFBsYXllcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueXkgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56NiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpJID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueXQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXguYTNaKHRoaXMuZGF0YS5zcGF3bmluZ1NlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWUuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhaS5hM2EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8yLm9rID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBiZi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56MSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTNiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhYy5kWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYW8uYTNjKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWMuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFyLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiTC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk0uZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiVS5hM2QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhaS5hNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUkuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhbC5hM2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI4LmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk8uZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJkLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhM2YucHV0SW1hZ2VEYXRhKGEzZywgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVMuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXYuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFVLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU0uZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVAuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhWC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiMy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjQuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGIwLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpKLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5hM2QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXUuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5ncCAmJiAoIXRoaXMua0UgfHwgIXRoaXMuaDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEzVyA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhM2goKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSC5tNCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2FELmVRXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYLnNob3coZmFsc2UsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWYubFgodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hME4gPSBmdW5jdGlvbihhM2kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3AgJiYgIWI4Lm93LmEzai5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hM2ogPSBiOC5hM2sueVUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYTNsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBicC5jbGVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56MSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5hM20oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwLmExLnNldFN0YXRlKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuc2V0U3RhdGUoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAhYTNpICYmIGJULmU5LnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmEzVyA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hM24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hM1cgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoNSwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzbyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmdwID8gKGFNLmdxIHx8ICFiQi5hM3ApIDogKHRoaXMua0UgJiYgKGFNLmdxIHx8IHRoaXMuaDEpKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuejEgPT09IDEgJiYgIXRoaXMuaDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhM1QoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWFwVHlwZSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWFwUHJvY2VkdXJhbEluZGV4ID0gMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXBSZWFsaXN0aWNJbmRleCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWFwU2VlZCA9IDE0MDcxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcE5hbWUgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBhc3NhYmxlV2F0ZXIgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBhc3NhYmxlTW91bnRhaW5zID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJDb3VudCA9IDUxMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5odW1hbkNvdW50ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBsYXllciA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllck1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJhdHRsZVJveWFsZU1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm51bWJlclRlYW1zID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1pvbWJpZU1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlzQ29udGVzdCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXNSZXBsYXkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsbyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzVHlwZSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzUGVyc29uYWxpemVkID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvcnNEYXRhID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RhYmxlQ29sb3IgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRlYW1QbGF5ZXJDb3VudCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV1dHJhbEJvdHMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJvdERpZmZpY3VsdHlUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3REaWZmaWN1bHR5VmFsdWUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmJvdERpZmZpY3VsdHlUZWFtID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3REaWZmaWN1bHR5RGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bhd25pbmdUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGF3bmluZ1NlZWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNwYXduaW5nRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0YWJsZVNwYXduID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJOYW1lc1R5cGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllck5hbWVzRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0YWJsZU5hbWUgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJbmNvbWVUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSW5jb21lVmFsdWUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJbmNvbWVEYXRhID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50SW5jb21lVHlwZSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEluY29tZVZhbHVlID0gMzI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEluY29tZURhdGEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlJbmNvbWVUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pSW5jb21lVmFsdWUgPSA2NDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pSW5jb21lRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc1Jlc291cmNlc1R5cGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNSZXNvdXJjZXNWYWx1ZSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc1Jlc291cmNlc0RhdGEgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhM1YoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNZID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTNyID0gYUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBwLmExayhhM3IudGVhbVBsYXllckNvdW50LCBhM3IucGxheWVyQ291bnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTNyLm51bWJlclRlYW1zID0gYjkucHAuYTFiKGEzci50ZWFtUGxheWVyQ291bnQsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEzci50ZWFtUGxheWVyQ291bnRbMF0gJiYgYTNyLnRlYW1QbGF5ZXJDb3VudFs3XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEzci50ZWFtUGxheWVyQ291bnRbN10gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzcyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEzciA9IGFELmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTNyLm1hcFR5cGUgPCAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIuYTcoYlIuYTN0KGEzciksIGEzci5tYXBTZWVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIuYTN1KGEzci5jYW52YXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM3YgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhM3IgPSBhRC5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhM3IuY29sb3JzRGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEzci5jb2xvcnNEYXRhID0gbmV3IFVpbnQzMkFycmF5KDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEzci5zZWxlY3RhYmxlQ29sb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhM3IuY29sb3JzRGF0YVswXSA9IGJpLnkudWgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhM3Iuc2VsZWN0YWJsZU5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWEzci5wbGF5ZXJOYW1lc0RhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTNyLnBsYXllck5hbWVzRGF0YSA9IG5ldyBBcnJheSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTNyLnBsYXllck5hbWVzRGF0YVswXSA9IGJpLmVELmRhdGFbMTIyXS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTN3ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhID0gbmV3IGEzVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5hSW5jb21lVHlwZSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmFJbmNvbWVEYXRhID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5hSW5jb21lRGF0YVswXSA9IDY0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZFYoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhM3ggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54VyA9IGZ1bmN0aW9uKHBOLCBvSikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEzeSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRjogYVcuYTN6KCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE46IHBOLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9KOiBvSg0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzeC5wdXNoKGEzeSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gMzApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MCgpLnhXKGEzeSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhM3ggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmE0MSgzMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MSgzMCkuY2xlYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTQyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTN4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZFAoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueTIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdhcCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuclggPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBuID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkyID0gMC4wMDIyICogYjkucGcucGgoMC41KSAqIGgucGk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJYID0gdGhpcy55MiAvIGguazsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FwID0gTWF0aC5tYXgoTWF0aC5mbG9vcigoYTAuYTEucjQoKSA/IDAuMDExNCA6IDAuMDEyOTYpICogaC5waSksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbiA9IHRoaXMuZ2FwIC8gaC5rOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZE8oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTQzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTAuYTEucjQoKSA/IDIgOiAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYzkoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBxRzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVuLCBlcCwgYTQ0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTQ1LCBhNDY7DQogICAgICAgICAgICAgICAgICAgIHZhciBlRjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllcjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE0NzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdhcDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHpvb207DQogICAgICAgICAgICAgICAgICAgIHZhciBvYzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE0ODsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNDkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0QSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNEIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxRzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9jID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBlbiA9IGVwID0gZUYgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTQ1ID0gYTQ2ID0gLTEwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0NCA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjA3NSA6IDAuMDQ2OCkgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHpvb20gPSBhNDQgLyBhYi5nZXQoMykuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZ2FwID0gTWF0aC5mbG9vcihhNDQgLyAzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0QSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSA5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0QyA9IFtiQS5uQywgYkEublEsIGJBLm1rLCBiQS5uaywgYkEubmRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUcgPSBuZXcgQXJyYXkoZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1thQl0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhQiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaE46IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzOiBbXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW46IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwOiAwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmNvbG9ycyA9IFswLCAxLCAyLCAzXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmVuID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzFdLmNvbG9ycyA9IFswLCAxLCA0XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzFdLmVuID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzFdLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzJdLmNvbG9ycyA9IFswLCAyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzJdLmVuID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1syXS5lcCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1szXS5jb2xvcnMgPSBbMF07DQogICAgICAgICAgICAgICAgICAgICAgICBxR1szXS5lbiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1szXS5lcCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s0XS5jb2xvcnMgPSBbMCwgMl07DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s0XS5lbiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s0XS5lcCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s1XS5jb2xvcnMgPSBbM107DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s1XS5lbiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s1XS5lcCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbNl0uaWQgPSAyMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzZdLmNvbG9ycyA9IFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzZdLmVuID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzZdLmVwID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s3XS5pZCA9IDIxOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbN10uY29sb3JzID0gWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbN10uZW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbN10uZXAgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbOF0uaWQgPSAxNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzhdLmNvbG9ycyA9IFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzhdLmVuID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzhdLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IDA7IGYwIDwgcUdbYUJdLmNvbG9ycy5sZW5ndGg7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbYUJdLmNhbnZhcy5wdXNoKHZUKHFHW2FCXS5pZCwgYTRDW3FHW2FCXS5jb2xvcnNbZjBdXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB2VChpZCwgYTFxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPCAyMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOS5jYW52YXMueG8oYWIuZ2V0KDMpLCBpZCwgYTFxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoWCA9IGFiLmdldCgzKS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFyID0gYjkucGcudlQoaFgsIGhYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IGI5LnBnLmdldENvbnRleHQoYTFyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYWIuZ2V0KDE4KSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFqLnZlLnkzKGFqLnF3LnhzICsgYWoucXcueTksIGhkLCAwLCAwLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTFyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBxID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhai52ZS5ndChreSwga3osIHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IGd0KGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjAgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhai52ZS5oTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjAgPiAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMHMgPSBmdW5jdGlvbihreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNDUgPSBreTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0NiA9IGt6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZUYgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGd0KGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTQ1ID0gLTEwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhNDYgPSAtMTAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNEQgPSBhNEUoa3ksIGt6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNEYgPSBhNEcoYTREKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNEYgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocUdbYTRGXS5jb2xvcnNbcUdbYTRGXS5rZl0gPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNEYgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNEgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRJKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9jLnB1c2gocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2MubGVuZ3RoID4gMTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Muc2hpZnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRGID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBvYy5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFtvY1thQl1dID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYy5zcGxpY2UoYUIsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiNC5hNEooMSwgb2MsIHRydWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5nMS5vYihvYywgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNEYgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5vOChhUi5oNygpLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0RiA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oMyhhNDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNEYgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocUdbMF0ua2YgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmEzUiAmJiBhVy5hM3ooKSA8IDM1MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlUuYTRLKDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oRChhUi5oNygpLCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIwLmhGKHBsYXllciwgYVIuaDcoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0RiA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJVLmE0SygxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oQihhUi5oNygpLCBhNDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0RiA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJVLmE0SygwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhai52ZS5zaG93KGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRGID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI0LmE0SigwLCBbcGxheWVyXSwgdHJ1ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuZzEub1kocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRGID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIuaDYoYVIuaDcoKSwgYTQ3LCBwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGljayA9IGZ1bmN0aW9uKGt5LCBreiwgYTB6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3cgPSBiTC5neChreSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3kgPSBiTC5neihreik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVMgPSBiTC5mNChndywgZ3kpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gYkwuZVcoZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTC5oMChndywgZ3kpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0TCA9IChhMC5hMS5yNCgpID8gMC4wMjUgOiAwLjAxNDQpICogaC5waTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IHBlcmZvcm1hbmNlLm5vdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGt5IC0gYTQ1KSA+IGE0TCB8fCBNYXRoLmFicyhreiAtIGE0NikgPiBhNEwgfHwgZGwgPiBlRiArIDUwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVGID0gZGw7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTB6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRNKGt5LCBreiwgZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFNLmdxIHx8IHRoaXMuaE4oKSB8fCAhYjkuZzEuZ3MoYUQuZVEpIHx8IGFELmdwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYTB6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWMuZWIoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTQ3ID0gZVM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzNdLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYTROKGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0uaDkub0QoZVMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhMHopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYk0uYTRPLmE0UCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE0USg1NSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEweikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTS5oOS5hNFIoa3ksIGt6KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYy5nRihlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYTROKGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllciA9IGFjLmVZKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmpKKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5rZiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzddLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYTROKGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVsKGVLKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0NyA9IGFtLmVILmVKKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTQ3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlViA9IGJMLmVXKGE0Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzhdLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyID0gYWMuZVgoZVYpID8gYUQuZWQgOiBhYy5lWShlVik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTQ3ID0gZVM7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0uaDkuaEEoYUQuZVEsIGVTKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5rZiA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMV0uaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzFdLmtmID0gYk4uZkhbMl0gPyAwIDogMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5oOChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hNE4oa3ksIGt6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIgPSBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaEMoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0ua2YgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaEUoYUQuZVEsIHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5rZiA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyID0gYWMuZVkoZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYXllciA9PT0gYUQuZVEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5oTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0ua2YgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzddLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hNE4oa3ksIGt6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmtmID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFHWzVdLmhOID0gYTRTKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBxR1s3XS5oTiA9ICFiOS5nMS5qSihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVaKHBsYXllciwgYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbNF0uaE4gPSAhYjkuZzEuakoocGxheWVyKSAmJiAhYWYuYTRUKHBsYXllcikgJiYgYjQuYTRKKDAsIFtwbGF5ZXJdLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbNl0uaE4gPSBhNFUocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaEcoYUQuZVEsIHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0ua2YgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5oTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoRShhRC5lUSwgcGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxR1swXS5rZiA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFHWzBdLmhOID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uaE4gPSB0aGlzLmE0VigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmE0TihreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbMl0uaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcUdbMF0uaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYTROKGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNE0oa3ksIGt6LCBlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0VzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lYihlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi5hNFgoZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE0VyA9IGJNLmg5LmE0WShreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0VyA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi5hNFgoZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi5hNFooYTRXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNEgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkbCA+IGE0OCArIDQwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTQ4ID0gZGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTRTKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFiOS5nMS5qSihwbGF5ZXIpICYmICFhNEkocGxheWVyKSAmJiBiNC5hNEooMSwgW3BsYXllcl0sIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNFUocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAob2MubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlcmZvcm1hbmNlLm5vdygpID4gYTQ4ICsgNDAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9jID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFhNEkocGxheWVyKSAmJiAhYTRhKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTRJKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IG9jLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2NbYUJdID09PSBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0YShwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gb2MubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZVoocGxheWVyLCBvY1thQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0TiA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSBreSAtIE1hdGguZmxvb3IoYTQ0IC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICBlcCA9IGt6IC0gTWF0aC5mbG9vcihhNDQgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhai52ZS5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhai52ZS55MShreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWoudmUuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTRiKHRoaXMsIGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNGIockksIGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gYTRFKGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRHKGUxKSA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChlMSA9PT0gMSB8fCBlMSA9PT0gNikgJiYgYTRHKDIpID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGUxID09PSA2IHx8IGUxID09PSA5KSAmJiBhNEcoMTApID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBySS5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTRHKGE0RCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNEQgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWcgPSBxRy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxR1thQl0uaE4gJiYgcUdbYUJdLmVuICsgMSA9PT0gYTREICUgNCAmJiBxR1thQl0uZXAgKyAxID09PSAoYTREID4+IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBxRy5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbYUJdLmhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUdbYUJdLmtmID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFqLnZlLmhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhOID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hNFYoKSB8fCBhai52ZS5oTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRWID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBxRy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxR1thQl0uaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTRFKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDLCB3RDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGdhcCAvIDI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3kgPCBlbiAtIGE0NCAtIDMgKiBzSiB8fCBreSA+IGVuICsgMyAqIGE0NCArIDUgKiBzSiB8fCBreiA8IGVwIC0gYTQ0IC0gMyAqIHNKIHx8IGt6ID4gZXAgKyAyICogYTQ0ICsgMyAqIHNKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgd0MgPSBreSA8IGVuIC0gc0ogPyAwIDoga3kgPCBlbiArIGE0NCArIHNKID8gMSA6IGt5IDwgZW4gKyAyICogYTQ0ICsgMyAqIHNKID8gMiA6IDM7DQogICAgICAgICAgICAgICAgICAgICAgICB3RCA9IGt6IDwgZXAgLSBzSiA/IDAgOiBreiA8IGVwICsgYTQ0ICsgc0ogPyAxIDogMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3RCAqIDQgKyB3QzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhai52ZS5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFqLnZlLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTRjKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNGMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSB0bzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IHFHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZjAubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0ZCA9IChhNDQgKyBnYXApIC8gem9vbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oem9vbSwgMCwgMCwgem9vbSwgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYwW2FCXS5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoZjBbYUJdLmNhbnZhc1tmMFthQl0ua2ZdLCBmMFthQl0uZW4gKiBhNGQsIGYwW2FCXS5lcCAqIGE0ZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY0EoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBqOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRmOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRnOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRoID0gLTE7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3EgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTRmID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdxID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBhNGcgPSBhMC5hMS5yNCgpID8gMS4yIDogMC42Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBqID0gYVIuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICBhNGUgPSBiOS5wZy5yVigxLCAoYTAuYTEucjQoKSA/IDAuNSA6IDAuNDUpICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBhNGkoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0aSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNGo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeEQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuY2xlYXJSZWN0KDAsIDAsIGosIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubWk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBqLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNGYgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBqLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCAxLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIGogLSAxLCBqLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGogLSAxLCAwLCAxLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0aiA9IDAuOSAqIGogLyBhYi5nZXQoMCkud2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuc2V0VHJhbnNmb3JtKGE0aiwgMCwgMCwgYTRqLCBNYXRoLmZsb29yKChqIC0gYTRqICogYWIuZ2V0KDApLndpZHRoKSAvIDIpLCBNYXRoLmZsb29yKChqIC0gYTRqICogYWIuZ2V0KDApLmhlaWdodCkgLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5kcmF3SW1hZ2UoYWIuZ2V0KDApLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ncSA9ICF0aGlzLmdxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRmID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRpKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtFICYmIGFELnoxID09PSAxICYmICFhRC5oMSAmJiAhYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQi5hMTYoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmdwICYmIGJCLmEzcCAmJiBiQi5hMTgodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNGsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRrID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGFELmtFIHx8IGFELmdwKSAmJiBhRC56MSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWLmxYKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhLnpDKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5zZXRTdGF0ZSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3QgPSBmdW5jdGlvbihreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0aCA9IGE0bChreSwga3opOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0aCA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE0bSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE0aDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0bSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTS5ncSAmJiAhYUQua0UgJiYgIWFELmdwICYmICFiZC5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2YgPSBhNGwoa3ksIGt6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA9PT0gYTRmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTRmID0ga2Y7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNGkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBYID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2YgPSBhNGwoa3ksIGt6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRoICE9PSBrZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELm1GKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQi5hMTYoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhYUQuZ3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5hME4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZiA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmExNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtmID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtmID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0bChreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYU0uZ3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3kgPD0gaiArIGJiLmdhcCAmJiBreiA+PSBhUi5lcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gOTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGt5IDw9IDQgKiBqICsgYmIuZ2FwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGt6ID49IGFSLmVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3ogPj0gYVIuZXAgLSBqIC0gYTRnICogYmIuZ2FwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa3kgPD0gNyAqIGogKyBiYi5nYXAgJiYga3ogPj0gYVIuZXAgLSBqIC0gYTRnICogYmIuZ2FwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNG4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNG8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShjYW52YXMsIGJiLmdhcCwgYVIuZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wSCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFnLmxsW3BsYXllcl0gIT09IDAgJiYgYUQuejEgIT09IDIgJiYgIWI5LmcxLmpKKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNG4oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IE1hdGguZmxvb3IoNS41ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgYmIuZ2FwLCBhUi5lcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0ZiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIDQgKiBqLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYTRmID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoNCAqIGosIDAsIE1hdGguZmxvb3IoMS41ICogaiksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCBpLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoNCAqIGosIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoMCwgaiAtIDEsIGksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoaSAtIDEsIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoTCg0MiksIDIgKiBqLCAwLjU0ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBlZyA9IDAuNCAqIGo7DQogICAgICAgICAgICAgICAgICAgICAgICBhTS5hNHAoYmIuZ2FwICsgNCAqIGogKyAoMS41ICogaiAtIGVnKSAvIDIsIGFSLmVwICsgMC4zICogaiwgZWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0bygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0cSgxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNHEoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCBiYi5nYXAsIGFSLmVwIC0gYUIgKiBhNGcgKiBiYi5nYXAgLSBhQiAqIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubWk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCA0ICogaiwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRmID09PSBhQiArIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCA0ICogaiwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIDQgKiBqLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoNCAqIGosIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoMCwgaiAtIDEsIDQgKiBqLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGFCID09PSAwID8gTCg0MikgOiBMKDQzKSwgMiAqIGosIDAuNTQgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0cCA9IGZ1bmN0aW9uKGVuLCBlcCwgZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCBlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYmIueTI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5tb3ZlVG8oMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oZWcsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLm1vdmVUbygwLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oZWcsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjQigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE0cjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGo7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTR6ID0gIiI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0eCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHcgPSAhYTAuYTEucjQoKSA/IDEyIDogNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0diA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5cDogWzAsIDAsIDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MDogWzAsIDAsIDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU4OiBbMjIwLCAxODAsIDE4MF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG06IFswLCAwLCAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMTogWzAsIDAsIDBdDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmgxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56RCgwLCAxOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNTEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1Mih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC54UCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygzNDAsIEwoNDQpLCA2LCAwLCBhNTQoMjU1LCAyMDAsIDApLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1MihzZWxmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hNHoubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDIwMCwgc2VsZi5hNHosIDAsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYTR6ID0gIiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNTUsIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgaiA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjAzMSA6IDAuMDI0OSkgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBqIDwgMTAgPyAxMCA6IGo7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvbnRTaXplID0gTWF0aC5mbG9vcigyICogaiAvIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNGUgPSBiOS5wZy5yVigxLCB0aGlzLmZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0cyA9IGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0dCA9IE1hdGguZmxvb3IoaiAvIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0ci5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTU1ID0gYTRyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0ciA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhNTUubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoYTU1W2FCXS5lRiwgYTU1W2FCXS5wTiwgYTU1W2FCXS5pZCwgYTU1W2FCXS5wbGF5ZXIsIGE1NVthQl0uYTU2LCBhNTVbYUJdLmE1NywgYTU1W2FCXS52bSwgYTU1W2FCXS5hNTgsIGE1NVthQl0uYTU5LCBhNTVbYUJdLmE1QSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNUIoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVCID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gTCg0NSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHUgPSBhUS5tZWFzdXJlVGV4dChwTiwgdGhpcy5hNGUpICsgNSAqIGE0dDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0eS5oZWlnaHQgPSBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTR5LndpZHRoID0gYTR1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhEID0gYTR5LmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZvbnQgPSB0aGlzLmE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh4RCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oeEQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuY2xlYXJSZWN0KDAsIDAsIGE0dSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5uOTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIDAsIGE0dSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxUZXh0KHBOLCBNYXRoLmZsb29yKGE0dSAvIDIpLCBNYXRoLmZsb29yKGogLyAyKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1QyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2LmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF2Lmk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhNHIubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVnID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE0clswXS5hNUQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTVFKGE0clswXS5hNUQsIGE0clsxXS5hNUQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNUYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGE0ci5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXYuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE1RShhdi5pLCBhNHJbMF0uYTVEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF2Lmk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWcgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTRyWzBdLmE1RDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWcgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTVFKGE0clswXS5hNUQsIGE0clsxXS5hNUQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE1RShhNUUoYTRyWzBdLmE1RCwgYTRyWzFdLmE1RCksIGE0clsyXS5hNUQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geDkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVIuYTVHKGFOLmE1QygpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdi5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVIuZXAgLSBhUi5qIC0gMiAqIGE0czsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVIuZXAgLSBhNHM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiQi5hNUcoYU4uYTVGKCkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2LmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiQi54OSgpIC0gYVIuaiAtIDIgKiBhNHM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJCLng5KCkgLSBhNHM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhdi5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoLmogLSBhUi5qIC0gKGJqLmE0MygpICsgMSkgKiBhNHM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaC5qIC0gYmouYTQzKCkgKiBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBhNUgsIGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1SSA9IHg5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYTRyLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNUggPSBhNUkgLSAoYUIgKyAxKSAqIGo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwID49IGE1SCAmJiBlcCA8IGE1SCArIGopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0uaWQgPT09IDUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPj0gaC5pIC0gYTR1IC0gYTRzIC0gYTRyW2FCXS5pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuID49IGguaSAtIGE0dSAtIGE0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5nMS5vWShhNHJbYUJdLnBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUgubTYoYTRyW2FCXS5wbGF5ZXIsIDgwMCwgZmFsc2UsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPj0gaC5pIC0gYTRyW2FCXS5pIC0gYTRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCA9PT0gNzM2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1SiA9IGE0clthQl0ucE4uc3BsaXQoIiAiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3BlbihhNUpbYTVKLmxlbmd0aCAtIDFdLCBTWzk2XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGE0clthQl0uYTU4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0uYTVBICYmIGE0clthQl0uYTVBLmV6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlUyA9IGE0clthQl0uYTVBLmVTOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUMgPSBiTC5lbyhlUykgLSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1EID0gYkwuZXEoZVMpIC0gMTA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFILm01KG1DLCBtRCwgbUMgKyAxOSwgbUQgKyAxOSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhNHJbYUJdLmE1QSAmJiBhNHJbYUJdLmE1QS5mMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSC5tNyhhNHJbYUJdLnBsYXllciwgYTRyW2FCXS5hNUEubTgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFILm02KGE0clthQl0ucGxheWVyLCA4MDAsIGZhbHNlLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0udm0gPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGwgPSBhNHJbYUJdLnZtOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS52bSA9IGE0clthQl0ucGxheWVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS5wbGF5ZXIgPSBkbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhXID0gZnVuY3Rpb24oZGwsIHBOLCBpZCwgZ0QsIGE1NiwgYTU3LCB2bSwgYTU4LCBhNTksIGE1QSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTUzKGRsLCBwTiwgaWQsIGdELCBhNTYsIGE1Nywgdm0sIGE1OCwgYTU5LCBhNUEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNUsgPSBmdW5jdGlvbihyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNTMoMzAwLCByLCAyNTIsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1MyhkbCwgcE4sIGlkLCBnRCwgYTU2LCBhNTcsIHZtLCBhNTgsIGE1OSwgYTVBLCBhNUwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgeEQsIGE1RCwgYTFyLCBwWTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNU0gPSBhNTkgIT09IHVuZGVmaW5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihhUS5tZWFzdXJlVGV4dChwTiwgYU4uYTRlKSArIDEuNSAqIGE0dCArIChhNU0gPyBqIDogKDEuNSAqIGE0dCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYTVMKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnAueFcocE4sIGE1OSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSArIDIgKiBhNHMgKyBhUi5qID4gaC5pICYmICFhNU0gJiYgaWQgIT09IDUwICYmIHBOLmxlbmd0aCA+IDIwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBiOS56ZC5hMzgocE4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MyhkbCwgZ1swXSwgaWQsIGdELCBhNTYsIGE1Nywgdm0sIGE1OCwgYTU5LCBhNUEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MyhkbCwgZ1sxXSwgaWQsIGdELCBhNTYsIGE1Nywgdm0sIGE1OCwgYTU5LCBhNUEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE1RCA9IGkgKyAoaWQgPT09IDUwID8gYTR1IDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTFyLndpZHRoID0gaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGExci5oZWlnaHQgPSBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQgPSBhMXIuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZm9udCA9IGFOLmE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh4RCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oeEQsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuY2xlYXJSZWN0KDAsIDAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYTU3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBhNTY7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dChwTiwgTWF0aC5mbG9vcigxLjUgKiBhNHQpLCBNYXRoLmZsb29yKGogLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVNKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhai52ZS55MyhhNTksIHhELCBpIC0gaiwgMCwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwWSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRjogZGwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE46IHBOLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXI6IGdELA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhczogYTFyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1NjogYTU2LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1NzogYTU3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IGksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVEOiBhNUQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdm06IHZtLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1ODogYTU4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1OTogYTU5LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1QTogYTVBDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBZLmVGID09PSAwIHx8IChhNHIubGVuZ3RoID4gMCAmJiBhNHJbMF0uZUYgPiAwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0ci51bnNoaWZ0KHBZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgYTRyLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5lRiA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0ci5zcGxpY2UoYUIsIDAsIHBZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHIucHVzaChwWSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0sgPSBmdW5jdGlvbihpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhNHIubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmlkID09PSBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLmVGID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpEID0gZnVuY3Rpb24ocGxheWVyLCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVEuajMocGxheWVyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNU4oNDIzLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMTYwLCBMKDQ2LCBbYWcueFhbcGxheWVyXV0pLCA0MjMsIHBsYXllciwgU1s3N10sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1Tyg1MCwgYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRLmozKHBsYXllciwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDM2MCwgTCg0NywgW2FnLnhYW3BsYXllcl1dKSwgMCwgcGxheWVyLCBiQS5uUywgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSC5tNihwbGF5ZXIsIDI3MDAsIGZhbHNlLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUS5qMyhwbGF5ZXIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCBMKDQ4KSwgMCwgcGxheWVyLCAicmdiKDEwLDI1NSwyNTUpIiwgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSC5tNihwbGF5ZXIsIDI3MDAsIGZhbHNlLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUS5qMyhwbGF5ZXIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCBMKDQ5LCBbYWcueFhbcGxheWVyXV0pLCAwLCBwbGF5ZXIsIGJBLm1tLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFILm02KHBsYXllciwgMjcwMCwgZmFsc2UsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTVQKDEsIHBsYXllciwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuYTJOW3BsYXllcl0gPT09IDIgfHwgYjkuZzEuakooYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVRKDEsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZi5hNVIocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMTgwLCBMKDUwLCBbYWcueFhbcGxheWVyXV0pLCAxLCBwbGF5ZXIsIGE1NCgyNTUsIDIwMCwgMTgwKSwgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNU4oNTczLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDE4MCwgTCg1MSwgW2FnLnhYW3BsYXllcl1dKSwgNTczLCBwbGF5ZXIsIGJBLm5TLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDE4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDI1NSwgTCg1MiksIDE4LCAwLCBiQS5tbSwgYkEubWosIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygyMjAsIEwoNTMpLCBpZCwgMCwgYkEubW0sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMjIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE1UCgyLCBwbGF5ZXIsIHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA1OSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCBMKDU0KSwgaWQsIDAsIGJBLm5qLCBiQS5taiwgMCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMEggPSBmdW5jdGlvbihyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNTMoMjAwLCBMKDU1LCBbcl0pLCA5NCwgMCwgYkEubW0sIGJBLm5PLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56UCA9IGZ1bmN0aW9uKGE1Uykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZy5nVFthNVNdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVEuajMoYTVTLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5qdiA8IDEwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCBMKDQ5LCBbYWcueFhbYTVTXV0pLCAzLCBhNVMsIGJBLm1tLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMCwgTCg1NiwgW2FnLnhYW2E1U11dKSwgMywgYTVTLCBiQS5tbSwgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRYID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNVQgPSAiKCIgKyBiTC5lbyhlSyA+PiAyKSArICIsICIgKyBiTC5lcShlSyA+PiAyKSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNTggPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmViKGVLKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChlSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVUID0gTCg1NywgW2E1VF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllciA9IGFjLmVZKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBMKDU4LCBbYjkueEQuYTIzKGFnLnpmW3BsYXllcl0sIGI5LnBnLnJWKDAsIDEwKSwgMTUwKV0pICsgU1sxM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IEwoNTksIFtiOS56ZC55SihhZy5naFtwbGF5ZXJdKV0pICsgU1sxM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IEwoNjAsIFtiOS56ZC55SihhZy5nVFtwbGF5ZXJdKV0pICsgU1sxM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1VSA9IGJmLnpNW2JmLmtIW2JmLmVlW3BsYXllcl1dXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IEwoNjEpICsgIjogIiArIGE1VSArIFNbMTNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS5qSihwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiArPSBMKDYyKSArICI6ICIgKyBhRS5rNlthRS5oS1twbGF5ZXJdXSArIFNbMTNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IEwoNjMsIFtwbGF5ZXJdKSArIFNbMTNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiArPSBMKDY0LCBbYTVUXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1VCA9IHBOOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTggPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMuZWwoZUspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVUID0gTCg2NSwgW2E1VF0pICsgIiAgICMiICsgYWMuZU8oZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNVQgPSBMKDY2LCBbYTVUXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhNU4oNTUsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDIyMCwgYTVULCA1NSwgcGxheWVyLCBiQS5tbSwgYkEubWosIC0xLCBhNTgsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRaID0gZnVuY3Rpb24oYTVWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBiTS55Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllciA9IGtkLmE1V1thNVZdID4+IDM7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhNU4oNTUsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gTCg2NywgW2FnLnhYW3BsYXllcl1dKSArIFNbMTNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gTCg1OSwgW2tkLmE1WFthNVZdXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNTMoMjIwLCBwTiwgNTUsIHBsYXllciwgYkEubW0sIGJBLm1qLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9JID0gZnVuY3Rpb24obzUsIGE1WSwgb0opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvNSA9PT0gYUQuZVEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMTc1LCAiICIgKyBMKDY4LCBbYWcueFhbYTVZXV0pICsgIjogIiwgMTAwMSwgYTVZLCBhNTQoMjAwLCAyNTUsIDIxMCksIGJBLm1qLCAtMSwgdHJ1ZSwgb0opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE1WihvNSwgb0opOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNVogPSBmdW5jdGlvbihvNSwgb0opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1TigxMDAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygxNzUsIGFnLnhYW281XSArICI6ICIsIDEwMDAsIG81LCBiQS5tbSwgInJnYmEoNSw2MCwyNSwwLjkpIiwgLTEsIHRydWUsIG9KKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1UShpZCwgbGcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNWEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYTRyLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0uaWQgPT09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1YSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVhID49IGxnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHIuc3BsaWNlKGFCLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpPID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56Nikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBMKDY5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUS56TihMKDcwKSwgMiwgMSwgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCByLCA0MCwgMCwgU1s3N10sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gTCg3MSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVEuek4oTCg3MiksIDIsIDAsIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMCwgciwgNDEsIDAsIGJBLm1tLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueEsgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IGFnLnhYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVqID0gYUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygzMDAsIGc4WzBdICsgIiBbIiArIGFELnpKLnhSKGVqLmVsb1swXSkgKyAiXSB2cyAiICsgZzhbMV0gKyAiIFsiICsgYUQuekoueFIoZWouZWxvWzFdKSArICJdIiwgNjUsIDAsIGJBLm1kLCAicmdiYSgxMDAsMjU1LDI1NSwwLjc1KSIsIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1YiA9IGZ1bmN0aW9uKHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygzNTAsIHIsIDAsIDAsICJyZ2IoNDAsMjU1LDIwMCkiLCAicmdiYSgxMCw2MCw0MCwwLjkpIiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVjID0gZnVuY3Rpb24oYTVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNTMoMCwgYTVkID8gTCg3MykgOiBMKDc0KSwgMjQ3LCAwLCBiQS5uaSwgYkEubWosIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhUID0gZnVuY3Rpb24oeFEsIHhTLCBhNWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGFELmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSBhZy54WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygwLCBnOFswXSArICI6ICIgKyBhRC56Si54Uihlai5lbG9bMF0pICsgU1sxMjNdICsgeFEsIDY2LCAwLCBiQS5tbSwgYTVlWzBdLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDAsIGc4WzFdICsgIjogIiArIGFELnpKLnhSKGVqLmVsb1sxXSkgKyBTWzEyM10gKyB4UywgNjYsIDEsIGJBLm1tLCBhNWVbMV0sIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9aID0gZnVuY3Rpb24ocGxheWVyLCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1Tyg1MCwgcGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMTI4LCBMKDc1LCBbYWcueFhbcGxheWVyXV0pLCA1MiwgcGxheWVyLCBhNTQoMTgwLCAyNTUsIDE4MCksIGJBLm1qLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmLnBGKHBsYXllciwgMiwgMjU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMzg0LCBMKDc2LCBbYWcueFhbcGxheWVyXV0pLCA1MSwgcGxheWVyLCBhNTQoMjEwLCAyMTAsIDI1NSksIGJBLm1qLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVPKDUxLCBwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygxMjgsIEwoNzcsIFthZy54WFtwbGF5ZXJdXSksIDUyLCBwbGF5ZXIsIGJBLm1tLCAicmdiYSg2MCwxMjAsMTAsMC45KSIsIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWYucEYocGxheWVyLCAyLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygzODQsIEwoNzgsIFthZy54WFtwbGF5ZXJdXSksIDUwLCBwbGF5ZXIsIGJBLm1tLCAicmdiYSg5MCw5MCw5MCwwLjkpIiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZi5wRihwbGF5ZXIsIDIsIDk2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9kID0gZnVuY3Rpb24oeXAsIHRhcmdldCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gYTU0KDIxMCwgMjU1LCAyMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHlwLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMjMwLCBMKDc5LCBbeXAubGVuZ3RoLCBhZy54WFt0YXJnZXRdXSksIDY2LCB0YXJnZXQsIGNvbG9yLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMjMwLCBMKDgwLCBbYWcueFhbeXBbMF1dLCBhZy54WFt0YXJnZXRdXSksIDY2LCB5cFswXSwgY29sb3IsIGJBLm1qLCB0YXJnZXQsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTU0KGUwLCBzSiwgZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzddICsgZTAgKyAiLCIgKyBzSiArICIsIiArIGYwICsgIikiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVmID0gZnVuY3Rpb24ocGxheWVyLCB0YXJnZXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygyMzAsIEwoODEsIFthZy54WFtwbGF5ZXJdLCBhZy54WFt0YXJnZXRdXSksIDY2LCBwbGF5ZXIsIGJBLm1tLCAicmdiYSg3NSw2NSw1LDAuOSkiLCB0YXJnZXQsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNFEgPSBmdW5jdGlvbihpZCwgZzgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1TihpZCwgZzgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTVOKGlkLCBnOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYTRyLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0uaWQgPT09IGlkICYmIChnOC0tKSA8PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0ci5zcGxpY2UoYUIsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQi0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZy0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLno4ID0gZnVuY3Rpb24oaWQsIHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTVPKGlkLCBwbGF5ZXIgPT09IHVuZGVmaW5lZCA/IGFELmVkIDogcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1TyhpZCwgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTRyLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCA9PT0gaWQgJiYgKHBsYXllciA9PT0gYUQuZWQgfHwgYTRyW2FCXS5wbGF5ZXIgPT09IHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyLnNwbGljZShhQiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNWcgPSBmdW5jdGlvbihpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhNHIubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmlkID09PSBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTRyW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub1UgPSBmdW5jdGlvbihhNWgsIGE1aSwgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuYTJOW2FELmVRXSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNWo7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVoID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVqID0gTCg4MiwgW2FnLnhYW3BsYXllcl1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVqID0gTCg4MywgW2I5LnpkLnlKKGE1aCksIGFnLnhYW3BsYXllcl1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE1MygyMDAsIGE1aiwgMzAsIHBsYXllciwgInJnYigxOTAsMjU1LDE5MCkiLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1aSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNWkgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVqID0gTCg4NCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVqID0gTCg4NSwgW2I5LnpkLnlKKGE1aSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnAueFcoYTVqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVrID0gZnVuY3Rpb24oYTVoLCBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5hMk5bYUQuZVFdID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTVOKDMxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNWo7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuYTJOW3BsYXllcl0gPT09IDIgfHwgcGxheWVyID49IGFELmp2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNWogPSBMKDg2LCBbYWcueFhbcGxheWVyXV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1aiA9IEwoODcsIFthZy54WFtwbGF5ZXJdLCBiOS56ZC55SihhNWgpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygxNTAsIGE1aiwgMzEsIHBsYXllciwgYkEubWQsICJyZ2JhKDIwNSwyMDUsMjA1LDAuOSkiLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNWggPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVqID0gTCg4OCwgW2FnLnhYW3BsYXllcl1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNWogPSBMKDg5LCBbYWcueFhbcGxheWVyXSwgYjkuemQueUooYTVoKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoMTUwLCBhNWosIDMxLCBwbGF5ZXIsIGJBLm1kLCAicmdiYSgyMDUsMjU1LDIwNSwwLjkpIiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTUxKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJSLnZSLnZTW2JSLmVNXS5uYW1lLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1bChMKDkwLCBbYlIudlIudlNbYlIuZU1dLm5hbWVdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNWwoTCg5MSwgWyhiUi5lciAtIDIpICsgIngiICsgKGJSLmVzIC0gMildKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNWwoTCg5MiwgW2I5LnpkLnlKKGFvLmE1bSldKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW8uYTVtICE9PSBhby5hNW4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNWwoTCg5MywgW2I5LnpkLnlKKGFvLmE1bikgKyAiICgiICsgYjkuemQuYTM0KDEwMCAqIGFvLmE1biAvIGFvLmE1bSwgMSkgKyAiKSJdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW8uYTVvID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1bChMKDY2LCBbYjkuemQueUooYW8uYTVvKSArICIgKCIgKyBiOS56ZC5hMzQoMTAwICogYW8uYTVvIC8gYW8uYTVtLCAxKSArICIpIl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhby5hNXAgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVsKEwoOTQsIFtiOS56ZC55Sihhby5hNXApICsgIiAoIiArIGI5LnpkLmEzNCgxMDAgKiBhby5hNXAgLyBhby5hNW0sIDEpICsgIikiXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1MygxMjAsIEwoOTUpLCA2LCAwLCBhNTQoMjM1LCAyNTUsIDEyMCksIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1bChwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDM0MCwgcE4sIDYsIDAsIGE1NCgyMTUsIDI0NSwgMjU1KSwgYkEubWosIC0xLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy56NyA9IGZ1bmN0aW9uKGJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBiZS5qcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDI7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTR2LnRtW2FCXSA+IDAgJiYgKGJyIHx8IGE0di5mMVthQl0gPCBmMSAtIDIyMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNXEoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVxID0gZnVuY3Rpb24oaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGE0di50bVtpZF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gYTR2LnlwW2lkXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0di50bVtpZF0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gTCg5NiwgW2FnLnhYW3BsYXllcl0sIGFnLnhYW2E0di5hNTBbMF1dXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiA9IEwoOTcsIFthZy54WFtwbGF5ZXJdXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiA9IEwoOTgsIFthZy54WFtwbGF5ZXJdXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiA9IEwoOTksIFthZy54WFtwbGF5ZXJdXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1Tig3LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoYTR2LmU4W2lkXSwgcE4sIDcsIGE0di5hNTBbaWRdLCBiQS5tbSwgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gTCgxMDAsIFtlZ10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBMKDEwMSwgW2VnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBMKDEwMiwgW2VnXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1Tig3LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTMoYTR2LmU4W2lkXSwgcE4sIDcsIHBsYXllciwgYkEubW0sIGJBLm1qLCAtMSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNVAgPSBmdW5jdGlvbihpZCwgaDUsIHZtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBiZS5qcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYTR2LnRtW2lkXSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHYudG1baWRdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHYueXBbaWRdID0gaDU7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHYuYTUwW2lkXSA9IHZtOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTR2LmYxW2lkXSA9IGYxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAxICYmIChhRC56NCA8IDMyIHx8IGFELnoxID09PSAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTVxKGlkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPiAxICYmIChhNHYuZjFbaWRdIDwgZjEgLSAxNDAgfHwgYUQuejEgPT09IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNXEoaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYjEuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBocCA9IGE0ci5sZW5ndGggLSBhNHc7DQogICAgICAgICAgICAgICAgICAgICAgICBocCA9IGhwIDw9IDEgPyAxIDogaHAgKiBocDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTRyLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5lRiA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS5lRiAtPSBocDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0clthQl0uZUYgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyLnNwbGljZShhQiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuejcoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTVyKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc4LCBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHggPT09IDEyOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE0eCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE0eCA8IDEyOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGc4ID0gNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhbC5qdyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuYTJOW2FsLmp4W2FCXV0gPT09IDEgJiYgZzgtLSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTUzKDI0MCwgTCg5OSwgW2FnLnhYW2FsLmp4W2FCXV1dKSwgMSwgYWwuanhbYUJdLCBiQS5tZCwgInJnYmEoMjU1LDI1NSwyNTUsMC43NSkiLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IHg5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0Q7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGE0ci5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0QgPSBlcCAtIChhQiArIDEpICogajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCA9PT0gNTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGE0clthQl0uY2FudmFzLCBoLmkgLSBhNHJbYUJdLmkgLSBhNHUgLSBhNHMsIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGE0eSwgaC5pIC0gYTR1IC0gYTRzLCB3RCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGE0clthQl0uY2FudmFzLCBoLmkgLSBhNHJbYUJdLmkgLSBhNHMsIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjQygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE1cywgYTV0LCBhNXU7DQogICAgICAgICAgICAgICAgICAgIHZhciBpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgajsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBwTjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBMKDEwMyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaSA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjUzIDogMC4zNikgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBNYXRoLmZsb29yKDAuMDY1ICogaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250ID0gYjkucGcuclYoMSwgTWF0aC5mbG9vcigwLjkgKiBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNXUtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0VGltZSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRUaW1lID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgemo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1diA9IGRsLmdldFVUQ01pbnV0ZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNXcgPSBkbC5nZXRVVENTZWNvbmRzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTV4ID0gWzAsIDEwLCAyMCwgMjUsIDMwLCAzNSwgNDAsIDQ1LCA1MF07DQogICAgICAgICAgICAgICAgICAgICAgICBhNXQgPSA2MCAqIDYwIC0gNjAgKiBhNXYgLSBhNXc7DQogICAgICAgICAgICAgICAgICAgICAgICBhNXQgJT0gNjAgKiA1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1eSA9IDYwICogNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBhNXgubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCg2MCAqIGE1diArIGE1dyArIGE1dCkgJSAzNjAwID09PSA2MCAqIGE1eFthQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTV5ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTV0ICs9IGE1eTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1cyA9IHBOICsgYTV6KE1hdGguZmxvb3IoYTV0IC8gNjApKSArICI6IiArIGE1eihhNXQgJSA2MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB6aiA9IGE1dTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE1dSA9IGE1diAqIDYwICsgYTV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpqID09PSBhNXUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gYVEubWVhc3VyZVRleHQoYTVzLCBmb250KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gTWF0aC5mbG9vcigwLjQgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTV6KGE2MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE2MCA8IDEwID8gIjAiICsgYTYwIDogU3RyaW5nKGE2MCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gMSArIE1hdGguZmxvb3IoaiAvIDE1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnRyYW5zbGF0ZShoLmkgLSBqLCBNYXRoLmZsb29yKDAuNSAqIChoLmogKyBpKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ucm90YXRlKC1NYXRoLlBJIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBiQS5tZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZVJlY3QoMCwgMCwgaSwgaiArIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1kOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGZvbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUodG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGE1cywgTWF0aC5mbG9vcihpIC8gMiksIE1hdGguZmxvb3IoMC41OSAqIGopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNEKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRyOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTYxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgaiwgYTYyOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTRlID0gYU4uYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGFOLmZvbnRTaXplICsgNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBNYXRoLmZsb29yKDEuMjUgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5hMS5yNCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IE1hdGguZmxvb3IoMS4yNSAqIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTYyID0gTWF0aC5mbG9vcigwLjE1ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5mb250ID0gYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTYxID0gTWF0aC5mbG9vcihiUi52WC5tZWFzdXJlVGV4dCgiMDIgMDAwIDAwMCAwMDAwIikud2lkdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhNHIubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2MyhhNHJbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNjQoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhNHIubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmE2NSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLmE2NSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNjQoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2NChhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2NiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGwgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmo2ID09PSBhRC5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFN0eWxlID0gYkEubXg7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmE2NyhhNHJbYUJdLmo2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmZpbGxTdHlsZSA9IGI5LmNvbG9yLm1nKGJOLmZGWzBdLCBiTi5mRlsxXSwgYk4uZkZbMl0sIDAuODcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5wcC5hMVYoYk4uZkYsIDAsIDIpID4gNDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2NiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBobCA9IGJBLm1kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYTRyW2FCXS5jYW52YXMud2lkdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmNsZWFyUmVjdCgwLCAwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFJlY3QoMCwgMCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmZpbGxTdHlsZSA9IGhsOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTY4KGE0clthQl0ueEQsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBhNjEgKyAyICogaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFJlY3QoaSAtIGE2MSAtIGosIDAsIDEsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFRleHQoYWcueFhbYTRyW2FCXS5qNl0sIE1hdGguZmxvb3IoKGkgLSBhNjEpIC8gMiksIE1hdGguZmxvb3IoMC41NyAqIGopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzMiA9IGE0clthQl0uaWQgIT09IDAgPyAwIDogajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFRleHQoYjkuemQueUooYTRyW2FCXS5oSyksIE1hdGguZmxvb3IoaSAtIGE2MSAvIDIgLSBzMiksIE1hdGguZmxvb3IoMC41NyAqIGopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2OShhQiwgaSwgczIsIGE2Nik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2QShhQiwgaSwgYTY2LCBobCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZCKGFCLCBpLCBhNjYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNkEoYUIsIDIgKiBqLCBhNjYsIGhsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNjgoeEQsIGksIGopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIDAsIGksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgaiAtIDEsIGksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgMSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChpIC0gMSwgMCwgMSwgaik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTY5KGFCLCBpLCBzMiwgYTY2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmZpbGxTdHlsZSA9IGE2NiA/IGJBLm1vIDogYkEubWs7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTZDID0gTWF0aC5mbG9vcihhNjEgKiBhNHJbYUJdLmhLIC8gYTRyW2FCXS5hNkQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS54RC5maWxsUmVjdChNYXRoLmZsb29yKGkgLSBhNjEgLSBzMiksIGogLSBhNjIsIGE2QywgYTYyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNkEoYUIsIGksIGE2NiwgaGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuc3Ryb2tlU3R5bGUgPSBhNHJbYUJdLmE2RSA/IGJBLm12IDogYTY2ID8gYkEubksgOiBiQS5uTDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFN0eWxlID0gaGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmZpbGxSZWN0KGkgLSBqLCAwLCAxLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQubGluZVdpZHRoID0gTWF0aC5tYXgoTWF0aC5mbG9vcihqIC8gMTIpLCAzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQubGluZUNhcCA9ICJyb3VuZCI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gMC4zNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBqICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELm1vdmVUbyhNYXRoLmZsb29yKGkgLSBtTyAqIGogKyBlaiksIE1hdGguZmxvb3IobU8gKiBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmxpbmVUbyhNYXRoLmZsb29yKGkgLSBqICsgbU8gKiBqKSwgTWF0aC5mbG9vcihqIC0gbU8gKiBqICsgZWopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuc3Ryb2tlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS54RC5tb3ZlVG8oTWF0aC5mbG9vcihpIC0gaiArIG1PICogaiksIE1hdGguZmxvb3IobU8gKiBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmxpbmVUbyhNYXRoLmZsb29yKGkgLSBtTyAqIGogKyBlaiksIE1hdGguZmxvb3IoaiAtIG1PICogaiArIGVqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2QihhQiwgaSwgYTY2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELnN0cm9rZVN0eWxlID0gYTY2ID8gYkEubjQgOiBiQS5uRTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQuZmlsbFJlY3QoaiwgMCwgMSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gMC4zOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdUID0gaSAtIGo7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS54RC5tb3ZlVG8oTWF0aC5mbG9vcihtTyAqIGogKyB3VCksIE1hdGguZmxvb3IoaiAvIDIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQubGluZVRvKE1hdGguZmxvb3IoaiAtIG1PICogaiArIGVqICsgd1QpLCBNYXRoLmZsb29yKGogLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS54RC5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ueEQubW92ZVRvKE1hdGguZmxvb3IoaiAvIDIgKyB3VCksIE1hdGguZmxvb3IobU8gKiBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLnhELmxpbmVUbyhNYXRoLmZsb29yKGogLyAyICsgd1QpLCBNYXRoLmZsb29yKGogLSBtTyAqIGogKyBlaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS54RC5zdHJva2UoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIgfHwgYWcubGxbYUQuZVFdID09PSAwIHx8IGFELmdwIHx8IGI5LmcxLmpKKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNkY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTZHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2SDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNkkgPSBhMC5hMS5yNCgpID8gaiA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTZKID0gYTAuYTEucjQoKSA/IE1hdGguZmxvb3IoMC4xNSAqIGopIDogMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhNHIubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2RiA9IGE2SyhhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZHID0gYTZMKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNkggPSBhNHJbYUJdLmNhbnZhcy53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3ogPj0gYTZHIC0gYTZKICYmIGt6IDw9IGE2RyArIGogKyBhNkopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGt5ID49IGE2RiAtIGE2SSAmJiBreSA8PSBhNkYgKyBqICsgYTZJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWE0clthQl0uYTZFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyW2FCXS5hNjUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0uYTZFID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5vRyhhNHJbYUJdLmo2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge30NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGE0clthQl0uaWQgPT09IDAgJiYga3kgPj0gYTZGICsgYTZIIC0gaiAtIGE2SSAmJiBreSA8PSBhNkYgKyBhNkggKyBhNkkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJVLmE0SygzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3LmgyLmhEKGFSLmg3KCksIGE0clthQl0uajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbYUQuZVFdID09PSAwIHx8IChiOS5nMS5qSihhRC5lUSkgJiYgIWFELmdwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE2TSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZNKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWQuZmwoYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhNk4oZWcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZPKGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNlAoZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZPKGVnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNk4oZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHIubGVuZ3RoICE9PSBlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2FCXS5pZCAhPT0gYWQuZm0oYUQuZVEsIGFCKSB8fCBhNHJbYUJdLmo2ICE9PSBhZC5mcihhRC5lUSwgYUIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNk8oZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgaEs7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBhZC5mcyhhRC5lUSwgYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmhLICE9PSBoSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHJbYUJdLmhLID0gaEs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0uYTZEID0gaEsgPiBhNHJbYUJdLmE2RCA/IGhLIDogYTRyW2FCXS5hNkQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0uYTY1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZQKGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGlkLCBqNiwgZjAsIGhLLCBhM3k7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTU1ID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBsb29wOiBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gYWQuZm0oYUQuZVEsIGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqNiA9IGFkLmZyKGFELmVRLCBhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IDA7IGYwIDwgYTRyLmxlbmd0aDsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyW2YwXS5pZCA9PT0gaWQgJiYgYTRyW2YwXS5qNiA9PT0gajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1NS5wdXNoKGE0ci5zcGxpY2UoZjAsIDEpWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGxvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBhZC5mcyhhRC5lUSwgYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEzeSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgajY6IGo2LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoSzogaEssDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2RDogaEssDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTY1OiB0cnVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNkU6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXM6IG51bGwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhEOiBudWxsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNjMoYTN5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNTUucHVzaChhM3kpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyID0gYTU1Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTZRID0gZnVuY3Rpb24oZ0QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWluKGE0ci5sZW5ndGgsIGFkLmZsKGFELmVRKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNHJbYUJdLmo2ID09PSBnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNHIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2MyhhM3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzeS5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudlguZm9udCA9IGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYTYxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEzeS5qNiA8IGFELmVkICYmIGEzeS5pZCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gTWF0aC5mbG9vcihiUi52WC5tZWFzdXJlVGV4dChhZy54WFthM3kuajZdICsgU1sxMTRdKS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpICs9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTN5LmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSArPSBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTN5LmNhbnZhcy53aWR0aCA9IGk7DQogICAgICAgICAgICAgICAgICAgICAgICBhM3kuY2FudmFzLmhlaWdodCA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICBhM3kueEQgPSBhM3kuY2FudmFzLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzeS54RC5mb250ID0gYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKGEzeS54RCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYTN5LnhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNksoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhVS5hNlIoKSA/IGguaSAtIGE0clthQl0uY2FudmFzLndpZHRoIC0gYmIuZ2FwIDogYVUuZW47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZMKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigyICogYmIuZ2FwICsgKGFVLmE2UigpID8gYVcuaiArIGJiLmdhcCA6IDApICsgYVUuaiArIGFCICogKDEuMyAqIGopKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbYUQuZVFdID09PSAwIHx8IChiOS5nMS5qSihhRC5lUSkgJiYgIWFELmdwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTRyLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYTRyW2FCXS5jYW52YXMsIGE2SyhhQiksIGE2TChhQikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY0UoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNHI7DQogICAgICAgICAgICAgICAgICAgIHZhciBrMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2UzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2VDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGo7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNGU7DQogICAgICAgICAgICAgICAgICAgIHZhciBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2VTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2VjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2VzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2WDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcywgeEQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBseTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2WTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgazAgPSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTZTID0gYTZUID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0ciA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRlID0gbmV3IEFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemUgPSBuZXcgQXJyYXkoMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhNlUgPSBuZXcgQXJyYXkoMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhNlVbMF0gPSAwLjM7DQogICAgICAgICAgICAgICAgICAgICAgICBhNlVbMV0gPSAwLjc7DQogICAgICAgICAgICAgICAgICAgICAgICBhNlYgPSBuZXcgQXJyYXkoNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZZID0gYmUuZUYgKyAyMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHU1KGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGFCID09PSAwID8gTCgxMDQpIDogYUIgPT09IDEgPyBMKDEwNSkgOiBhQiA9PT0gMiA/IEwoMTA2KSA6IEwoMTA3KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBNYXRoLmZsb29yKChhMC5hMS5yNCgpID8gMC4wNzI1IDogMC4wNTgpICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZVswXSA9IE1hdGguZmxvb3IoYTZVWzBdICogMC44NSAqIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemVbMV0gPSBNYXRoLmZsb29yKGE2VVsxXSAqIDAuODUgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0ZVswXSA9IGI5LnBnLnJWKDEsIGZvbnRTaXplWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0ZVsxXSA9IGI5LnBnLnJWKDEsIGZvbnRTaXplWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhNlYubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2VlthQl0gPSB0aGlzLm1lYXN1cmVUZXh0KHU1KGFCKSArIFNbMTE0XSwgYTRlWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE2VyA9IE1hdGguZmxvb3IoMSArIDAuMDUgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2WCA9IE1hdGguZmxvb3IoMC4yICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTRyLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYTRyLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHRoaXMubWVhc3VyZVRleHQoYTRyW2FCXS5wTiArICIwMCIsIGE0ZVsxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE0clthQl0ud2lkdGggPSBpIDwgYTZWW2FCXSA/IGE2VlthQl0gOiBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNlooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrMCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE2YSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZhKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGswID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGID4gYTZZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGswID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUS56TihiUi52Ui52U1tiUi5lTV0ubmFtZSwgMywgMSwgOSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2YigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWVhc3VyZVRleHQgPSBmdW5jdGlvbihwTiwgYTRlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5mb250ID0gYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQocE4pLndpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuajMgPSBmdW5jdGlvbihhNmMsIGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpOKGFnLnhYW2E2Y10sIGFCLCAxLCBhQiA9PT0gMCA/IDMgOiA3KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuek4gPSBmdW5jdGlvbihwTiwgYTZkLCBhNmUsIGU4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBOLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gdGhpcy5tZWFzdXJlVGV4dChwTiArICIwMCIsIGE0ZVsxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gaSA8IGE2VlthNmRdID8gYTZWW2E2ZF0gOiBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRyLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOOiBwTiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogaSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmQ6IGE2ZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmU6IGE2ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlODogZTgNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGswID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZTID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2YigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrMCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNlMgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZaKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2UyA9IDAuMDAwMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZTICs9IChiZS5lRiAtIGx5KSAqIDAuMDAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNlMgPj0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNlQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMCA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2UyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoazAgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNlQgKz0gKGJlLmVGIC0gbHkpIC8gMTAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZUID4gYTRyWzBdLmU4IHx8IChhNlQgPiAxICYmIGE0ci5sZW5ndGggPiAxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrMCA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrMCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2UyAtPSAoYmUuZUYgLSBseSkgKiAwLjAwMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZTIDw9IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZTID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRyLnNoaWZ0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGswID0gYTRyLmxlbmd0aCA+IDAgPyAxIDogMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoazAgPT09IDAgfHwgYTZTID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2UyA8IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5nbG9iYWxBbHBoYSA9IGE2UzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5nbG9iYWxBbHBoYSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTZmKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNmYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoY2FudmFzLCBiYi5nYXAgKyAoYUQuaFYgPyBiYi5nYXAgKyBiZy5hNmcoKSA6IDApLCBhNmggKyAyICogYmIuZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNlooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBhNHJbMF0ud2lkdGggKyBhNlc7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaiArIGE2VzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhEID0gY2FudmFzLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmNsZWFyUmVjdCgwLCAwLCBhNHJbMF0ud2lkdGggKyBhNlcsIGogKyBhNlcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQudHJhbnNsYXRlKE1hdGguZmxvb3IoYTZXIC8gMiksIE1hdGguZmxvb3IoYTZXIC8gMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubGluZVdpZHRoID0gYTZXOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYTRyWzBdLmE2ZSA9PT0gMSA/IGJBLm1yIDogYkEubWo7DQogICAgICAgICAgICAgICAgICAgICAgICBhNmkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZVN0eWxlID0gYTRyWzBdLmE2ZSA9PT0gMSA/IGJBLm1kIDogYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBhNmkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh4RCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBhNHJbMF0uYTZlID09PSAxID8gYkEubWQgOiBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZvbnQgPSBhNGVbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dCh1NShhNHJbMF0uYTZkKSwgTWF0aC5mbG9vcihhNHJbMF0ud2lkdGggLyAyKSwgTWF0aC5mbG9vcigwLjcyICogYTZVWzBdICogaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZm9udCA9IGE0ZVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxUZXh0KGE0clswXS5wTiwgTWF0aC5mbG9vcihhNHJbMF0ud2lkdGggLyAyKSwgTWF0aC5mbG9vcigoYTZVWzBdICsgMC40OCAqIGE2VVsxXSkgKiBqKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZpKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5tb3ZlVG8oYTZYLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVUbyhhNHJbMF0ud2lkdGggLSBhNlgsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubGluZVRvKGE0clswXS53aWR0aCwgYTZYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVUbyhhNHJbMF0ud2lkdGgsIGogLSBhNlgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubGluZVRvKGE0clswXS53aWR0aCAtIGE2WCwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5saW5lVG8oYTZYLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVUbygwLCBqIC0gYTZYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVUbygwLCBhNlgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuY2xvc2VQYXRoKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY20oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBqOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeEQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNmo7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNms7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNmw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNm07DQogICAgICAgICAgICAgICAgICAgIHZhciBhNjU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNm47DQogICAgICAgICAgICAgICAgICAgIHZhciBhNm87DQogICAgICAgICAgICAgICAgICAgIHZhciBhNnA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oTiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTZxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTFyID0gbmV3IEFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTZyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDI7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMXJbYUJdID0gYjkuY2FudmFzLnhvKGFiLmdldCgzKSwgOCAtIGFCLCBiQS5udik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFyW2FCXSA9IGI5LmNhbnZhcy5hMXQoYTFyW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNnAgPSAtMTAwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhNnIgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZvID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2cSA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oTiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2biA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhNmogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZrID0gWzAsIDBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZsID0gWzEsIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZtID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBhUi5qOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gNCAqIGo7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gdGhpcy5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICB4RCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBsWSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhNjUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsWSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbFkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGF2Lmk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhDKHhELCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IE1hdGguZmxvb3IoaSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2aiA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm42Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGtkLCAwLCBrZCwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGE2aiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5uTTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBrZCwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB4RSh4RCwgaSwgaiwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgczIgPSBNYXRoLmZsb29yKDAuMjUgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHMyID0gczIgPCAyID8gMiA6IHMyOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubXM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTVtID0gTWF0aC5mbG9vcigoaiAtIDQpICogYTZrWzFdIC8gYTZsWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNW0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMiwgaiAtIDIgLSBhNW0sIHMyLCBhNW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTVtID0gTWF0aC5mbG9vcigoaiAtIDQpICogYTZrWzBdIC8gYTZsWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNW0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoaSAtIDIgLSBzMiwgaiAtIDIgLSBhNW0sIHMyLCBhNW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhGID0gTWF0aC5mbG9vcihqIC8gOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RiA9IHhGIDwgMiA/IDIgOiB4RjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhHKHhELCBNYXRoLmZsb29yKDAuNCAqIGopLCAwLCBqLCB4RiwgMC41LCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4Ryh4RCwgTWF0aC5mbG9vcihpIC0gMS40ICogaiksIDAsIGosIHhGLCAwLjUsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gKDEuMSAqIGopIC8gYTFyWzBdLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnNldFRyYW5zZm9ybShlSywgMCwgMCwgZUssIChpIC0gZUsgKiBhMXJbMF0ud2lkdGgpIC8gMiwgLTAuMDUgKiBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmRyYXdJbWFnZShhMXJbK2E1ZF0sIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3QgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA8IGguaSAtIHRoaXMuaSAtIGJiLmdhcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtRCA9IHg5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXAgPCBtRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhPKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU0uZ3EgJiYgYU0uYTE3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oUCgoZW4gPiAoaC5pIC0gYmIuZ2FwIC0gdGhpcy5pIC8gMikpID8gMSA6IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZvID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2by0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNm8gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZ0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNnUoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNnEgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNnYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZ3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZ3KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTZxID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBhNWQgPSBhaC5hNngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLmEzSygyNTcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uYTVjKGE1ZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdi5oTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZuID0gMzYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZ5KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZ1KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2eiA9IGJlLmpzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZ6ICUgNDAgIT09IDE0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2eiA8IGE2cikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2eiA8IGE2cCArIDUzNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZyID0gYTZ6ICsgMTA3MTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmEyUSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNncoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbC5qdyA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2ciA9IGE2eiArIDUzNTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMm47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMm4gPSBiZy5hMm8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJuID0gYWcuZ1RbbEFbMF1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEybiA+PSBiSy5kbSg5NiAqIGFELmpmLCAxMDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZyID0gYTZ6ICsgNTM1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTZ2KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoMjUwLCBMKDEwOCwgW2FnLnhYW2E2cV1dKSwgNjczLCBhNnEsIGJBLm1tLCBiQS5taiwgLTEsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2eSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuakooYWwuanhbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbCArPSBhZy5nVFthbC5qeFthQl1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmxbMF0gPSBNYXRoLm1heChiSy5kbSgzICogZGwsIDQpLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyA9PT0gOSAmJiBiZi5rSFtiZy5sNygpXSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZsWzBdID0gTWF0aC5tYXgoZGwsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYksuZG0oMTAwICogYmcuYTJvKCksIGFELmpmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYksucEUoMjAwIC0gMiAqIGY4LCA0MCwgMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYksuZG0oZjggKiBkbCwgMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2bFswXSA9IE1hdGgubWF4KGY4LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2bFswXSA9IE1hdGgubWF4KGJLLmRtKDMgKiBkbCwgNSksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE2bFsxXSA9IE1hdGgubWF4KGRsIC0gYTZsWzBdLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNnQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNm4tLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNm4gPT09IDE4MCAmJiAzICogYTZrWzBdIDwgYTZsWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2a1swXSA+PSBhNmxbMF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJRLnllLnl3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlEueWUuejAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2a1sxXSA+PSBhNmxbMV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNm8gPSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNm4gPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE2cygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2cCA9IGJlLmpzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZqID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2biA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhNm0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF2LmhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi56OCgyNDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZrWzBdID0gYTZrWzFdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLmEzSyg2NzMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhOICYmIGE2a1swXSA8IGE2bFswXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wRyA9IGZ1bmN0aW9uKHBsYXllciwgYTcwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTcxOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3MSA9IEwoMTA5LCBbYWcueFhbcGxheWVyXV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNzEgPSBMKDExMCwgW2FnLnhYW3BsYXllcl1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDQ1MCwgYTcxLCAyNTcsIHBsYXllciwgYTcwID8gYkEubjQgOiBiQS5uSiwgYkEubWosIC0xLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2bS5wdXNoKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gYUQua0UgPyBNYXRoLm1heChhNmxbMF0sIGE2bFsxXSkgOiBhZy5nVFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGwgPSBNYXRoLm1heChkbCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTcwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZrWzBdICs9IGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmtbMV0gKz0gZGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2aiA9IGE3MCA/IDEgOiAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHg5KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSLmE1RyhhTi5hNUMoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVIuZXAgLSBqIC0gYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJCLmE1RyhhTi5hNUYoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYkIueDkoKSAtIGogLSBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaC5qIC0gaiAtIGJqLmE0MygpICogYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IHg5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoY2FudmFzLCBoLmkgLSB0aGlzLmkgLSBiYi5nYXAsIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaFEgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuanMoKSA8IGE2cCArIDE0MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE2biAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3IoMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoamdbcGxheWVyXSA+PSAxMCAmJiAhYjkuZzEuYTJqKHBsYXllciwgOSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE8gPSBmdW5jdGlvbihnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncigxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuZ3MoZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhNm0ubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNm1bYUJdID09PSBnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhNID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhNnEgPSBwbGF5ZXI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjRigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGksIGVuOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTcyOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeEQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBoTjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGlGOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTNCOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTRlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTY1Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTczID0gMTEgLyAxMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3UgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaE4gPSAhYUQuaDEgJiYgIWFELmdwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTY1ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpRiA9IDAuNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEzQiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmd1ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5hMS5yNCgpICYmIGguaSA8IDAuOCAqIGguaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaiA9IE1hdGguZmxvb3IoMC4wNjYgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gaC5pIC0gNCAqIGJiLmdhcCAtIHRoaXMuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjY1IDogMC4zODkpICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAoMTIgLSBpICUgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaiA9IE1hdGguZmxvb3IoaSAvIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE3MiA9IE1hdGguZmxvb3IoMyAqIHRoaXMuaiAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRlID0gYjkucGcuclYoMSwgTWF0aC5mbG9vcigwLjUgKiB0aGlzLmopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHRoaXMuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhEID0gY2FudmFzLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZvbnQgPSBhNGU7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUoeEQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTc0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNzUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTc0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuYTEucjQoKSAmJiBoLmkgPCAwLjggKiBoLmopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbiA9IHRoaXMuaiArIDMgKiBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuID0gTWF0aC5mbG9vcigoaC5pIC0gaSkgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXAgPSBoLmogLSB0aGlzLmogLSBiai5hNDMoKSAqIGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNjUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNjUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNzUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3NigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNzcgPSAxMzA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaUYgPCAxIC8gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gTWF0aC5mbG9vcigzICogaUYgKiBhNzcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzhdICsgZjggKyAiLCIgKyBhNzcgKyBTWzExOV07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlGIDwgMiAvIDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCA9IE1hdGguZmxvb3IoMyAqIChpRiAtIDEgLyAzKSAqIGE3Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNbOF0gKyBhNzcgKyAiLCIgKyAoYTc3IC0gZjgpICsgU1sxMTldOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCA9IE1hdGguZmxvb3IoMyAqIChpRiAtIDIgLyAzKSAqIGE3Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNbOF0gKyBhNzcgKyAiLDAsIiArIGY4ICsgIiwwLjg1KSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTc1KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2QyA9IE1hdGguZmxvb3IoaUYgKiAoaSAtIDIgKiBhNzIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNzggPSAxICsgTWF0aC5mbG9vcigwLjA2MjUgKiBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNzkgPSAxICsgTWF0aC5mbG9vcigwLjMgKiBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN0EgPSBNYXRoLmZsb29yKDAuNTUgKiBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmNsZWFyUmVjdCgwLCAwLCBpLCBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgYTcyLCBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGE3MiArIGE2QywgMCwgaSAtIGE3MiAtIGE2QywgYVIuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBhNzYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGE3MiwgMCwgYTZDLCBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBhUi5qIC0gMSwgaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCAxLCBhUi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGE3MiwgMCwgMSwgYVIuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChhNzIgKyBhNkMsIDAsIDEsIGFSLmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoaSAtIGE3MiwgMCwgMSwgYVIuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChpIC0gMSwgMCwgMSwgYVIuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChNYXRoLmZsb29yKDAuMjUgKiBhUi5qKSArIGE3OSwgTWF0aC5mbG9vcigoYVIuaiAtIGE3OCkgLyAyKSwgYVIuaiAtIDIgKiBhNzksIGE3OCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChNYXRoLmZsb29yKGkgLSAxLjI1ICogYVIuaikgKyBhNzksIE1hdGguZmxvb3IoKGFSLmogLSBhNzgpIC8gMiksIGFSLmogLSAyICogYTc5IC0gYTc5ICUgMiwgYTc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KE1hdGguZmxvb3IoaSAtIDEuMjUgKiBhUi5qKSArIE1hdGguZmxvb3IoKGFSLmogLSBhNzgpIC8gMiksIGE3OSwgYTc4LCBhUi5qIC0gMiAqIGE3OSAtIGE3OSAlIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTNCID0gYjkuZzEuaUUoYUQuZVEsIGFSLmg3KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFRleHQoYjkuemQueUooYTNCKSArICIgKCIgKyBiOS56ZC5hMzQoMTAwICogaUYsICsoaUYgPCAwLjEpKSArICIpIiwgTWF0aC5mbG9vcigwLjUgKiBpKSwgYTdBKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhOID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISghaE4gfHwgYU0uZ3EgJiYgZW4gPCBNYXRoLmZsb29yKGJiLmdhcCArIDUuNSAqIHRoaXMuaikpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNUcgPSBmdW5jdGlvbihhN0IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW4gKyBpID4gaC5pIC0gYTdCIC0gYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0kgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhOID0gIWFELmdwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNnMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmg3ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksucEUoTWF0aC5mbG9vcihpRiAqIDEwMjQgKyAwLjUpIC0gMSwgMCwgMTAyMyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExMCA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaE4oKSAmJiBreSA+IGVuICYmIGt5IDwgZW4gKyBpICYmIGt6ID4gdGhpcy5lcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3QyhreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBreSA+IGVuICYmIGt5IDwgZW4gKyBhNzIgJiYga3ogPiBhUi5lcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN0Qoa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ga3kgPiBlbiArIGkgLSBhNzIgJiYga3kgPCBlbiArIGkgJiYga3ogPiBhUi5lcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVIuYTEwKGt5LCBreikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhUy5tSCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3RSh0aGlzLCBreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN0UockksIGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3QyhreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE3RihhNzMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3RChreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE3RigxIC8gYTczKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJJLmd1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhN0coa3kpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTEzID0gZnVuY3Rpb24obU8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCB8fCAhdGhpcy5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3RihtTykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN0YoYTFRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTFRID4gMSAmJiBpRiA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMVEgPiAxICYmIGExUSAqIGlGIC0gaUYgPCAxIC8gMTAyNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExUSA9IChpRiArIDEgLyAxMDI0KSAvIGlGOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhMVEgPCAxICYmIGlGIC0gYTFRICogaUYgPCAxIC8gMTAyNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExUSA9IChpRiAtIDEgLyAxMDI0KSAvIGlGOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaUYgPSBiSy5wRShpRiAqIGExUSwgMSAvIDEwMjQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTc1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN0coa3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGlGOw0KICAgICAgICAgICAgICAgICAgICAgICAgaUYgPSBiSy5wRSgoa3kgLSBlbiAtIGE3MikgLyAoaSAtIDIgKiBhNzIpLCAxIC8gMTAyNCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwgIT09IGlGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTc1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFogPSBmdW5jdGlvbihkZWx0YVkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtTzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YVkgPT09IDAgfHwgIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YVkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbU8gPSA0MDAgLyAoNDAwICsgZGVsdGFZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtTyA9IG1PIDwgYTczID8gYTczIDogbU87DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1PID0gKDQwMCAtIGRlbHRhWSkgLyA0MDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbU8gPSBtTyA+IDEgLyBhNzMgPyAxIC8gYTczIDogbU87DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTdGKG1PKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oa3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmd1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE3RyhreSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ndSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTNCICE9PSBiOS5nMS5pRShhRC5lUSwgdGhpcy5oNygpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2NSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShjYW52YXMsIGVuLCB0aGlzLmVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGN3KCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeEQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhN0g7DQogICAgICAgICAgICAgICAgICAgIHZhciBmb250Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTdJID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3SiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTdLID0gWzEwLCA1LCAzLCAyLCAxLjUsIDEsIDAuNzUsIDAuNSwgMC4yNV07DQogICAgICAgICAgICAgICAgICAgIHZhciBhN0wgPSA1Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzcCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmdwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTdMID0gNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNwID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBhN0ogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3SCA9IG5ldyBxSShbMC4zLCAwLjMgLyA2XSxbMC41LCAxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hN00gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhN0tbYTdMXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhN0guZXA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1RyA9IGZ1bmN0aW9uKGE3Qikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmdwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE3SC5lbiArIGE3SC5pID4gaC5pIC0gYTdCIC0gYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhN0gucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhN0guZXAgLT0gKGJqLmE0MygpIC0gMSkgKiBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250ID0gYjkucGcuclYoMCwgMC4zICogYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IE1hdGguZmxvb3IoYTdILmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IE1hdGguZmxvb3IoYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZm9udCA9IGZvbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oeEQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxZKHRoaXMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTYgPSBmdW5jdGlvbihhN04pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCB8fCB0LmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTdOID09PSBhRC5tRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELm1GID0gYTdOOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmcucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN0kgPSBiZS5lRiArIDIwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbFkodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmdwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgYTdILmVuIHx8IGVwIDwgYTdILmVwIHx8IGVuID4gYTdILmVuICsgYTdILmkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTdKICYmIGE3Tyh0aGlzLCBlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZW4gLT0gYTdILmVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgMC4zICogYTdILmkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN0ogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmExNighYUQubUYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbiA8IDAuNyAqIGE3SC5pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdKID0gIWE3SjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmExOChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE4ID0gZnVuY3Rpb24oYTdQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmExNihmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE3SiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM3AgPSAhdGhpcy5hM3A7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hM3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU0uZ3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU0uYTE3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLmExLnNldFN0YXRlKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhYTdQICYmIGFNLmE0aygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbFkodGhpcyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExOSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM3AgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNLmE0aygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbFkodGhpcyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwcCA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5tRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTS5ndChlbiwgZXApID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5ndChlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGID4gYTdJIHx8ICF0aGlzLmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5ndChlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdJID0gYmUuZUYgKyAyMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZ3AgJiYgYUQubUYgJiYgYmUuZUYgPiBhN0kgLSAxMDAwICYmIGJlLmVGIDwgYTdJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56OSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNwID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBsWSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQubUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPiBhN0kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPiBhN0kgLSAxMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmdsb2JhbEFscGhhID0gYTdRKDAsICgxMDAwIC0gKGJlLmVGIC0gKGE3SSAtIDEwMDApKSkgLyAxMDAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdSKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE3UigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTdSKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3Sikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3UygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGNhbnZhcywgTWF0aC5mbG9vcihhN0guZW4pLCBNYXRoLmZsb29yKGE3SC5lcCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxZKHJJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhN1QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3VSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAhckkuYTNwID8gYTdXKCkgOiBhN1goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3WSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3VCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmNsZWFyUmVjdCgwLCAwLCBNYXRoLmZsb29yKGE3SC5pKSwgTWF0aC5mbG9vcihhN0guaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubWk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBNYXRoLmZsb29yKGE3SC5pKSwgTWF0aC5mbG9vcihhN0guaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELm1GKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubkI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgTWF0aC5mbG9vcigwLjMgKiBhN0guaSksIE1hdGguZmxvb3IoYTdILmopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN1UoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxUZXh0KCJIaWRlIFVJIiwgMC4xNSAqIGE3SC5pLCAwLjUgKiBhN0guaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChNYXRoLmZsb29yKDAuMyAqIGE3SC5pIC0gMC41KSwgMCwgMiwgTWF0aC5mbG9vcihhN0guaikpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3VigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IDAuNSAqIGE3SC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFRleHQoIlJlcGxheSBTcGVlZCIsIGVuLCAwLjMxICogYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFRleHQoYTdaKGE3TCksIGVuLCAwLjY5ICogYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoTWF0aC5mbG9vcigwLjcgKiBhN0guaSAtIDAuNSksIDAsIDIsIE1hdGguZmxvb3IoYTdILmopKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN1coKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IE1hdGguZmxvb3IoMC40NiAqIGE3SC5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gTWF0aC5mbG9vcigwLjIzICogYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gTWF0aC5mbG9vcigwLjg1ICogYTdILmkgLSAwLjUgKiBpICsgaSAvIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IE1hdGguZmxvb3IoMC41ICogYTdILmogLSBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubW92ZVRvKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5saW5lVG8oZW4gKyBpLCBlcCArIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubGluZVRvKGVuLCBlcCArIChqIDw8IDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN1goKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgczIgPSBNYXRoLmZsb29yKDAuMDIgKiBhN0guaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgczMgPSBNYXRoLmZsb29yKDAuMDI1ICogYTdILmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1DID0gTWF0aC5mbG9vcigwLjg1ICogYTdILmkgLSBzMiAtIDAuNSAqIHMzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtRCA9IE1hdGguZmxvb3IoMC4yNSAqIGE3SC5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN0EgPSBNYXRoLmZsb29yKGE3SC5qKSAtIDIgKiBtRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KG1DLCBtRCwgczIsIGE3QSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChtQyArIHMyICsgczMsIG1ELCBzMiwgYTdBKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN1koKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBNYXRoLmZsb29yKGE3SC5pKSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCAyLCBNYXRoLmZsb29yKGE3SC5qKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBNYXRoLmZsb29yKGE3SC5qKSAtIDIsIE1hdGguZmxvb3IoYTdILmkpLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KE1hdGguZmxvb3IoYTdILmkgLSAyKSwgMCwgMiwgTWF0aC5mbG9vcihhN0guaikpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3UygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGE3Sy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTdBID0gTWF0aC5mbG9vcigwLjUgKiBhN0guaik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IGVnICogYTdBOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gTWF0aC5mbG9vcihNYXRoLmZsb29yKGE3SC5lbikgKyAwLjMgKiBhN0guaSAtIDAuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBNYXRoLmZsb29yKE1hdGguZmxvb3IoYTdILmVwKSAtIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKDAuNCAqIGE3SC5pICsgMi41KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm5COw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwICsgYTdMICogYTdBLCBpLCBhN0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChlbiwgZXAsIDIsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwLCBpLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KGVuICsgaSAtIDIsIGVwLCAyLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAxOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwICsgYUIgKiBhN0EsIGksIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCAwLjYgKiBhN0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSBlbiArIDAuNSAqIGk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGE3WihhQiksIGVuLCBlcCArIChhQiArIDAuNikgKiBhN0EpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3TyhySSwgZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhN0subGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE3QSA9IE1hdGguZmxvb3IoMC41ICogYTdILmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBlZyAqIGE3QTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQyA9IE1hdGguZmxvb3IoTWF0aC5mbG9vcihhN0guZW4pICsgMC4zICogYTdILmkgLSAwLjUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1EID0gTWF0aC5mbG9vcihNYXRoLmZsb29yKGE3SC5lcCkgLSBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcigwLjQgKiBhN0guaSArIDIuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhN0ogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA8IG1DIHx8IGVuID4gbUMgKyBpIHx8IGVwIDwgbUQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE3TCA9IGE3USgwLCBNYXRoLmZsb29yKChlcCAtIG1EKSAvIGE3QSksIGVnIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBsWShySSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN1ooYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQiA9PT0gNSA/ICJOb3JtYWwiIDogKCIiICsgYTdLW2FCXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIGlIOw0KICAgICAgICAgICAgICAgIHZhciBpRzsNCiAgICAgICAgICAgICAgICB2YXIgaUk7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY0coKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhN2E7DQogICAgICAgICAgICAgICAgICAgIHZhciBhN2I7DQogICAgICAgICAgICAgICAgICAgIHZhciBpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTdjOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTdkOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhN2EgPSBuZXcgQXJyYXkoMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhN2IgPSBuZXcgQXJyYXkoMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1IID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpRyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpSSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhN2MgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlIID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaSA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjA3MiA6IDAuMDUwMikgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBpIDwgOCA/IDggOiBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdhW2FCXSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdhW2FCXS53aWR0aCA9IGk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdhW2FCXS5oZWlnaHQgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3YlthQl0gPSBhN2FbYUJdLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTdmKGE3ZywgYTVIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKE1hdGgucG93KChhN2cgLSAoZW4gKyBpIC8gMikpLCAyKSArIE1hdGgucG93KChhNUggLSAoZXAgKyBpIC8gMikpLCAyKSA8IGkgKiBpIC8gNCB8fCBNYXRoLnBvdygoYTdnIC0gKGVuICsgaSAvIDIpKSwgMikgKyBNYXRoLnBvdygoYTVIIC0gKGVwICsgMiAqIGkpKSwgMikgPCBpICogaSAvIDQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtaUcgLyBpSDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtaUkgLyBpSDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubVIgPSBmdW5jdGlvbihhN2gsIGh5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpRyA9IGlIICogYTdoIC0gaHk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1TID0gZnVuY3Rpb24oYTdpLCBoeikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaUkgPSBpSCAqIGE3aSAtIGh6Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGE3ZywgYTVIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELm1GICYmIGE3ZihhN2csIGE1SCkgJiYgIWJpLmVELmRhdGFbOF0udmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVIIDwgZXAgKyAxLjI1ICogaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hMFooTWF0aC5mbG9vcihoLmkgLyAyKSwgTWF0aC5mbG9vcihoLmogLyAyKSwgLTIwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYTBaKE1hdGguZmxvb3IoaC5pIC8gMiksIE1hdGguZmxvb3IoaC5qIC8gMiksIDIwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUgubVUoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1IID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdjID0gYTdnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2QgPSBhNUg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFcgPSBmdW5jdGlvbihhN2csIGE1SCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSC5tVSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTdqID0gaUc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTdrID0gaUk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTEgPSBhN2MgLSBhN2c7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTQgPSBhN2QgLSBhNUg7DQogICAgICAgICAgICAgICAgICAgICAgICBpRyArPSBpMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlJICs9IGk0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTBXKGkxLCBpNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE3bCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdjID0gYTdnOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdkID0gYTVIOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhN2ogIT09IGlHIHx8IGE3ayAhPT0gaUkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFogPSBmdW5jdGlvbihreSwga3osIGRlbHRhWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1POw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSC5tVSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVsdGFZID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1PID0gNTAwIC8gKDUwMCArIGRlbHRhWSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbU8gPSBtTyA8IDAuNSA/IDAuNSA6IG1POw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZWx0YVkgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbU8gPSAoNTAwIC0gZGVsdGFZKSAvIDUwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtTyA9IG1PID4gMiA/IDIgOiBtTzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hN20oa3ksIGt6LCBtTyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTdtID0gZnVuY3Rpb24oZW4sIGVwLCBlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZUsgPSBhN24oZUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuem9vbShlSywgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3byhlSywgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTdsID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTdwID0gaC5pIC8gMTY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE3cSA9IGguaiAvIDE2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpRyA8IC1oLmkgKyBhN3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaiA9IC1oLmkgKyBhN3AgLSBpRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpRyA+IGlIICogYlIuZXIgLSBhN3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaiA9IGlIICogYlIuZXIgLSBhN3AgLSBpRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpSSA8IC1oLmogKyBhN3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoayA9IC1oLmogKyBhN3EgLSBpSTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpSSA+IGlIICogYlIuZXMgLSBhN3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoayA9IGlIICogYlIuZXMgLSBhN3EgLSBpSTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlHICs9IGhqOw0KICAgICAgICAgICAgICAgICAgICAgICAgaUkgKz0gaGs7DQogICAgICAgICAgICAgICAgICAgICAgICBiWi5tVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTdyKGhqLCBoayk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhN24oYTFRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMVEgPSBhMVEgKiBpSCA+IDEwMjQgPyAxMDI0IC8gaUggOiBhMVE7DQogICAgICAgICAgICAgICAgICAgICAgICBhMVEgPSBhMVEgKiBpSCA8IDAuMTI1ID8gMC4xMjUgLyBpSCA6IGExUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMVE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTdvKGExUSwga3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpSCAqPSBhMVE7DQogICAgICAgICAgICAgICAgICAgICAgICBpRyA9IChpRyArIGt5KSAqIGExUSAtIGt5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaUkgPSAoaUkgKyBreikgKiBhMVEgLSBrejsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTLmE3bCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE3ZSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN3MgPSBNYXRoLmZsb29yKDEgKyBpIC8gMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdiW2FCXS5jbGVhclJlY3QoMCwgMCwgaSwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdiW2FCXS5maWxsU3R5bGUgPSBiQS5tZjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3YlthQl0uYXJjKGkgLyAyLCBpIC8gMiwgaSAvIDIgLSBhN3MsIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLmxpbmVXaWR0aCA9IGE3czsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3YlthQl0uc3Ryb2tlU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3YlthQl0uYXJjKGkgLyAyLCBpIC8gMiwgaSAvIDIgLSBhN3MsIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN2JbYUJdLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhHKGE3YlthQl0sIDAsIDAsIGksIGE3cywgMC4zLCBhQiA9PT0gMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuID0gaC5pIC0gaSAtIGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gTWF0aC5mbG9vcihoLmogLyAyIC0gMS4yNSAqIGkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpLmVELmRhdGFbOF0udmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYTdhWzBdLCBlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGE3YVsxXSwgZW4sIE1hdGguZmxvb3IoZXAgKyAzICogaSAvIDIpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNIKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3dDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3dTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3djsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdhcDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3dzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3eDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3eTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE3ejsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4MDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4MTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdrOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTgyOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTZDOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTgzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTg0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTg1Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE4NiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhODMgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTgyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eiA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hODcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4MSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhN3QgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ2FwID0gMC4zOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBnID0gWzIwODY0NDM3NywgMjA4NjQ0Mzc3LCAyMDg2NDQzNzcsIDIwNjk2NDcwOSwgMjA1MTU2NTk0LCAyNTA2ODA4MDMsIDI0OTA4OTgzNSwgMjM0NDc2NTUyLCAyNTIzNDYyMDksIDI2MzE5NjQwNiwgMjcwODIxNTMzLCAyOTE0MzY0MDAsIDI5NDkwNzEwMywgMjg4ODY2MTc5LCAyOTc5NjA4OTAsIDMxMDE2NTkyOCwgMzIzMjE1NzM4LCAzMjYwMDU3MTIsIDMxMjA3ODg3MiwgMjgyNjY4Njc0LCAyNjg4ODMyMzEsIDI2MTEwMDg4NSwgMjQ3ODcwMjA5LCAyNDAxNzU4MjgsIDIzMTY5NzIzNSwgMjQwNjE0MjAyLCAyMzc2NDcxNzQsIDIzMDUyNTIxMiwgMjI4MjM5MDk5LCAyMjYwNzA3MzMsIDIxNTk5MjczOSwgMjE2OTYxNjc2LCAyMzEwNzk1ODQsIDIzNTc5MzUwMiwgMjM0MDMyODIxLCAyMjg0MDI0NjIsIDIxNjk0MjgzMiwgMjExODYyNjcwLCAyMDk3OTI0MTgsIDIyMDYyNjQ5NSwgMjIxMDIwNTM1LCAyMjgxOTg2MzMsIDIyNjkxMDgwNiwgMjI3Njg3Mjk1LCAyMTA5Njk1NDcsIDE5NzM5MzUwNiwgMjA1NjI5MDYxLCAyMTU4MjAxMzUsIDIxMzY5NDkzNSwgMjA5NDU1ODcwLCAyMTU4MjI1ODQsIDIxNTEzMDI5OSwgMjE0MDM0MjE5LCAyMjkxOTA0MTQsIDIzMDA1NTI5MCwgMjI1MzEzNzkxLCAyMjMzOTg1MjMsIDIzMTg3MDE2OSwgMjI2MjI0OTM4LCAyMTgyNDI3MDYsIDIzNTg5MTAyOSwgMjEwNDk4NDQ0LCAxOTUzMjkxMTYsIDE4NzY3NjAwNywgMTgzNDMyNjM0LCAxNzU3NTIxMDYsIDE3MDA5NjIwNSwgMTczMzY5MzQyLCAxNzE0NTQzNTcsIDE4NTgxMDMxMCwgMTg5NjE2NTc3LCAxOTA3ODg4NjEsIDE3OTI5MTQ4NywgMTc5NTEzOTgwLCAxODkxMjIzNTMsIDE4ODM3NTU3MiwgMjAyMDYwNzIyLCAyMDMyNTY2MDksIDE5Nzk0ODY1MiwgMTkxOTUwNDQ4LCAxOTQ2OTMyMTcsIDE5NjMzNTQ5MCwgMTk1OTExOTE5LCAyMDIyNjQyODMsIDE5OTI1MTYyMCwgMTkzNjk5MzM2LCAxODg0NDEyMTAsIDE4MzQxOTM0NSwgMTk1OTE5OTg4LCAxOTgxMjY4MjMsIDE5OTc4MDc4OCwgMTk3NDQwNTUwLCAxOTAxNDQ4ODQsIDE3OTEzOTM2MiwgMTY2NDY5MDk5LCAxNzg4Mjc4NzcsIDE4MzgwMTk4MCwgMTk3OTUyNDg0LCAxODg4NzU4NjEsIDE4NTkxOTc4MywgMTg2MjM3NDExLCAxODI1MDQ5NTIsIDE4MzUzMjAxMywgMTc0MTA5MDA0LCAxNzgxNTk3MDEsIDE2MTAzMTM0NywgMTk0NjIyODM4LCAyMDU2NDU2NDUsIDIwMDQ5NjQ1NywgMTk0NzczMzI3LCAxOTQ1NDY0ODEsIDIwNzg5MzIxNywgMjEwOTIwMTI2LCAyMTMzNzYxNDQsIDE3Mzg1OTg5NywgMTU0MzI2ODg2LCAxNTg5NDM3MjksIDE2Njc3Mjk3NSwgMTc1MDY2MDQ2LCAxNzc0MDY0MDUsIDE3OTAxODU2MiwgMTg1OTg2MTE5LCAxODY3NDc1ODMsIDIwMDc4NzkzOSwgMjA4OTU5OTM3LCAxNjE5ODc1NzYsIDE4NTUxMjQwMCwgMTg1Nzg4ODk5LCAxODU5NTc0ODcsIDE5NDU5MTA2MywgMjE1NjM0MTU3LCAyMzA1NzkzMTQsIDIzNzYzNzM4MywgMjQwNTE4NzA3LCAyMjEzOTgyMzksIDIyNTIzMDc5NSwgMjI0ODkxMjg1LCAyMTEyOTI5MTYsIDIxNjk0NDYyNiwgMjE5NDM2Mjk5LCAyMjY1MjM5MTgsIDIzMjQwNTU2OCwgMjMyMTY2NDI2LCAyMTY5MjE3ODIsIDI0NDc2Nzk2NCwgMjU3Mjc4OTQ2LCAyNDM1NDgxMDAsIDIzNzM4Njk0MywgMjQyODAyNjI3LCAyMjk3MTc2MjIsIDE2ODE0OTcwOSwgMjU5OTcxODk2LCAyNjcwNTc3NjcsIDI1NzYwNjYzNSwgMjA5ODU3MzY0LCAxMjYwMzU1NjgsIDEyOTgzMzIzNywgMTUxMzEyNzAzLCAxOTcwMDY2OTUsIDczMTIwNjU3LCAzNzU1MTAyNCwgMzkyMjk0MzIsIDI5NTE3NzM2LCAyOTM4MjYzMSwgMzE1MTIwNDUsIDQyNjUyMDk3LCA0NzM2MzAxOSwgNDk2MjQ5MDYsIDQ2Njg3MzEwLCAzMzc2NzEyMCwgMzEyMzA0MzksIDM0MjExNjQzLCA0MzA5NDUzMSwgNTM3NDcwNTMsIDU1MzgwNjgyLCA0OTc3OTExNywgNDc3NDg4MzMsIDIxMDM4ODAyLCAyMDQwNjQ4NCwgMjQ1MjM3OTMsIDI2NTY2MTM5LCAyNTI4NDE0MiwgMjY4MjU1NTMsIDIzNDk3NDQzLCAyMDI5MTg2NSwgMTc3NjUwMjIsIDIxMjkxMzIwLCAyMTEwNjEyMywgMTkwNTAxMjgsIDE4MzI0NDI2LCAxOTA0NDA2NywgMTk1OTQ3MjEsIDE5MzQ3ODQ1LCAyMzM2NTEyNCwgMjQxODY1MjksIDE5ODI0ODgxLCAxNzk1MjgxMiwgMTcwOTM4MzgsIDE3MzI4NTc5LCAxNzYwNzI5NiwgMjEyODQ3MzcsIDIyNTUxMDEyLCAyMDQ3MTI4MSwgMTkzNTA4NDgsIDE5NjU0OTMxLCAxODcyNTQ2MCwgMTg2NDE5MjYsIDIzMzAxMjY5LCAyNTE3ODkwMiwgMjE2MTcwNDEsIDIxNDMzNzgxLCAyMTA3ODk1NywgMTk1MjYwNDcsIDE4NjY1MDY0LCAyMTM5NDQwMSwgMjE1NzUwNDksIDE5Mjg2Njc3LCAxODAxODQ1MCwgMTc1NTA3NzUsIDE3MjgyNDI4LCAxNzA1NTUwOSwgMTkzNDg3MDQsIDIwMTc3ODQ1LCAxOTc2NjIxMSwgMTkwODgwMzcsIDE4MTE4ODAyLCAxODI2OTQyOCwgMTg1MDA2MTQsIDE5MTMwMjIwLCAxOTM1MTc5OCwgMTkyMDUxODgsIDE5NDg5OTYxLCAyMDIzMzI4NiwgMjA3MjY4MTEsIDIzMjQ1MTQ1LCAyNjE1ODc0MSwgMjYwOTY2NDIsIDI0NDI0MTgxLCAyMzY5MDY2MSwgMjI5Njc0OTIsIDIxMDk4MDA4LCAyMDMyNTk3MywgMTk0MzE5MDcsIDE3MDA4Mjk1LCAxNTU4MzA5NiwgMTQyMDk3NTIsIDE0MzA3MTg0LCAxMzU0MTQ5OCwgMTI4MjI2NzksIDEzMTU0MzExLCAxMjE2MTE5NCwgMTI5NTY1NDMsIDExNDM1Njk3LCAxMzQyODkyOCwgMTIyNjI1MTQsIDEyODU4NTE5LCAxMjQwNTM0NCwgMTI4ODQzMDksIDE0NDEwMDExLCAxNTU1NjY4MSwgMTUyNjAxNzgsIDE0ODYzODA3LCAxMzg2MTQ1OCwgMTUxNzYxNDQsIDE0MDg5ODQ5LCAxMzA2Mzk4NywgMTIzNzg3MTYsIDEzMDYxODY3LCAxMzExODkwMCwgMTMxMTI2NTMsIDEzMTM3MjYzLCAxMzA2MjI1MywgMTMxMjY4NzUsIDE0MTM2ODMzLCAxNDcxMTg1MiwgMTQzNDEyNTAsIDExODg4MjcwLCAxMzEzNzAwNiwgMTI4MzA4NDEsIDEyNTE2OTM3LCAxMjc4Mzc4OSwgMTMxMzkzOTMsIDEyOTMxMDAwLCAxMjg1NzU4MiwgMTM2NzczMjksIDEzODkyOTYzLCAxMzE3MTUyOCwgMTQxMzUyMzYsIDE0NjQwNzUwLCAxNTY3Nzk3MCwgMTY3NTgzOTksIDE5MTI1MTc3LCAxNzcyMzQ0NiwgMTY0Njk0ODQsIDE3MDMyODg0LCAxOTc5MjYwMywgMjE0MjYzOTcsIDIyMDMyNTM0LCAyMDI3MTI1MSwgMTYxOTAxNzYsIDE2NzcyODEzLCAxNzY3NTk3NywgMTg3NjQwMjYsIDE4MzQ2MjA5LCAxOTU3NjgzNCwgMjA5ODk3OTIsIDIxMzUwODM5LCAxNDY5Njg4NSwgMTQ2NTMwNzUsIDE0Njc3OTk5LCAxNDk1ODc1OSwgMTQyMTAyNjAsIDE1NDg4MzUyLCAxNTYyMzYwNCwgMTQ0NzMxNDQsIDEyODIzMDYyLCAxNDg2OTkwOSwgMTUxNDIyNjQsIDE1NTY3MDE0LCAxNzg5NjcyNSwgMjAwODEzNDcsIDE3NzY1MDA2LCAxMjc2MzkyNSwgMTM1MjM2MTAsIDEzOTc5OTgzLCAxNTA4MDg1NiwgMTcxMTYzOTQsIDE4NDgzMjM4LCAxODA4NDMyMCwgMTIxMDAyODIsIDEyMjIxNTI5LCAxMjQ0MTU3OSwgMTIwNTgyMjAsIDEyNDQxNjg5LCAxMjgyMTU0NiwgMTM0MDE1ODMsIDEzMDA5ODk1LCAxMjI3MTA2NiwgMTIyMTAwOTQsIDEyMzU1NjQyLCAxMzczNzExNSwgMTQyNTc4MDcsIDE0OTA0ODk3LCAxNDA3MjE2MSwgMTU2NDAzODcsIDE1NzIxODAzLCAxNjM5Nzk3MCwgMTkyNTQ4MzksIDIxNjA4OTA2LCAyMDUyNzQ3MSwgMTY1OTYyMDYsIDE1NTUwNTYzLCAxNDM4NTU5MSwgMTU1NDcyNjIsIDEzMTc0MzAyLCAxMjQ2MjMxOSwgMTMwMDA2NjksIDEyODMyNTQxLCAxMjE4NjM3NiwgMTMxNTA5NDAsIDE0NjU0Mzc5LCAxNDI5OTM4NiwgMTQxNTg1MjgsIDE1MTg1OTcxLCAxMjQ0NDExNywgMTQyNTM0NDUsIDE1MDQ5MDUzLCAxNDEyMzMxMCwgMTY4OTI4NTMsIDE1OTYzOTMxLCAxMTg1ODcyNywgMTAwMTI3MDMsIDk0NzgxOTEsIDkxOTM0NjAsIDg4NTEwODIsIDkyOTg4NDgsIDk2MzgyMDQsIDk0NDI0OTYsIDg2NTM1OTMsIDkwOTM1MjcsIDg1MzA5NzcsIDg4MDkxMTQsIDk2MDk2MTIsIDk5MDY5MTIsIDk2MTU3NTYsIDk0Nzc4NzksIDk3MTMwNzUsIDkxMjY1ODMsIDg5NDkzNzgsIDk1Nzc1OTUsIDEwMTgwMTg2LCA5ODU4NzA1LCA5NTM0MjEzLCA5MTg0NjYwLCA4ODg5NDU1LCA4MzExMzEzLCA5NzM4MzQ2LCA5NzcyMTY0LCA5MTU3NzkxLCA4NDQ1NDEzLCA4NDY3Mjc5LCA4NzU2MDAyLCA5MjU3OTUxLCAxMDIxMzUzNiwgMTA2MjA1MzAsIDEwMzUyMjk2LCA5MzUwNTMxLCA5MTE4NzA5LCA5NjE0MjM3LCA5NjkyNDkxLCAxMDgwMTIxNSwgMTA5ODQ4MDQsIDk1NDIzMDksIDk2MDk1MzgsIDkzOTE0MzAsIDk1MTU1MTcsIDEwMDY0NDk0LCAxMTA2MTY4NCwgMTA0MDgwMDUsIDk3OTQ3NjgsIDkyOTc2NDMsIDkyNzU5OTIsIDkzOTQwNzYsIDk3MTYwODQsIDEwMDQ1OTU4LCA5NzE1MjI5LCA5MDkxMjQ4LCAxMDAxMDU4NCwgOTg0NTUyOCwgOTUzMjU4OCwgODk4NjMyMCwgOTAzNzcwOCwgOTgyMDk5NiwgODk1MzQ2NCwgOTA3NDA2NCwgODY0NDY5MiwgODAyNTMwOCwgODgzMjExMiwgMTA3ODU3ODgsIDEwNTM5NzA4LCA4OTA4NzQ0LCA4MzMxMjE2LCA4ODU4MTAwLCA4NjI2ODQwLCA3NjY2Mjg0LCA4NTAzMzcyLCA4ODU1MzA4LCA2NzYyNTQwLCA2NDE0MDc2LCA2Nzg2NjkyLCA2NDQ1NTMyLCA2MjYyMTkyLCA1OTE4MTc2LCA1ODY0Mzc2LCA1NDY0OTI4LCA1Mzg0OTk2LCA1OTQyNzYwLCA1MjYxOTcyLCA1NDA0NjEyLCA2MTg0ODYwLCA2MzEyOTQ4LCA1ODE1NjYwLCA1MjA4NTUyLCA0NzM0MzkyLCA0NTM4Nzg0LCA0NjYxNDA0LCA1MTQ1NTI0LCA0ODE5MzY4LCA0MzY5MjI0LCA0NDU4NTg0LCA0Mjg5OTU2LCAzNTM4Mjg4LCAzNTE3NTQ0LCAzODcxODc2LCAzMzg4MDQ4LCAzMzQ0Nzk2LCAzMDg5MjI4LCAyODYzNjc2LCAyMjY4OTY0LCAyMTYwNTAwLCAyNTgwMDA0LCAyMjQ0MzU2LCAyMDE4NDA4LCAxNjg4OTEyLCAxOTQ1MzY4LCAxNzk2MzMyLCAxNjE5MjYwLCAyMDYwMjkyLCAxNTk3NjU2LCAxNDcyNzg4LCAxMzA2MjA4LCAxMTcxNDA4LCAxMDIxMDk2LCAxMTA5MzEyLCAxMjQxMjc2LCAxMzA1MDkyLCAxMTQyNzQ4LCAxMTU3NzAwLCA5OTE5ODQsIDc4Njk5MiwgNzg2Mzk2LCAxMDQzOTU2LCAxMDI5MzIwLCA4NjA1MDAsIDgzNDgyNCwgODQxOTEyLCA3MzY0NjQsIDY5MDMyOCwgODc4Mzc2LCA5MDcyMzIsIDc5NDkzMiwgNjQ2Mzg4LCA3NTI2MDAsIDY3MjgzNiwgNjM2MjEyLCA3OTQxMDgsIDc0Njg1NiwgNjQyOTI4LCA2NzEzMjgsIDQ5MzU2OCwgNDU4MTY4LCA0Mjg3NzYsIDQ2NDczNiwgMzcxNDEyLCAzMTQ1NjgsIDIyNTQ3MiwgMjUyMDcyLCAyMjc2MDQsIDI1MTA0OCwgMjY5MTg0LCAxNzQxMzYsIDgyNTU3NiwgNTM2MDYwLCAxNjU5NTIsIDE1MzI1MiwgMTgwMDM2LCAxNDk2MTYsIDEzODQ3MiwgMTU3ODMyLCAxODgxNTIsIDE4MDEwOCwgMTM0MDc2LCA3MDk2MCwgODkyMzYsIDExMTQyOCwgNjA1MjAsIDc0NjIwLCA3MzQyNCwgNzQ3MjAsIDcxNTg0LCA5NDQzMiwgNjI1NzIsIDY2NDIwLCAzMjUzMiwgMzQ0NTIsIDQxMDQ4LCA1MTM3MiwgNjE5MTYsIDQzMjM2LCA1NTE3MiwgMjY3NzYsIDQ3MDAwLCA1NzQyNCwgOTMxMDAsIDY0OTgwLCAzNzI4OCwgNDQyOTYsIDM0NTg4LCA0MDcwMCwgMjkyMDAsIDI0NjA0LCAxODE4NCwgNDI2NjAsIDMxNDA0LCAzODA5NiwgMTg1NTYsIDE3Mzg4LCAxOTU2OCwgMTc2MDQsIDIyMzI4LCA0MDMwMCwgMzkzOTIsIDMzNDQwLCAxNzk2MCwgNzk4NCwgMTE2MTIsIDY3NzAwLCAxNDEwOCwgMjI0NDQsIDE5NzU2LCA5NDM2LCAxNjg2NCwgMTQ0MDAsIDE3MjE2LCAxNDQzNiwgODYxMiwgMTU5NTIsIDI5NzY0LCAxODc0OCwgMTYzNDgsIDIzOTc2LCAyMjA4MCwgMjAyNjgsIDIwOTg0LCA5NDgwLCAzMDczNiwgMTU5OTYsIDk0ODQsIDkzOTIsIDk3MTYsIDIxNTQwLCA1NzQyOCwgMjQ3ODgsIDE4NzI4LCA4NTI4LCA1OTcyLCAyMDU2MCwgMTgyNjgsIDI4MDg4LCAxNTM2NCwgMTUzMDAsIDI5MzQ4LCAzMDk5MiwgMjA1NjQsIDM0NDIwLCAxNjcxNiwgMTQ0MjQsIDEyMzYwLCAxNTEyNCwgNTExNzIsIDEzMTc2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTd1ID0gTWF0aC5mbG9vcigwLjE1ICogaC5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4MCA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjAxOCA6IDAuMDEzNykgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4MCA9IGE4MCA8IDIgPyAyIDogYTgwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTRlID0gYjkucGcuclYoMSwgYTgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4OSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTg4KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1ID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJQbGF0ZWF1IEEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDU3DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIk1heCBBIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiAxDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIkJsYWNrIEZyaWRheSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDE1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDE1DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIk1heCBCIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMTksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogMTkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiTWF4IEMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA0NCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA0NA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJGaXJzdCBBbmRyb2lkIFZlcnNpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA1OCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA1OA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJNYXggRCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDY3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDY3DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIlRoZSBpRnJhbWUgRXhwbG9zaW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogOTgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogOTkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiVGhlIDE1NS1EYXkgVXB0cmVuZCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDU4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDIxMw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJNYXggRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDIxMywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiAyMTMNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiUGxhdGVhdSBCIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMjE0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDI1OQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJUdXJidWxlbnQgVGltZXMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiAyNjAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogMzQ0DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIk1heCBGIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMjYyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDI2Mg0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJNYXggRyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDI4MiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiAyODINCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiTWF4IEgiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiAzMzMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogMzMzDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIlRoZSAxOS1EYXkgRG93bnRyZW5kIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMjgzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDMwMQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJQbGF0ZWF1IEMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiAzNDUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogMzg1DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIlRoZSBBbGxpYW5jZSBBc2NlbnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiAzODYsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogMzk1DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIk1heCBJIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMzk1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDM5NQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJGaXJzdCBpT1MgVmVyc2lvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDQxMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA0MTENCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiUGxhdGVhdSBEIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogMzk2LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDQ1Mw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJUaGUgVGlrVG9rIFJldm9sdXRpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA0NTQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogNDcwDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIk1heCBKIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogNDU2LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDQ1Ng0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJNYXggSyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDQ3MiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA0NzINCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiTWF4IEwiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA0NzgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogNDc4DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIllUIERyZXciLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA0NzEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogNDg1DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIlBsYXRlYXUgRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDQ4NSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA2MDANCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiVXB0cmVuZCBBIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZzogNjAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IDYxMw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhODUucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6ICJNYXggTSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDYxMywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA2MTMNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiRG93bnRyZW5kIEEiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnOiA2MTQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTogNjM1DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4NS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogIlBsYXRlYXUgRiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDYzNiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA3MzcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTg1LnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4OiAiRW5kIG9mIFJlY29yZCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWc6IDczOCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlOiA3MzgNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThBID0gZnVuY3Rpb24oYThCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4NiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBhOEIubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZy51bnNoaWZ0KGE4QlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTg5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhODkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhN3YgPSBNYXRoLmZsb29yKChhMC5hMS5yNCgpID8gMC4wNyA6IDAuMDM1KSAqIDAuMiAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTd2ID0gYTVFKGEwLmExLnI0KCkgPyAzIDogMSwgYTd2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOEMgPSBoLmkgLyAoZy5sZW5ndGggKyBnYXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTd2ID0gYThDID4gYTd2ID8gYThDIDogYTd2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTZDID0gTWF0aC5mbG9vcigoMSAtIGdhcCkgKiBhN3YpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTd0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4RCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThFID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhOEQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE4RCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3dCA9IGE3dCA8IC0yMCA/IC0yMCA6IGE3dDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3dCA9IGE3dCA+IChnLmxlbmd0aCAtIDE1KSAqIGE3diA/IChnLmxlbmd0aCAtIDE1KSAqIGE3diA6IGE3dDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eCA9IE1hdGguZmxvb3IoYTd0IC8gYTd2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eSA9IGE3eCArIE1hdGguZmxvb3IoaC5pIC8gYTd2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eSA9IGE3eSA+IGcubGVuZ3RoIC0gMSA/IGcubGVuZ3RoIC0gMSA6IGE3eTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eCA9IGE3eSA8IGE3eCA/IGE3eSA6IGE3eDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3eCA9IGE3eCA8IDAgPyAwIDogYTd4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYThGKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYThGKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYTd5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTd3ID0gYTd1IC8gZ1trZF07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGE3eSAtIDE7IGFCID49IGE3eDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnW2FCXSA+IGdba2RdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkID0gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3dyA9IGE3dSAvIChNYXRoLnBvdyhnW2FCXSwgYTgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE4Ryhlbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gTWF0aC5mbG9vcigoYTd0ICsgaC5pIC0gZW4gLSBnYXAgKiBhN3YpIC8gYTd2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRsID0gZGwgPCAtMSA/IC0xIDogZGwgPT09IC0xID8gMCA6IGRsID4gZy5sZW5ndGggLSAxID8gLTEgOiBkbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkbCAhPT0gYTd6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTd6ID0gZGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4MyA9PT0gLTEgJiYgYTd6ID09PSAwICYmIGFULmE4Nikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhODMgPSBzZXRJbnRlcnZhbChhOEgsIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXAgPiBoLmogLSAwLjYgKiBhN3UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hODcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuICE9PSBnaykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTd0ICs9IGVuIC0gZ2s7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnayA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYThEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOEcoZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hODcgPSBhN3ogIT09IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4RyhlbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFnKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFnID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTd6ICE9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTg3ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTd6ID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFogPSBmdW5jdGlvbihlbiwgZGVsdGFZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTd6ICE9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3dCArPSBNYXRoLmZsb29yKGRlbHRhWSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThHKGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEwVyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3eiAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnayA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTg3ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTB2ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTd6ICE9PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTg3ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTd5OyBhQiA+PSBhN3g7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOEkoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYTg2ICYmIGE3eCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm5NOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4SSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhN3ogIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW87DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThJKGE3eik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhOEooKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE4SShhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2MiA9IE1hdGguZmxvb3IoYTd3ICogKE1hdGgucG93KGdbYUJdLCBhODIpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChhN3QgKyBoLmkgLSAoYUIgKyAxKSAqIGE3diwgaC5qIC0gYTYyLCBhNkMsIGE2Mik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYThKKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3eiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5mb250ID0gYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHRvLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBkbC5zZXRUaW1lKGE4MS5nZXRUaW1lKCkgLSBhN3ogKiAxMDAwICogNjAgKiA2MCAqIDI0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb250aCA9ICJtb250aCI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYThLID0gImRheSI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEludGwgIT09IFNbMjddKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGggPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChTWzg5XSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoOiBTWzgyXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZvcm1hdChkbCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThLID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoU1s4OV0sew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWVrZGF5OiBTWzgyXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZvcm1hdChkbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYThMID0gYThLICsgIiwgIiArIGRsLmdldFVUQ0RhdGUoKSArICIgIiArIG1vbnRoICsgIiAiICsgZGwuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOE07DQogICAgICAgICAgICAgICAgICAgICAgICBhOE0gPSBnW2E3el0gPT09IDEgPyBMKDExMSkgOiBMKDExMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhOE0gPSBiOS56ZC55SihnW2E3el0pICsgIiAiICsgYThNOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMyID0gTWF0aC5mbG9vcih0by5tZWFzdXJlVGV4dChhOEwpLndpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzMyA9IE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoYThNKS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYThOID0gTWF0aC5mbG9vcigwLjUgKiAoczIgKyBhODApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOE8gPSBhN3QgKyBoLmkgLSAoYTd6ICsgMSkgKiBhN3Y7DQogICAgICAgICAgICAgICAgICAgICAgICBhOE8gPSBhOE8gPCBhOE4gPyBhOE4gOiBhOE8gPiBoLmkgLSBhOE4gPyBoLmkgLSBhOE4gOiBhOE87DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBoLmogLSBNYXRoLmZsb29yKGE3dyAqIChNYXRoLnBvdyhnW2E3el0sIGE4MikpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOFAgPSBNYXRoLmZsb29yKDEuMSAqIGE4MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYThRID0gbUQgPiBoLmogLSBhOFAgPyBoLmogLSBhOFAgOiBtRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1qOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoaC5pIC0gczMgLSBhODAsIGE4USAtIGE4UCwgczMgKyBhODAsIGE4UCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChhOE8gLSBhOE4sIGguaiAtIGE4UCwgczIgKyBhODAsIGE4UCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChhOE0sIE1hdGguZmxvb3IoaC5pIC0gMC41ICogYTgwKSwgYThRKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4UihhOFEgLSAyICogYThQLCBhOFApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGE4TCwgYThPLCBoLmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBiQS5tcTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVXaWR0aCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLm1vdmVUbygwLCBtRCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oaC5pLCBtRCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5jbG9zZVBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE4UihtRCwgYThQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2YgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMSA9IGcubGVuZ3RoIC0gYTd6IC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTg1Lmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPj0gYTg1W2FCXS5lZyAmJiBlMSA8PSBhODVbYUJdLmUgJiYgKGtmID09PSAtMSB8fCBhODVbYUJdLmUgLSBhODVbYUJdLmVnIDwgYTg1W2tmXS5lIC0gYTg1W2tmXS5lZykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2YgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2YgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMyID0gTWF0aC5mbG9vcih0by5tZWFzdXJlVGV4dChhODVba2ZdLmc4KS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KGguaSAtIHMyIC0gYTgwLCBtRCwgczIgKyBhODAsIGE4UCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGE4NVtrZl0uZzgsIE1hdGguZmxvb3IoaC5pIC0gMC41ICogYTgwKSwgbUQgKyBhOFApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE4SCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE3eiA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE3eiAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4NCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhODMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4MyA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGdbMV0gLyAoMjQgKiA2MCAqIDYwICogMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4NCAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEICs9IChkbCAtIGE4NCkgKiBnWzFdIC8gKDI0ICogNjAgKiA2MCAqIDEwMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4NCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdEID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbMF0gKz0gTWF0aC5mbG9vcihnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNJKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVuID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGksIGVwLCBhOFM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOFQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBjYW52YXM7DQogICAgICAgICAgICAgICAgICAgIHZhciB4RDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE2NTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEyVzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4VTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4VjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4VzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4WDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYThUID0gYUQuYTNROw0KICAgICAgICAgICAgICAgICAgICAgICAgYThWID0gU1s3NV07DQogICAgICAgICAgICAgICAgICAgICAgICBhOFcgPSAicmdiYSgxNTAsMCwwLDAuOCkiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThVID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2NSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhMlcgPSBhZy5naFthRC5lUV07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBNYXRoLmZsb29yKChhMC5hMS5yNCgpID8gMC4zMDUgOiAwLjI0KSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gTWF0aC5mbG9vcigwLjUgKyAwLjEzICogaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gTWF0aC5mbG9vcih0aGlzLmogKiA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0ZSA9IGI5LnBnLnJWKDEsIE1hdGguZmxvb3IoMC44ICogdGhpcy5qKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOFggPSBNYXRoLmZsb29yKDAuNSAqIHRoaXMuaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5mb250ID0gYTRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXAgPSBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICBhOFMgPSBNYXRoLmZsb29yKDEgKyAwLjEzICogdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IHRoaXMuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhEID0gY2FudmFzLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZvbnQgPSBhNGU7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUoeEQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYThZKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE2UiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEwLmExLnI0KCkgJiYgaC5pIDwgMS4yICogaC5qOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmE2UigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbiA9IGguaSAtIGkgLSBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW4gPSBNYXRoLmZsb29yKGFWLmE4WigpICsgKGguaSAtIGFWLmE4WigpIC0gYVcuaSAtIGkpIC8gMiAtIDAuNSAqIGJiLmdhcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTY1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTY1ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOFkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThZID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5jbGVhclJlY3QoMCwgMCwgaSwgdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGE4VSA/IGE4ViA6IGE4VzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIDAsIGksIHRoaXMuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYThhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4YigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYWcuZ2hbYUQuZVFdID49IGFlLmpiKGFELmVRKSA/IGJBLm5KIDogYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dChiOS56ZC55SihhMlcpLCBNYXRoLmZsb29yKGkgLyAyKSwgYThYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCAxLCB0aGlzLmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgdGhpcy5qIC0gMSwgaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChpIC0gMSwgMCwgMSwgdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThhID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBiZS5qcygpICUgMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjEgLT0gZjEgJSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYxID0gOSAtIGJLLmRtKGYxLCAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0QgPSBNYXRoLmZsb29yKGYxICogKHRoaXMuaiAtIGE4UykgLyA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIHdELCBhOFMsIHRoaXMuaiAtIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGkgLSBhOFMsIHdELCBhOFMsIHRoaXMuaiAtIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThiID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChhOFMsIHRoaXMuaiAtIGE4UywgTWF0aC5mbG9vcigoaSAtIDIgKiBhOFMpICogYWcuZ2hbYUQuZVFdIC8gYThUKSwgYThTKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGFELmVROw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSBhZy5naFtnRF0gLSBhZy5hMlZbZ0RdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEyVyAhPT0gZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOFQgPSBhNUUoZjAsIGE4VCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThVID0gZjAgPiBhMlcgJiYgZjAgPj0gMTA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJXID0gZjA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTY1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmUuanMoKSAlIDEwID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTY1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFthRC5lUV0gPT09IDAgfHwgYUQuaDEgfHwgYWcuYTJOW2FELmVRXSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShjYW52YXMsIHRoaXMuZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBhNmg7DQogICAgICAgICAgICAgICAgdmFyIGxBOw0KICAgICAgICAgICAgICAgIHZhciBqZzsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjSigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4YzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4ZDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4ZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4ZjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4ZzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4aDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4aTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4ajsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4azsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4bCwgYThtOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYThuOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYThvOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYThwLCBhOHEsIGE4cjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4czsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4dDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4dTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4djsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4dzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4eDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTh5Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTh6Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTkwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTkxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTkyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE5MyA9IDE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOTQgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTh5ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4eiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTkwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5MSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhOHggPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4ZyA9IGEwLmExLnI0KCkgPyA2IDogMTA7DQogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhOTMgPSBiaS5lRC5kYXRhWzExXS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5MyA9IGE5MyA9PT0gMCA/IDEwIDogYTkzID09PSAxID8gNSA6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBhOHcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4dSA9IG5ldyBVaW50MTZBcnJheShhOGcgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4diA9IG5ldyBVaW50MzJBcnJheShhOGcgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4ayA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgbEEgPSBuZXcgVWludDE2QXJyYXkoYThrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGpnID0gbmV3IFVpbnQxNkFycmF5KGE4ayk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYThrIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxBW2FCXSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpnW2FCXSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOHMgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5NSA9IE1hdGguZmxvb3IoYThjIC0gYThxIC0gYThwIC0gYThqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4dCA9IG5ldyBBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuZm9udCA9IGE4ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRC5lZCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHRbYUJdID0gKGFCICsgMSkgKyAiLiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWcueFhbYUJdID0gYjkueEQuYTIzKGFnLnpmW2FCXSwgYThmLCBhOTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4c1thQl0gPSBNYXRoLmZsb29yKGE4aS5tZWFzdXJlVGV4dChhZy54WFthQl0pLndpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5NigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbihkWCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmExLnI0KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOGMgPSBNYXRoLmZsb29yKDAuMzM1ICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTZoID0gTWF0aC5mbG9vcigoYThnICogYThjKSAvIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOGMgPSBNYXRoLmZsb29yKDAuMjcgKiBoLnBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNmggPSBNYXRoLmZsb29yKChhOGcgKiBhOGMpIC8gMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYThjID0gTWF0aC5mbG9vcigwLjk3ICogYThjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGgud2lkdGggPSBhOGM7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGguaGVpZ2h0ID0gYTZoOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpID0gYThoLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4bCA9IDAuMDI1ICogYThjOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThlID0gMC4xNjAgKiBhOGM7DQogICAgICAgICAgICAgICAgICAgICAgICBhOG0gPSAwLjAwMCAqIGE4YzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4biA9IE1hdGguZmxvb3IoMC40NSAqIGE4bCArIGE4ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOG8gPSAoYTZoIC0gYThlIC0gMiAqIGE4bCAtIGE4bSkgLyBhOGc7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGQgPSBiOS5wZy5yVigxLCBNYXRoLmZsb29yKDAuNTUgKiBhOGUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5MiA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjY3IDogMC43MikgKiBhOG8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThmID0gYjkucGcuclYoMCwgYTkyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5mb250ID0gYThmOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThwID0gTWF0aC5mbG9vcigwLjA0ICogYThjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4cSA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjE5NSA6IDAuMTgpICogYThjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aiA9IE1hdGguZmxvb3IoYThpLm1lYXN1cmVUZXh0KCIwMDkyMDYwMCIpLndpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5mb250ID0gYThkOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThyID0gYThjIC0gYThwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkWCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5mb250ID0gYThmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4c1thQl0gPSBNYXRoLmZsb29yKGE4aS5tZWFzdXJlVGV4dChhZy54WFthQl0pLndpZHRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTk2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhOTQgPSBiOS54RC5hMjMoTCgxMTMpLCBhOGQsIDAuOTYgKiBhOGMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOFogPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhOGM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxYID0gZnVuY3Rpb24oYnIsIGE5Nykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE5NyB8fCAoYTh3ICYmIChiciB8fCBiZS5qcygpICUgYTkzID09PSAwKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE5NigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlejsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5jbGVhclJlY3QoMCwgMCwgYThjLCBhNmgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxTdHlsZSA9IGJBLm5jOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxSZWN0KDAsIDAsIGE4YywgYThuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsU3R5bGUgPSBiQS5taTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsUmVjdCgwLCBhOG4sIGE4YywgYTZoIC0gYThuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqZ1thRC5lUV0gPj0gcG9zaXRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTgoamdbYUQuZVFdIC0gcG9zaXRpb24sIGJBLm5CKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqZ1thRC5lUV0gIT09IDAgJiYgcG9zaXRpb24gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTgoMCwgYkEubmgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4eCAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTgoYTh4LCBiQS5tbik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuZmlsbFJlY3QoMCwgYThuLCBhOGMsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxSZWN0KDAsIDAsIGE4YywgYmIueTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxSZWN0KDAsIDAsIGJiLnkyLCBhNmgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxSZWN0KGE4YyAtIGJiLnkyLCAwLCBiYi55MiwgYTZoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsUmVjdCgwLCBhNmggLSBiYi55MiwgYThjLCBiYi55Mik7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuZm9udCA9IGE4ZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZShhOGksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKGE4aSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuZmlsbFRleHQoYTk0LCBNYXRoLmZsb29yKGE4YyAvIDIpLCBNYXRoLmZsb29yKGE4bCArIGE4ZSAvIDIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGpnW2FELmVRXSA8IHBvc2l0aW9uICsgYThnIC0gMSA/IDEgOiAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZvbnQgPSBhOGY7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYThpLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBhOGcgLSBnRTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5OShsQVtleiArIHBvc2l0aW9uXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlBKGV6LCBleiArIHBvc2l0aW9uLCBsQVtleiArIHBvc2l0aW9uXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYThpLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBhOGcgLSBnRTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5OShsQVtleiArIHBvc2l0aW9uXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlCKGV6LCBsQVtleiArIHBvc2l0aW9uXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ0UgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTkoYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbihhOGksIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5QShhOGcgLSAxLCBqZ1thRC5lUV0sIGFELmVRKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYThpLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOUIoYThnIC0gMSwgYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlDKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTk5KHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxTdHlsZSA9IGJmLmE5RFtiZi5hOUVbcGxheWVyXV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTk4KGFCLCBhOUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsU3R5bGUgPSBhOUY7DQogICAgICAgICAgICAgICAgICAgICAgICBhQiA9IGFCID4gYThnIC0gMSA/IGE4ZyAtIDEgOiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOUcgPSBNYXRoLmZsb29yKChhQiA9PT0gYThnIC0gMSA/IDIgOiBhQiA9PT0gMCA/IDEuMTUgOiAxKSAqIGE4byk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOUcgPSBhQiA9PT0gYThnIC0gMiA/IE1hdGguZmxvb3IoYThuICsgOS4xNSAqIGE4bykgLSBNYXRoLmZsb29yKGE4biArIDguMTUgKiBhOG8pIDogYTlHOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxSZWN0KDAsIE1hdGguZmxvb3IoYThuICsgKGFCICsgKGFCID09PSAwID8gMCA6IDAuMTUpKSAqIGE4byksIGE4YywgYTlHKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOUMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTRqID0gMC43ICogYThvIC8gYWIuZ2V0KDQpLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5zZXRUcmFuc2Zvcm0oYTRqLCAwLCAwLCBhNGosIE1hdGguZmxvb3IoYThwICsgMC41OCAqIGE4byArIDAuNSAqIGE0aiAqIGFiLmdldCg0KS53aWR0aCksIE1hdGguZmxvb3IoYThsICsgYThlICsgMC40ICogYThvKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOGkuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5kcmF3SW1hZ2UoYWIuZ2V0KDQpLCAtTWF0aC5mbG9vcihhYi5nZXQoNCkud2lkdGggLyAyKSwgLU1hdGguZmxvb3IoYWIuZ2V0KDQpLmhlaWdodCAvIDIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlBKGE5SCwgYTJsLCBhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxUZXh0KGE4dFthMmxdLCBhOHAsIE1hdGguZmxvb3IoYThsICsgYThlICsgKGE5SCArIDAuNSkgKiBhOG8pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5hMk5bYUJdID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZvbnQgPSBTWzg2XSArIGE4ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IE1hdGguZmxvb3IoYThsICsgYThlICsgKGE5SCArIDAuNSkgKiBhOG8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThpLmZpbGxUZXh0KGFnLnhYW2FCXSwgYThxLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuYTJOW2FCXSAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5mb250ID0gYThmOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCIDwgYUQuanYgJiYgYWcuYTJOW2FCXSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsUmVjdChhOHEsIGVwICsgMC4zNSAqIGE5MiwgYThzW2FCXSwgTWF0aC5tYXgoMSwgMC4xICogYTkyKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlCKGE5SCwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4aS5maWxsVGV4dChhZy5nVFthQl0sIGE4ciwgTWF0aC5mbG9vcihhOGwgKyBhOGUgKyAoYTlIICsgMC41KSAqIGE4bykpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5SSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5TCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlMKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhOGcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTh1W2FCXSA9IGxBW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHZbYUJdID0gYWcuZ1RbbEFbYUJdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE4dVthOGddID0gamdbYUQuZVFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTh2W2E4Z10gPSBhZy5nVFthRC5lUV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlLKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gYTh3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTh3ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGpnW2FELmVRXSA+PSBhOGcgLSAxID8gYThnIC0gMiA6IGE4ZyAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGdFOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4dVthQl0gIT09IGxBW2FCXSB8fCBhOHZbYUJdICE9PSBhZy5nVFtsQVthQl1dKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnRSA9PT0gYThnIC0gMiAmJiAoYTh1W2E4Z10gIT09IGpnW2FELmVRXSB8fCBhOHZbYThnXSAhPT0gYWcuZ1RbYUQuZVFdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTh3ID0gZGw7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlKKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5TTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtVSA9IGE4ayAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IDA7IGV6IDwgbVU7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuZ1RbbEFbZXpdXSA8IGFnLmdUW2xBW2V6ICsgMV1dKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5TSA9IGxBW2V6XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbEFbZXpdID0gbEFbZXogKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbEFbZXogKyAxXSA9IGE5TTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgamdbbEFbZXpdXSA9IGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqZ1tsQVtleiArIDFdXSA9IGV6ICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlJKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXogPSBhOGsgLSAxOyBleiA+PSAwOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2xBW2V6XV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlOKGV6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlOKGV6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTlPID0gbEFbZXpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYThrLS07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGV6OyBhQiA8IGE4azsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxBW2FCXSA9IGxBW2FCICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgamdbbEFbYUJdXSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbEFbYThrXSA9IGE5TzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGpnW2xBW2E4a11dID0gYThrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ3QgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeTEoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4eSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4eiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTkwID0gYTkxID0gYTlRKGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkkuYTFBKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gYTdRKC0xLCBhOTEsIGE4Zyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5UCA9IChhOVAgPT09IGE4ZykgPyAtMSA6IGE5UDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4eCAhPT0gYTlQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHggPSBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGw7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTlQID0gYTlRKGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhOHopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbCA9IHBvc2l0aW9uOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uICs9IGE5MCAtIGE5UDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGE3USgwLCBwb3NpdGlvbiwgYUQuZWQgLSBhOGcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiAhPT0gZGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTkwID0gYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVAgPSBhN1EoLTEsIGE5UCwgYThnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gKGE5UCA9PT0gYThnIHx8ICF5MShlbiwgZXApKSA/IC0xIDogYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHggPSBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5NigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gYTdRKC0xLCBhOVAsIGE4Zyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVAgPSAoYTlQID09PSBhOGcgfHwgIXkxKGVuLCBlcCkgfHwgYkkuYTFBKCkpID8gLTEgOiBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTh4ICE9PSBhOVApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOHggPSBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTk2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMHYgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYTh6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTh6ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTlQID0gYTlRKGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiSS5hMUEoKSAmJiBhOHggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTh4ID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTk2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGIC0gYTh5IDwgMzUwICYmIGE5MSA9PT0gYTlQKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gYTdRKC0xLCBhOVAsIGE4Zyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gKGE5UCA9PT0gYThnIHx8ICF5MShlbiwgZXApKSA/IC0xIDogYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhOVAgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSBsQVthOVAgKyBwb3NpdGlvbl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhOVAgPT09IGE4ZyAtIDEgJiYgamdbYUQuZVFdID49IHBvc2l0aW9uICsgYThnIC0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyID0gYUQuZVE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW3BsYXllcl0gIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFILm02KHBsYXllciwgODAwLCBmYWxzZSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBaID0gZnVuY3Rpb24oZW4sIGVwLCBkZWx0YVkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOVA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTh6IHx8IGFELm1GKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5UiA9IE1hdGgubWF4KE1hdGguZmxvb3IoTWF0aC5hYnMoZGVsdGFZKSAvIDQwKSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeTEoZW4sIGVwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5UCA9IGE5UShlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gYTdRKC0xLCBhOVAsIGE4Zyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlQID0gKGE5UCA9PT0gYThnIHx8IGJJLmExQSgpKSA/IC0xIDogYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YVkgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiA8IGFELmVkIC0gYThnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiArPSBNYXRoLm1pbihhRC5lZCAtIGE4ZyAtIHBvc2l0aW9uLCBhOVIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTh4ID0gYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTk2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiAtPSBNYXRoLm1pbihwb3NpdGlvbiwgYTlSKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTh4ID0gYTlQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOTYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE5UShlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZXAgLT0gYmIuZ2FwICsgYThuOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVwIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKGVwIC8gYThvKSAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVwIDwgKGE4ZyAtIDEpICogYThvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoZXAgLyBhOG8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcCA8IGE2aCAtIGE4bikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhOGcgLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZXAgLT0gYTZoIC0gYThuOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE4ZyArIE1hdGguZmxvb3IoZXAgLyBhOG8pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHkxKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuID49IGJiLmdhcCAmJiBlbiA8IGJiLmdhcCArIGE4YyAmJiBlcCA+PSBiYi5nYXAgJiYgZXAgPCBiYi5nYXAgKyBhNmg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGE4aCwgYmIuZ2FwLCBiYi5nYXApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY0soKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBjYW52YXM7DQogICAgICAgICAgICAgICAgICAgIHZhciB4RDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVuOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZXA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhNjIsIGE5UzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdhcDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE5VDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnRTaXplOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTlVOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTlWLCBhOVc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOVg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOVk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOVo7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOWE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOWI7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOWM7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5YSA9IGE5YiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVYgPSBuZXcgQXJyYXkoOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVZbMF0gPSBMKDExNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVZbMV0gPSBhRC5rRSA/IEwoMTE1KSA6IEwoMTE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5VlsyXSA9IEwoMTE3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5VlszXSA9IEwoMTE4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5Vls0XSA9IEwoMTE5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5Vls1XSA9IEwoMTIwLCAwLCBTWzEwMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlWWzZdID0gTCgxMjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlWWzddID0gTCgxMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlXID0gbmV3IEFycmF5KGE5Vi5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlXLmZpbGwoIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYID0gbmV3IEFycmF5KGE5Vi5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzBdID0gYUQua0UgPyAwIDogYUQuanY7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVhbMV0gPSBhRC5rRSA/IGFsLmp3IDogYUQua0c7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVhbMl0gPSBhRC56MzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WFszXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVhbNF0gPSBiSy5kbSgxMDAwMCAqIGFnLmdUWzBdLCBNYXRoLm1heChhRC5qZiwgMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzVdID0gKGFELmRhdGEuaUluY29tZVR5cGUgPT09IDAgPyA3MDAgOiBhRC5kYXRhLmlJbmNvbWVUeXBlID09PSAxID8gYksuZG0oYUQuZGF0YS5pSW5jb21lVmFsdWUgKiA3MDAsIDY0KSA6IGJLLmRtKGFELmRhdGEuaUluY29tZURhdGFbYUQuZVFdICogNzAwLCA2NCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzZdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5ZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzddID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WiA9IGE5ZSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WSA9IG5ldyBBcnJheShhOVYubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYTlWLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVlbYUJdID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5YyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVlbMF0gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVlbMl0gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVlbM10gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOWMgPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVlbM10gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOWMgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTlVID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gTWF0aC5mbG9vcigoYTAuYTEucjQoKSA/IDAuMTY0NiA6IDAuMTI2KSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gTWF0aC5mbG9vcigxLjE4ICogdGhpcy5pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2MiA9IE1hdGguZmxvb3IoMC4wNCAqIHRoaXMuaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBnYXAgPSBNYXRoLmZsb29yKDAuMDM1ICogdGhpcy5pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5VCA9IDAuMDQgKiB0aGlzLmk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVMgPSB0aGlzLmo7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmogLT0gTWF0aC5mbG9vcihhOWMgKiAodGhpcy5qIC0gMiAqIGE2MikgLyBhOVYubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplID0gTWF0aC5mbG9vcigwLjcgKiAoYTlTIC0gYTYyKSAvIGE5Vi5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0ZSA9IGI5LnBnLnJWKDEsIGZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSB0aGlzLmk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gdGhpcy5qOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZm9udCA9IGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5ZihhNGUsIDAuNTc1ICogdGhpcy5pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh4RCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5saW5lV2lkdGggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTc0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVS5hNzQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5ZygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlmKGE0ZSwgaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGE5Vy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVdbYUJdID0gYjkueEQuYTIzKGE5VlthQl0sIGE0ZSwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuID0gaC5pIC0gdGhpcy5pIC0gYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOWggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0ogPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gYmIuZ2FwICsgKChhVS5hNlIoKSAmJiBhZy5sbFthRC5lUV0gIT09IDAgJiYgIWFELmgxKSA/IGFVLmogKyBiYi5nYXAgOiAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFggPSBmdW5jdGlvbihicikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJyIHx8IGE5VSA+PSAxMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOVUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5ZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlnKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuY2xlYXJSZWN0KDAsIDAsIGFXLmksIGFXLmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubWo7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBhVy5pLCBhVy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm42Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZUsgPSBhOWEgPiAwID8gYTlhIDogTWF0aC5zcXJ0KGE5WFs0XSAvIDEwMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIGFXLmogLSBhNjIgLSAxLCBNYXRoLmZsb29yKGVLICogYVcuaSksIGE2Mik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIDAsIGFXLmksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgMSwgYVcuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdChhVy5pIC0gMSwgMCwgMSwgYVcuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBhVy5qIC0gMSwgYVcuaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBhVy5qIC0gYTYyIC0gMSwgYVcuaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGE5Vy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWE5WVthQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGwrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih4RCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5aSA9IE1hdGguZmxvb3IoKChhOVMgLSBhNjIpICsgMiAqIGE5VCkgKiAoYUIgLSBkbCArIDEpIC8gKGE5Vy5sZW5ndGggKyAxKSAtIDAuNyAqIGE5VCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFRleHQoYTlXW2FCXSwgZ2FwLCBhOWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih4RCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCID09PSA1ICYmIGFnLmxsW2FELmVRXSAhPT0gMCAmJiBhZy5naFthRC5lUV0gPj0gYWUuamIoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm5mOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dChhOWUoYUIpLCBhVy5pIC0gZ2FwLCBhOWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dChhOWUoYUIpLCBhVy5pIC0gZ2FwLCBhOWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOWUoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiA8IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTlYW2FCXS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhQiA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOS56ZC5hMzQoYTlYW2FCXSAvIDEwMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFCID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGI5LnpkLmEzNChhOVhbYUJdIC8gMTAwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUIgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYjkuemQuYTM0KGE5WFthQl0gLyAxMDAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhQiA8IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYjkuemQueUooYTlYW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhVy5hOWooYTlYWzddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzeiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE5WFs3XTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTlqID0gZnVuY3Rpb24odmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IE1hdGguZmxvb3IodmFsdWUgLyAxMDAwIC8gNjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gTWF0aC5mbG9vcigodmFsdWUgLSAxMDAwICogNjAgKiBrZCkgLyAxMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZyA8IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtkICsgIjowIiArIGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtkICsgIjoiICsgZWc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhOWsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5bCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sUCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOWQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlvKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOXAoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE5aygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYTlZWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELno0IC0gYUQuejMgPT09IGE5WFswXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WFswXSA9IGFELno0IC0gYUQuejM7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVUrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOWwoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWwuancgLSBhOVhbMF0gPT09IGE5WFsxXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WFsxXSA9IGFsLmp3IC0gYTlYWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlVKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sUCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhOVlbMl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejMgPT09IGE5WFsyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WFsyXSA9IGFELnozOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlVKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOW8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJuLCBwZXI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMm4gPSBiZy5hMm8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJuID0gYWcuZ1RbbEFbMF1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGVyID0gYksuZG0oMTAwMDAgKiBhMm4sIE1hdGgubWF4KGFELmpmLCAxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVhbM10gPSBhMm47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTlYWzRdID09PSBwZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhOVUrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5WFs0XSA9IHBlcjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOXAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDggJiYgYTlxKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTlYWzNdIDwgYUQuamYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWE5cigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYlEueWUuejAoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhOXIoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nN1thbC5qeFthQl1dLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE5cSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAyOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhhQikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlEueWUuejAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE5bSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOXMgPSBhZS5hOXQoYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE5cyA9PT0gYTlYWzVdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzVdID0gYTlzOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlVKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTlkKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmdUW2FELmVRXSA9PT0gYTlYWzZdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzZdID0gYWcuZ1RbYUQuZVFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlVKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTluKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTlYWzddICs9IGJlLmE5dTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGE5ZSg3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhOVogIT09IHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlaID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlVICs9IDEwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE5diA9IGZ1bmN0aW9uKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0osIGE5dywgZGw7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgJSAyID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVYubFgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCID09PSBhRC5hM1MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOWEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5ZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiA9PT0gLTEgJiYgYTliID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTl3ID0gYTlhOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmdwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlhID0gYUIgLyBhRC5hM1M7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlnKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE5YSAhPT0gYTl3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGwgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0ogPSBkbCAtIGFCICogMzkyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5YiA9IChhQiA9PT0gMCB8fCBzSiA8IGE5YikgPyBzSiA6IGE5YjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGE5YSA9IChkbCAtIGE5YikgLyAoYUQuYTNTICogMzkyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5YSA9IGE5YSA+IDEgPyAxIDogYTlhOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTlnKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTlhICE9PSBhOXc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoY2FudmFzLCBlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY0woKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBoTjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE5eDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGk7DQogICAgICAgICAgICAgICAgICAgIHZhciBqOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTdBOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTl5Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTl6Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYTZTOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbHk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQTA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBhQTAgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTdBID0gMC42MTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5eSA9IDAuMDc7DQogICAgICAgICAgICAgICAgICAgICAgICBhOXogPSAwLjA5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTZTID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGx5ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmExLnI0KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gTWF0aC5mbG9vcigwLjY5ICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBNYXRoLmZsb29yKDAuNSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGFBMShpLCBhNUUoaC5pIC0gMiAqIGJiLmdhcCwgMTApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBhQTEoaSwgTWF0aC5mbG9vcihhNUUoKGguaiAtIDIgKiBiYi5nYXApLCAzKSAqIDMuNTcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBNYXRoLmZsb29yKDAuMjggKiBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBMigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oZjgsIGFBMywgYTZ4LCBhQTQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQTQgJiYgYUEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUEwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE5eCA9IGE2eCA/IDIxIDogKGY4ID8gMSA6IDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUi5hNnMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGx5ID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBhNlMgPSBhQTMgPyAxIDogMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaE4gfHwgYTZTID49IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNlMgKz0gMC4wMDA1ICogKGJlLmVGIC0gbHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTZTID0gYTZTID4gMSA/IDEgOiBhNlM7DQogICAgICAgICAgICAgICAgICAgICAgICBseSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoTiB8fCBhNlMgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVuIC09IE1hdGguZmxvb3IoKGguaSAtIGkpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICBlcCAtPSB4OSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgMCB8fCBlcCA8IDAgfHwgZW4gPiBpIHx8IGVwID4gaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA+IGkgLSBqIC8gMyAmJiBlcCA8IGogLyAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaE4gfHwgYTZTIDw9IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5nbG9iYWxBbHBoYSA9IGE2UzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShjYW52YXMsIE1hdGguZmxvb3IoKGguaSAtIGkpIC8gMiksIHg5KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZ2xvYmFsQWxwaGEgPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24geDkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBNYXRoLmZsb29yKChoLmkgLSBpKSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgYVIuaiArIDIgKiBiYi5nYXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaC5qIC0gaiAtIDQgKiBiYi5nYXAgLSBhUi5qOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGguaiAtIGogLSAyICogYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBMigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeEQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1DID0gTWF0aC5mbG9vcigxICsgaiAvIDQwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmNsZWFyUmVjdCgwLCAwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1qOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QobUMsIG1DLCBpIC0gMiAqIG1DLCBqIC0gMiAqIG1DKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVKb2luID0gImJldmVsIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVXaWR0aCA9IDIgKiBtQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZVN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5zdHJva2VSZWN0KG1DLCBtQywgaSAtIDIgKiBtQywgaiAtIDIgKiBtQyk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IGFiLmdldChhOXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFBNSA9IGYxLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFBNiA9IGYxLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNGogPSAoYTl4ID09PSAxID8gMC44NSA6IGE5eCA9PT0gMjEgPyAwLjY2NiA6IDAuOSkgKiBhN0EgKiBqIC8gYUE2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuc2V0VHJhbnNmb3JtKGE0aiwgMCwgMCwgYTRqLCBNYXRoLmZsb29yKChpIC0gYTRqICogYUE1KSAvIDIpLCBNYXRoLmZsb29yKChqIC0gYTRqICogYUE2KSAvIDIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmRyYXdJbWFnZShmMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgTWF0aC5mbG9vcihpIC0gYTl6ICogaiAtIGE5eSAqIGogLSBtQyksIE1hdGguZmxvb3IobUMgKyBhOXkgKiBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQTcoeEQsIE1hdGguZmxvb3IoYTl6ICogaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBNyh4RCwgZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVXaWR0aCA9IE1hdGguZmxvb3IoMSArIGogLyA4MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5zdHJva2VTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5tb3ZlVG8oMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5saW5lVG8oZWcsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELm1vdmVUbygwLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5saW5lVG8oZWcsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuc3Ryb2tlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZEooKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQTg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQTkgPSBuZXcgVWludDhBcnJheSg1KTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFBQSA9IG5ldyBVaW50OEFycmF5KDUpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFBQiA9IG5ldyBhQUMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYmkuZUQuZGF0YVsxMTldLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFBOS5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQTlbYUJdID0gKGY4ID4+ICgyICogYUIpKSAlIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUE4ID0gW0woMTIzKSwgTCgxMjQpLCBMKDEyNSwgW2JXLmFBRFsyOF1dKSwgTCgxMjYsIFtiVy5hQURbMjZdXSksIEwoMTI3LCBbYlcuYUFEWzBdXSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQUIuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFCLmlxKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0SyA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPiAxICYmIGJJLnE5KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFBRShpZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5hNUsoYUE4W2lkXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQUUoZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQTlbZTFdID09PSAzIHx8IGFBQVtlMV0gPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhQUFbZTFdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC42KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhQTlbZTFdKys7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFBOS5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCArPSBhQTlbYUJdIDw8ICgyICogYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTE5LCBmOCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQUMoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQUY7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBRiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQUcoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQUgoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQUkoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQUooKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFBSygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUFHKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSAzMCAhPT0gOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEubDMoOTApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUFGID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBSCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwWSA9IGFOLmE1Zyg5NTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS5raChwWS5wbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5hNFEoOTU2LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBhRC5oViA/IGFBTCgpIDogYUFNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ0QgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ueFcoMCwgTCgxMjgsIFthZy54WFtnRF1dKSwgOTU2LCBnRCwgYkEubW0sIGJBLm1qLCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQU0oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFOID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2MgPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQU8gPSBqZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBhQU47IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBrY1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBT1tnRF0gIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQUwoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBiZy5sNygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJmLmtIW2lkXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZyA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxBW2VnIC0gMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5cCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSB5cFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVlW2dEXSAhPT0gaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQUooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcFkgPSBhTi5hNWcoOTU3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcFkgfHwgIXBZLmE1QSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChwWS5hNUEuZVMgPDwgMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE0USg5NTcsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBSygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFuLmlhLmt0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVEID0gYW4uaWEuZUQ7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZVMgPSBlRFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVYKGVTIDw8IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDAsIEwoMTI5LCBbYkwuZW8oZVMpLCBiTC5lcShlUyldKSwgOTU3LCAwLCBiQS5tbSwgYkEubWosIC0xLCB0cnVlLCB1bmRlZmluZWQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV6OiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVM6IGVTDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRLKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFBUCA9IG5ldyBhQVEoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVAucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQVEoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFSID0gZG9jdW1lbnQuaGVhZC5xdWVyeVNlbGVjdG9yKCJzdHlsZSNzcyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQVIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQVIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFBUi5pZCA9ICJzcyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChhQVIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUFSLnNoZWV0LmNzc1J1bGVzLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUFSLnNoZWV0LmRlbGV0ZVJ1bGUoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE3SSA9ICI6Oi13ZWJraXQtc2Nyb2xsYmFyIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQVMgPSBiOS5wZy5wcShiYi5yWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFggPSBiOS5wZy5wcShNYXRoLm1heChiOS5wZy5xeigwLjAxMiksIDgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUFSLnNoZWV0Lmluc2VydFJ1bGUoYTdJICsgInt3aWR0aDoiICsgaFggKyAiO2hlaWdodDoiICsgaFggKyAiO30iLCBhQVIuc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQVIuc2hlZXQuaW5zZXJ0UnVsZShhN0kgKyAiLXRodW1ie2JhY2tncm91bmQtY29sb3I6d2hpdGU7fSIsIGFBUi5zaGVldC5jc3NSdWxlcy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFBUi5zaGVldC5pbnNlcnRSdWxlKGE3SSArICItdHJhY2t7YmFja2dyb3VuZDoiICsgYkEubWkgKyAiO30iLCBhQVIuc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQVIuc2hlZXQuaW5zZXJ0UnVsZShhN0kgKyAiLXRyYWNrOmhvcml6b250YWx7Ym9yZGVyLXRvcDoiICsgYUFTICsgU1sxMjBdLCBhQVIuc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQVIuc2hlZXQuaW5zZXJ0UnVsZShhN0kgKyAiLXRyYWNrOnZlcnRpY2Fse2JvcmRlci1sZWZ0OiIgKyBhQVMgKyBTWzEyMF0sIGFBUi5zaGVldC5jc3NSdWxlcy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFBUi5zaGVldC5pbnNlcnRSdWxlKGE3SSArICItYnV0dG9ue2Rpc3BsYXk6bm9uZTt9IiwgYUFSLnNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImVycm9yIDM0MjU6ICIgKyBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUFSLnNoZWV0LmNzc1J1bGVzLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUFSLnNoZWV0LmRlbGV0ZVJ1bGUoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZEkoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFUID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWMgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM04gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVUgPSBbMCwgMCwgMCwgMF07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFWID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEzTiA9IHRoaXMuYTNOIHx8IHRoaXMubWM7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWMgJiYgKCF0aGlzLmFBVCB8fCAhdGhpcy5hM04pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1DID0gYlouYUFXWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1EID0gYlouYUFXWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1QID0gYlouYUFXWzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1RID0gYlouYUFXWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgbUMgPSBtQyA8IHRoaXMuYUFVWzBdID8gdGhpcy5hQVVbMF0gOiBtQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1EID0gbUQgPCB0aGlzLmFBVVsxXSA/IHRoaXMuYUFVWzFdIDogbUQ7DQogICAgICAgICAgICAgICAgICAgICAgICBtUCA9IG1QID4gdGhpcy5hQVVbMl0gPyB0aGlzLmFBVVsyXSA6IG1QOw0KICAgICAgICAgICAgICAgICAgICAgICAgbVEgPSBtUSA+IHRoaXMuYUFVWzNdID8gdGhpcy5hQVVbM10gOiBtUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWMgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFUID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobUMgPT09IHRoaXMuYUFVWzBdICYmIG1EID09PSB0aGlzLmFBVVsxXSAmJiBtUCA9PT0gdGhpcy5hQVVbMl0gJiYgbVEgPT09IHRoaXMuYUFVWzNdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM08oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobVAgPj0gbUMgJiYgbVEgPj0gbUQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhM2YucHV0SW1hZ2VEYXRhKGEzZywgMCwgMCwgbUMsIG1ELCBtUCAtIG1DICsgMSwgbVEgLSBtRCArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM08gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmEzTiAmJiB0aGlzLmFBVVsyXSA+PSB0aGlzLmFBVVswXSAmJiB0aGlzLmFBVVszXSA+PSB0aGlzLmFBVVsxXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEzZi5wdXRJbWFnZURhdGEoYTNnLCAwLCAwLCB0aGlzLmFBVVswXSwgdGhpcy5hQVVbMV0sIHRoaXMuYUFVWzJdIC0gdGhpcy5hQVVbMF0gKyAxLCB0aGlzLmFBVVszXSAtIHRoaXMuYUFVWzFdICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEzTiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56QyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYUFVWzJdID49IHRoaXMuYUFVWzBdICYmIHRoaXMuYUFVWzNdID49IHRoaXMuYUFVWzFdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTNmLnB1dEltYWdlRGF0YShhM2csIDAsIDAsIHRoaXMuYUFVWzBdLCB0aGlzLmFBVVsxXSwgdGhpcy5hQVVbMl0gLSB0aGlzLmFBVVswXSArIDEsIHRoaXMuYUFVWzNdIC0gdGhpcy5hQVVbMV0gKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWMgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBVVswXSA9IGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVVbMV0gPSBiUi5lczsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFVWzJdID0gdGhpcy5hQVVbM10gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yIChlbiA9IDE7IGVuIDwgYlIuZXIgLSAxOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlcCA9IGJSLmVzIC0gMjsgZXAgPiAxOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQVhbYWMud2koZW4sIGVwKSArIDJdID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBVVswXSA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3A6IGZvciAoZXAgPSAxOyBlcCA8IGJSLmVzIC0gMTsgZXArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSBiUi5lciAtIDI7IGVuID4gMTsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUFYW2FjLndpKGVuLCBlcCkgKyAyXSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVVbMV0gPSBlcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGxvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsb29wOiBmb3IgKGVuID0gYlIuZXIgLSAyOyBlbiA+IDA7IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gYlIuZXMgLSAyOyBlcCA+IDE7IGVwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBWFthYy53aShlbiwgZXApICsgMl0gPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFVWzJdID0gZW47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yIChlcCA9IGJSLmVzIC0gMjsgZXAgPiAwOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlbiA9IGJSLmVyIC0gMjsgZW4gPiAxOyBlbi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQVhbYWMud2koZW4sIGVwKSArIDJdID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBVVszXSA9IGVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIEwodmFsdWUsIGFBWSwgdUwpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBOOw0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBTWzQ2XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBiNi5hQVpbdmFsdWVdOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodUwgJiYgYjYuYUFhKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gdUw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKCFhQVkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhQVkubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCAzOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi5yZXBsYWNlKCJ7IiArICgxMCAqIGV6ICsgYUIpICsgIn0iLCBhQVlbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGJ6KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBuZXcgYUFiKCk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQWMgPSAobmV3IGFBZCgpKS5MODQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFaID0gYUFjOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUFlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBZigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBZygpICYmIGFBaCgpICYmIGFBaSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUFlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFogPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJmLmRZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRS5kWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmQuZFkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJjLmRZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm4gPSBuZXcgZHIoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFhID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hQVogPT09IGFBYyB8fCAhYUFjLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBZigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmOCA9IGJpLmVELmRhdGFbMTJdLnZhbHVlLnNwbGl0KCItIilbMF0udG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmOCA9PT0gImVuIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI2LmFBWiA9IGFBYzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQWcoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmkuZUQuZGF0YVsxMl0udmFsdWUgPT09IGJpLmVELmRhdGFbMTQ1XS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQWgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmkuZUQuZGF0YVsxNDZdLnZhbHVlID4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQWkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBiaS5lRC5kYXRhWzE0Nl0udmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGJpLnB5LnVSKGVnLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZy5sZW5ndGggIT09IGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5wcC5hMWcoZykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUFqKGcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFBaihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZWc7IGorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbal0gPSBnW2pdLnJlcGxhY2UoIiYjMzk7IiwgIiciKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQWsgPSBiaS5weS51UihlZywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgIT09IGFBay5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LnBwLmExZyhhQWspKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUFjLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOEIgPSBuZXcgQXJyYXkoa2QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFBbCA9IGtkID09PSBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IE1hdGgubWluKGVnLCBrZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwga2Q7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOEJbYUJdID0gYUFjW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgPCBlZyAmJiBhQWtbYUJdID09PSBhOEJbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE4QlthQl0gPSBnW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFBbCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gMDsgZjAgPCBnODsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUFrW2YwXSA9PT0gYThCW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYThCW2FCXSA9IGdbZjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiNi5hQVogPSBhOEI7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUFsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFtID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFBZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFBZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBYy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFuID0gYmkuZUQuZGF0YVsxMl0udmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYUFwKDAsIGFBbi5zbGljZSgwLCAyMCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQXEgPSBmdW5jdGlvbihnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZy5sZW5ndGggIT09IGFBYy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBWiA9IGc7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxNDUsIGJpLmVELmRhdGFbMTJdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE0NiwgZy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucHkudVgoZywgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucHkudVgoYUFjLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gMCAmJiB0LnJ2ID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LmFBcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQXMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gbmF2aWdhdG9yLmxhbmd1YWdlczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZyB8fCAhZy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzAsIDBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFBdCA9IE1hdGgubWF4KGI2LmRhdGEuYUF1KGdbMF0pLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbYUF0LCBhQXRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFthQXQsIE1hdGgubWF4KGI2LmRhdGEuYUF1KGdbMV0pLCAwKV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQWIoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZyA9IFsiZW4iLCAiYWEiLCAiYWIiLCAiYWNlIiwgImFjaCIsICJhZiIsICJhayIsICJhbHoiLCAiYW0iLCAiYXIiLCAiYXMiLCAiYXYiLCAiYXdhIiwgImF5IiwgImF6IiwgImJhIiwgImJhbCIsICJiYW4iLCAiYmJjIiwgImJjaSIsICJiZSIsICJiZW0iLCAiYmVyIiwgImJlci1MYXRuIiwgImJldyIsICJiZyIsICJiaG8iLCAiYmlrIiwgImJtIiwgImJtLU5rb28iLCAiYm4iLCAiYm8iLCAiYnIiLCAiYnMiLCAiYnRzIiwgImJ0eCIsICJidWEiLCAiY2EiLCAiY2UiLCAiY2ViIiwgImNnZyIsICJjaCIsICJjaGsiLCAiY2htIiwgImNrYiIsICJjbmgiLCAiY28iLCAiY3JoIiwgImNycyIsICJjcyIsICJjdiIsICJjeSIsICJkYSIsICJkZSIsICJkaW4iLCAiZG9pIiwgImRvdiIsICJkdiIsICJkeXUiLCAiZHoiLCAiZWUiLCAiZWwiLCAiZW8iLCAiZXMiLCAiZXQiLCAiZXUiLCAiZmEiLCAiZmEtQUYiLCAiZmYiLCAiZmkiLCAiZmoiLCAiZm8iLCAiZm9uIiwgImZyIiwgImZ1ciIsICJmeSIsICJnYSIsICJnYWEiLCAiZ2QiLCAiZ2wiLCAiZ24iLCAiZ29tIiwgImd1IiwgImd2IiwgImhhIiwgImhhdyIsICJoZSIsICJoaSIsICJoaWwiLCAiaG1uIiwgImhyIiwgImhyeCIsICJodCIsICJodSIsICJoeSIsICJpYmEiLCAiaWQiLCAiaWciLCAiaWxvIiwgImlzIiwgIml0IiwgIml3IiwgImphIiwgImphbSIsICJqdiIsICJqdyIsICJrYSIsICJrYWMiLCAia2VrIiwgImtnIiwgImtoYSIsICJrayIsICJrbCIsICJrbSIsICJrbiIsICJrbyIsICJrciIsICJrcmkiLCAia3R1IiwgImt1IiwgImt2IiwgImt5IiwgImxhIiwgImxiIiwgImxnIiwgImxpIiwgImxpaiIsICJsbW8iLCAibG4iLCAibG8iLCAibHQiLCAibHRnIiwgImx1byIsICJsdXMiLCAibHYiLCAibWFkIiwgIm1haSIsICJtYWsiLCAibWFtIiwgIm1mZSIsICJtZyIsICJtaCIsICJtaSIsICJtaW4iLCAibWsiLCAibWwiLCAibW4iLCAibW5pLU10ZWkiLCAibXIiLCAibXMiLCAibXMtQXJhYiIsICJtdCIsICJtd3IiLCAibXkiLCAibmRjLVpXIiwgIm5lIiwgIm5ldyIsICJuaGUiLCAibmwiLCAibm8iLCAibnIiLCAibnNvIiwgIm51cyIsICJueSIsICJvYyIsICJvbSIsICJvciIsICJvcyIsICJwYSIsICJwYS1BcmFiIiwgInBhZyIsICJwYW0iLCAicGFwIiwgInBsIiwgInBzIiwgInB0IiwgInB0LVBUIiwgInF1IiwgInJuIiwgInJvIiwgInJvbSIsICJydSIsICJydyIsICJzYSIsICJzYWgiLCAic2NuIiwgInNkIiwgInNlIiwgInNnIiwgInNobiIsICJzaSIsICJzayIsICJzbCIsICJzbSIsICJzbiIsICJzbyIsICJzcSIsICJzciIsICJzcyIsICJzdCIsICJzdSIsICJzdXMiLCAic3YiLCAic3ciLCAic3psIiwgInRhIiwgInRjeSIsICJ0ZSIsICJ0ZXQiLCAidGciLCAidGgiLCAidGkiLCAidGl2IiwgInRrIiwgInRsIiwgInRuIiwgInRvIiwgInRwaSIsICJ0ciIsICJ0cnAiLCAidHMiLCAidHQiLCAidHVtIiwgInR5IiwgInR5diIsICJ1ZG0iLCAidWciLCAidWsiLCAidXIiLCAidXoiLCAidmUiLCAidmVjIiwgInZpIiwgIndhciIsICJ3byIsICJ4aCIsICJ5aSIsICJ5byIsICJ5dWEiLCAieXVlIiwgInphcCIsICJ6aCIsICJ6aC1DTiIsICJ6aC1UVyIsICJ6dSIsICJuYiIsICJmaWwiLCAic2giXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQXYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQXcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFBdy5wdXNoKGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQXggPSBiaS5lRC5kYXRhWzEyXS51TDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBd1thQl0gPT09IGFBeCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQXcuc3BsaWNlKGFCLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWctLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUF3LnNvcnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVnKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhQXcudW5zaGlmdChhQXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEludGwgPT09IFNbMjddKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQXc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQXkgPSBuZXcgSW50bC5EaXNwbGF5TmFtZXMoW2FBd1thQl1dLHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJsYW5ndWFnZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGFBeS5vZihhQXdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBOICE9PSBhQXdbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQXdbYUJdID0gYUF3W2FCXSArICI6ICIgKyBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3IgMzY0NjogIiArIGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBdzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUF6ID0gZnVuY3Rpb24oYUIwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSBiaS5lRC5kYXRhWzEyXS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFCMC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocE4gPT09IGFCMFthQl0uc3BsaXQoIjoiKVswXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFBdSA9IGZ1bmN0aW9uKGFCMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQjEgfHwgYUIxLmxlbmd0aCA8IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFCMSA9IChhQjEuc3BsaXQoIi0iKVswXSkudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIxID09PSBnW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUFkKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLkw4NCA9IFsiTm8gQWRtaW4iLCAiSGVscGVyIiwgIkp1bmlvciBNb2RlcmF0b3IiLCAiTW9kZXJhdG9yIiwgIlNlbmlvciBNb2RlcmF0b3IiLCAiTGVhZCBNb2RlcmF0b3IiLCAiSGVhZCBBZG1pbiIsICJWZXJ5IEVhc3kiLCAiRWFzeSIsICJOb3JtYWwiLCAiSGFyZCIsICJWZXJ5IEhhcmQiLCAiSW1wb3NzaWJsZSIsICJUeXBlIHlvdXIgbWVzc2FnZSBoZXJlLi4uIiwgIlNlbmQiLCAiQWN0aXZhdGVkIiwgIlRvcCBDbGFuIiwgIkJlc3QgQ2xhbiBNZW1iZXIiLCAiVG9wIEFkbWluIiwgIkJlc3QgMXYxIFBsYXllciIsICJCZXN0IEJhdHRsZSBSb3lhbGUgUGxheWVyIiwgIlJpY2hlc3QgUGxheWVyIiwgIlRvcCBQYXRyZW9uIiwgIkxvYmJ5IiwgIllvdSBoYXZlIGVhcm5lZCBhbiBhZGRpdGlvbmFsIHsxMH0gZ29sZCEiLCAiezB9IGhhcyBlYXJuZWQgYW4gYWRkaXRpb25hbCB7MTF9IGdvbGQhIiwgIlRlYW0gezB9IiwgIlRlYW0gezB9IGhhcyB3b24gdGhlIGdhbWUhIiwgIllvdSBoYXZlIGVhcm5lZCBhIHBhcnRpY2lwYXRpb24gcmV3YXJkIG9mIHsxMH0gZ29sZC4iLCAiVGhlIHByaXplIG1vbmV5IGhhcyBiZWVuIGRpc3RyaWJ1dGVkIGFzIGZvbGxvd3M6IiwgImFuZCB7MTB9IG1vcmUiLCAiWW91IGhhdmUgZWFybmVkIHsxMH0gZ29sZC4iLCAiWW91IGhhdmUgZWFybmVkIHsxMH0gYmF0dGxlIHJveWFsZSBwb2ludHMhIiwgIkNsYW4gezB9IGhhcyB3b24gezExfSBwb2ludHMuIiwgIllvdSBoYXZlIGVhcm5lZCB7MTB9IGNsYW4gcG9pbnRzISIsICJZb3UgaGF2ZSBlYXJuZWQgYW4gYWRkaXRpb25hbCB7MTB9IGdvbGQgYmVjYXVzZSB5b3UgcGxheWVkIGZvciB7MX0uIiwgIkNoZWNrIGNsYW4gcmVzdWx0cyBhdCB0aGlzIHBhZ2U6ICIsICJCYWNrIiwgIkVycm9yIiwgIkVycm9yIHsxMH0iLCAiTm90IEVub3VnaCBHb2xkISIsICJZb3UgbmVlZCBtb3JlIGdvbGQgdG8gcGVyZm9ybSB0aGlzIGFjdGlvbi4iLCAiUXVpdCBHYW1lIiwgIk1vcmUiLCAiVGhpcyBpcyBhIGNvbnRlc3QhIiwgIkFjY2VwdCIsICJZb3UgaGF2ZSBjb25xdWVyZWQgezB9LiIsICJZb3UgaGF2ZSBiZWVuIGNvbnF1ZXJlZCBieSB7MH0uIiwgIkNvbmdyYXR1bGF0aW9ucyEgWW91IGhhdmUgd29uIHRoZSBnYW1lLiIsICJ7MH0gaGFzIHdvbiB0aGUgZ2FtZS4iLCAiezB9IGhhcyBicm9rZW4gdGhlIG5vbi1hZ2dyZXNzaW9uIHBhY3QuIiwgInswfSBpcyBhdHRhY2tpbmcgeW91ISIsICJDaG9vc2UgeW91ciBzdGFydCBwb3NpdGlvbiEiLCAiWW91IGhhdmUgc3VycmVuZGVyZWQhIiwgIlRoZSBnYW1lIGhhcyBlbmRlZCBpbiBhIHN0YWxlbWF0ZSEiLCAiRXJyb3I6IHsxMH0iLCAiezB9IGhhcyBiZWVuIGltbW9ydGFsaXplZCEiLCAiTmV1dHJhbCBMYW5kOiB7MH0iLCAiUGxheWVyOiB7MH0iLCAiU3RyZW5ndGg6IHsxMH0iLCAiVGVycml0b3J5OiB7MTB9IiwgIlRlYW0iLCAiQm90IERpZmZpY3VsdHkiLCAiSW5kZXg6IHsxMH0iLCAiQ29vcmRpbmF0ZXM6IHsxMH0iLCAiTW91bnRhaW46IHsxMH0iLCAiV2F0ZXI6IHsxMH0iLCAiU2hpcCBPd25lcjogezB9IiwgIk1lc3NhZ2UgdG8gezB9IiwgIkh1bWFuaXR5IHRyaXVtcGhzISBUaGUgdW5kZWFkIGhhdmUgYmVlbiBiZWF0ZW4gYmFjay4iLCAiVGhlIFJlc2lzdGFuY2UiLCAiTWFua2luZCdzIGVyYSBlbmRzLCBvdmVycnVuIGJ5IHRoZSByZWxlbnRsZXNzIHRpZGUgb2YgdGhlIHVuZGVhZC4iLCAiVGhlIFZpcnVzIiwgIklmIHBlYWNlIGlzIGFncmVlZCB1cG9uLCB0aGUgZ2FtZSBlbmRzIGluIGEgc3RhbGVtYXRlLiIsICJJZiBwZWFjZSBpcyBhZ3JlZWQgdXBvbiwgdGhlIGxhcmdlc3QgdGVycml0b3J5IGhvbGRlciB3aW5zIHRoZSBnYW1lLiIsICJZb3UgaGF2ZSBzaWduZWQgYSBub24tYWdncmVzc2lvbiBwYWN0IHdpdGggezB9LiIsICJZb3UgaGF2ZSBhc2tlZCB7MH0gdG8gc2lnbiBhIG5vbi1hZ2dyZXNzaW9uIHBhY3QuIiwgInswfSBoYXMgYWNjZXB0ZWQgdGhlIG5vbi1hZ2dyZXNzaW9uIHBhY3QuIiwgInswfSByZXF1ZXN0cyBhIG5vbi1hZ2dyZXNzaW9uIHBhY3QuIiwgIllvdSBoYXZlIGFza2VkIHsxMH0gcGxheWVycyB0byBhdHRhY2sgezF9LiIsICJZb3UgaGF2ZSBhc2tlZCB7MH0gdG8gYXR0YWNrIHsxfS4iLCAiezB9IHN1Z2dlc3RzIHlvdSBhdHRhY2sgezF9LiIsICJZb3UgaGF2ZSBleHBvcnRlZCAxIHJlc291cmNlIHRvIHswfS4iLCAiWW91IGhhdmUgZXhwb3J0ZWQgezEwfSByZXNvdXJjZXMgdG8gezF9LiIsICJBIHRheCBvZiAxIHVuaXQgaGFzIGJlZW4gZGVkdWN0ZWQuIiwgIkEgdGF4IG9mIHsxMH0gdW5pdHMgaGFzIGJlZW4gZGVkdWN0ZWQuIiwgIkEgYm90ICh7MH0pIGhhcyBzdXBwb3J0ZWQgeW91IHdpdGggMSByZXNvdXJjZS4iLCAiQSBib3QgKHswfSkgaGFzIHN1cHBvcnRlZCB5b3Ugd2l0aCB7MTF9IHJlc291cmNlcy4iLCAiezB9IGhhcyBzdXBwb3J0ZWQgeW91IHdpdGggMSByZXNvdXJjZS4iLCAiezB9IGhhcyBzdXBwb3J0ZWQgeW91IHdpdGggezExfSByZXNvdXJjZXMuIiwgIk1hcDogezB9IiwgIkRpbWVuc2lvbjogezEwfSIsICJPdmVyYWxsIFBpeGVsczogezEwfSIsICJMYW5kOiB7MTB9IiwgIk1vdW50YWluczogezEwfSIsICJGdWxsIHNlbmRpbmcgaXMgZGlzYWJsZWQuIiwgInswfSBoYXMgYmVlbiBjb25xdWVyZWQgYnkgezF9LiIsICJ7MH0gaGFzIGxlZnQgdGhlIGdhbWUuIiwgInswfSBoYXMgc3VycmVuZGVyZWQuIiwgInswfSBoYXMgam9pbmVkIHRoZSBnYW1lLiIsICJ7MTB9IHBsYXllcnMgaGF2ZSBiZWVuIGNvbnF1ZXJlZC4iLCAiezEwfSBwbGF5ZXJzIGhhdmUgbGVmdCB0aGUgZ2FtZS4iLCAiezEwfSBwbGF5ZXJzIGhhdmUgc3VycmVuZGVyZWQuIiwgIk5leHQgQ29udGVzdDogIiwgIllPVSBIQVZFIENPTlFVRVJFRCIsICJZT1UgSEFWRSBCRUVOIENPTlFVRVJFRCBCWSIsICJUSEUgR0FNRSBIQVMgQkVFTiBXT04gQlkiLCAiTUFQOiIsICJ7MH0gaGFzIGNhbGxlZCB0aGUgcGVhY2Ugdm90ZS4iLCAiezB9IGhhcyB2b3RlZCBmb3IgcGVhY2UuIiwgInswfSBoYXMgcmVqZWN0ZWQgcGVhY2UuIiwgInNlY29uZCBwbGF5ZWQiLCAic2Vjb25kcyBwbGF5ZWQiLCAiTEVBREVSQk9BUkQiLCAiSHVtYW5zIiwgIlBsYXllcnMiLCAiQm90cyIsICJTcGVjdGF0b3JzIiwgIlRocmVzaG9sZCIsICJQZXJjZW50YWdlIiwgIkdyb3d0aCIsICJJbmNvbWUiLCAiVGltZSIsICJIaW50OiBUaGUgdG9wIDkgZW1vamlzIGFyZSBvcmRlcmVkIGJ5IHVzYWdlLiIsICJIaW50OiBTZWxlY3QgYSBib2F0IHRvIHNlbmQgaXQgdG8gYSBuZXcgbG9jYXRpb24uIiwgIkhpbnQ6IENhbGwgdGhlIHBlYWNlIHZvdGUgYnkgcHJlc3NpbmcgezB9LiIsICJIaW50OiBBZGQgdHJvb3BzIHRvIHlvdXIgd2Vha2VzdCBvbmdvaW5nIGF0dGFjayB3aXRoIHswfS4iLCAiSGludDogSG92ZXIgd2l0aCB0aGUgbW91c2Ugb3ZlciBhIHBsYXllciBhbmQgcHJlc3MgezB9IHRvIGF0dGFjayB0aGVtLiIsICJ7MH0gc3RpbGwgbmVlZHMgdG8gYmUgY29ucXVlcmVkISIsICJBIG5ldXRyYWwgcGl4ZWwgYXQgcG9zaXRpb24gKHsxMH0sIHsxMX0pIHN0aWxsIG5lZWRzIHRvIGJlIGNvbnF1ZXJlZCEiLCAiU2hvdyBBY2NvdW50IiwgIk1vZGVyYXRpb24gQWN0aW9ucyIsICJSZXBvcnQgVXNlciIsICJNZW50aW9uIiwgIkxvYWRpbmciLCAiezB9IGhhcyBkZWZlYXRlZCB7MX0hIiwgIldoaXRlIEFyZW5hIiwgIkJsYWNrIEFyZW5hIiwgIklzbGFuZCIsICJNb3VudGFpbnMiLCAiRGVzZXJ0IiwgIlN3YW1wIiwgIldoaXRlIFBsYWlucyIsICJDbGlmZnMiLCAiUG9uZCIsICJIYWxvIiwgIkV1cm9wZSIsICJXb3JsZCIsICJDYXVjYXNpYSIsICJBZnJpY2EiLCAiTWlkZGxlIEVhc3QiLCAiU2NhbmRpbmF2aWEiLCAiTm9ydGggQW1lcmljYSIsICJTb3V0aCBBbWVyaWNhIiwgIkFzaWEiLCAiQXVzdHJhbGlhIiwgIklzbGFuZCBLaW5nZG9tIiwgIlJlZnJlc2giLCAiUHVibGljIFByb2ZpbGUiLCAi8J+niCBHb2xkIiwgIk1vbm9wb2xpc3QiLCAiQmFua2VyIiwgIk1pbmVyIiwgIlNhdmVyIiwgIlN0YXJ0ZXIiLCAiQWNjb3VudCBCYWxhbmNlOiAiLCAiUmFuazogIiwgIlN0YXR1czogIiwgIlBsYXkgbXVsdGlwbGF5ZXIgZ2FtZXMgdG8gZWFybiBnb2xkLiBBY2NvdW50cyB3aXRob3V0IGdvbGQgd2lsbCBiZSBkZWxldGVkISBFYWNoIGRheSwgeW91IHdpbGwgbG9zZSAwLjUwIGdvbGQgb3IgMC4wMSUgb2YgeW91ciBiYWxhbmNlLCB3aGljaGV2ZXIgYW1vdW50IGlzIGhpZ2hlci4iLCAiQnV0dG9ucyB3aXRoIHllbGxvdyBmb250IGNvbG9yIHVzZSBhIHNtYWxsIGFtb3VudCBvZiBnb2xkLCB3aGljaCBpcyB0aGVuIHJlZGlyZWN0ZWQgYmFzZWQgb24gdGhlIHNwZWNpZmljIGFjdGlvbiB0YWtlbi4iLCAiR29sZCBpcyB0aGUgZnVlbCB0aGF0IGtlZXBzIHlvdXIgYWNjb3VudCBydW5uaW5nISBLZWVwIHRoZSBiYWxhbmNlIHVwISIsICJHb2xkIFRyYW5zZmVyIiwgIkNvbmZpcm0iLCAiQ2FuY2VsIiwgIllvdSBhcmUgYWJvdXQgdG8gc2VuZCB7MTB9IGdvbGQgZnJvbSB0aGUgU291cmNlIEFjY291bnQgezF9LiBUaGUgdHJhbnNhY3Rpb24gZmVlIGlzIHsxMn0gZ29sZC4gVGhlIFRhcmdldCBBY2NvdW50ICh7M30pIHdpbGwgcmVjZWl2ZSB7MTR9IGdvbGQuIiwgIkFjY291bnQgTmFtZSIsICJDb3B5IiwgIlBhc3N3b3JkIiwgIlNob3ciLCAiSGlkZSIsICJSZXF1ZXN0IE5ldyBQYXNzd29yZCIsICJTZWN1cml0eSBUaXAiLCAiVG8gc2FmZWd1YXJkIHlvdXIgYWNjb3VudCwgbmV2ZXIgZGlzY2xvc2UgeW91ciBwYXNzd29yZCB0byBhbnlvbmUuIFdlIHdpbGwgbmV2ZXIgYXNrIGZvciB5b3VyIHBhc3N3b3JkLCBhcyB3ZSBkbyBub3QgcmVxdWlyZSBpdCBmb3IgYW55IHNlcnZpY2UuIiwgIklmIHlvdSBoYXZlIGFjY2Vzc2VkIHlvdXIgYWNjb3VudCB0aHJvdWdoIHVub2ZmaWNpYWwgd2VicGFnZXMgb3IgYXBwcywgeW91ciBzZWN1cml0eSBtYXkgYmUgY29tcHJvbWlzZWQuIFdlIHJlY29tbWVuZCBjaGFuZ2luZyB5b3VyIHBhc3N3b3JkLiIsICJJZiB5b3UgbG9zZSB5b3VyIHBhc3N3b3JkIG9yIGFjY291bnQgbmFtZSwgeW91IG1heSBsb3NlIGFjY2VzcyB0byB5b3VyIGFjY291bnQuIEluIHN1Y2ggYSBjYXNlLCB3ZSBhcmUgdW5hYmxlIHRvIHJlY292ZXIgaXQuIFBsZWFzZSBlbnN1cmUgdGhhdCB5b3Ugc3RvcmUgeW91ciBhY2NvdW50IG5hbWUgYW5kIHBhc3N3b3JkIGluIGEgc2FmZSBwbGFjZS4iLCAiQWNjb3VudCBPcHRpb25zIiwgIkxvZyBpbiB0byBhIERpZmZlcmVudCBBY2NvdW50IiwgIkNyZWF0ZSBOZXcgQWNjb3VudCIsICJEZWxldGUgQWNjb3VudDogIiwgIvCfl5HvuI8gQWNjb3VudCBEZWxldGlvbiIsICJBY2NvdW50cyB3aXRob3V0IGdvbGQgd2lsbCBiZSBkZWxldGVkIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgOCBkYXlzLiBUbyBpbml0aWF0ZSB0aGlzIHByb2Nlc3MsIGRlcGxldGUgYWxsIHlvdXIgZ29sZC4iLCAiU2F2ZWQgQWNjb3VudHMiLCAiTGlzdGVkIGFjY291bnRzIG1heSBoYXZlIGJlZW4gcmVtb3ZlZCBpbiB0aGUgbWVhbnRpbWUgZHVlIHRvIGluc3VmZmljaWVudCBmdW5kcy4iLCAi8J+Xke+4jyBSZW1vdmUgRnJvbSBMaXN0IiwgIuKeoe+4jyBMb2dpbiIsICIxdjEgUmF0aW5nIiwgIkVsbzogIiwgIlBsYXllZCBHYW1lczogIiwgIkJhdHRsZSBSb3lhbGUgUmF0aW5nIiwgIkNvbW1hbmRlciIsICJTdHJhdGVnaXN0IiwgIlNvbGRpZXIiLCAiUmVjcnVpdCIsICJSYXRpbmc6ICIsICJBZG1pbiBTdGF0aXN0aWNzIiwgIlZvdGVzOiAiLCAiWW91IGFyZSBhYm91dCB0byBwdXJjaGFzZSB7MTB9IHZvdGVzIGZvciB7MTF9IEdvbGQgd2l0aCB5b3VyIEFjY291bnQgezJ9LiIsICJVc2VybmFtZSIsICJQbGVhc2UgY2hvb3NlIGEgcmVzcGVjdGZ1bCB1c2VybmFtZS4iLCAiQmlvIiwgIlVwbG9hZCBCaW8iLCAiVGhlIG1vbnRobHkgZmVlIGlzIGN1cnJlbnRseSB7MTB9IGdvbGQuIiwgIkVuYWJsZSBBdXRvIFJlbmV3IiwgIkRpc2FibGUgQXV0byBSZW5ldyIsICJBdXRvIFJlbmV3IGlzIG9mZi4gVGhlIHN1YnNjcmlwdGlvbiB3aWxsIGVuZCBpbiB7MTB9IGRheShzKS4iLCAiQXV0byBSZW5ldyBpcyBvbi4gVGhlIHN1YnNjcmlwdGlvbiB3aWxsIHJlbmV3IGluIHsxMH0gZGF5KHMpLiIsICJEZXNjcmlwdGlvbiIsICJSZXBvcnQgUGxheWVyIiwgIlByaW1hcnkgQ2xhbiBTdGF0cyIsICJDbGFuOiB7MH0iLCAiTW9udGhseSBQb2ludHM6IHswfSIsICJSYW5rOiB7MH0iLCAiVG90YWwgUG9pbnRzOiB7MH0iLCAiV29uIEdhbWVzOiB7MH0iLCAiQXZnLiBQb2ludHMgcGVyIEdhbWU6IHswfSIsICJTZWNvbmRhcnkgQ2xhbiBTdGF0cyIsICJPbmNlIHRoZSBtb250aGx5IHBvaW50cyBvZiB0aGUgc2Vjb25kYXJ5IGNsYW4gc3VycGFzcyB0aGUgbW9udGhseSBwb2ludHMgb2YgdGhlIHByaW1hcnkgY2xhbiwgdGhlIHNlY29uZGFyeSBjbGFuIHdpbGwgYmVjb21lIHRoZSBuZXcgcHJpbWFyeSBjbGFuLiIsICJJbiB0aGlzIHNjZW5hcmlvLCB5b3VyIGNsYW4gbGVhZGVyIHN0YXRpc3RpY3Mgd2lsbCBiZSByZXNldC4iLCAiQ2xhbiBMZWFkZXIgU3RhdGlzdGljcyIsICJDbGFuIExlYWRlciBvZiB7MH0iLCAiTm8gQ2xhbiBMZWFkZXIiLCAiRWxlY3QiLCAiRXZlcnkgd2VlaywgeW91IGNhbiB2b3RlIGZvciBvbmUgY2xhbiBtZW1iZXIgdG8gaW5jcmVhc2UgdGhlaXIgY2xhbiBsZWFkZXIgcG9pbnRzLiIsICJZb3UgYW5kIHRoaXMgY2xhbiBtZW1iZXIgbXVzdCBoYXZlIHRoZSBzYW1lIHByaW1hcnkgY2xhbiwgd2hpY2ggY2FuIGJlIGNoZWNrZWQgaW4gdGhlIFByaW1hcnkgQ2xhbiBTdGF0cy4iLCAiQSBjbGFuIGxlYWRlciBnYWlucyBnb2xkIHdoZW5ldmVyIGEgbWVtYmVyIGVhcm5zIGdvbGQgaW4gYSBnYW1lLiIsICJSYXRpbmc6IHsxMH0iLCAiUmFuazogezEwfSIsICJTdGF0dXM6IHsxMH0iLCAiQWN0aXZlIiwgIkluYWN0aXZlIiwgIlVubGluayBBY2NvdW50IiwgIkJlbmVmaXRzOiIsICJObyBBZHMiLCAiU2VwYXJhdGUgTGVhZGVyYm9hcmQiLCAiRXh0cmEgR29sZCBJbmNvbWUiLCAiU3RhdHVzOiBOb3QgTGlua2VkIiwgIkpvaW4gVGVycml0b3JpYWwuaW8gb24gUGF0cmVvbjoiLCAiT25jZSB5b3UgaGF2ZSBqb2luZWQsIGNvbm5lY3QgeW91ciBhY2NvdW50OiIsICJJZiB5b3UgaGlkZSBQYXRyZW9uLCBubyBvbmUgY2FuIHNoYXJlIHRoZWlyIG1lbWJlcnNoaXAgd2l0aCB5b3UuIiwgIkFkZGl0aW9uYWwgSW5jb21lIiwgIk9wdGlvbnMiLCAiRGVmYXVsdCIsICJVbmlmb3JtIiwgIkN1c3RvbWl6ZWQiLCAiTWl4ZWQiLCAiVGVhbSBkZXBlbmRlbnQiLCAiUGxheWVyIENvdW50IiwgIkNsYW4gQ2hhcnQiLCAi8J+boO+4jyBPcHRpb25zIiwgIvCfm6DvuI8gQ2hhcnQgT3B0aW9ucyIsICJTZWFyY2ggVGVybXMiLCAiU2VwYXJhdGUgc2VhcmNoIHRlcm1zIHdpdGggYSBjb21tYS4iLCAiTG9hZCBEYXRhIiwgIlN0YXJ0IEluZGV4IiwgIkVuZCBJbmRleCIsICJUaW1lZnJhbWUiLCAiTW9yZSBPcHRpb25zIiwgIlktQXhpcyBDb21wcmVzc2lvbiIsICJDaG9vc2UgWW91ciBOYXRpb24ncyBDb2xvciEiLCAiTmF0aW9uYWwgQ29sb3IiLCAiUmVkOiAiLCAiR3JlZW46ICIsICJCbHVlOiAiLCAiQWRqdXN0IiwgIkNvbG9ycyIsICJSYW5kb20iLCAiU2VsZWN0YWJsZSBDb2xvciIsICLij7MgQ29ubmVjdGluZy4uLiIsICJGaW5kIFNlcnZlci4uLiIsICJOZXcgQ29ubmVjdGlvbi4uLiIsICJDdXN0b20gU2NlbmFyaW8iLCAi4pqU77iPIFBsYXkiLCAiTWFwIiwgIlNldHRpbmdzIiwgIkdhbWUgTW9kZSIsICJDbHVzdGVyZWQiLCAiUGxheWVyIE5hbWVzIiwgIktpbmdkb20gTmFtZXMiLCAiU2ltcGxlIE5hbWVzIiwgIlRlcnJpdG9yaWFsIEluY29tZSIsICJJbnRlcmVzdCBJbmNvbWUiLCAiU3RhcnRpbmcgUmVzb3VyY2VzIiwgIk1vcmUgU2V0dGluZ3MiLCAiUmVzZXQgU2NlbmFyaW8iLCAiT3BlbiBGaWxlLi4uIiwgIlNhdmUgQXMgRmlsZS4uLiIsICLwn5OcIEdhbWUgTG9nIiwgIk11bHRpcGxheWVyIiwgIk15IEFjY291bnQiLCAiR2FtZSBNZW51IiwgIllvdXIgS2luZ2RvbSdzIE5hbWUiLCAiQ2xhbnMiLCAiQ2xhbiBNZW1iZXJzIiwgIkFkbWlucyIsICIxdjEgUGxheWVycyIsICJCYXR0bGUgUm95YWxlIiwgIlJpY2hlc3QgUGxheWVycyIsICJQYXRyZW9uIE1lbWJlcnMiLCAi8J+PhiBMZWFkZXJib2FyZHMiLCAiUHJldmlvdXMgMTAiLCAiTmV4dCAxMCIsICIxdjEgUGxheWVyIFJhbmtpbmciLCAiQ2xhbiBSYW5raW5nIiwgIkNsYW4gTWVtYmVyIFJhbmtpbmciLCAiQWRtaW4gUmFua2luZyIsICIxdjEgUmVwb3J0cyIsICJBZG1pbiBFbGVjdGlvbiIsICJCbG9ja2NoYWluIiwgIkNsYW4gTGVhZGVyIEVsZWN0aW9uIiwgIkJpbyBSZXBvcnRzIiwgIkJhdHRsZSBSb3lhbGUgUGxheWVycyIsICJBdWRpdCBMb2ciLCAiUmFua2luZyIsICJQbGF5ZXIiLCAiRWxvIiwgIkNsYW4iLCAiUmF0aW5nIiwgIkxlYWRlciIsICJJbmRleCIsICJTZWNvbmRzIEFnbyIsICJBY2N1c2VyIiwgIkFjY3VzZWQiLCAiVm90ZXIiLCAiVGFyZ2V0IEFjY291bnQiLCAiVm90ZXMiLCAiU2VuZGVyIiwgIlJlY2VpdmVyIiwgIkFtb3VudCIsICJOdW1iZXIiLCAiR29sZCIsICJBZG1pbiIsICJBZmZlY3RlZCBBY2NvdW50IiwgIlR5cGUiLCAiRWxvIERlZHVjdGVkIiwgIkJpbyBSZW1vdmVkIiwgIvCfm6DvuI8gTGlzdCBPcHRpb25zIiwgIkNsYW4gTmFtZSBTZWFyY2giLCAiVXNlcm5hbWUgU2VhcmNoIiwgIlF1YW50aXR5IiwgIkFjY291bnQgTmFtZSBTZWFyY2giLCAiMXYxIiwgIlpvbWJpZSIsICJDaGF0IiwgIkNsb3NlIiwgIlJlYWR5IiwgIk5leHQgTWFwIiwgIk5leHQgR2FtZSBNb2RlIiwgIk5leHQgQ29udGVzdCIsICJUZWFtcyIsICJPTiIsICJPRkYiLCAiWm9tYmllcyIsICJMb2dpbiIsICLwn5OcIExvZ3MiLCAiUHJvY2VkdXJhbCBNYXAiLCAiUmVhbGlzdGljIE1hcCIsICJDdXN0b20gTWFwIiwgIlBhc3NhYmxlIFdhdGVyIiwgIlBhc3NhYmxlIE1vdW50YWlucyIsICJTZWxlY3QgRmlsZSIsICJQcmV2aWV3IiwgIk1hcCBOYW1lIiwgIlNlbGVjdGFibGUgTmFtZSIsICLilrbvuI8gUmVwbGF5IiwgIvCflLIgU2VsZWN0IEFsbCIsICLwn5OLIENvcHkiLCAi8J+Xke+4jyBDbGVhciIsICLilrbvuI8gTGF1bmNoIiwgIkluc2VydCB0aGUgcmVwbGF5IHN0cmluZyBoZXJlISIsICLimpnvuI8gU2V0dGluZ3MiLCAi8J+UhCBSZXNldCIsICJSZWxvYWQgUmVxdWlyZWQiLCAiQSBnYW1lIHJlbG9hZCBpcyByZXF1aXJlZCB0byBhcHBseSB0aGUgbmV3IGNvbmZpZ3VyYXRpb24uIiwgIkluZm9ybWF0aW9uIiwgIkluY3JlYXNpbmcgcmVzb2x1dGlvbiwgc2hyaW5raW5nIG1pbmltdW0gZm9udCBzaXplLCBhbmQgc3BlZWRpbmcgdXAgdGV4dCByZW5kZXJpbmcgY2FuIHN0cmFpbiB5b3VyIHN5c3RlbSBhbmQgaGluZGVyIGdhbWVwbGF5IHJlc3BvbnNpdmVuZXNzLiIsICJSZXNvbHV0aW9uIiwgIkxvdyIsICJNZWRpdW0iLCAiSGlnaCIsICJWZXJ5IEhpZ2giLCAiTWluaW11bSBGb250IFNpemUiLCAiU21hbGwiLCAiVmVyeSBTbWFsbCIsICJUZXh0IFJlbmRlcmluZyBTcGVlZCIsICJTbG93IiwgIkZhc3QiLCAiTGFyZ2UgVUkiLCAiUGxhY2UgQmFsYW5jZSBBYm92ZSIsICJIaWRlIFpvb20gQnV0dG9ucyIsICJGb250IiwgIk1lc3NhZ2UgQm94IiwgIktlZXAgQ2xvc2VkIiwgIklzIE11dGVkIiwgIlNob3J0Y3V0IEtleXMiLCAiUmVzZXQiLCAiTGFuZ3VhZ2UiLCAiU3Bhd25pbmciLCAiU2VsZWN0YWJsZSBTcGF3biIsICLwn5SRIE15IEFjY291bnQiLCAi8J+TiCBDaGFydHMiLCAi8J+niCBHb2xkIFRyYW5zZmVyIiwgIvCflJcgTGlua3MiLCAi4oS577iPIEdhbWUgVmVyc2lvbiIsICLwn5eR77iPIERlbGV0ZSBEYXRhIiwgIlByaXZhY3kgU2V0dGluZ3MiLCAiRm9yY2UgUmVzdGFydCBHYW1lIiwgIuKYsCBHYW1lIE1lbnUiLCAi8J+TiiBHYW1lIFN0YXRpc3RpY3MiLCAi8J+Ps++4jyBTdXJyZW5kZXIiLCAi8J+Viu+4jyBDYWxsIFBlYWNlIFZvdGUiLCAiQW5kcm9pZCBBcHAiLCAiaU9TIEFwcCIsICJDaGFuZ2Vsb2ciLCAiQ2xhbiBSZXN1bHRzIiwgIlR1dG9yaWFsIiwgIkRvIHlvdSB3YW50IHRvIGRlbGV0ZSBhbGwgbG9jYWxseSBzdG9yZWQgZGF0YSwgbGlrZSB1c2VybmFtZXMsIGFjY291bnQgZGF0YSBhbmQgc2V0dGluZyBkYXRhPyIsICJBY2NvdW50cyB3aXRob3V0IGdvbGQgd2lsbCBiZSBkZWxldGVkIGFmdGVyIHNvbWUgZGF5cyBvZiBncmFjZS4iLCAi8J+Xke+4jyBEZWxldGUiLCAiVXNlciBQcml2YWN5IiwgIkNoZWNrIG91dCBvdXIgUHJpdmFjeSBQb2xpY3kgYXQ6IiwgIlNvdXJjZSBBY2NvdW50IiwgIlNlbmQgZ29sZCBvbmx5IHRvIHRydXN0ZWQgYWNjb3VudHMhIiwgIlJlcGxheSBFcnJvciIsICJXYXJuaW5nIiwgIkxvYWRpbmcuLi4iLCAiQW4gZW5lbXkgc2hpcCBiZWxvbmdpbmcgdG8gezB9IGlzIGhlYWRpbmcgdG93YXJkcyB5b3VyIHNob3JlLiIsICJJbml0aWF0ZSBMYW5kIEF0dGFjayBBdCBNb3VzZSBQb2ludGVyIiwgIkxhdW5jaCBTaGlwIFRvd2FyZHMgTW91c2UgUG9pbnRlciIsICJJbmNyZWFzZSBQZXJjZW50YWdlIEJhciIsICJEZWNyZWFzZSBQZXJjZW50YWdlIEJhciIsICJTbGlnaHRseSBJbmNyZWFzZSBQZXJjZW50YWdlIEJhciIsICJTbGlnaHRseSBEZWNyZWFzZSBQZXJjZW50YWdlIEJhciIsICJTd2l0Y2ggVUkgVmlzaWJpbGl0eSIsICJab29tIEluIiwgIlpvb20gT3V0IiwgIkNhbWVyYSBMZWZ0IiwgIkNhbWVyYSBSaWdodCIsICJDYW1lcmEgVXAiLCAiQ2FtZXJhIERvd24iLCAiQWRkIFRvIFdlYWtlc3QgQXR0YWNrIiwgIkNhbGwgUGVhY2UgVm90ZSIsICJBdmcuIEF0dGFjayBTdHJlbmd0aCIsICJMYW5kIEF0dGFja3MiLCAiU2hpcHMgbGF1bmNoZWQiLCAiQm90cyBjb25xdWVyZWQiLCAiSHVtYW5zIGNvbnF1ZXJlZCIsICJBdHRhY2tlZCBieSBCb3RzIiwgIkF0dGFja2VkIGJ5IEh1bWFucyIsICJUZXJyaXRvcmlhbCBMb3NzIiwgIlJlY2VpdmVkIFN1cHBvcnQiLCAiT3ZlcmFsbCBJbmNvbWUiLCAiQWRkaXRpb25hbCBDb3N0cyIsICJMYW5kIFdhciBMb3NzZXMiLCAiTmF2YWwgTG9zc2VzIiwgIlRyYW5zbWl0dGVkIFN1cHBvcnQiLCAiT3ZlcmFsbCBFeHBlbnNlcyIsICJNb3VudGFpbiBBdHRhY2tzIiwgIlNoaXBzIGxhbmRlZCIsICJUZXJyaXRvcnkiLCAiTnVtYmVycyIsICJTdGF0aXN0aWNzIiwgIk5ldXRyYWwiLCAiUmVkIiwgIkdyZWVuIiwgIkJsdWUiLCAiWWVsbG93IiwgIk1hZ2VudGEiLCAiQ3lhbiIsICJXaGl0ZSIsICJCbGFjayIsICJTaGlwIGxhdW5jaGVkISIsICJTaGlwIHNlbGVjdGVkISIsICJTaGlwIG9uIHRoZSB3YXkhIiwgIlVwY29taW5nIEFsbGlhbmNlIENvbnRlc3QhIiwgIlVwY29taW5nIEJhdHRsZSBSb3lhbGUgQ29udGVzdCEiLCAiVXBjb21pbmcgMXYxIENvbnRlc3QhIiwgIlVwY29taW5nIFpvbWJpZSBDb250ZXN0ISJdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVuLCBlcDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGo7DQogICAgICAgICAgICAgICAgICAgIHZhciBzczsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFCMjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFCMzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFCNDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFCNTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFCNjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhMkk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQjc7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKHBOLCBhQjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSAmJiBhMC5kbiA+PSAxMyAmJiBhMC5kbiA8IDE4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMkkgPSBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTJJICE9PSBwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEwLnVQLnNhdmVTdHJpbmcoMjAwLCBwTik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhMkkgPSBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShhMkkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUI3LnRpdGxlID0gYTJJOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUI3LnRhcmdldCA9IFNbOTZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUI3LmhyZWYgPSBhMkk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjcuc3R5bGUudGV4dEFsaWduID0gU1sxMF07DQogICAgICAgICAgICAgICAgICAgICAgICBhQjcuc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNy5zdHlsZS5wb3NpdGlvbiA9IFNbM107DQogICAgICAgICAgICAgICAgICAgICAgICBhQjcuc3R5bGUucGFkZGluZyA9IFNbNjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUI3LnN0eWxlLm1hcmdpbiA9IFNbNjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYUI3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYUI3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGh5LCBoeikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGh5IDwgZW4gfHwgaHogPCBlcCB8fCBoeSA+IGVuICsgaSB8fCBoeiA+IGVwICsgaiB8fCAoaHkgPiBlbiArIGkgLSBzcyAmJiBoeiA8IGVwICsgc3MpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFCNyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhQjUgPSBNYXRoLmZsb29yKDAuOCAqIChhMC5hMS5yNCgpID8gKGguaSA+IGguaiA/IDAuNiA6IDAuNTUpIDogMC40KSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc3MgPSBNYXRoLmZsb29yKDAuMTUgKiBhQjUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUIyID0gTWF0aC5mbG9vcigwLjM1ICogc3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUIzID0gTWF0aC5mbG9vcigwLjUgKiBzcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjQgPSBNYXRoLmZsb29yKDIuNSAqIGFCMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBqID0gc3MgKyBhQjIgKyAzICogYUIzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE0ZSA9IGI5LnBnLnJWKDEsIGFCMiAvIGguayk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjYgPSBNYXRoLmZsb29yKGguayAqIGFRLm1lYXN1cmVUZXh0KGEySSwgYTRlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gKGFCNiA+IGFCNSA/IGFCNiA6IGFCNSkgKyAyICogYUI0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOSA9IGk7DQogICAgICAgICAgICAgICAgICAgICAgICBpID0gTWF0aC5taW4oaSwgaC5pIC0gMiAqIChhMC5hMS5yNCgpID8gMiA6IDEpICogYmIuZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE0ZSA9IGI5LnBnLnJWKDEsIChpIC8gYUI5KSAqIGFCMiAvIGguayk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjYgPSBNYXRoLmZsb29yKGguayAqIGFRLm1lYXN1cmVUZXh0KGEySSwgYTRlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBlbiA9IE1hdGguZmxvb3IoKGguaSAtIGkpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICBlcCA9IE1hdGguZmxvb3IoKGguaiAtIGopIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjcuc3R5bGUuZm9udCA9IGE0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNy5zdHlsZS50b3AgPSBNYXRoLmZsb29yKChlcCArIDEuNCAqIGFCMyArIHNzKSAvIGguaykgKyAicHgiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUI3LnN0eWxlLmxlZnQgPSBNYXRoLmZsb29yKChlbiArIChpIC0gYUI2KSAvIDIpIC8gaC5rKSArICJweCI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KGVuLCBlcCArIHNzLCBpLCBqIC0gc3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubnE7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChlbiwgZXAsIGksIHNzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYmIueTI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlUmVjdChlbiwgZXAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwICsgc3MsIGksIGJiLnkyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigxLCAwLjQ4ICogc3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dCgiWW91IGFyZSBsZWF2aW5nIFRlcnJpdG9yaWFsLmlvISIsIE1hdGguZmxvb3IoZW4gKyAoaSAtIDAuNSAqIHNzKSAvIDIpLCBNYXRoLmZsb29yKGVwICsgMC41NSAqIHNzKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTS5hNHAoTWF0aC5mbG9vcihlbiArIGkgLSAwLjggKiBzcyksIE1hdGguZmxvb3IoZXAgKyAwLjI1ICogc3MpLCBNYXRoLmZsb29yKDAuNSAqIHNzKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkYigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGdhcCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IFswLCAwLCAwLCAwLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gWzAsIDAsIDAsIDAsIDBdOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbU8gPSBbMSwgMSwgMSwgMSwgMV07DQogICAgICAgICAgICAgICAgICAgIHZhciBmOCA9IFt0cnVlLCB0cnVlLCB0cnVlLCBmYWxzZSwgZmFsc2VdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZSID0gW3RydWUsIHRydWUsIHRydWUsIGZhbHNlLCBmYWxzZV07DQogICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOVY7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJBID0gZnVuY3Rpb24oYTFyLCBhQkIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYxID0gYTFyOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBhQkI7DQogICAgICAgICAgICAgICAgICAgICAgICBhOVYgPSBbYkouYUJDLCBiSi5hMDUsIGJKLmFCRCwgYkouYUJELCBiSi5hQkVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYi5zTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMyID0gTWF0aC5mbG9vcigoYTAuYTEucjQoKSA/IDAuMjYxIDogMC4xOTUpICogaC5waSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgczMgPSBNYXRoLmZsb29yKDAuOSAqIHMyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN0EgPSBNYXRoLmZsb29yKDAuMTcgKiBzMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBnYXAgPSBhMC5hMS5yNCgpID8gMiAqIGJiLmdhcCA6IGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1PWzBdID0gczIgLyBmMVswXS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1PWzFdID0gczMgLyBmMVsxXS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1PWzJdID0gYTdBIC8gZjFbMl0uaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgbU9bM10gPSBhN0EgLyBmMVszXS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICBtT1s0XSA9IGE3QSAvIGYxWzRdLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1PWzJdICo9IDEuNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1PWzNdICo9IDEuMDc7DQogICAgICAgICAgICAgICAgICAgICAgICBlblswXSA9IGdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuWzFdID0gZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW5bMl0gPSBnYXA7DQogICAgICAgICAgICAgICAgICAgICAgICBlblszXSA9IGdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuWzRdID0gTWF0aC5mbG9vcigyICogZ2FwICsgbU9bM10gKiBmMVszXS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBlcFswXSA9IGdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwWzFdID0gZXBbMF0gKyBnYXAgKyBtT1swXSAqIGYxWzBdLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwWzJdID0gZXBbMV0gKyBnYXAgKyBtT1sxXSAqIGYxWzFdLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwWzNdID0gZXBbMl0gKyBnYXAgKyBtT1syXSAqIGYxWzJdLmhlaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwWzRdID0gZXBbM107DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWY4WzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgNTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcFthQl0gLT0gbU9bMF0gKiBmMVswXS5oZWlnaHQgKyBnYXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmOFsxXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAyOyBhQiA8IDU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXBbYUJdIC09IG1PWzFdICogZjFbMV0uaGVpZ2h0ICsgZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKGFhLmEwOSgpID09PSA3ICYmIGEwLmExLnI0KCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGh5LCBoeikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmMSB8fCAhdGhpcy5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGY4Lmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjhbYUJdICYmIHRoaXMuZlJbYUJdICYmIGh5ID4gZW5bYUJdICYmIGh6ID4gZXBbYUJdICYmIGh5IDwgZW5bYUJdICsgbU9bYUJdICogZjFbYUJdLndpZHRoICYmIGh6IDwgZXBbYUJdICsgbU9bYUJdICogZjFbYUJdLmhlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoOSwgdC5ydiwgbmV3IGFCRigiWW91IGFyZSBsZWF2aW5nIFRlcnJpdG9yaWFsLmlvLiIsYjkucGcuYTJIKGE5VlthQl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZjEgfHwgIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA1OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4W2FCXSAmJiB0aGlzLmZSW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0obU9bYUJdLCAwLCAwLCBtT1thQl0sIGVuW2FCXSwgZXBbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGYxW2FCXSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZFQoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJHID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQkggPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnQxID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xcSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudE4gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnN6ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQkkgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF3ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQkogPSBuZXcgYUJLKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBFID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hODEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4MSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQkcgPSBiRi5yeS52SihiaS5lRC5kYXRhWzEwNV0udmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50MSA9IG5ldyBhQkwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXEgPSBuZXcgYUJNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBuZXcgYUJOKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnROID0gbmV3IGFCTygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeiA9IG5ldyBhQlAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IG5ldyBhQlEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUJJID0gbmV3IGFCUigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdyA9IG5ldyBhQlMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm8uZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTBFID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwLmExLnNldFN0YXRlKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuc2V0U3RhdGUoMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRIID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF3ICYmIHRoaXMucXcudEgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUJIID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudDEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xcSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50TiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN6ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFCSSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF3ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTBFID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJvLnRIKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5zZXRTdGF0ZSgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFCTCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50MiA9IFtbXSwgW10sIFtdLCBbXV07DQogICAgICAgICAgICAgICAgICAgIHRoaXMudDMgPSBbMCwgMCwgMCwgMF07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJUID0gZnVuY3Rpb24oYUJVLCBydCwgdXNlcm5hbWUsIHQ4LCBhMmwsIGFCViwgZWxvLCBjb2xvciwgdXIsIGFCVykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50MlthQlVdLnB1c2godGhpcy5hQlgocnQsIHVzZXJuYW1lLCB0OCwgYTJsLCBhQlYsIGVsbywgY29sb3IsIHVyLCBhQlcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS5hQkcgPT09IHJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm0uYUJIID0gdGhpcy50MlthQlVdW3RoaXMudDJbYUJVXS5sZW5ndGggLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkuYUJZICs9IHQucnYgPT09IDI5ICYmIGJtLnkucWpbMF0gPT09IGFCVSAmJiBibS55LnFqWzJdID09PSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQlggPSBmdW5jdGlvbihydCwgdXNlcm5hbWUsIHQ4LCBhMmwsIGFCViwgZWxvLCBjb2xvciwgdXIsIGFCVykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogcnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQ4OiB0OCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMmw6IGEybCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQlY6IGFCViwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbG86IGVsbywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXI6IHVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCVzogYUJXDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQlogPSBmdW5jdGlvbihlMSwgYUJVLCB0OCwgYTJsLCBhQlYsIGVsbywgdXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnQyW2FCVV1bZTFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnQ4ID0gdDg7DQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuYTJsID0gYTJsOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLmFCViA9IGFCVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5lbG8gPSBlbG87DQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIudXIgPSB1cjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkuYUJZICs9IHQucnYgPT09IDI5ICYmIGJtLnkucWpbMF0gPT09IGFCVSAmJiBibS55LnFqWzJdID09PSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQmEgPSBmdW5jdGlvbihlMSwgYUJVLCBhQmIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnQyW2FCVV1bZTFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCYyA9IHBsYXllci51c2VybmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQmQgPSAiUmVkYWN0ZWQgIiArIGJFLnJ5LnlKKHBsYXllci5ydCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUJiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnVzZXJuYW1lID0gIlsiICsgYjkuemQuemkoYUJjKSArICJdICIgKyBhQmQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci51c2VybmFtZSA9IGFCZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQmMuaW5kZXhPZigiUmVkYWN0ZWQiKSA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuYUJlID0gYUJjOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5hQmYgPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ueS5hQlkgKz0gdC5ydiA9PT0gMjkgJiYgYm0ueS5xalswXSA9PT0gYUJVICYmIGJtLnkucWpbMl0gPT09IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCZyA9IGZ1bmN0aW9uKGUxLCBhQmgsIGFCaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllciA9IHRoaXMudDJbYUJoXVtlMV07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFCaihlMSwgYUJoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudDJbYUJpXS5wdXNoKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBibS55LmFCWSArPSB0LnJ2ID09PSAyOSAmJiBibS55LnFqWzBdID09PSBhQmkgJiYgYm0ueS5xalsyXSA9PT0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJqID0gZnVuY3Rpb24oZTEsIGFCaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQxID0gdGhpcy50MlthQmhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID49IHRoaXMudDNbYUJoXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQxW2UxXSA9IHQxW3QxLmxlbmd0aCAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnQzW2FCaF0tLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUJoID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQxLnNwbGljZSh0aGlzLnQzW2FCaF0gKyAxLCAwLCB0MVt0MS5sZW5ndGggLSAxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQxLnNwbGljZShlMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdDFbZTFdID0gdDFbdGhpcy50M1thQmhdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdDFbdGhpcy50M1thQmhdXSA9IHQxW3QxLmxlbmd0aCAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHQxLnBvcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ueS5hQlkgKz0gdC5ydiA9PT0gMjkgJiYgYm0ueS5xalswXSA9PT0gYUJoICYmIGJtLnkucWpbMl0gPT09IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCayA9IGZ1bmN0aW9uKGUxLCBxaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ueS5hQlkgKz0gdC5ydiA9PT0gMjkgJiYgYm0ueS5xalswXSA9PT0gcWkgJiYgYm0ueS5xalsyXSA9PT0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0MSA9IHRoaXMudDJbcWldOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBZID0gdDFbZTFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFpID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID49IHRoaXMudDNbcWldKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQmwgPSB0aGlzLnQzW3FpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsbyA9IHBZLmVsbzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFCbCAmJiBlbG8gPiB0MVthQmwgLSAxXS5lbG8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCbC0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQxW2UxXSA9IHQxW3RoaXMudDNbcWldXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdDEuc3BsaWNlKHRoaXMudDNbcWldKyssIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0MS5zcGxpY2UoYUJsLCAwLCBwWSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdDEuc3BsaWNlKHRoaXMudDNbcWldLS0sIDAsIHBZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0MS5zcGxpY2UoZTEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA+PSB0aGlzLnQzW3FpXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCbSh0MSwgdGhpcy50M1txaV0rKywgZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFCbSh0MSwgLS10aGlzLnQzW3FpXSwgZTEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJtKGcsIHNGLCBzRykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCbiA9IGdbc0ZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ1tzRl0gPSBnW3NHXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGdbc0ddID0gYUJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJvID0gZnVuY3Rpb24ocnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0MiA9IHRoaXMudDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB0Mi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdDEgPSB0MlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gdDEubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCBrZDsgZXorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnQgPT09IHQxW2V6XS5ydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQxW2V6XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJLKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRnID0gZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0MyA9IGJtLnQxLnQzW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0MyA8IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcWsgPSBibS55LnFsW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQnAgPSBxay5hQnEgPT09IDkgPyAzMzMgOiA1MTI7DQogICAgICAgICAgICAgICAgICAgICAgICB0MyA9IE1hdGgubWluKHQzLCBhQnApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFrLmFCcSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQzIC09IHQzICUgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0MSA9IGJtLnQxLnQyW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQnIgPSB0MS5zcGxpY2UoMCwgdDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0udDEudDNbZTFdIC09IHQzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCcyA9IGFCdChhQnIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCcyA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS55LmFCWSArPSB0LnJ2ID09PSAyOSAmJiBibS55LnFqWzBdID09PSBlMSAmJiBibS55LnFqWzJdID09PSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxay5hQnEgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hQnUgPSAocWsuYUJ1ICsgKGFCcyA+PiAxKSkgJSAxMDI0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IGFCcyAtIGFCcyAlIDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUJzID0gYUJzICUgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQnIgPSBhQnIuc2xpY2UoZ0UsIGdFICsgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhdy5kWChxaywgYUJyLCBhQnMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCdiA9IGZ1bmN0aW9uKHFrLCBhQnIsIGFCcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVqID0gYUQuZGF0YSA9IG5ldyBhM1QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnNwYXduaW5nU2VlZCA9IHFrLnNwYXduaW5nU2VlZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxay5hQnEgPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLm51bWJlclRlYW1zID0gcWsuYUJxICsgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocWsuYUJxID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSBlai5pc1pvbWJpZU1vZGUgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLm51bWJlclRlYW1zID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmJhdHRsZVJveWFsZU1vZGUgPSBxay5hQnEgPT09IDcgPyAwIDogKHFrLmFCcSA9PT0gMTAgPyAxIDogMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlai5zZWxlY3RlZFBsYXllciA9IGFCczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLmlzQ29udGVzdCA9IHFrLmFCdzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLm1hcFR5cGUgPSBiUi5hQngocWsuZU0pID8gMCA6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi5hQnkoZWosIHFrLmVNKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLm1hcFNlZWQgPSBxay5tYXBTZWVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCeiA9IGVqLmh1bWFuQ291bnQgPSBhQnIubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWouc2VsZWN0YWJsZVNwYXduID0gZWouZ2FtZU1vZGUgPT09IDEgfHwgYUJ6IDwgMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWouY29sb3JzRGF0YSA9IG5ldyBVaW50MzJBcnJheShhQnopOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWoucGxheWVyTmFtZXNEYXRhID0gbmV3IEFycmF5KGFCeik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYUJ6OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouY29sb3JzRGF0YVthQl0gPSBhQnJbYUJdLmNvbG9yOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLnBsYXllck5hbWVzRGF0YVthQl0gPSBhQnJbYUJdLnVzZXJuYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVqLmJhdHRsZVJveWFsZU1vZGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5lbG8gPSBuZXcgVWludDE2QXJyYXkoYUJ6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBhQno7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZWxvW2FCXSA9IGFCclthQl0uZWxvOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLnNldFN0YXRlKDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIuYTcocWsuZU0sIGVqLm1hcFNlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1cgPSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJ0KGFCcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFibS5hQkgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhQnIubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJ0ID0gYm0uYUJILnJ0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCclthQl0ucnQgPT09IHJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJNKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZHMgPSBbIiIsICIiLCAiIiwgIkFkbWluIiwgIkNsYW4gTGVhZGVyIiwgU1sxMDldLCAiQ2xhbiBNZW1iZXIiLCAiIiwgU1sxMDVdLCAiV2VhbHRoeSBQbGF5ZXIiLCAiUGF0cmVvbiBNZW1iZXIiXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFDMCA9IFtiQS5uMCwgYkEubjAsIGJBLm4xLCBiQS5uVSwgYkEublYsIGJBLm5ILCBiQS5uYSwgYkEubjEsIGJBLm5zLCBiQS5uaSwgYkEubnVdOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUMxID0gW1sxXSwgWzFdLCBbMS4yXSwgWzEuNCwgMS4yXSwgWzEuNywgMS40LCAxLjJdLCBbMS40LCAxLjJdLCBbMS40LCAxLjJdLCBbMS4yXSwgWzEuNCwgMS4yXSwgWzEuNCwgMS4yXSwgWzEuNCwgMS4yXV07DQogICAgICAgICAgICAgICAgICAgIHZhciBhQzIgPSBbIllvdXIgYWNjb3VudCBpcyB0b28gbmV3ISIsICJUaGUgc2VydmVyIGNvdWxkbid0IHByb2Nlc3MgeW91ciByZXF1ZXN0LiIsICJTcGFtIGRldGVjdGVkISIsICJZb3UgYXJlIG11dGVkISIsICJQbGF5ZXIgY291bGRuJ3QgYmUgZm91bmQuIiwgIllvdSBkb24ndCBoYXZlIHBlcm1pc3Npb24gZm9yIHRoaXMgb3BlcmF0aW9uISIsICJOb3QgZW5vdWdoIGdvbGQhIiwgIkFjdGlvbiBjYW5jZWxsZWQhIiwgIlVzZXIgcmVjZWl2ZWQgdGhpcyBwdW5pc2htZW50IGFscmVhZHkhIiwgIkxvYmJ5IHJlc3RhcnRzIGluIDIgbWludXRlcyEiLCAiTG9iYnkgcmVzdGFydHMgaW4gMTAgc2Vjb25kcyEiXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xcyA9IGZ1bmN0aW9uKGFDMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgPCA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUM0ID0gIkAiICsgYkUucnkueUooYUMzLnJ0LCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUM0ICsgIjogIiArIGFDMy5yOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDMy5pZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6aiA9ICJAIiArIGJFLnJ5LnlKKGFDMy50YXJnZXQsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuYUM1ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMudmFsdWUgPj0gMzI3NjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzQgKyBTWzYzXSArIChhQzMudmFsdWUgLSAzMjc2OCArIDEpICsgIiBnb2xkIGFnYWluc3QgIiArIHpqICsgIiB0byB3ZWFrZW4gdGhlIGxhdHRlcidzIGFkbWluIHBvc2l0aW9uLiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFDNCArIFNbNjNdICsgKGFDMy52YWx1ZSArIDEpICsgIiBnb2xkIGZvciAiICsgemogKyAiIHRvIHN0cmVuZ3RoZW4gdGhlIGxhdHRlcidzIGFkbWluIHBvc2l0aW9uLiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhQzMuYUM1ID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzQgKyAiIHNlbnQgIiArIE1hdGguZmxvb3IoYUMzLnZhbHVlIC8gMTAwKSArICIgR29sZCB0byAiICsgemogKyAiLiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzQgKyBTWzYzXSArIGFDMy52YWx1ZSArICIgcG9pbnRzIGZvciAiICsgemogKyAiIHRvIGFja25vd2xlZGdlIHRoZSBsYXR0ZXIgYXMgY2xhbiBsZWFkZXIuIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUMzLmFDNSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUM0ICsgIiB3YXMgbXV0ZWQuIER1cmF0aW9uOiAxIEhvdXIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUMzLmFDNSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlRoZSB1c2VybmFtZSBvZiAiICsgYUM0ICsgIiB3YXMgcmVkYWN0ZWQuIER1cmF0aW9uOiAxIERheSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzQgKyAiIHdhcyBraWNrZWQuIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUM0ICsgYm4uZTQoYUMzLmFDNSwgYm4uZHlbYUMzLmFDNV1bYUMzLnZhbHVlXSkgKyAiQCIgKyBiRS5yeS55SihhQzMudGFyZ2V0LCA1KSArIGJuLmU2KGFDMy5hQzUsIGJuLmR5W2FDMy5hQzVdW2FDMy52YWx1ZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDMy5pZCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzQgKyBibi5lNCg1LCBibi5keVs1XVthQzMuYUM1XSkgKyAiQCIgKyBiRS5yeS55SihhQzMudGFyZ2V0LCA1KSArIGJuLmU2KDUsIGJuLmR5WzVdW2FDMy5hQzVdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUMyW2FDMy5hQzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDMy5pZCA9PT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiWW91IGFyZSBhYm91dCB0byBtZW50aW9uICIgKyBhQzMudmFsdWUgKyAiIHBsYXllciIgKyAoYUMzLnZhbHVlID09PSAxID8gIiIgOiAicyIpICsgIi4gVGhpcyBhY3Rpb24gd2lsbCBjb3N0ICIgKyAoTWF0aC5tYXgoMTAgKiBhQzMudmFsdWUsIDEwKSAvIDEwMCkudG9GaXhlZCgyKSArICIgR29sZC4gUHJvY2VlZD8gKHllcyAvIG5vKSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFyID0gZnVuY3Rpb24oYUMzLCBhNXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUMzOiBhQzMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcjogYTVzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDNjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQzc6IGFDMy5pZCA/IGJBLm5UIDogYkEubW0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnQ2ID0gZnVuY3Rpb24ocGxheWVyLCBxaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChxaSA9PT0gMiA/ICIoIiArIChwbGF5ZXIuZWxvIC8gMTApLnRvRml4ZWQoMSkgKyAiKSAiIDogIiIpICsgcGxheWVyLnVzZXJuYW1lOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50NyA9IGZ1bmN0aW9uKHQ4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUMwW3Q4XTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUM4ID0gZnVuY3Rpb24odDgsIGEybCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQ4IDwgMyB8fCB0OCA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzFbdDhdWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQ4ID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFDMVt0OF1bYTJsIDwgMSA/IDAgOiBhMmwgPCAxMCA/IDEgOiAyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQzFbdDhdW2EybCA8IDEwID8gMCA6IDFdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQzkgPSBmdW5jdGlvbihhMmwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMmwgPT09IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCbyA9IGZ1bmN0aW9uKHFpLCBydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQyID0gYm0udDEudDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdDEgPSB0MltxaV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB0MS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnQgPT09IHQxW2FCXS5ydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdDFbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gMDsgZjAgPCB0Mi5sZW5ndGg7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocWkgPT09IGYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0MSA9IHQyW2YwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZyA9IHQxLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnQgPT09IHQxW2FCXS5ydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQxW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50OSA9IGZ1bmN0aW9uKHBZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJtLmFCSCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwWS5ydCA9PT0gYm0uYUJILnJ0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQ0EgPSBmdW5jdGlvbih0MSwgYUNCLCBhQ0MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6ZyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yICh2YXIgYUIgPSBhQ0I7IGFCIDwgYUNDOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpoID0gYjkuemQuemkodDFbYUJdLnVzZXJuYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXpoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmMCA9IHpnLmxlbmd0aCAtIDE7IGYwID49IDA7IGYwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpoID09PSB6Z1tmMF0ubmFtZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemdbZjBdLmc4Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpnLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB6aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZzg6IDENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHpnLnNvcnQoZnVuY3Rpb24oZXosIGYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYwLmc4IC0gZXouZzg7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6Zy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSB6Z1swXS5uYW1lICsgIjogIiArIHpnWzBdLmc4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDwgemcubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gU1sxM10gKyB6Z1thQl0ubmFtZSArICI6ICIgKyB6Z1thQl0uZzg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcE47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDRCA9IGZ1bmN0aW9uKHQ4LCBhMmwsIGFCVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRzW3Q4XS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlJhbms6ICIgKyAoYTJsICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHNbdDhdICsgU1sxMjFdICsgKGEybCArIDEpICsgKCh0OCAhPT0gMyAmJiBhQlYgPCAxMDApID8gU1sxM10gKyAoZHNbM10gKyBTWzEyMV0gKyAoYUJWICsgMSkpIDogIiIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQ0UgPSBmdW5jdGlvbihydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFsID0gYm0ueS5xbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBxbC5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ0YocWxbYUJdLnFtLCBydCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhQ0YoYm0ubWVzc2FnZS5hQ0coKSwgcnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ucXcuYUNFKHJ0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFDRihxbSwgcnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gcW0ubGVuZ3RoIC0gMTsgZjAgPj0gMDsgZjAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwWSA9IHFtW2YwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocFkuaWQgPT09IDAgJiYgcFkucnQgPT09IHJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBZLnIgPSBTWzk3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJQKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgck8gPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUNIID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFDSSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQ0ogPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUNLID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQ0wgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghck8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNIID09PSBhQ00oYUNLKSAmJiBhQ0kgPT09IGFDSy51cikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFDSSA9IGFDSy51cjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFDSi5zaG93KC0xLCAtMSwgYUNOKGFDSywgMCwgMSksIDEsIDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50QSA9IGZ1bmN0aW9uKGUsIHBZLCBhQ08pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN0ggPSBlLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyhhN0gubGVmdCwgYTdILnRvcCwgcFksIDAsIGFDTyk7DQogICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC5hZGRFdmVudExpc3RlbmVyKFNbNDhdLCBmdW5jdGlvbiByZW1vdmUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihTWzQ4XSwgcmVtb3ZlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS5zeiAmJiBibS5zei5xeCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUNOKHBZLCBhQ08sIGFDUCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gcFkudXNlcm5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiArPSBTWzEzXSArIGJtLnFxLmFDRChwWS50OCwgcFkuYTJsLCBwWS5hQlYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gYUNRKHBZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9ICIgICBJUDogIiArIGJFLnJ5LnlKKHBZLmFCVywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiArPSBTWzEzXSArIFsi8J+fpSBPZmZsaW5lIiwgIvCfn6kgT25saW5lIl1bYUNQID8gYUNIIDogYUNNKHBZLCBhQ08pXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ00ocFksIGFDTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDTyB8fCBibS50MS5hQm8ocFkucnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhQ0ggPSAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoYUNIID0gMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUNRKHBZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0ogPSBwWS51cjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzSiA8IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU1s2NV0gKyBzSjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHNKID0gc0ogJSAxMDI0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNKIDwgMTAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzY1XSArIHNKICsgImsiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNbNjVdICsgKHNKIC0gOTk5KSArICJNIjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbihlbiwgZXAsIHBZLCByUywgYUNPKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFDSikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDSiA9IG5ldyByTSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUNLID0gcFk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQ0kgPSBhQ0sudXI7DQogICAgICAgICAgICAgICAgICAgICAgICBhQ0ouc2hvdyhlbiwgZXAsIGFDTihwWSwgYUNPKSwgclMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgck8gPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKHJZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNKICYmIGFDSi5xeChyWSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByTyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUNLID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFCTigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xbCA9IG5ldyBBcnJheSg0KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xaiA9IFswLCAwLCAxLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQlkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDUiA9IFswLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHRoaXMucWwubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xbFthQl0gPSBuZXcgYUNTKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFqWzBdID0gYmkuZUQuZGF0YVsxNThdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQ1QgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFDVSh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUNWID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhQ1coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFDVShmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ1UoYUNYKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0ueS5hQlkgJiYgYm0ueS5xalsyXSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQxKDI5KS5hQ1koKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkuYUJZID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQxKDI5KS5hQ1ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS55LnFsW2JtLnkucWpbMF1dLnNtID09PSAwIHx8IGFDWCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQxKDI5KS5hQ2EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnN6LmFDTCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFDVygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBibS55LnFsLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxayA9IGJtLnkucWxbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxay5zbSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hQ2IgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUNjID0gTWF0aC5tYXgocWsuYUNjIC0gcWsuYUNiICUgMiwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUNiKys7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQ2QgPSBmdW5jdGlvbihxaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucWpbMF0gIT09IHFpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucWpbMl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LmE0MSgyOSkuYUNlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQlIoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQ2YgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUNnID0gIiI7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQ2ggPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUNpID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFDaiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuejUgPSBmdW5jdGlvbihyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUNmID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUNrID0gci50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ2sgPT09ICJ5ZXMiIHx8IGFDayA9PT0gInkiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDbChhQ2cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyLmluZGV4T2YoIkAiKSA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ2wocik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDbiA9IGFDbyhyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUNuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUNsKHIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFDZyA9IHI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGFDcChhQ24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDcSA9IGFDcihhQ24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDcyhhQ24sIGFDcSwgcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNxLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ2kgfHwgYUN0KGFDbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUN1KGcubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ2wocik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ24ubGVuZ3RoID09PSBhQ2opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ2wocik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUN2KGcsIGFDcSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQ3UoZy5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUNsKGE1cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYXouYUN3LmFDeCgzLCBhNXMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFDbSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2UuYUN5KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogNSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQzU6IDcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFDdShnOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUNmID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2UuYUN5KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogNiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZzgNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFDdChhQ24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFDbi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGFDblthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09ICJAYWxsIiB8fCBpID09PSAiQGV2ZXJ5b25lIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ3AoYUNuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhQ24ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDeiA9IFswLCAwLCAwLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYUNuW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IDA7IGV6IDwgNDsgZXorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gU1sxMDhdICsgKGV6ICsgMSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDeltlel0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUNpID0gYjkucHAuYTFWKGFDeik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNpICUgNCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOS5wcC5hMW4oYm0udDEudDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IDA7IGV6IDwgNDsgZXorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ3pbZXpdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDeltlel0gPSBibS50MS50Mltlel07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUN6W2V6XSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOS5wcC5hMW4oYUN6KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ3IoYUNuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUNxID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhQ2ggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUNqID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFDbi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGFDblthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gaS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LnpkLnN0YXJ0c1dpdGgoaSwgIkBbIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtkIDw9IDkgJiYgYjkuemQuYTJMKGksICJdIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDcS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogaS5zdWJzdHJpbmcoMiwga2QgLSAxKS50b1VwcGVyQ2FzZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtkID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS56ZC5zdGFydHNXaXRoKGksIFNbMTA4XSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDaisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ3EucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4OiBiRi5yeS52SihpLnN1YnN0cmluZygxKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2QgPiAxICYmIGtkIDwgNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUQwID0gYjYuZGF0YS5hQXUoaS5zdWJzdHJpbmcoMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQwID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDcS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYUQwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxOiBhQg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ2ggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFDcTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ3MoYUNuLCBhQ3EsIHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhQ3EubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDcVthQl0uaWQgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IHIucmVwbGFjZShhQ25bYUNxW2FCXS5lMV0sICJAIiArIGFDcVthQl0uZjgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFDZyA9IHI7DQogICAgICAgICAgICAgICAgICAgICAgICBhQ2YgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUNsKHIuc2xpY2UoMCwgMTI2KSArICJ8Iik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ3YoZywgYUNxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhQ3EubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBnLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3A6IGZvciAodmFyIGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXogPSAwOyBleiA8IGtkOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ3FbZXpdLmlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNxW2V6XS5mOCA9PT0gYjkuemQuemkoZ1thQl0udXNlcm5hbWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQ3FbZXpdLmlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUNxW2V6XS5mOCA9PT0gZ1thQl0ucnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0gPSBnWy0tZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUNvKHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRDEgPSBuZXcgUmVnRXhwKCJcXEJAWy1cXHdcXFtcXF1dKyIsImciKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByLm1hdGNoKGFEMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRDIgPSBmdW5jdGlvbihyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUNuID0gYUNvKHIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQ24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNSA9IG5ldyBSZWdFeHAoIl5bMC05XSskIik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhQ24ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBhQ25bYUJdLnN1YnN0cmluZygxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBpLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2QgPj0gMSAmJiBrZCA8PSAzICYmIGE1LnRlc3QoaSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFEMCA9IHBhcnNlSW50KGksIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihhRDApICYmIGFEMCA+PSAwICYmIGFEMCA8IGI2LmRhdGEuZy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSByLnJlcGxhY2UoIkAiICsgaSwgIkAiICsgYjYuZGF0YS5nW2FEMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQlEoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRDM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRDQgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFENSA9IC0xOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUQ2ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFENyA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUN5ID0gZnVuY3Rpb24oYUMzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUMzLmlkID09PSAyICYmIGFDMy5hQzUgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS5xcS5hQ0UoYUMzLnJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcFkgPSBibS5xcS5xcihhQzMsIGJtLnFxLnFzKGFDMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFDMy5pZCA9PT0gNSB8fCBhQzMuaWQgPT09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MSgyOSkuYUQ4KCkucXUocFkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQzMuaWQgIT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IGJlLmVGIDwgYUQ2ICsgMjAwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQ1ID09PSBhRDQubGVuZ3RoIC0gMSB8fCAhZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRDUgPSBhRDQubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUQ0LnB1c2goYUMzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICFiaS5lRC5kYXRhWzE0XS52YWx1ZSAmJiBiby5wbGF5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFEMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaS5lRC5kYXRhWzEzXS52YWx1ZSB8fCAoYUQ3ICYmIGYwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEMy5yOShhRDQubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQ5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEQSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURCKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUQ2ID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50RSA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFENyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURBKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFENSA9IChhRDQubGVuZ3RoICsgYUQ1ICsgMiAqIHRoaXMudEUgLSAxKSAlIGFENC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQ5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUQ5KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFENC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRDcgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQzICYmIGFEMy50SCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQzID0gbmV3IHRCKGFEQik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRDMucjkoYUQ1LCBhRDQubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEMy5zaG93KGFENFthRDVdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2UucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURBKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUQzICYmIGFEMy50SCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQzID0gbmV3IHRJKGFEOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRDMucjkoYUQ0Lmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRDMuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ubWVzc2FnZS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRDUgPSBhRDQubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEMyAmJiBhRDMudEgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEMyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUQzICYmIGFEMy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUNHID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUQ0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJPKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYURDID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFERCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhREUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYURGID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFERyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYURIID0gZnVuY3Rpb24oZSwgcFkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBhREQgPSBwWTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEQyA9IG5ldyB0SihbbmV3IHcoTCgxMzApLGFESSxhREQudDggPT09IDAgPyAxIDogMCksIG5ldyB3KEwoMTMxKSxhREosYURLKCkpLCBuZXcgdyhMKDEzMiwgMCwgU1s1M10pLGFETCxhRE0oKSksIG5ldyB3KEwoMTMzKSxhRE4sMCldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRYOiBlLmNsaWVudFgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50WTogZS5jbGllbnRZDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYURPKGFERy5jbGllbnRYLCBhREcuY2xpZW50WSwgMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGNvZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ICE9PSAyOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUREKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUubGVuZ3RoIDwgMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IFNbMzhdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS56ZC5zdGFydHNXaXRoKGNvZGUsICJOdW1wYWQiKSAmJiAhYjkuemQuc3RhcnRzV2l0aChjb2RlLCAiRGlnaXQiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gcGFyc2VJbnQoY29kZVtjb2RlLmxlbmd0aCAtIDFdLCAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZjgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYURFID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hREgoYURHLCBhREQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhREMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYURFID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4IDw9IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYURJKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmOCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhREooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGY4ID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFETCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFETigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFERSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhREYgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4IDw9IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGY4ID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmOCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYURSKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjggPT09IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYURUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCg1LCBiSy5wRShmOCAtIDEsIDAsIDMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRFAoYURGLCBiSy5wRShmOCAtIDEsIDAsIGJuLmR5W2FERl0ubGVuZ3RoIC0gMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhREkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYURELnQ4ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYm0udE4ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCAyOSwgbmV3IHJ3KDI1LHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByeDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogYkUucnkueUooYURELnJ0LCA1KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwyOSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFESigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IGFEQy5lbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFEQy5lcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnROLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhREMgPSBuZXcgdEooW25ldyB3KCJLaWNrIFVzZXIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoMCwgMCkpLCBuZXcgdygiQmxvY2sgQ2hhdCIsYURRLGFEVigxKSksIG5ldyB3KCJDZW5zb3IgVXNlcm5hbWUiLGFEUixhRFYoMikpLCBuZXcgdyhTWzEwM10sYURTLGFEVigzKSksIG5ldyB3KFNbMTAyXSxhRFQsYURWKDQpKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURPKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhREUgPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURGID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRFYoaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYm0uYUJIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0ucXEudDkoYUREKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJtLmFCSC5hQlYgPj0gYURELmEybCB8fCAoaWQgPT09IDAgJiYgYURELmEybCA8IDIwMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxIC0gYm4uZHooaWQsIGJtLmFCSC5hQlYsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFETSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYm0uYUJIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0ucXEudDkoYUREKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURVKGlkLCBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFibS5hQkgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS5xcS50OShhREQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJsID0gYm0uYUJILmFCVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMmwgPj0gYURELmEybCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDEgLSBibi5keihpZCwgYTJsLCBlMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURLKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFibS5hQkgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS5xcS50OShhREQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0uYUJILmFCViA+PSAxMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS5hQkguYUJWID49IGFERC5hMmwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFETCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IGFEQy5lbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFEQy5lcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnROLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYURXID0gYURNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhREMgPSBuZXcgdEooW25ldyB3KGJuLmR5WzVdWzBdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCg1LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFcpLCBuZXcgdyhibi5keVs1XVsxXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoNSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURXKSwgbmV3IHcoYm4uZHlbNV1bMl0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDUsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVyksIG5ldyB3KGJuLmR5WzVdWzNdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCg1LCAzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFcpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRE8oZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICBhREYgPSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFETigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ID09PSAyOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYUJJKGJFLnJ5LnlKKGFERC5ydCwgNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFEUChpZCwgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFDdy5hQ3goNSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFERC5ydA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURRKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gYURDLmVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gYURDLmVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0udE4ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEQyA9IG5ldyB0SihbbmV3IHcoYm4uZHlbMV1bMF0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSgxLCAwKSksIG5ldyB3KGJuLmR5WzFdWzFdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoMSwgMSkpLCBuZXcgdyhibi5keVsxXVsyXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoMSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURVKDEsIDIpKSwgbmV3IHcoYm4uZHlbMV1bM10sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDEsIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSgxLCAzKSksIG5ldyB3KGJuLmR5WzFdWzRdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgxLCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoMSwgNCkpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRE8oZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERSA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICBhREYgPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFEUigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IGFEQy5lbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFEQy5lcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnROLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhREMgPSBuZXcgdEooW25ldyB3KGJuLmR5WzJdWzBdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoMiwgMCkpLCBuZXcgdyhibi5keVsyXVsxXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoMiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURVKDIsIDEpKSwgbmV3IHcoYm4uZHlbMl1bMl0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSgyLCAyKSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFETyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURFID0gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERiA9IDI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURTKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gYURDLmVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gYURDLmVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0udE4ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEQyA9IG5ldyB0SihbbmV3IHcoYm4uZHlbM11bMF0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDMsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSgzLCAwKSksIG5ldyB3KGJuLmR5WzNdWzFdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCgzLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoMywgMSkpLCBuZXcgdyhibi5keVszXVsyXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoMywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURVKDMsIDIpKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURPKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhREUgPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURGID0gMzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRFQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBhREMuZW47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBhREMuZXA7DQogICAgICAgICAgICAgICAgICAgICAgICBibS50Ti5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURDID0gbmV3IHRKKFtuZXcgdyhibi5keVs0XVswXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoNCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURVKDQsIDApKSwgbmV3IHcoYm4uZHlbNF1bMV0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSg0LCAxKSksIG5ldyB3KGJuLmR5WzRdWzJdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEUCg0LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxhRFUoNCwgMikpLCBuZXcgdyhibi5keVs0XVszXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRFAoNCwgMyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYURVKDQsIDMpKSwgbmV3IHcoYm4uZHlbNF1bNF0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYURQKDQsIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGFEVSg0LCA0KSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFETyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURFID0gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFERiA9IDQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURPKGVuLCBlcCwgdFApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEQy5zaG93KGVuLCBlcCwgdFApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0uc3ouc2hvdyhhREMuZW4sIGFEQy5lcCwgYURELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhREUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURDICYmIGFEQy5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURDID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnN6LnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ1MoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc20gPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVNID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXBTZWVkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQnEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFEWCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYURZID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQncgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDYyA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bhd25pbmdTZWVkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMEcgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCdSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucW0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xbiA9IDEwNDg1NzU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUNiID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRFogPSBbew0KICAgICAgICAgICAgICAgICAgICAgICAgZU06IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBtYXBTZWVkOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJxOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgZUY6IDEwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCdzogMA0KICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICBlTTogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcFNlZWQ6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhQnE6IDEsDQogICAgICAgICAgICAgICAgICAgICAgICBlRjogMjAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJ3OiAwDQogICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVNOiAyLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFwU2VlZDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCcTogMiwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVGOiAzMDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhQnc6IDANCiAgICAgICAgICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgZU06IDMsDQogICAgICAgICAgICAgICAgICAgICAgICBtYXBTZWVkOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJxOiAzLA0KICAgICAgICAgICAgICAgICAgICAgICAgZUY6IDQwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCdzogMA0KICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICBlTTogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcFNlZWQ6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhQnE6IDksDQogICAgICAgICAgICAgICAgICAgICAgICBlRjogNTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJ3OiAwDQogICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVNOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFwU2VlZDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCcTogMTAsDQogICAgICAgICAgICAgICAgICAgICAgICBlRjogNjAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJ3OiAwDQogICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVNOiAyLA0KICAgICAgICAgICAgICAgICAgICAgICAgbWFwU2VlZDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCcTogOCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVGOiA3MDAsDQogICAgICAgICAgICAgICAgICAgICAgICBhQnc6IDANCiAgICAgICAgICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgZU06IDMsDQogICAgICAgICAgICAgICAgICAgICAgICBtYXBTZWVkOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgYUJxOiAzLA0KICAgICAgICAgICAgICAgICAgICAgICAgZUY6IDgwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCdzogMA0KICAgICAgICAgICAgICAgICAgICB9XTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUJTKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYURhID0gW107DQogICAgICAgICAgICAgICAgICAgIHZhciBzOCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYURiID0gW107DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBzOC5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzOFthQl0ub25jbGljayA9IHM4W2FCXS5vbm1vdXNlb3ZlciA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzOCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhRGIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm0gPSBmdW5jdGlvbihwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRGMgPSBhRGQocFkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFEYy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTC5hcHBlbmRDaGlsZChhRGNbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwWS5hQzMuaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTC52eDE0MyA9IHBZLmFDMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRGIucHVzaChwTCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5tYXJnaW4gPSAiMC42ZW0gMC42ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkucXYgJiYgKHBMLnN0eWxlLm1hcmdpbkxlZnQgPSBwTC5zdHlsZS5tYXJnaW5SaWdodCA9IFNbNl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUuZm9udCA9IFNbNl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYURlID0gcFkuYUMzLmlkID4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmFDNiAmJiAocEwuc3R5bGUuZm9udFdlaWdodCA9IFNbMzZdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEZSAmJiAocEwuc3R5bGUucGFkZGluZ0xlZnQgPSAiMC43ZW0iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEZSAmJiAocEwuc3R5bGUuZm9udFN0eWxlID0gIml0YWxpYyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuc3R5bGUuZm9udFNpemUgPSBwWS5mb250U2l6ZS50b0ZpeGVkKDIpICsgImVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFEZChwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBwWS5yOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFEYyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBhRGYociwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRGMucHVzaChhRGcociwgcFkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRGMucHVzaChhRGgoci5zdWJzdHJpbmcoMSwgNiksIHBZLCBmMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEYy5wdXNoKGFEZyhyLnN1YnN0cmluZygwLCBmMSksIHBZKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEYy5wdXNoKGFEaChyLnN1YnN0cmluZyhmMSArIDEsIGYxICsgNiksIHBZLCBmMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gci5zdWJzdHJpbmcoZjEgKyA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRGM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYURoKHBOLCBwWSwgZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRGkgPSBhRGoocE4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAwICYmIHBZLmFDMy5pZCA9PT0gMCAmJiBwWS5xdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBZLmZvbnRTaXplID0gYm0ucXEuYUM4KGFEaS50OCwgYURpLmEybCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFkuYUM2ID0gYm0ucXEuYUM5KGFEaS5hMmwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzE0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi50ZXh0Q29udGVudCA9IGFEayhhRGksIHBZLCBmMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5kaXNwbGF5ID0gU1s0OV07DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5jb2xvciA9IGJtLnFxLnQ3KGFEaS50OCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5jdXJzb3IgPSBTWzMxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLm1hcmdpbiA9ICIwIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLmZvbnQgPSBTWzZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUubWluV2lkdGggPSBxZi5zdHlsZS5taW5IZWlnaHQgPSBTWzE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnFxLnQ5KGFEaSkgJiYgKHFmLnN0eWxlLnRleHREZWNvcmF0aW9uID0gU1s2OF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0ucXEuYUM5KGFEaS5hMmwpICYmIChxZi5zdHlsZS5mb250V2VpZ2h0ID0gU1szNl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYub25jbGljayA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS50Ti5hREgoZSwgYURpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgICAgICFiSS5xOSgpICYmIChxZi5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS5zei50QShlLCBhRGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHM4LnB1c2gocWYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHFmOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFEayhhRGksIHBZLCBmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFEbCA9IGFEaS5hQmYgJiYgYURpLmFCZi0tICYmIChwWS5hQzMuaWQgPT09IDIgfHwgKChwWS5hQzMuaWQgPT09IDMgfHwgcFkuYUMzLmlkID09PSA0KSAmJiBmMSAhPT0gMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFEaS51c2VybmFtZSArIChhRGwgPyAiICgiICsgYURpLmFCZSArICIpIiA6ICIiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRGcociwgcFkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxZiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1sxNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYudGV4dENvbnRlbnQgPSByOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWYuc3R5bGUuY29sb3IgPSBwWS5hQzc7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5tYXJnaW4gPSAiMCI7DQogICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5mb250ID0gU1s2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxZjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRGoocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBydCA9IGJGLnJ5LnZKKHBOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRGkgPSBibS50MS5hQm8ocnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFEaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEYS5wdXNoKGFEaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFEYS5sZW5ndGggPiA1MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRGEuc2hpZnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFEaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYURhLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnQgPT09IGFEYVthQl0ucnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYURpID0gYURhW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCIDwgNDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEYS5wdXNoKGFEaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFEaTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYm0udDEuYUJYKHJ0LCBwTiwgMSwgOTk5OTk5LCA5OTk5OTksIDAsIDAsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFEZihyLCBwb3NpdGlvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCID0gci5pbmRleE9mKCJAIiwgcG9zaXRpb24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IHIuc3Vic3RyaW5nKGFCICsgMSwgYUIgKyA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5sZW5ndGggIT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYURmKHIsIGFCICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuemQuc3RhcnRzV2l0aChwTiwgInJvb20iKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRGYociwgYUIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRG0gPSBuZXcgUmVnRXhwKCJeW2EtekEtWjAtOV8tXSskIik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFEbS50ZXN0KHBOKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRGYociwgYUIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRG4gPSByLnN1YnN0cmluZyhhQiArIDYsIGFCICsgNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYURuLmxlbmd0aCAhPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRG8gPSBuZXcgUmVnRXhwKCJeWyA6IS5dKyQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYURvLnRlc3QoYURuKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRGYociwgYUIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDRSA9IGZ1bmN0aW9uKHJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYURwID0gYURiOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhRHAubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGFEcFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVqLnZ4MTQzLnJ0ID09PSBydCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZWouZmlyc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWoucmVtb3ZlQ2hpbGQoZWouZmlyc3RDaGlsZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWoudngxNDMuciA9IFNbOTddOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYURjID0gYURkKGJtLnFxLnFyKGVqLnZ4MTQzLCBibS5xcS5xcyhlai52eDE0MykpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZXogPSAwOyBleiA8IGFEYy5sZW5ndGg7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmFwcGVuZENoaWxkKGFEY1tlel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEcC5zcGxpY2UoYUIsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNNKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYURxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYURyOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYURzOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmogPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYXAgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRHEgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEciA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYURzID0gInJnYmEoMjU1LDI1NSwyNTUsMC4xNikiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xRyA9IG5ldyBBcnJheSg3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaiA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjEyMyA6IDAuMDkzKSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gTWF0aC5mbG9vcigoYTAuYTEucjQoKSA/IDMuOTYgOiA0LjIpICogdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FwID0gTWF0aC5mbG9vcigwLjAyNSAqIHRoaXMuaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUR0ID0gTWF0aC5mbG9vcigwLjI2ICogdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRHUgPSBiOS5wZy5yVigxLCBhRHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1swXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiBNYXRoLmZsb29yKDAuNiAqIHRoaXMuaSAtIHRoaXMuZ2FwIC8gMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogdGhpcy5qLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1czogIk11bHRpcGxheWVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiBhRHUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUR2OiAicmdiYSgyMiw4OCwyMiwwLjgpIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogYUR0DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUR0ID0gTWF0aC5mbG9vcigwLjE4ICogdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEdSA9IGI5LnBnLnJWKDEsIGFEdCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFHWzFdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IHRoaXMuaSAtIHRoaXMucUdbMF0uaSAtIHRoaXMuZ2FwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IHRoaXMuaiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNXM6ICJTaW5nbGUgUGxheWVyIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiBhRHUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUR2OiAicmdiYSgyMiw4OCw4OCwwLjgpIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogYUR0DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1syXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiB0aGlzLmksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogTWF0aC5mbG9vcigwLjMgKiB0aGlzLmopLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1czogIiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDogdGhpcy5xR1sxXS5mb250LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEdjogU1s3M10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHRoaXMucUdbMV0uZm9udFNpemUNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFHWzNdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IHRoaXMuaSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqOiB0aGlzLmosDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVzOiBTWzEwNl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udDogdGhpcy5xR1swXS5mb250LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFEdjogU1s0NV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6IHRoaXMucUdbMF0uZm9udFNpemUNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFHWzRdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IHRoaXMuaSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqOiBNYXRoLmZsb29yKDAuMyAqIHRoaXMuaiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVzOiAiVGhlIGdhbWUgd2FzIHVwZGF0ZWQhIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiB0aGlzLnFHWzFdLmZvbnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUR2OiBTWzczXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogdGhpcy5xR1sxXS5mb250U2l6ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucUdbNV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW46IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXA6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogdGhpcy5xR1swXS5pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IE1hdGguZmxvb3IoMC44ICogdGhpcy5qKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNXM6IFNbOTldLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHRoaXMucUdbMF0uZm9udCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRHY6IFNbNzVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiB0aGlzLnFHWzBdLmZvbnRTaXplDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1s2XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiB0aGlzLnFHWzFdLmksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogdGhpcy5xR1s1XS5qLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1czogU1sxMDZdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHRoaXMucUdbMF0uZm9udCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRHY6IFNbNDVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiB0aGlzLnFHWzBdLmZvbnRTaXplDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOEUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYThFID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gTWF0aC5mbG9vcigwLjU0ICogaC5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucUdbMF0uZW4gPSBNYXRoLmZsb29yKDAuNSAqIGguaSAtIDAuNSAqIHRoaXMuaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFHWzFdLmVuID0gdGhpcy5xR1swXS5lbiArIHRoaXMucUdbMF0uaSArIHRoaXMuZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1syXS5lbiA9IHRoaXMucUdbM10uZW4gPSB0aGlzLnFHWzBdLmVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1s0XS5lbiA9IHRoaXMucUdbNV0uZW4gPSB0aGlzLnFHWzBdLmVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1s2XS5lbiA9IHRoaXMucUdbMV0uZW47DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFHWzBdLmVwID0gTWF0aC5mbG9vcigwLjU0ICogaC5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucUdbMV0uZXAgPSB0aGlzLnFHWzBdLmVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1syXS5lcCA9IE1hdGguZmxvb3IoKGguaiAtIHRoaXMucUdbMl0uaiAtIHRoaXMucUdbM10uaiAtIHRoaXMuZ2FwKSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xR1szXS5lcCA9IHRoaXMucUdbMl0uZXAgKyB0aGlzLnFHWzJdLmogKyB0aGlzLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucUdbNF0uZXAgPSBNYXRoLmZsb29yKChoLmogLSB0aGlzLnFHWzRdLmogLSB0aGlzLnFHWzVdLmogLSB0aGlzLmdhcCkgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucUdbNV0uZXAgPSB0aGlzLnFHWzZdLmVwID0gdGhpcy5xR1s0XS5lcCArIHRoaXMucUdbNF0uaiArIHRoaXMuZ2FwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRHcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEeCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFEeCgxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUR5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRHgoMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRHgoMyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFEeiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUR4KDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUR4KDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUR4KDYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFcgPSBmdW5jdGlvbihlbiwgZXAsIGxYKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCID0gdGhpcy5hMTAoZW4sIGVwLCAwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWEuYTA5KCkgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQiA9IHRoaXMuYTEwKGVuLCBlcCwgMywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFhLmEwOSgpID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIgPSB0aGlzLmExMChlbiwgZXAsIDUsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFEcSAhPT0gYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRHEgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobFgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVC5xZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTAgPSBmdW5jdGlvbihlbiwgZXAsIGFFMCwgc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhRTA7IGFCIDwgYUUwICsgc2l6ZTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA+PSB0aGlzLnFHW2FCXS5lbiAmJiBlcCA+PSB0aGlzLnFHW2FCXS5lcCAmJiBlbiA8PSB0aGlzLnFHW2FCXS5lbiArIHRoaXMucUdbYUJdLmkgJiYgZXAgPD0gdGhpcy5xR1thQl0uZXAgKyB0aGlzLnFHW2FCXS5qKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRHgoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBhWS5xR1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBidXR0b24uZW47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBidXR0b24uZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGJ1dHRvbi5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBidXR0b24uajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJ1dHRvbi5hRHY7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChlbiwgZXAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCID09PSBhRHEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBhRHM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoZW4sIGVwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVXaWR0aCA9IGJiLnkyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBhRHI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VSZWN0KGVuLCBlcCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRTEoYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRTEoYnV0dG9uKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBidXR0b24uZW47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBidXR0b24uZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGJ1dHRvbi5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBidXR0b24uajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUodG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGJ1dHRvbi5mb250Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYURyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYnV0dG9uLmE1cywgTWF0aC5mbG9vcihlbiArIGkgLyAyKSwgTWF0aC5mbG9vcihlcCArIGogLyAyICsgMC4xICogYnV0dG9uLmZvbnRTaXplKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY04oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRTI7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRTM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRTQsIGFFNSwgYUU2LCBhRTcsIGFFOCwgYUU5LCBhRUE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRUI7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRUM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRUQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRUU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRUYgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFRyA9IDE7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLnNldFN0YXRlKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUUyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFMyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBhRTkgPSAicmdiYSgwLDIyMCwxMjAsMC40KSI7DQogICAgICAgICAgICAgICAgICAgICAgICBhRUEgPSBTWzQ1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhRUYgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVFID0gdGhpcy5hRUcgLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVIKDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFNSA9IE1hdGguZmxvb3IoKGEwLmExLnI0KCkgPyAwLjUgOiAwLjI1KSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUU2ID0gYUU1ICsgMTI7DQogICAgICAgICAgICAgICAgICAgICAgICBhRTQgPSBNYXRoLmZsb29yKDAuMTI1ICogYUU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFOCA9IGFFNCAqIDM7DQogICAgICAgICAgICAgICAgICAgICAgICBhRTcgPSBNYXRoLmZsb29yKDAuMjI1ICogYUU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFQyA9IE1hdGguZmxvb3IoMC4zICogYUU0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFQiA9IGI5LnBnLnJWKDAsIGFFQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRUgoYUVJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFFSSAmJiBhRUUgPT09IDEgJiYgYUVGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUVGID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmNsb3NlKGFFRSwgMzI4MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFRSA9IChhRUUgKyAxKSAlIGF6LnkuYUVKOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUVEID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hRUsoYUVFLCA0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFDdy5hRUwoYUVFKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwRCA9IGZ1bmN0aW9uKGEwNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwNyA9PT0gYUVFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUVNKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRU4oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPiBhRUQgKyAxMjAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFTSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFTSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRUUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmEwSigzMjQ5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRUgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUMgPSBNYXRoLmZsb29yKChoLmkgLSBhRTYpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBNYXRoLmZsb29yKDAuNSAqIChoLmogLSBiYi5nYXAgLSBhRTQgLSBhRTcpKSArIGFFNCArIGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA+IG1DICYmIGVuIDwgbUMgKyBhRTYgJiYgZXAgPiBtRCAmJiBlcCA8IG1EICsgYUU3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hMUMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWS5hMFcoZW4sIGVwLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExQyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hME0oMzI2MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnkueigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFhLmEwOSgpICE9PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUVOKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRU8oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFTygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFMiArPSBhRTMgKiAwLjA3ICogKGFFMiA8IDE2ID8gKDUgKyBhRTIpIDogYUUyID4gODQgPyAxMDUgLSBhRTIgOiAxNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUUyID4gMTAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUUyID0gMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFMyA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhRTIgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUUyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRTMgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUU5ID0gU1s3Nl0gKyBNYXRoLmZsb29yKDE5MCAtIDEuOSAqIGFFMikgKyAiLCIgKyBNYXRoLmZsb29yKDEyMCAtIDEuMiAqIGFFMikgKyAiLCIgKyAoMC40ICsgMC4wMDQgKiBhRTIpICsgIikiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVBID0gU1s3Nl0gKyBNYXRoLmZsb29yKDEuOSAqIGFFMikgKyAiLCIgKyBNYXRoLmZsb29yKDEuMiAqIGFFMikgKyAiLCIgKyAoMC44IC0gMC4wMDQgKiBhRTIpICsgIikiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IE1hdGguZmxvb3IoKGguaSAtIGFFNikgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IE1hdGguZmxvb3IoMC41ICogKGguaiAtIGJiLmdhcCAtIGFFNCAtIGFFNykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVQKEwoMTM0KSwgZXAsIDMsIGFFMiAvIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRVEoZW4sIGVwICsgYUU0ICsgYmIuZ2FwLCBhRTYsIGFFNywgTCgzNykpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUVRKGVuLCBlcCwgaSwgaiwgYTVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5taDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KGVuLCBlcCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lV2lkdGggPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZVJlY3QoZW4sIGVwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGguZmxvb3IoMC4zICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGE1cywgTWF0aC5mbG9vcihlbiArIGkgLyAyKSwgTWF0aC5mbG9vcihlcCArIGogLyAyICsgMC4xICogZWcpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRVAodGl0bGUsIGVwLCBhN3YsIHNtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBhRUE7DQogICAgICAgICAgICAgICAgICAgICAgICBhRVIoZXAsIGE3diwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBhRTk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRVIoZXAsIGE3diwgc20pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFUihlcCwgYTd2LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVTKHRpdGxlLCBlcCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUVTKGFFVCwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUodG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGFFQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYUVULCBNYXRoLmZsb29yKDAuNSAqIGguaSksIE1hdGguZmxvb3IoZXAgKyAwLjU4ICogYUU0KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUVSKGVwLCBhN3YsIHNtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUMgPSBNYXRoLmZsb29yKChoLmkgLSBhRTUpIC8gMikgKyBhRTg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbVAgPSBtQyArIE1hdGguZmxvb3Ioc20gKiAoYUU1IC0gMiAqIGFFOCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYTd2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5tb3ZlVG8obUMsIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVUbyhtUCwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVRvKE1hdGguZmxvb3IobUMgLSBhRTggKyBzbSAqIGFFNSksIGVwICsgYUU0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVUbyhtQyAtIGFFOCwgZXAgKyBhRTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uY2xvc2VQYXRoKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY08oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhMDMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhWS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTAzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUgPSBmdW5jdGlvbihhRVUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwMyA9IGFFVTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTA5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTAzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRVYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiUi52Wikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5lRiA8IDQwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PT0gU1szOV0gfHwgZS5rZXkgPT09IFNbMzhdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYUVXKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PT0gU1szOV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwMyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYTAzID09PSA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUVYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiWS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUVXID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYlkucXgoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiUi52Wikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiWS5ndChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwMyA9PT0gNiAmJiBhWi5ndChlbiwgZXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJYLmd0KGVuLCBlcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhVC5ndChlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwMyA9PT0gMCkge30gZWxzZSBpZiAoYTAzID09PSA3KSB7fQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFcgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVQuYTg3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFZLmEwVyhlbiwgZXAsIHRydWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhVC5hMFcoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2sgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFULmEwdigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMFogPSBmdW5jdGlvbihlbiwgZXAsIGRlbHRhWSkge30NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVkuYThFKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAzID09PSA4IHx8IGEwMyA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54NygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwMyAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFULnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU8udG4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFFWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJYLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAzID09PSAwKSB7fSBlbHNlIGlmIChhMDMgPT09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWi50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYlkudG4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudG4oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYlIudlopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCBoLmksIGguaik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFFYSA9IGguaSAvIGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFFYiA9IGguaiAvIGJSLmVzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gYUVhID4gYUViID8gYUVhIDogYUViOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKGVLLCAwLCAwLCBlSywgTWF0aC5mbG9vcigoaC5pIC0gZUsgKiBiUi5lcikgLyAyKSwgTWF0aC5mbG9vcigoaC5qIC0gZUsgKiBiUi5lcykgLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYlIudmIsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubWg7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCBoLmksIGguaik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFWiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gTWF0aC5mbG9vcigwLjMgKiBoLmopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGFiLmFFYyhTWzIxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGMgPSAxLjc1ICogaC5qIC8gY2FudmFzLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGMgPSAoaGMgKiBjYW52YXMud2lkdGgpIDwgKDAuOTggKiBoLmkpID8gKDAuOTggKiBoLmkgLyBjYW52YXMud2lkdGgpIDogaGM7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5nbG9iYWxBbHBoYSA9IDAuMTU7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IE1hdGguZmxvb3IoMC41ICogKGguaSAtIGhjICogY2FudmFzLndpZHRoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBlbiA9IE1hdGguZmxvb3IoZW4gLyBoYyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTVIID0gTWF0aC5mbG9vcihlcCAtIDAuNSAqIGNhbnZhcy5oZWlnaHQgKiBoYyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNUggPSBNYXRoLmZsb29yKGE1SCAvIGhjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybShoYywgMCwgMCwgaGMsIGVuLCBhNUgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGNhbnZhcywgZW4sIGE1SCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5nbG9iYWxBbHBoYSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY24oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJ1ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVmOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVnOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVoOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVqID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKHFrLCBhQnIsIGFCcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC54KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBibS50SCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuc2V0U3RhdGUoMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVoID0gcWs7DQogICAgICAgICAgICAgICAgICAgICAgICBhRWkgPSBhQnI7DQogICAgICAgICAgICAgICAgICAgICAgICBhRWogPSBhQnM7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFCdSA9IHFrLmFCdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUVkID0gYUJzOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFZiA9IGJlLmVGICsgNDUwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYTBHID0gcWsuYTBHOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYTBGID09PSBxay5hMEcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGlyZWN0IHBhc3MiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRWcgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGVsYXllZCBwYXNzIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZShhei55LmEwRiwgMzI0Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUVnID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hRUsocWsuYTBHLCA1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5hRWsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRWwoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFbSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFaCA9IGFFaSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhRWogPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRWcgPiAwICYmIGJlLmVGID4gYUVmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUVuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRW4oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRWctLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFZiArPSA0NTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmFFbyA9PT0gMCAmJiBiZS5qcygpID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hRUsoYXoueS5hMEcsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUVwID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgIT09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYm0uYUJKLmFCdihhRWgsIGFFaSwgYUVqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFhLmEwOSgpICE9PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFFZSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFFZSA+PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm0uYUJKLmFCdihhRWgsIGFFaSwgYUVqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFbCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhYS54NygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVyKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUVyKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGFiLmFFYyhTWzg0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbU8gPSAoYTAuYTEucjQoKSA/IDAuMzk2IDogMC4yNSkgKiBoLnBpIC8gY2FudmFzLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKG1PLCAwLCAwLCBtTywgTWF0aC5mbG9vcigoaC5pIC0gbU8gKiBjYW52YXMud2lkdGgpIC8gMiksIE1hdGguZmxvb3IoKGguaiAtIG1PICogY2FudmFzLmhlaWdodCkgLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShjYW52YXMsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNQKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgek07DQogICAgICAgICAgICAgICAgICAgIHZhciBhRXQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW52YXMgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFdSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbnZhc1tlMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFYyA9IGZ1bmN0aW9uKG5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gek0ubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6TVthQl0gPT09IG5hbWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbnZhc1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFFdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc04gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhRXMgPD0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUV2ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV3KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRXUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXMgPSAyMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyA9IG5ldyBBcnJheShhRXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgek0gPSBuZXcgQXJyYXkoYUVzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMCwgImV4aXQiLCA2LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUZZQUFBQkdCQU1BQUFDa3JuNWZBQUFBSGxCTVZFVUFBQUFpSkNJNE9qZGNYbHRvYW1lSWlvZWpwcVBFeHNQWTI5ai8vLzl4YXJaSUFBQUF5VWxFUVZSSXgrM1dRUXFDUUJURzhUZE9CNURVSStTNm5SY29QSUZodTFiQkhHR080QW55M1RZeEFrV1R2MURTWXI3MUQ0YjVtT0U5a1dtc3prZUMvWnB0VDZPY2wreGo1cWd0YlZSMWlabjlWRTJ3VTJ1TzJKcnlobTJoMk9hS2JkWmd1L05LclhWSzdmNnExSnBhcVRXRllwdnJVdHFoUFRUWXBzdDBhQk92MkRybHRseGgzOTJpdTBVMXQ1STRiaVgxM1BadkY3K3p2T0ZXaWhYV2xOeSthcVovTTNMY2l2WGNkczF4SzlrS0szR1lBVnRZZSs4Q1ovYy83QnI5YmxTTmNnbjc1Ty90RTI2VGFzVXZIMEltQUFBQUFFbEZUa1N1UW1DQyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDEsICJ2aWN0b3J5IiwgNiwgImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFEWUFBQUFLQVFNQUFBREZNejlJQUFBQUJsQk1WRVVBQUFELy8vK2wyWi9kQUFBQVNVbEVRVlFJMTJNNGx2aisrK2VmTFF6SGtvSDBqeGFHSSt5TWJjSWNaeGlPcEVIb015RDZ4eCtHSEJCOW9JSWhBMFEvTUdDb1NBZlNCUVlNQnNrUDJ6OWJBT2xFSUMxaEFBREpZU0ZNdnhYWFRBQUFBQUJKUlU1RXJrSmdnZz09Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMiwgImRlZmVhdCIsIDYsIFNbMjNdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFeigzLCAib3JkZXJzIiwgNiwgImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUJxUUFBQUJrQkFNQUFBQVN4a3lGQUFBQUdGQk1WRVVBQUFBc0xpeEtTMGxrWm1PRmg0U3FyS25NenN2Ly8vOEo3aDF4QUFBZ0FFbEVRVlI0MnUxZFMzZmJOckNtK05KV2FSTjdxOXZXOGxhM1NheXQwdHJtVmtsdGN5dS94SzBUaStUZnY4U0xtQUVHSUJUTDV5YXRlSHJTV05IbndldkREQVl6d3lnaW5nODNWZHM5emVQZlVlQnpRQndRQjRUeitjaS9MNTdtbndQaWdEZ2dYb1JJQVlDRGxnZkVBWEZBZkQvaVkyczkveHdRQjhRQjhiMklTOEc4eDZzL0o2UGZMNFRKMkQ0Y0VBZkVBZkVDUkhNMVVUK1BMcW9CekFGeFFCd1Fic1FaKy9mSEtmd292bUdmM1I4UUI4UUJzVHNpSXkxRGJqMnVRaER4em9qb2dEZ2cvc1VJNXN0b2lIL0xLcGRmdzBEOHNUTWlPaUFPaUg4dklpcGRiR1BzckFNUVY3c2hSbVU5MlZsRzlKcUlrOHE0YWZnaFduVkEvS3lJV2ZjUG4ybjk5YTc3cDd0QlJMYmREWkczN1hwWEdidTNhZ2ZFV1dzNWNGNnBWV25WZlA2UmVuNUF2QWFDcWJVSGo2ZkRWbTBtNG15N0c2TEUzQTZTRVUxMlJnVDM0NTI2YUxoL1BSbTY2ODNrbFdXOEtpTGRQUHlBcmZwZVJMNTZEUm5zMDlydEN5eUozMmNnNG1xN0c0S3Qzczc4K3pBTmx4RkZxeDFiRmQ2UFdGK0xMMTlMaG55U3RyNkJOc1FlWmFUR1FuaDhsWDZNdXJHNi9hNVYwcS9QNXRWR2QzZEUwVXgyUUZ4dVpJVGZKejhpNHp5THA1SGJkYkdpRVBEbjdVNklsQy9lVWRrK2g4dUlrdldPclFydng2bStENjlmUzBiLzQzSlVyUU1SeWFhblJYU3krVHlBS0hIRHl1MnI5Q05uUytxN1ZvbGN3NjJrNUd1TTdzNkl1RzIvN1lEUVc2OG1GWUZnTk92c25keEo5ak5ySXlnTmQzeUJLVFdJS1BqaWhkYmZzSXdvL2JwanE0TDdFY01ZaytYcnlOQ255T2h0OVRVUVVlZ2paOUxONjlTTGlLdDE1TmptOXRtUDA3WnAyL24zckJLOUtwdlhHdDJkRVVmR2pBOGdmcjNScEhxWU9CR1pNTzZMdG5ib3FaRkp3d3dkQjdqZHRBMUczR3cybGEwVEJtVjBpM0c3VzZ2Qys1SHpiV2NaOHd2eTU5ZVJvWCtlVnUxVEdHSUVSb2kxY2UxRkdLWkNBYmJmZ0g0czdnTDdVYlR6QmVYOUNoMHJ2Vys5d3VqdWpHQ3V2SjNXbFZna0tHcldRckN0Y0NYKzU5SlRXV3ZPbGlWMEc0cklVTmpodDJBWjBlaTRudXpVcXZCK0ZHcGN6MHlqWm44eTlGbHFqYnlkUGtRS21yUG8vdjdrUmVSb3JZd1FjUWY3a1ZUTlBLd2ZSVHM1SmdjaGNLejR2SzlmYVhSM1JmQVRTTHZidXRMeDZNcDFheUs2YjlSaVVEdE9UVnluUEdpd0tnUVV1ZzFGNUloUzYyQVo3elpXaHNvQUlyd2ZiYjhQbGFZZHNEY1ordC9YdlFVM2hFaUZGNmR2MlpNWHNVQlRuN1ZJRnc2MXFyRE8yQzdFb24yb09zTXY2VXlnWnZzZDg4SG4vZW0xUm5kSEJEOUViM2VVTWRLSzZqT0ZZRDczVmErL3RrNnEzeEdJZm9lemdVNEUxbExUVUJrbjlyM1JBQ0s4SDJ6bGZ0V3RXNytHRFAyTTE0UktweEVKNi9KY0gwSFdYa1NCak5ZY1UycWdWWmtkV2VOQ0NQZkVwYlVsQm82Vk9MZHVYMnQwZDBPTUt0R0p6V1EzR1dkcS9aTDlpS3JldG1BYTdaRnVWd1h0b2NydytPUUUwNTBJNUFwb1FtVmsxTDJSdjFYaC9jajF3bVVyOXpsNkJSbmczTG0yZkZST0JGam9pRklrNGdpTjV4aFR5dDhxc2JRTTVlbEFzQW44VXRyKzBiL0R4aXBCdUgyUDdvNElhZmVsTzgvNXU5Nlg5WnY5cFF6Y01zVFdnZ0tPa1JXRmlOQlJKQWdCTXlPM2dUSkc5TDJSdDFYaC9SaUR0Ymd3VDVSN2tnSCtkVzJObG5lczFoYTdISWdNZmVQVW9KUzNWZXk2MHJyT2RDRzYzMXpZZStKc0d6WldHY0xaaU5tR1BiQWw3Ni81UjlkLzduOCtVckVJVHcwWFpvQ01FN2wrNDgzVVJIUjhBT2ZTeEhWTm5BQ2ZIa0tvZldjYmpGZ0FTajBGeWppaTc0MThyYUlmRWxFQU4wbHVYcnJzUjhibFp0VWI2bXZ0UVRyWjNIdGxhRW9sZURzaEVDbmJFSHNsZnI0SUgxMXV4NnlPVEJ2QWhSZ0RTclY2aVczRHhpcEhsTElRc2Jsemd1VDB4ejNPT2ZqdGE4czBDWkZ4SmxvNUUwaUlpTEQvTzJzZHhDLzBTak05NWtja3BaeUluUFpPK0dTTUtzZTlrYWRWam9kQ2xQaVUwZ2IzUEZnRzg4TmVpNmZhck52SFZ2MGd0MGVYakxJLzVXVXRicGlOeUpjZzFDbCtNQ25sNmNlWk9LU1dyWFhiU0NMR2hKWTZFeXNnWUt3V1dMdVpDTFU2dmxxZUFOVzYvY3c1NThHS2MyR2Ftc3NxU01ZbFYxTEVER2FFRytBTHJhOVhOSUpQQlNIWGhVakJHSzNDWkNDWHhuTllxOXlIVlFzQktaVllsTnFIak5OMjA3Zi9jajFiOXo5c2hHU1hqRVUvc21iTWdvMFlyNC8waUdiYlkweXB2eTNFZTlYakczbU1ZaWFLVHJKNzcyeVZyYVY0THQ0MmJLd3FUQ2tUTWRhVWlxK3ZOMGFwaCtuZTVseU1icmZTUjFjOEtCWXY0QkFabzVJcktia2d3ZmNXNXVFcmN3VGRWbW90bTRoRW5ZcXlTUkJpQklab0hpYWpRQzZOU1VpclBJZFZDMUdDWVlzdFN1MURSbEVuZmZ2UDF2bTY2dnRTZnZYSkdQZVdibTRtRVZpSS9DSFZLeVBmanZ1ZG5qK2R5WThSY2J0aFNkOXZlYnEzOEpkay9LOVgzYVFrRjV2VzJTcEVxVHYyNWFwZms0TmpsWnBuTUFNQktGWGExVk5XZTV0enllNWJoMDRJa1pFK3lOalFPVUlRZXEzVFU0MnBwOTZ1dEdZekViT2VVaXVIdmpVUVlLaWlNQVN1OWJUMElKWmVvOW9oWTRCU3pwNFBXeG9LVWRUYTBYblJsR3U5UFpUZmZESzBianB1clF0SUE1RnRwbVh2dGN2ckhIMC9hYzBaNUEyU2NTenF5bExlVkd3MmNtN29WaUZLR2E2bXdiR2FtU2RpQTZFcEZSTXkxbnVhRDIzN1BLaGowZXA3NW54RzJLTXBvZGVZZy9BVC9PRE5XZGVYVEs1bEMxSDFsTEt2VzBqRXFaTlNEa1RhdXE2SFRVVFNMbjNIMUNVdEF4cCthWENyL0pZR1JrRERiMTAySjZiaDU1S1I5WlFxREpQWFJzU2JkZDZmaFBNR1V5cTFaaENzV01hb2JKVXZSUjRtbUJ1NlZUNUtEWTVWWlZydkJrSlRLbThkV21vUDh3Rk9kUS9TNFJtbHR6dlB1VXBnbUFJRWEvZUVjaENDTERsZVlYUEY3TFUxaFVqN0FjME1PODZGeU9scktUZkNHTnhuTnlJMzcxYXdkbnlpWlJUZzJKRUh0OHJ6V0FqbW5uZ3ZucXIrWlZyMFA2aDVjTWhJKzNDWjB2U1Btb2hrZWZuSXBsamFpVTJLRE1XMEEyT0VwdFJteWJhYlZjNDhXOEMvNW15VmoxSkRZNVZoNzRPTjBKU2laQ3ozTkIvUTU4VWlXOW5TT0VYaFhFRXladUFvb2hBc1ZqYWlMN0tVbnZxMWxIMHBsV3F2cVYvTEtmWFpYTU1rSW5WU3lvRTR4dU5hdXhGRjY5YlRLbDdZbHJFQXFIRndxM3lQaGJqc3grYW8zZHowNG1hOWk0MldvVjNubGVVZk5SRFpiYjVabnNtZFBNM2F2OUJBOFh3U2hPZ29KZTUzV1ltRHVHeFhPVjljc3BSV0kzUTEyU29mcFliR2FrRUZva0dFcGhSeGxHb24rNW9QNlBQcWR1Rzgwd1lWY25VSHlaQnIveFlpdXQrelJpY05wWmc2UVo5NmQ1RG9TeTdXV21YTnJLWlViVjVCa0FoOU5HcnNTd3NLc1RESzVyb1JoREdKcEU1SkdaQkdKVUZLVnovY2o0WEllb3VVR3d2TC9udEx2d3h3SmpkTkVBT1IxWEhGSFJSTWlaLzkycTdoaFg2K0tsY3hSblNVaXMvUHovOVMxNUVkcGRxYW14bC9uSi8vL1lzWVI3SlZYa3I1eHlvaHpzTVk0YWVVY0tQc1lUNlF6NnVaNUxWcG5nVEpFSWFmMUc0U2tZQjVLdTRuaUgvTWhQb0lWbkhHWFJ1SkhZU3VLV1djWkdnRTZNd3pZUmZZaURmbUJMNXhJYkxXbzZWTzVlWm95d0JoQjRscFgvbjY0VFhlTVNKSEJON3FOcTM5TXBSeWlxMnJFeFBSc2ZOc3M1UU9pcHRsdFMzQkVoazNsMzlWR0JHRGExck9WKzRLK2FTOU5NNVdlU25sSDZ1Y2p1MEVDRCtsUkpmMk1CK0EzYnp2YTc0bzE3dk4rVVNvcVR1aGpRU0MvUStJUU1VazJOU2thTzN6WDU4WmF1QVlVUW9uU05JSWJiQVQ1eDRLWVkrdEMzRnFXVWNHK2VsK3hOcWFQQ1VyNFRqNjRYbE14RUp2SDVCU3BSNHhXb1k2UXFYR09yUVJlWHVmVkxXOHF0K3N5MllCZmxmT3JFMk02Q2tsRFpHVldPNlBjMGdwc2xWZVN2bkhxcUlNRFlRWW9KUXlSbDQ2SC9pQXZzb21WZ2pRc0l6UkkxZFQzU3BlTEh0RTE0RWFzaGJlbmMvdWdEcDU2by8zWTJ6ZGpVcEVxWHBpT3dUR3RqbktFZ1BhNW1IaWNDR016ZU9TajFJUVlhUm1uUFBnc0t1cEprNUR5Nmo2M0cxaTVYcjZFZmxkSVFBQkVnVEdqM3Jxd01lMERPWG95d2d6R1NPeWJtNHYyenZob0dqckdmTXh6dlYyMGxRTlJqRFN4TzgvWE56ME83VmM3WS9uNSsvbmlsSlVxL3lVOG8xVlJwb25DREZFcWVmOXpJZGNWZEwxdWhvSmZYTzcwNXdmZFJTYWNTVWxpQzdjWHdYb1hGcGhUazFCa1pPMTJHbTNHQUVIYVV0ZEVsTUl4VVhPcDlnK3Z0b0lQNlVBSW9ickxyN1JMcTIvSWtnNFc4YXBUSDNoNnJPbUR0WE9mamdlQXpFQ045VGpxNTVTS1lyWHBXU2N5clZLRlh6QWlPNTMzU1ZWYzhNNzJUWWZtWWRoQ1kzK0dpTVlhVEprL01BZkZLV29WdmtwNVJ1cmtneEVRNGdoU3RWN21ROFZjQ0NWeGx6cXora3VjejVpKzJGY01TVWwraTcrVnhubVk3dWRJQnFpK3dCKy9qTE9hMmNHcGJiMnFkQTY0WTIwcjcwMFF4SXB4SWR6ODNFZ2NyNkxaVXZ6OXF0YmpadnFpZHVvVDZRTVllQnVCQW5yYS9UODQrekg0SGtZZWlmMCtnYVV5cEduZ3BJeGxsUWFFMXczRUZXbnBzNFlrZHI3YnJidnNUL2pqQzlqaUFpakZOVXFQNlU4WTVYUWdXZ0lNVVNwSnRySGZDaTdiNVZKLzBJbVVzeEJ0TUtnakNPK05jenVlRlVRN1ovQW5YdG41UGhWT0hDSUc1WVlvZldZcEJTbUNJRkFLZGwyQ1RRU01YVHlWQWh4d2x5SU83WEsydDVTdVN4dEdTZXQ1M2w0WWF2RU5WSGIxMW9CbERvRkg5TXlsSGFpOG1jTVJQZVYrMFRtUGMzYXBvVEtJRW1xeHdsR2hGR0thcFdmVXA2eFd0QlgvQWdSUkNtTktQa3ZxL2pucGFKckgySmM5dmR1VnF0S0tlVnM4M2l0UEdiTHFId09YNG1pTEUwODU5M3FIUk9KY1hCZ2JkRit2OHl3dExwaG5odUlyRFVvaFF0dkVnanVzT1d2RkJuSmx6UXVoeEQrQnlDRW0xeFVyODZzeVpncU43b2w0NnoxUHJjdmF4VmZUSFhienhhZ1ZObDkvTlhiODB6ZVlKUXREdGtqRUx3MGxyZ3BXWGVEdklHSXhhcFlHb2d3U2xHdDhsUEtQVllKZmJPSUVVR0duMGFFVUlvdE1iTlZDUzU5RW9zT3BPRDRPVFRubWJKZ0U2VjJHWUtkV3UwNzNnZmJjVjhyWHE0eVZ6eXJvbFJ0TU5sRUtIOUdveStuNW43RTBOTWpzbDRYZFdOWUVMNGk1U2MxWkx6ek0wb1lBQUlob2lRenRZS1NqUXpkRnAxaGlxQ1M3aHdzbzNwb0Y3Vk5xZXBhZjB6M1hPVWRWSlF2RXlGUzlwMzZ0MHBNUW9FelBJdjY4dTlyakJqNUtMVk1sQ1loV3VXbmxIc0dGOEFPRjQ5MEwwSkVrSHRDSThJbzlXeTFTcHhwL2hHRWVTTitYTElXZmd0ZGlhV3lZTWY5NGJCRGRHWkZUWER2M25MY2YxTy9aWTBSSUk5SlVhbzFTc0lhQ0NyTXBQWWljcWY2TnhISGZDYkU2WU9mUGg5L3I5Qms1SEpLc0l5a0dxQlUxeVdGcVBUaTJ5cXp0NDVnNUpxaUZKSVJ0MWZ0UnhYWm9pbVZkaC9talh1czFQYTVFbGUrYTN0V0FTTGpPWVFQUjJLWHl2RElMcHJ5cHNhSVFFb1JyUnFnRkViOHp1S3VySXNnTStKQ0k0WW90Y1NJTUVvMVZqK3Ezdmo2L1dKeng3OVk4eFkya1hjK0RFN1dhdGVUanNoMTEzN3JZdlNrNTlUTUNsUXQycWV4bGJCb1VzcElZbk1qV3BnZzRFYU1oeWpWSTBxNSt0bUt6c1VwRGRLbDZUMkNXRVl4eEtodXZCUUNVK3EwSDUycUQ1aFJsRUl5c3ZhUDlyM2FiRFNsOGlacjA5N1VzSHJlaDArc3paeGVDcEZ0ZWRjZlJJRVNXVXhDNzB2Q1hROFJYV3ZkbEVvVmxtalZBS1VRb3REVUppa3lOeEZEVjcxVGU4NkhLZFhOaTlFUFhSd29yUm9CV0FzMXVveTg4NEdWeVVwSmtlRndUOTN2K0dwOStXMGxYazBGTTJuWDZscjNHU01LZ2xJb25jbEVnTnJqWHlNeVhjT1NNVWdwaGVBYnVnb3pVTG52a0ZOTDVVWkhNaEo1RzNOTlB6dy9yMGVJOVRxV0hhNzZybGU5UGxPVVFqSllFT3RjT1NJMHBSWjExa2E5ZjhMcWViK2RQdkdkMEg0OUJFSms3VElUc2UyOFNZV1o2TWZ4RUZHMTgzU1lVa1NyQmlnRkVhbjI4R1h1bTF1SUdOSlNXeXhqbUZKZjMvSkpOL3FoRENSRzZSWG5VaU5XZk8xZWlYWVlTTjByckVZaXVuRW5mSVNNVTNlbzNJTXVON1ZGQ0VBUVRTbDBOV1VpZ0djYlVtcnJSa1FaR3hlK3NoK3Z1WXU3a3FHZUprTFVhY3A3ZmRSeEI0ZFdyN240SjBQR0thckZTNThBZWdUL1pVK1NVZ2s4YXlrUmlsSklSdkhjVWFwNE5pbFZmdTBvMWZzbnJKNzNKdnN6ZHoxRWI2K3NlUVdJdEp2Z1M3M2w1RER1NStSTnBlcVphMFRGaU9PZzFMeW5GTkdxQVVwQlJPNU5LRlF4QkJBeFJDbGhQdmNJazFKUHZTbWtZMDk0dUwvUkQ5VUJrUmtveXJRZjRhUlllajZRNGJpS1VIeEFoK0RHbi8xMHEvQU8yME56SmFRdXpkZEMyWlRDS1hRSW9jM3A1bW9hL1hwSjNGT1lNc1FSU1liaHFhRTJBbWNGWXRFcjcyOXNLbXR4WEFSeDc3VjZ2eGFTVWZuaUF1V0FUUlFDVVlwSE9KWEtsL2psUk0yZnBCU1VzZTRvcFU1Tm1sSlZkLzZORnJXejUxSHZQZS82OHpXcFRFV0ZFTjBlKzFudmNjc1lxdi95N3Ayb0tnb1JQa3BOTWswcHExV0RsTklJVFpDc2RYc2JhRVRwT3RoQ1JDQ2xWbVkvY2xRamh2bk01bnpxN2lQUFNqVFBMelZZUWl1QkVHdU8wRk9iS1U3N0EyRXRFRkdRbElJZVBBTnhhbmdrVXR0RFljb1lwcFJDVkswYWw3V291U3ZQVXhuWTRNU2ZVRVpLeHhyaTA4d1V5bWlmWklsUzl2dlhwM3poVnJKMWZQNmV6SDdFN1NwbHYyT0NLWlV5MzJIVSt5ZnNucXNoYTNnaDJhUFdybWtBRWF5VVQycW95MldVc0x2cXNzNXVMVVRGWGVVMHBYUldBZEdxQVVwQmhELzdTZWN0VWdnSHBmRG9CbFBLNkFkTXdQekNrbHVlaWVvZVRlVzZsaXFSSWxqMEFkbU5pMUxSRzV4UXNhV0ZKQzFKS2JpWFlzVElLaDl4WkttcDc2YVVxQjh1bmM1OCt5dGxOc0JNQ3lsYWMzakh2a2hibWxMZkNrMnA2SmNBU21Xc0NNODBVWmVaaWxJNU94ZEh2WCtDbnNLeFBCODFjdlc0S2NVS0RVL2Y5YjVIUG9IenVCTGRubjI1bmhpSVVqU1pvbFNqZmNIN29sUzVMMHB0OTBJcFJQRjdIdEZqMXU3MlVPb0k2NEZjQ21hVVFyOGptZEx1Y1cxZkdzV1pqaHlVYXV4ckZVUGJycTBBalMyTkNLR1VST1RLNHVPSDY4ZmVXekxWdy9jc3Z3UmxGRU92ZnNoRU9WSjlQY1JmNHROVFNyeTF3YVlVbEpFenFrK1ZJNktuMUlMWmp0MCtzM0wxSEk3Wk5yWnp3UXpFR1lzalA0R0hxWVp2SjNXbjZxb050L1lob3V4UGZpU2x0czVXRFZBS0lnWUo4cnd6WW9zUXdaUktyU3d0R0NBekljTHA2UGt3M1gxS3Qzd1RpQWlWS0RxdTV4RkpsMXVrbHVaME9DdWdGS3pnaUJBbFRzNUVjcWEwakFCS1NZUjJvWGZ5NTFwYXJmZUhSdDQ4R0tYR253Y0NManZ4Q1F5dXJLc0FTa0VaeFRPbmxQUlA5SlFxV1RtSTduKzNycDZyWUdhK0N4R3g2QmlSOFBpdWYyUW9DQzlPVjNldGF5NlprbTM3L0RqZHFpQktFYTBhb0JSRURCSmt2VE5paXhEQmxETDdFWnRYb3dzekI0R2VEL3NrRmZWNXF3bW4xQlE2TVVCcUJ1aVBmdXRVaktKMTA5WkZxVzFFSW9pVGsvNXNUY29Jb1pSQWNLTlNtcFlyZEsyMjFWTEVVV3NPWkNTMjNaZGFUdlM2YjFXbEF6OU1TbkgzeExxbkZPeEhwNTZZZVhmVUlFcU51RG5DbFpXajU5d0NqMFRjMW54aHAyeGlSUDU1ZEtPTEh2RTIzYkY4bTV5OWRsR2E0eERob1ZUZERmbzNaNnNHS0FVUmd3U1o3NHo0aGhCbEMyOXo1Y0dmb3BUVmo5S09BTDJOMHFWcmROMG5xYWl2K2gxelNnR2I1d2F3aHk1Zk9VSWFadWFrbEQ3dUk4UXhWYmE1TW1nMnN0NzNNMFNwa1hSUktTZWNHUFVUZEpNOGcyNzBOWkNSVThVRTdWbFVDTFlkc21EdnlxWVV1cGRhd1g3RTNPNWc0VjhUU0NtbXVCaWxsSC9DN2prenpwbVQ5NkxpNTE0V2VuY3h0M3JlZjdsWmdkcXNhMTVLamZHUUhRaE9aY2xMaURqbU1SNGtwYmJkSW5seXRtcUFVaEFSRmw2MEMwSzBxMGNNVTByZVMxbjl5SzF3dFc0SmxuUFg2UHFVbEVxeUgzRkt3VDBQdkxOdFFkY2pRdVo4NWFRVTJQY2hBbVhMWkYramUvVGhuSklSUWltQk9PMFowejFYNXpkR0VFdlphc2YzRnNnWTA5YVU1YmVWQ0U2cDFrbXBHbHhZYUJtTVNveFMwaitoS01Xb2xMV2dzSlI5V0dLdFp1K0VIVjNjaVZwSmhaa1BDeEFKNDk5SGZUak5KUS9aMzh0UE5pTG5GNU1rcGVDTnBkMHFSYWxtUTFJS0lzSXVibmRCeUZPRkZSL2hwSlJhWEdZL1lqTjRvTk5RUjYxemROMG5xVWpudlptVTR0NTVvYWZBSFM0S2FvVkMwdFpOcVpwQ3hFanZGVjhqcGxWL3RiTFN2cE5TaTk2dUkySXRKaXFLZ244WlVzb3VxWlNTb1JxYVVqWDdhMGxTcWxtU2xHTGM0WDQ5NFo5UWxGcHNCYVY2LzRUVmMra2hmVnpLVFpYWDExdzVKNzFzbTRlcHFyL1RSUEhOWittaDJmelJSQlNsdG5EcmhKUjZBamVXTGtveHFpY3ZwWlJCa04xSkdFZ3BxaCtGZGFwTFBSdVcwOTBudjZvcGhSUmJyNmVPNlBnN3BBcFBQWlRxVlE1RTVJaFNaVWVwKzR2S0dpdlM4R3VHRFQ5MkVDY2pNK1h2em5zM2VqTUZNaXFyZWt0S0pIZEF3Mi9ML2xyUVdxcUpLTU9QdVNVNHBZUi9RbEdxWEF0S0tVK2czZk4rUUIrWDR1NGp4eWMvQXpIamdWVlhGenBuNWt4c2l2SGxIWUZnVjA4NVRhbTF2bDV4R1g3L1dKYks5eGgraGhtM3U2a1lScW1hNmtkdWJaeUZYV2g4NGcrY0FPWkViL2poNDFkYzhsRENVVWxIaWFNRFcrbWoxQmNDY1lvb2RRUURrb0RyM1Q0VXhtL2V2SWxHM1IrVFNQM3hobWhWVXRFRlNwWEVRa1UxTElHTTJLN2VraElwaU5BOThjeit1ckFwZGZzT25hVkFQNnExcEZSZUEwcU5ST0Fibzl6VzBmTlRZQ3Z3Qk9BRnBwU0J3Q0gxZDhyWXVJdlN6WnhBcEgzWWtrVXAxbzI1enoxeHViUVh3ZXA3M0JQZlh1alFDS1BVTGRXUGtlbDh6UEJ5ZDdnbk1rSkpzWm5xM1JQRzBUem1sYW95TXFBVnV4V3oxa2NwZGRVREVTVSthbjJLcUxIeXVDNWRqMEtrU3plbEdsbElZeDdGS3lnajY0V2RxTmVFTVVxWmlmTFFpZjdrb0JSM2VsQk85RmlFUmMwajZaK1FsSktmUkwxL3d1NDVvTWczbm8xdEZQTXpFZThncHpvcjlGS21FNWIzRkNMQm9laVFVaXkzWStKem9zL3RmZlZ6OUQxTzlPMEwzZTdEVG5TNUtSTDlLRnc2ME9kRUgxRktpaTJGM29sdVhtWEYxVDJVZGUrOFdqejFVb3E2dmpTMGZSUlJZK1c1WVBNRjRVbEU3TXpQRUtiZnM0bFEzb21UQ3Q0aU5rNFprbExObUtDVTY2bzNZMXRkS3FyQ3JUU2xjcEUxcWI1QTlEeEJPcnlUbUJqN3BvVkliMkF5eTBaRmxldnpNRUpVbkRvVXBhWWdzNUc4NnAxWXEvSUwyYW9kTDI1M3Z4d091WmR5OVNOMzJLSFI4TlU3a1dZb3IzcUpnSXQ0Q29OYnA2NEFtRkhscDlUV1FpVFdYbkNDZjhkWEt3ems0N1gvbVZxSXhlTzVOUk9OMHYybFdvNGFJUzRVM2xiZ1VwdWtGQWhJZXFxQ0tLVmxqSDVUZjBTL0FDMFYvNC8rdHdrWkFKTWpTbFhpS0ZWN1FtYTZ1UnQ5dU40WUwyVmlCZ0dKcUlEM0gxRUt4Q001QXBMTWdESllRditIQzBoeTlTTjJ4T1Q2QXBKb0pTWExIcnBqL0daMjNJUWxKR3Y5bEpJYkk0MVFTeGEvNG01cmRhUWNTQTIwWlBDeW4yV3pURW9vN0V6dUR1bks2a2VGWHhIUkJGS3FIcU1ZUHorbHJLaTlLenJ5M1VJVUJxWG1Sa0ZVbTFLYjYvUDM1emVWTTdVTUkzQkVFcUJVcllNbkJpZ2xYY09QMCtnN0tmWDB3a0RibDFDS2tEQWZvdFFScWFSWUN5U2w2T0IxWGZWbzRrd21PQnVnbEhvbmkwYmsxR1p3WnMwOURLa1BvNVFaaE04S1I0RmJnRG9TWjRvdDFROTFKd29hUmxJS0pIYzhNUWU2cHRTUkNwczFLS1VROFFZL1MwR3BESC82U0NVVFZPaDJYeDZsbHBFbi9lQnNJRnNUSTA3UnhSU2dGUHY0YStSTDd1Z1h4dWppK3ZwcTRrdzUyVEZWWS9kMGtHQktVYWthZWZoWStkeDlRcEpNN2pCU3JFWkdGdFRTbWZKbTJYMFdwV296amV2WStrZUROWTJWK0JWS0taZ3E5ci9XVVc4dWY5SEs3a2VpK0FBY1VBNUs5U21JVDkwcWZCN2J5UjBXcFFRaXRkWVFwNVNacTB5a3ZBbms1eis0SFhlWHRuZXBQZWxHa2x6U0IwdzFsV09aQUVTT3ZPaUFVbXV3MTlJcGlMNUE0eGNrRkVZN0p5M3VRQ2s3b1RCMkJZQTRFYmxEU1VWRjA5LzBvVVRnUzZ3TzcwMmNUaDNPMmlGS0NUNkNaR09ZTGFKL2RXWm1aY0gwNURmTXhuckRGdTBicGd3K3YyR0wvZzI3bDNyRENQb3BzaERkT3V6a0pwL2g3NjJsMHRJQjV6MGlVeFBDakpkTDhWMlNVaUJSL3FucnlOZXhpc1Q0MXFjZ2FrcngwVkNJRVQ3WmJPWktTNkhkOFRHeUU3Tnp0U2QvWkVVdjgrNC9jOUx0Vk81MDAyNnUyR3RYTHVsckVDTzF2cUVweFF6WnBWUEdFS1Zla1BZZTdaeGFIMHdwTXUzZHRQeSsra2ZYZFpKaVgyNEVJakpMcmR6RGV4azdNVThYdUxnY3B0UlhqRENhL3ppM3JSdXJ0QWUvV2FXako4WXdQUU1nK0NBc1pMS2g1bStDaW5iMWlGemU4SWtJaFFYL2lhUVVLT2ZDY25xZnhqQlJYc3lwUVNuZHFwS2JkbHBsaUxOVTJ1cFBoVEZqbGcvSnRhSHdZYW9XeUpxZUQvaWNzS1Q0aXQ1NUVTSVJsZXBzU3JFbzlvbGJ4Z0NsWGxDY1JhK1QwQUl3d1pRaXh5cjNlQ2NvaE9za0pmMjNoY2pteHB5ZEE1UHBNMkV3eWpKTXR0MW5VNnFlUktod1UybkhKTmdXbWxIcUtZaFNDTUdXNTZqRnlYVk1WQWFIb2tlTStZZlo1dkZUMU9zc2tsS2c2QmlqMDNwc2wzTXhLS1ZiVlVnYS9QcmhabE5yOTBRbGx0UG8vZmxHaEUrWVJhNUV3bE42enR0MkpTOGQ1dVI4UU52dnB1cjJxNWxqNThVSTVQTFRsR3JVcTVJY01nWW85WUlTWXZ6WnFVeVpTU2srQjVrT3Erb3BSWllRRzlubXQyOTAzVXBLM09LWC9PMnREYjRHcWZYQnZxYjhGcUFJNVJDbHVHUlFYckNrbFd4dWpDOHFTQmhFS1lqSTJOTE8yVmN2alptYnRhMWRoUElZWGU2TjNKUUNwVEdmOHA1U3FPaVlRU25kcXZ6NWtpbWtTcWtqU2FseTNYK3F2SSs0RkNNZnpndXVaZE5POGR5bDdYRGgwZTU1ZXo2SE5XeXdYc09Jc3R0c1NwdFMyNjVqVzQrTUFVcTlvTkFsbGF1bUx0bm9ZcHJCbEtKbEZPNmpGSUZ3bnFTNlZWUExMUW9YcU9WMVlvNG9mMkovbXBNbGJTODMxc01xaCtOUHJuQVJYSnRTbTJsa1JXcmdzcmtobEVLSWpQMmw1RC9KNlpoZlNwZitHYXpXS3hFTGRMbm5wbFNQa0pSYWplM1NtSmhTb0ZWcGcxL1hJQ2sxMnhZbzFzUXFHQXpDak5uMitLeHlSNG41TUZvTFF5ZHhDWHVNWU13NXNpa0Z2Uk9PQXM0ZVNyMmtIRE1aR0VPc1kyOEJaNUpTRGhrNUVXemc3TGxIU1VXamUxbkFHWmRSNTdtZnBjczM4ZEppK3phbCtCNlZZa3BoR1NHVU1oRDhpTFB0VjZROEtqRXI5Tnh1VllFbzVUYjhlZ1NqVk5aVENoVnd4cFNDcmFydUs4aWRQaURwd3JocU1VZTMwT3VKWDBsWDlnc29pZmtZbGRSeGhVVGtNaDdab0JUTFdGeDVaUGdwOVpLWEJualVsRU5HS0tVY01oTG5yUlNCY0ora1lBZ0ZldGtIUENGUjlSaGU5Z29TNkM3ZlhQM0pLTlZnU3MwdEdTR1V3b2gwenI2L1l2Y0JoZkxTbHExWkNVMGhDclF6dWQwVEwrdjVyUGUvNFVqMHVzU1hNNllNdllVdWMzRmxYUSszS2thWllrMVZleENKb0k5QnFVYm9lcmNNUDZYMittcWJ3ZGZuaEZMS0lTTnB5YXNkRXVGVFVocGh2SkxxaUFpQ1JGdkdTMTZVVldDVHRiSXBOYlZraEZES2FoVi83WE41SjZkVDJXZDNWS3NncFVZZUovckxlaDVYZmJnZHBGVGVTbzlmN1pDaExiK25sSGYvQTNwRk9kbXF0OWhuLzRoTC81bUlTcjU3QVZHS0dZTzFUNGFmVXZ0OUFWdEpHbVVhRVkwNkpCOEFBQWxiU1VSQlZFb3BoNHpVYWZmWmlIeEFTY2xYdG8zdGNIYmlvTlozN3lXdmMxd1k0eWdOUCtPTk8xaEdDS1hNVnFYODFWdjZ5dVZPdU5DM1ZLc0FwY1Q1dzNIVis4SVhXYzZRTWEzTHVSaHVMMHRHb2FkRER0dU5TOGJsNDlYNTMvb3RvVW9KWEpwdmZjQXlDbG1lRjFHS0hhV2VmVDMzVTJxL3J3a05lQlhwN3ZOQi9IbzdOOHBFRENvcCtXTFJ6SHhKWjU4WVFEd3ZlK253TWVaT2ZCdHQ1c2k2YVd3WklaUXlXM1VzM21yUzlHNHZFV1QwUkxXcVVGTjFVWGtEa2w3NnV1WExQc2NBVWtybU4zMXh5c2oxSnNUTGRaL2Z1RjRiN2NpOXZLOGFiejl5a0xiWnY2dDNHb1BRTnNmcnJ5ZUJQWC81eTZ5SFg1ajlIZk5CVThxUEdEcEpxWU5YWXVYUVc2bThVTHgrYlgzeTI4QXpOUkU1ZlF3OFJaUkNpQ0JLR1FoR3FacjU3bXFka3RkOUx3T0JuUUJ4TEk3dkh5dC8yS3dsSThRdmd4Q1hsYTdqcnNObTJSM1M1b3RiUmd5RFpxMFpoWWlVWExDUFIzZ21MUmxKWDZkTlU0cnJyYW12NTE1S1ljVFFWZS93Nk9id1dMQzMrU0E5Zmw3RXNKTEs1TUxHSjdZamNFdnJPSDFKUkhLejhUOXpFNUhSUml1KzVrZUlJRW9aQ0NhSDMweXQrYjg5bEdiNURJVGcyUkxBNWV4STdyQmtoSGtuRUVJbklvOXZnQlU2OGNvb1RFbzlPMlJJVmJOQlYvQ1B2MVc0NjdhTXN1TmNqaW5GVGxlMXQxVmVTbUdFbjFMTmNuaDBFeUxnZEIvemdlL05iRXFaaUdFbHBlN0hDL1N0aWc2WFZjTy9CWWlCdHpKdExVUkN1bFpTZlBlTFpZUlF5a0F3STQ0M2JzcDNlVm5GZWVMb1Iwb2NsZ2xLMlRLR1RYYzNZa3dlVlVsRWpndy9Zek5DQ1A3dkQvQit1M21ZWEJwWEliYU1HU3Y3VWtGS05heUt4NjIzVlY1S1lZU2ZVcE9RMFYzWSsvRCs1bVBzaVozQWlFRWxwUkJzMGlibUROSUZqVWV5VnhLUitTbTFzaEVWbFg1ZklOMWxJQUlvWlNLVXdiU040bTZITHFVVDRKdXJIeWl6dkUrVWI3dzlEM2k4Q0pKU05DS0c3Z25EWk1ZSU5paGZadUNhNG5vZW5SbGhtb1NNVEJXSzd5bkZpMXd2dmEzeVVjcEErTE9mbGlHam0xbUJWWHVjajRXTFVpWmkwTjNYSTlnQ1dsbEcySzJqYTB1SThHWmVOQk1iVVJCcUtzVVhiUWlSY0I5enc0MFova2V6NmRPL3hZZWJsZFVxdlZCeU5vOTNrWG1maXhFZ3dsQzlZaW9sWHBCQnlCZ3kzWjJJQzdiNnJ3TVJCWENpMjBjcGdIaTN1WnF3TEdrK092enQ0dkVsZXd2NGtJeEt2UFJaVTJvSjZ3VFJyZkpSeWtCb1N1V3VaS25CMGJWczNqM09SK0dpRkwzYVZ3RXl4SmphRGliaTZVZTY2bS83M2M4WEFwRWJWWWNpWE5Pbk5oSEg3ZUN6dFZvbFdkR0lEOGE4SVplYnBhc2Z2VFg2TUFVc2IvdzlIMzU4Q05xMmRpQnlmZFZyMm4wVzRrU2xTWFhxZWZUaHVwS3ZJL1BMbURGTlZtcEs4U0c1ODdmS1J5a0RvU2tWdS94OWc2TTdNeGZsSHVmRFNTa1RVUTBwS2JBVExjQnJ6NTI1aCtKZm54RWk5cTMxS1lGQUFQN0tOaFNMdGpZUlFaUXlXeVhOV3Y1MkRtNXRmUEgzNDhoYXF6YWxhQm0reDQxUWVWS2IreUJFakY0UTMzZ1FNVDlIc1RmMWRvemlMc3pOcDRCVzhVcmdtYWJVaXEzZ3BiOVZQa29aaUxFM29YQVZOTHFwNlVYZjQzeFVMa3FaaUdwSVNXbUVNSkxnanVoNEs2RCtudnJiNVlCendrSXN6QmcvMDFURWlHUXorS3pzVmdIbnZIZzM3NTIvSHljOEd0eEhLYmNNanczZ1FwUmtzcTBid2Nkc2xWREZSakNDLytLR1pjcmZ4ZFBSK2ZYVlgyR3RLdG5JbDRwU1cwYmllcUJWSGtxWkNFQ3ArUHA2UTJ5OEFhTmI0UUhiNTN5NEtHVWhxaUVsbFJuV05IQzgxNGw5a1l6MW1rS2tmdWVFamNDbEd3MUszWkl5Z2pXNmhTajcwcS9USVVUaHA5UStXeFhwaTdzd0JGY2c4NFV1SStsQ2NQUG9ucjB0YTNxeFM2djRmUU83RlYrSmwwYk9VS29tMlNvUHBVeEVqbjBMdUg3UGZlRG9MakNsOWprZkxrcFppSEpJU2NGS3RZVzh0OGxWY044WmRkZWJnTFpJeE1qcG9HZ2NpSGR1U20xcHhNRGpRU3o0ZGMyTkdWSlBJZnlVMm1PclVuU1o5N2dNa01IM3JZMWRaTTVDOE1JVWZ6SVhhWHI3YmgzZXFrNHJkV3JxVEZEcVR2N29SYnd0UVZMMmdJellQRW1BVEs3SDBOSE5FYVgydWtvY0NZZzI0bWhBU1VFRTJ3ZHZnWklTZjdQSWY0VGUvU2w4Z2ljdVN0MjVFRE1YcGZqbE1vWHdQeDZFckRjWlRZWVJma3J0c1ZWblZvclpvSXpVVWJmUlJuUUwvWTZkRE5kblg2cmxEcTJhc2ZucXRzZU9VdDBzek1CMlNpTFVhd3dld25vK00zb2FSZSt2K1VmWGZ3YVBib1lvdGRkVjRxQ1VqUmpkYkZhaE1tVGt0bkxnZlJiS1pHbmJzNDMxZzh0QjBjeGRDRjJFRWo4UFRobER4ODU5SVB5VSt2OXFsWjlTTmlMdjFBdXZVVjFkTnJ2SVlIcUo1UUd2Y3Y0L2NKZEZJYlNXcVNldjIzTXpnS0orQlJtSmcxSXZsTUUycGo1S1RKYUoyQklieFoySk1QME5sbk9DUUVUUng0M0Z3TWQ1NUVONGo0VDdRSGdwdGNkVzNWZ3hlTU15SEpTaUVEZExua09hdHVWMnA3R2E4WVprcTF3NE9XNTlpTGhxUGRrS3J6U0RNYTVmdkVjWkdVMnBsOHJnYnlKWDdSWnBVbTh0SlZXaTRQUlVlb1ZTdXE3eTBvM2dJM1IrbzJvdWRBZUtxei85TW56UG5oQmVTdTJ2VmFtckVLRlBob05TTklJZGJ1dTh0V3ByRGN4SDFhK0hHUXlkb1JDRlpkOUhyekpXeEZYZTB5dkljRkRxcFRMNE9Fa3ZiTzBtNGRaR0RORDJwMEdrSGtydHNWV1pxMENRVHdaTktSckJqL0hmamxzcW10UW40MGdGc0dZVlBrUDhLRE1Jcmc3M0t5TW5LZlZ5R2V5RGJtODZkdVR5U3RmRnlrWjRucDhMVVRncHRjOVdFVHA5UGlpRHBKUUR3Yzg1YTNJQitQdFJpdk12d3ovOGlETUlBZ0wzSzRPazFCNWs4Q0c5OSttM00wdC9sV1M5bDU4U2NjZldyWXRTLysvOWdDWFYxME1JZHYyeEtxbmdGMytyMklWaE14Vi8vb2d6V1BVT3Z6M0xJQ20xRHhtY2hzc292WEVvcWRRbVllYksvUDM1RVB3MDVhRFVUOWJ6MFExeitCSGx1NFprdkZPVjFGYy9aTThMRmNxOWJ4bGpnbEo3a2NGamkycmYyY3UraGZqM0lpQ2xmcloreEdXZDBNVnlCMlNjbVE2SEg2cm5hYVhMcSs1VkJvcm51ZDFuUDdBVlRmdyttNlAvWGdTZzFNL1hqOUUwSTd6YkFUSXU4Zlh0ZjJYT2RZazJWVWxoVHpKRVdJUEQ3SHRIMTZMNDF5STBwWDdLZnFRM20rVjN5R0EyNDhOL2NjNlRjK1luT3Avdlc0WW5MREJ6K2RiL3JZaU9VcHYvWU05SE53Ly8zVGwvRFFSWGJRMkJZVmNWOU5IczM0cEl6OC8vb3owL0lQYUprQmVSLzVpZmZ2UmtYaDBRQjhRQjRVdjZPTFBlWXl3UGIvY0h4QUZ4UU95T2tFNmY1Z3E4MmJoeVJ2RWZFQWZFQVRHRVVKbnZ6ZVBWbjVQUjd4YzNWWHRBSEJBSHhBc1EwakxFeno4SHhBRnhRSHd2QXFVeGUxNDNjRUFjRUFkRUdDSUNGZmNaNEovb2dEZ2dEb2dYSWJybmd6QVNtOGUvb3dQaWdEZ2dka0w4SDh4ajdYcmNqZVZnQUFBQUFFbEZUa1N1UW1DQyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDQsICJjcm93biIsIDQsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSnNBQUFCcUJBTUFBQUJaZ1Q0REFBQUFKMUJNVkVVZ0lpMHhPaTVHVVRNYWRDWjNia0FSclJ5aGsxQUExZy9BcXpBQS93RFZ4V1h5MkQvMjVYVnhnVlZBQUFBR2pFbEVRVlJvM3MyYXoydmNSaFRIbitTVjE0bDlVRUorTkVrUEd5Z0JFeC9VaGhKOFcwb3dKY2xCTFpTd3R3MllVR29mbEpoZzl1YVdVZ3E1ckMyRTZNMHBKWWRtRDQweFpzbjBFQWZqdzBaL1ZPZk5TSnIzNUxVaktUcjBIY3hpVFQ0Nzg1MDMzL2MwRHZ4UkpwN2Z1Zk9vekxnaGxCbTFBVEx1Tm9XTFhjUlpnNFp3QWFob040T1RrMnVOWG5YQmJnWVhBcndXNGdDZzF3Z3VnUE5DUmgrdU5ZTHo0VGJpM3BRUXJ4eHVEWEVINERTQzgxQzYveTB1WGV4K1E3Z0FialM1RmR2UVFsd1hGaHZCUlFBUGhEZ0NHRFJ6Wmoyd1ZsWUJaaHF5Z0dmYUFwYWJNaWdQYVNVbWR3cHVzNkJTMUpHMHd1ODJTK00yd0I0VU54Zk9GU2Q4dVNRdWdvdXVVOHprUWc0SDFzMXBXazdEQlhOaTdQTHB5Y1ZhM0ZIWHhNOU9PWnduejlRV1M5a1l3R1htR2NuRUhrTTVIT0NKYW5NL2J2WFptUWpuOEpnTXl1QmlTdzdkYXhmOCtCMDdzZHZ6cFhGVFp1ZkJ3eU9XZDJwMm5VRnA3ZnJMWExwUndvNnMwczRxdWJPejBpb0hYTG9rNmJMRWNCK2N2clBQdjdTK3BsOE5Gczh5S1YyUzdETHhuc0lGdnRWZktRVGlJanlSbDNsTE11Qkp2SlFrWEx5NHczb1dQSVY0RENWT0gzQzJsQkJPU0pkTXVIamNtbjJGdUlxNFVOc1AvZTZoNWJCRFp5VXlPblIxVDYwMk4xamRGRW1jQi9acjhaaTFETUczdEYzYWhsbkVNZkc4RlllSmE2Mkx2d0FXaHhBcjY1YVZnQXoyMTdyTGRDV2ZJKzQ5MlovSUd0dnNTQytwcnNNWlFxUUx5eDdkVE8vRkc0Y09Ya2ZjTVhHQnAzT0NtRVFNMWdkVmlPMGhiQU5tdUhoTCtpMTV6TVptdGFsMFNVSmNRR1o2dDBla20wV0VjQ0dBdElyS3p3WW41MnRXRzJycGtzUzBVSkU4MWx2TEpCSFVqS1JnaUZQOWtlaVlQSWprMHozSDZMeWdjWWU1SHRJUnhUK21QZHVCZWFGYk5qL0hrZG50ektPYkRjejUxN2pqWEE4ODFjUnpRbGpJWnpmVTZIL0I0QUw4Z3N3RWRCS3J5Sklwc2xGNGgrQm0wd1VHa0g3ZUozbnNZK1prcTFYblgwZm1BcmhXTVo0aFcySHIzYlF3VVZTL1JaUFVleUhNYXRYNTE1RlpxS2M2S3FDbkVIOXpDRFB5VkhSd2VnZjAwTHBhMkVVdVhlNENhcTNNakgxb2ZSQnZYV2hMbkh4cnVIVFBKVzhoc1I2dVYwdWt5MXdnMEpuVjc5SGUzcFlJNkVsY1ZId0ppYlN3T3UrSmRKbDRuUmZxTVVtOHVLTVFqdkk3MWRHUXVoL3FwQlJiVjdsMHFRdUVMZjJZbGhQMTBpYjNYYm54OThDS2ZMb1lzVCtqcEZzeU9DV2VuejEyV0hFQzYxRldLelo5NmsvQkE1R3V0c2VrMCtMRnJsNHJ6UlFVekJtWTByTkQ3ZE5MeDR1dHRwVE9UaEltWHBncUs0VEYzUGdhcVdRUmZWOTFzL0VITnBjT3hYTzgyOWxqVTJmRHJEaWt1Smk4cjZaNW9sTHJybXV5VG9zSFZ2NDB6eFMxc1FOYVoxMnpHMUcrR3JGbk1lbVU1NW1uZWFhb3dzUEt0bWRlejNmbThuOGdiV2FXMGVScUlWTTJ6NVFOVTdreVhBQzM1RHA2TkUrVVhmTzFxdFYrbGoxTk15V1NLMXRObDViaGhyRHdNdTEvL1RXalR1YnJKanBnWmRQVDFRZkw5UFhNSERJY09uaFh5UmNEbmR6MUl1NFE0QWJiV2ltY0xUVllaamhaejVKakYzdUxxR1UydHJnUm1NbXVtUjYycU45SjNkYmxUSG9NSnpORkNRT1gvZm1NOXN1VXlTWEpTNlBlbmhNajdUNXUrSUEzWkI1TzVDWHUwWlgweS9mbDNveE80dVQwSUZWM0RKZ1ExL0h3V1lYK3psZDcrRmkxR2wvOExzZitLdi9aVWpJbE1KVi9STmh2MzZodlYwWEpLZUFDM1RrODF1WW51emNaczhuVXdESFdoWFRnRmQxdnRBdTQ3ZlJ3L2dsNXRFYlRjWmdDV2R4S2svdGNBUmRsYzNuVlNVZGVPbzFtMW1EL2xQVUh5d1ZjYkp4bzlhWWNlZkYrY2thOFVrTldURzczaXEwMnpiSEozNlBrSThHRzVJMnB3WG02N2FvVHg3bjNHcHcvUFMzS3hGRmVhUXd1YjVTcXgyRmVWUTB1UEMzTlBoNjcrZXVmd1VXMFBsZUxibDRHRFM0KzZXMWx3ODE3UWZKTzFvRlJQZHJFOU9BRTV4ZU52SHFlVUZ4cUF0WGp2V21YQ0c2YlYrank4YzVjaWhCYzdVenBtMDV6U0Z0UysxUHpoTDF0WTdtb0UrVE5sT0pxbXNDRXZINVJYTTFNT1NLdEpzWFZOSUZEMGxaVFhGZ3ZVM2JKNVRuRjFUU0JQdW1ES2E2bUNaQlhUWDR0NDlZeGdRbDVOK1E0djA2bUhOTTdEb1lMNnBRTGV1UEFjY002Vzh0dTRoaXVsZ24wNlkwUXcwVjFUS0JMNzNNWUxxNWpBaTY5bXVMM2R4NnNQQ2tUNjhrRWYwN3dBL3Q3RjhmNVVDN09xNzczL0pINjRKeUtDNkIxcjB3OFRDYjRjeUkvSExLYk40N2JxWjRwdSt6Mm5PTnFtQURMa3dLdWhnbDAyTDFtNFdhMnVnbkFXYmpLNWVLWS8xV2tnS3RzQWp4UFR1SVdQc0VBVHVCQ2FEMnBGSVUvbmhWd0VWU08zaG00dURwdWNOWVZ2bGVWTm5QbVh3U2lIeW9HLzk4SHcvOEFBc2xodlNVbk9jTUFBQUFBU1VWT1JLNUNZSUk9Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooNSwgU1s5M10sIDYsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ3NBQUFBS0FRTUFBQUFYWXpVUUFBQUFCbEJNVkVVQUFBRC8vLytsMlovZEFBQUFSa2xFUVZRSTEyT3dxYmRYT0h5QW9hYmUzdUQ0QVlhVVJBT0xZdzRneWdaRTFkdnBBS2wvRlhacS9nOFkvdFVZR0FPcFkza0d4ajRKRE1mUzdRM1BBS2xrZTRNekNRQ0hweG94c2ZUczhnQUFBQUJKUlU1RXJrSmdnZz09Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooNiwgU1syMV0sIDYsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBR01BQUFBS0FRTUFBQUNhRG5KRUFBQUFCbEJNVkVVQUFBRC8vLytsMlovZEFBQUFha2xFUVZRSTEyUDRYMWR2UC92dm4zK0pqeG5PUDJDQThaTEJQSW1FUklPR3hKWkR6TW9NUEFwZzNnd2dMMW1aNFF5UVYxTnZEK1Q5Zy9FcWJDUVNXejZrZndiekVtcnNnTHdmTUY2ZU9aQjNKODBZekt0TE41NlIrT2RjbXZFM2tBMTF5WVpBM2pFd0R3QUQ3enkxcno1ME9BQUFBQUJKUlU1RXJrSmdnZz09Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooNywgInlvdXR1YmUiLCA3LCBTWzIzXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooOCwgImdvb2dsZXBsYXkiLCAzLCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQVE0QUFBQlFDQU1BQUFEZm5HdWtBQUFBU0ZCTVZFVUFBQUJaRnhNb0tpZEdTRVdqTGlRZWFESndWUUF1Wkxmc1FURmtaMlRNVGx0RWhmTTNrclovZ1g0eXFGU05qNHlrcHFPUXc0NEQvaE4wMlhyMnV3Qyt3TDNlNE4zLy8vOCsrY3l3QUFBR2xFbEVRVlI0MnUyY2kzYmlLaFNHRVZxbk9JT2hwd0hlLzAwUGx3MXNFc2hWbTY2YXZkYU1WZ25LbDMzNUlSSHlIOWpYYXh0UUlJR0ZmSG43ekRnK3Bld1lmV0ZqM0FMNUFod1dCaVd2YnN3N0NIRyt3Y2xwaERyL0lEWnZkQ2NMNEdGeFNIbVNpUEh5U2I3T1VFbG1QZU5Ubm1rMEduYzRUZ3c1V2s0Y0o0NFR4NG5qc1Rqb25vcERwVFpHaVpDdlZUQkM0WWtLdW8vYXgvaWVTdFdlSzJNMFZMc09XdHBqajhWQjMrL1czcmNTNGRwbzVjYkY3Qi9DQkNNTW5wZ3dPbVlmNDN0R3dKSDJJS1UwL0czL2NCMFFlK3loT09nZDdIMWJ0MGJ6Y0hhSnh5SHlXeW9NTU9JWURsWVo3eGdXSnc4NDlFL0FjYysyQllqT1kxNkhROEJMaEJwRFBSeC83TUU0M3UvM1BVQzRLZnBjZ1VPYkdKN1N1WWN5MUw5eU1JNS85NUxIeWhUaWg0SnhTR2FOenVPZ0lUYlNteFlIZDQ4SDQvZ3o0TEhTUWNLUUlYR21WQ3JtY2NSWE1nN20veDJONCsrUXh5b2d3VHQ4V1EwNGxMREd0bmdIYzJuWlBoNk1ZOHpqVHJma0RqZStQYm5ETnU1TWR6eU9Dby9sRHBJcWkzQmc5bFFXNW52VHgrT284RmdNSk9vT1lUVGRxanRFYXN5TitRRTRhanlXQWttcWxHSlZ1Z0RIVUpVeWVPMEg0S2p5V0poQ3FuT1dJRlJUQjdRNkl3bHpGb1liMDRQbkxJQ2p6dU9kL0ZxYndWSG44WHVCek9GbzhMaGZYeFJIblVmZjkvUTFjZFI0OU02dXI0bGp6S01IdTc0a2ppR1BQdHYxRlhHVVBIcHMxK2tVUXBtZHVuSDJ5M0JnSHYzQUpoekVDYXBnY2k4UmxtYkVOZWdpV3p3OTd2blRjR1FlL2RqYU9oMloybGVKQkZwY3JzeVFrR2tHd24rTHNGK0tJL0tvMEdqNGh6U2xhZlk5T0V4WVhIZ3lqc0NqcjFwOVFjd3prTTVwRmJxWThBMDRQSTluNDNBODZqUnE3dUVKYUpIbWN6dHB6T05RekZ1SVVQWU5PUDcrNnhmakVNTjB3WGRPU2VkeDRCT2h2Z1BIN1dNcERybzdPTGJqWUFIRTAzSGNQajRhUEdndGpXcDZEQTZpZmJROEc0ZWpVZWN4amhVejllV2ZqVU45QjQ1QW84cWpudW5KbkR4VDZOSVU3YlRKYTJDaGtYZXhqbkN2cHpJTzVwYlpUSEY3MzlnN2FNWVJQa3o3KzRpeFRtTTFvYllVUjZSUjRWRS9sZTNNd1pJOFMvSFVsWnJCTHdmR05qcGR1UktGbkZFTkhHNmRXYWZja2ZyeGE5bTZ2RlBBeUkwNE1vMGhqMnREYzRpYWdoYndkWk94a1dJTHc2S0Zva1U0MUxEbEVBY0hxSUFEOThNanFwVHQyVFljbUViQm95NUlDeHlzSEQ0TlF4RStPb0ovQk4rUXdrZEJHQmM0T0FpNGpLT0QxejNBRG4rRTlyZzdGWHNOaDBuY2p3NTBlSEpJdlMxM2xEUXlqOWJzYlFxSFNucWR3K0JwMWlnU1RwbEl1VGhFVnNSQlV6ejVYbWxEbGZLc1N1RjZUZWlIb3pET1lOYmlHTktJUEpxVlZPS3dMSEZnSCtWaFNCS2RKd2hvRk9NYzQramlhSmpFaVlaVkprY3BsVnFIZERjUGNOK2VSb3E4Nmh4TGNJeHBlQjdYNmFxb1I3bkQ2d0dCU1NsL2h2QjU4bC9YLzY5eG9ZZzRRZzFOYytVYWpqZ3hpRGdvUktVTUpDVUVtYW9YN25rY05Sb2ZINVBMWUlVbkZ3WFFmeDFlaW9taUtudG1IRFByRUE3ZmIwZ3hVRHFIYzVaQytoUmxMRWVtSnRsTDF1S28wbmliVVRPNlVzUkMrbGM0bjFkd3FPaENBamZDVFdGa2JkMkJjWlJocEpKSGlscVZYWUNqUnVQdHNrUkREcXVZOG02cVpyeERqYnlqaG1Qd280STJEcCs0bmZKaUVDdythU2dROHF0eDFHaGNGb2hkUFpxMFFONXM1QTVXNUE2R2M0Y2E1QTY0TjJBWmpod1RxWTFQMHkyZE9JM2p0ZzBHT0NuKzNyRVM0TFRDY21WUnFKa3FxaUFiVnBiSXFXUHpPTkFiS2o3bHFCcXZ3M0ZiblRRSUtXUzNZbmpaVkpkKzQ3T2NnZ0hMREkxRHNQRXNUOGU2dzcwZ1YzaUhOSVhpcUZiWkdSeTM5VWxqdkZRYTdnL0xNeFFHRWhRRUp5VlpPblpabFlablFzaUdLdlZWdXlpMDdkeGhQeXowREcwNjA1NXdUK0M0Yll1VCtrSjZUaVY4cUIrTGlRaWN0U1Z6bG5MRloybGxnZnhrMWs3d2IxdmpoS0FGMG14ZGhWTmFYSmVqSVNZZXpSa3RLcFJ0SEJrK0w5T0lYSW5qdGhOR1VJUXFxZ1JLaG9zYmVXRTVpZTVpRlFQaWdZYkt3dE52R21KVFZDZHArZzBFcXV0d3QxRm9icE5ZYnFQckVtd0t4MjFQbkpTWEpWbnRveGtiTjZUVlJtcnMyWlN0V25nYy9CQ0ZUNnpHTkhDOFBRakdadU1TZWIxK2FOY3RDVGFCZyt5Tms1MHdkRXI5WFR2UU4xN3RuZUxid25FNUVBWWt3QzVWeFlmZUFhQmFFbXdLUitSeElZY1lYTVo4d05YTVZjNHgrVnU0eStVZ0dLMDEwVWVZTElyK0doeUhtaHpMaTBkWWE2SGpwK01nVkRqcElCNTlneUpqVTFYNi9CM3RpZVBFc1FiSHVYOEhFc1BuN2k2b25zbHo3eDhjSzU5dVp5aHhrZ2dyTkc1bktPc2VaN2lRdEcrWTQzSDZSOTVWenU4NXlGOTZ6MEhLdXJBSjQ3a2paZHlSMHUvUitUL1lNVnIySXFOMXd3QUFBQUJKUlU1RXJrSmdnZz09Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooOSwgImRpc2NvcmQiLCA3LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUN3QUFBQXlCQU1BQUFEVmRpVFpBQUFBRzFCTVZFVUEvd0JJLzBsdS8yNlAvNUNsLzZPOC83M1IvOUhuLytqLy8vK2lSdXdYQUFBQkpVbEVRVlE0eTgzVHZXN0NNQlFGNEJzS2RLVklwWXhJUmFKalZMVVNJNkpER1NObENDT3ExSkMxZitDeEZJTDkyRDIyRStkaS9BQmNpWkI4c2VSajM1am9WWjNWTjFGWEJTcWhSWWdQSkVJc1NRWHJBbm1qTDJ1UDVVc204MXo4M0JlYzVXTStKOVQ0dlM4WWZ6ejF5RlEwdjJhY2tLc3J4cjJHN2Q0WlBqSzFPMjE0ejNubytKZHoxL0VLVHkxTkkvdzZqbWNJSUQ2SkppckdlOGNZZElkR0ljUU93eDNqL2dFcEk2WCtxb1JrR3FybmQ2T1hGUi9OUkFjZE9XRmM2aERQZXJhMFhrL0Zvem8xY2s0YkhzU1ZwZzBqWUpTbGVydkdXOXpXU2RRWGhoWG96bGJHZWsxdVk5L3MyaFJXZWN0N3VjbnNmNWxkN0Rmb3NYK2tjc3YrQWR3dERmdkhkVzg3N3gvdTByYUI2T2EwcUczNXJLWmhib2tnNDFzS2NsUUVtVHIvZitTVVB0V3h1eVlBQUFBQVNVVk9SSzVDWUlJPSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDEwLCAiaW5zdGEiLCAzLCBTWzIzXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMTEsICJlbW9qaXMiLCA0LCBTWzIzXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMTIsICJmbGFncyIsIDMsIFNbMjNdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFeigxMywgImJlc3RUZWFtIiwgNSwgU1syM10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDE0LCAiYmVzdFBsYXllciIsIDUsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSGNBQUFCa0NBTUFBQUNMcFYrTkFBQURBRkJNVkVVQUFBQUFBaThFQkU4WkJRZ1VCd2diQndJUUEyNElCWHNUQkdJZ0NBWVpEQVVrQ1FvbkNBc2REQWNTRUFjaURRc3JDd2daRHh3UUVTd25EUWNZRXdNdkN4Y2ZFZ1V4REF0T0F6RWJGd3RQQXpscEFBSmxBQlZvQUF0Y0FEaGZBREJoQUNwakFDTWhFa1V5RWd0Y0FVQXVFeVJhQlVZZUhRa3VGUzFOQzBFdUdSY2FGNE1wRkhSVkRpc3lHRHdnSG5BbEpnOGFJSUVvSG1ZOUhGbG1GaEJnR0IxWkdVMHNMUkkxS1RZeExSOHJKNFEyTEN4SkpVZzBLbDVRSlZFek5CaFlKeXMzTDBwVUprMUdLMGRLTFRBZk00OHROR1MrRUFOSkxsVlhNQjg2T2hrME5Ic3NONHE4SFFCV09pVk5QU05EUXlGTFFDOWtOR1ZSUEdKTVAxVmxOMTVjTzF0aE9sNCtSVjg5UkhodE4yMUVSbGRXUUYxS1NTRlBSVUk1VGl3QVlEUUNYenE4S1E1S1JXbEJSWXRHU3pRM1VUWk5Sbjh3VFpraldqSmpSMWpCTGlzWllFZFNVU2dnWHp3OVQ1QThWR1pXVEdnQWJENEFiVE1IYWtOa1RGTXRYejVhVG1OK1FYMUZVb2RQVW1RK1hEUkxVM1JkVXo5UFZHd0hjREM1UEJkYldDc0FkVVZHWDNFQWV6a3FiRjlpWVRKRVlhUlRaemxaWUhoWFlJZTNUQnEzU3lwc1lFcGVZWEpZWW45UVk1ZVJVSkFBaFRselc0a0FpZ3BvYURKTGE0Ry9UVDZMV0lSMFkxcGVhbUNkVXAyRlhuZ0FrUStBWkduQ1VrMXlhV3EwV3lGWWNINW5iMVFCa3lGaWJZVnVjRG0wV3pJOGZIcDBjRVFBbFQ5WGNxUlFjN0ppY1pKcmNIOENtREpWZDQxK2IxckZYRmgzZHp3Q25pS25ZS0l3a0RHeGFTMnhhanQxYzhVQXBqSUFwVDV4ZTV0ZmY2NS9mMEZOaVpHY2NZeDBlY09RZkVGcWdLRmpoSlIwZ3BORm1FaXRlVDV5Z2NOK2c0R0loRlZnaXFPUGdXU0hoa21WZjNHQWgyeUppRU53aHNDa2dVT1JoVnhpa1lSNWlvWnJrWGVpZ0laWG0xN0lkM0ZkbGFWdGo3NlFqa3E5ZzJWc2xydDRsNkpxb1dobm03dGpuYk5EcjF1WWxrK0ZsNnlLbGNlZW5GR1dsTTlsczNONnJIeW5wVmVOcDhTSnJicVB0SmV4cjF1bXNKQ29yTlRZcUtXZ3pxYlZ3YkczeTlpMzBMbkp5dVBsek1yRzI5RHE1ZXZXN3RqaTZ1amsrT3I3OXZmLy8vOTlzekgxQUFBYiswbEVRVlJvM29XYURWd1VaZjdBOStSRlh0d0ZqMDFkUkY0U0dBaVUwWlJSUURaQkxoczRHMGhSa0NVUVVyUm1DUklGUXU1V3ZTRW9GL0JjZzBNNXptUUtsUlZ2ZWk4bkNxd3NsN2E4b3BlNXE3di9YbnZubm5xWnFhbnAvL2ZNekw0aC9mOC9jZUVEcy9QZDMvdnZlZVpSK1BqNGl2OWs4Zk9Xd0VrbFdCVDVoN0N3NEJCWjREZk85N2x1b0pSLzhQWDE5UXZ5OVVPTW9LQWdYd1g2d1ZmODh2SHo0RXEzQ1B4NWJrSkhSMU5jOExRd2tHQVJIQ3h6cFVzODc0SkV2TFZJRUxrK0NoOFBRWC94VU5OdkVxQ1RtOUJ5N05qUk5va2JKcW9mSXYvUmd3dmZsVTZzOHdXOVR1VDYrRXhpM2VBUXQybVJkWVBSejNFTkxTMG5Xem9xUXQzYzREdTRnWUVoZ1g1M2lNejFSZmIxODlMM1RpV0RKOGkwb3FxcWszOXZhZWxZSGhaMmo0dnI5UzUwbDVEQVNiaUk0UU5jWDhrR2ZpN3ZUaDVGWHJLc0txZjZ3dzgvckt4dWlMdm5IbG5oc09DSmJ3eVpURjBuMTBOUjZhZkEvNStiVUptVDkrSG82T2hnYm5XUms0dGU3c0JPeXZXVDlIVzdWZVo3dlhGU2JtNU84dURvME5EUWFFTnVkY1U5WVpLVHd5U0ZYWFFJOEovSGdyNitFOVBXRlU4aDdpUjErblhhdE9CcHdjdHkvTnVHRG9FTURWWG1WaThKQlpHaks5RHRaekc4UGU2cW5NRDFkY1Z4NENSWTlHWVJLRUduVFF1ZE5tMStYbElsWUhmdDJyVi82RlJLNWFZNEVSd2E2djU0MG9jTjhhZ2lnVXBsb0NmV1QrR1JRUEFuVjdFUTg5RWxvYUVTRXdEVEV2S1NVdnFCMnRqWWFOdzExTGFnc2dqOU90VEpEWE45Vm8vcWhSSlo2WmxKUHA1Y3oycmhoUTBXN3l6ZGZscHVrbjk3djdHeGNmM3E5WTJOdXc2MXBWVStGQ3FaT2xpMGRwaG83anVpTE5DdHNJOHJuaWZKb09BN3VKSXNXK0RmQU5qVkpkbloyU1hibTF0UDVhWlZMcGZBWUJkbkVRbnp5cW9RYjY1bkh2MDhkNW9IZDJiby9EVC8zUDdXeHRWWnFlSGhpVm5aTmMzOS9TbTVsVTRYeTJwN0oxV0luQmVlRHZaVHVISlpCb2Q0YzVGbHB6bTVNMmNtcEUxTjZlOXZMTW1LbjVWZU9pczJOUXVCay9NMnVlMFJLcHZiZytya2VoaGFqQ3MzMlYyUFpYQ28yOEl6a1N4TVNnYm5BbmFlZnVmT3JTc2lVOWZXdEpxYmtpc3IzTnpnTU5Ia3JvOC9DUmRvQ2xlM2NISkQzTmtUN0tHR2lMMDNDVGtYc0ZFYmQ5Ylc3dFRQazhCRnlaWFpvVjRTSE95MjJTUmM1Tjg3U2tiSVpPRUVycDA1YzM3eVZIQnV6WnI0eVB5dHRVZzJSa2VtRmdKNFlacVV4VzViZTRvVDdGVTNKalI3NzVEeVZ2ZXVaUCtVOXRidGErTWo3OXU2dFJ4azY5YjhxTmpVa2hwelgwREtzcnZnQ2hkWDdoVFNkeGMzMElzN1NjdWR3SjBweVJUL2dLYldtc0xVeUdnOVlEZHYzZ3prK3hDNDJiek9QMlhsVEFrOFZ5cWJ3Y0d1MWh3U1BER2cvWnp4N0UxR3lEQUk0MkFQWGUrNjYxNy9nS0xXbWhMQWJ0eGF2dm1wcDlpbm5pd3YzeFlURlo5WjBteThPeUJsL3Z6NWNYZk5uRHZYRlYyaDdsbGtJaGJpZVpKZTcwb2dxSTEzSmR4Nzc4S0ZLY24rL3Y0Qnl3Q2JGUnVWdjdWODIwY0Q3N3pEc1UvcXl4K0ppWXpQQXZEMktmN0pTV2xwZWJtNXk1Yk5UeEJORmVZcUk0RjNjc1d5TlptZDR4S1dMMXVZa3BhV2xwUTBGVUduM0gxMzgzYUV2USswdkhEbHY1OTg4c2s3Q0x3S3dKa2xOY2ErbXBTQXFWT25KaTFJeThtcnpLdXNMRUw4T005QnhHOHlPN3Vwd0Z1V201c25BYWY2TDl4VTFHUTBneGhyd0xleFVUSGJFUGJHamN2dnZZZkE1ZnJGWU9yVXdwS2ExdGIydHJhMmhrMmJVdEtTa2dHZVYxVlZYZDNRMEZDeDNBTWMrRFArRFM1cWFhbkt5MW1RTkRVNXBhaXByYzE4eXR6ZkQxK3RyVFUxSlpCQVVUR1BsT3YvY3VYR1R6LzkrSjRNM3JZb0ppbzJQZ3ZJZ0c3dEJ6RzN0N2MxTk9UbTVlWGtWY0hjZWF6SmlYWHJQVkhmWDdWVVZlWGxWVGEwOVErT25qclYzNDZJcmMzQUxGbWJsUm9iR1IyeHFsei91NjkvL0Fua3NoTzhjVkZFZEdSc2ZPcWF3aEpnMXpTM1NuZ1lTSVpHamg0OWV2TFlzWVE3K3BKaVFqTnFxRHAyL3Z6WE1Ec2QycjkvUHhCRlpDRXdVK05qUWRrNXEvVDYzNzExL2gvbmJ5THdxeEpZdisyQk9USFJVUWlkbXJWbXJVaHZibTdkdFgvLzBCQk1mLzlzT2JaOFVxNm52bTFWZWVkaFpFUHpCUFJZU2MzVWVHQkdSa1hIekZsRTZSOTc0YTB2Ly82M3YvMkFOUDdyS3dqTVBiVzVITWdSQ0IwWkd4dVA2SVVsMjZFNTcwTGdyenRhamlvOTV6WFIwSW9KWWRYWWt0UHh0WWlGeGw2U0lhb1pHUVhNbUlqRnF4NEdaVjk0NngrQS9lcmJIMjdmL3VueW4xNTU1VDB4cklIOHlLb0hGc2ZFQUJ6Unc3T3lZU3hBNE5IVFZTM3RVdEh5N0ljS0grLzBEUm5NU2ZwNkZMQ1ByMStkblJpT2tQUHVXNVgveU1adFVCZEZaUUg3MVZjZmYvemR6ZHUzTC84SmdaSEtRTmFqeXFuZnR2R1IvUHdWOTgyTFRNeEFZT0EyVkI5TnY3Tk1LeVNxbnhwVFMvRDExVk9MUmtWMXN4Tm5yUUNlWHFyRkFBVmRRVmtKKysxVjRGNTdYZ1lqOGxOUHl1eXRXMnQzYnQwNEt4RTBCbTUvWGt1cnUweTdwaXlKNjRkcFNRSVR2UkRjdjJBcU12UDYxUm5oNlR1aDI0bElZQUwweXk5Rkd5UHNENEM5ZGZuNXA1OTJrUUhOUHZVVVlwZEJpOXhaR3A2QnVLTzVWUjNwVHE0U3czRXN5TVVORE1TMHRJRW1NVDlVcXBEQ255SnUxcXh0Z0MyRHZKR1pvQ3RTRnJEdlg3ME5jdTNTYjM4cmdWOUJLWVhZU08vTkluampyS3pWTVBhWjA2cWFuZE9lRWlkMWxCWnpjZ01EZzNBZFRiQUdMU2FPdmYxSi9zak9xN01pZ1Z0V2hzd3JNLzhtVVQ5Ky83dnJDUHZGc3hzMkFOaEZsdFYrYW5OWldlM08vTWlzMWMyN0R1WGxJSFhGNGRZUEl3MEdtaVpVTHE2YW9FMFl3OUhFREdTUDBvYXBDMGNQSVc0K2NNdC85OEtYL3hDWkx1cjdvbk52WDNwMEE0aWs4cCtlZitYVlYxK1Z5QVBQNmN0cTlmTmlNMnBhRDdVdXFHb1UyekY0VUtNMWNDVEZhRFZPYmhCRzBEeUY4eVpLVkRqWW5CWmdOQnUzUXd2WVZsdW1mMEdNSmNTVXFXKy9meFdwZS8yUEczNzlheG44OU5QUGc0amtUOTc1NERQZzVrZUZGemEzbms0QmRXVnNFRUZ6ck1MRWtLS0hnYXZDdFNUNmxjRmkwR3BRNnkxdG03cnN0TEVST3UyS3JlVjZPV0ZGcUloOUc2VVE4dTZHKzBXd1JINUdJci8zM2pzZkFYZGJUQ1NNQTRmYUYxUTNoc29kQ1NOTlZvTGdHVklNTGVCaUpHMWdXQ3VHOFN5RksyRVpGQW9LVnh3Q2hjVU8vN3UzNUl4RlVLQUM5L290Q09acmY5eHd2d3Y4MjZlZmVlWVprZnZKZnk5OFZsNE9ZMGhXRGFpYjF1YnN3R3JDd0p0QU53YUZsbEtwOEZNUk5HWGdPRUdub0VGaERISFQyNlpPT1dYY1hoZ2Z0Ymk4L0RFbjkzMFpDMkRFdlhRL0VoZjRHUVJHM0NzWHRwVnZGTlUxdHlaVk5jcHJseGtZeFZweEJjK2JURFN0VlFjcS9OUmFnMEhOV1FXVzByS3NEcDhCM0ZCalhvRHh0QkVNamJyZUMxODZ1Vy9MZ3JMSWk3dkJ6VDM3MzgvMCtzWFJzWm1nYm5KYTJ6M3l1QU5CWmFFSjNNYnpCZzI0T0ZEaG95SU1uSmF3MmdVdFI0TDFNVFNpSUlYTk1EbkdSaTNXSTBPRGZ6MjRyLzBMd05mL2ZQOGQ0T2ZCdmNqTVZBUkVWWTI1SXJteVVaNHZaK0E2bGlVWWc5M0dxV2lJWDZYQ0I1SVhnb3F5T3loQlp4SnpDVFEyNWdaVW1FV0Y4MlZEdTdtdnZZWVV2dlhGaG9sYzhPOTdsOEhNK2tYSXpNYlRBUXZhNXNwY2pHUjRrcWV0RGl1TzhaQktTakd1R0N1cG9pOXlKb0hnVEdBRDBQaWVkdjhwWWlwRkw5STdEZTNtdmdZT3ZuWHRXWm43YXhjWHNEZXVmS1ovY0E3TW1EV25melcxY3IwOFhjNkFIR0lvdTlaaDF5cE1QRTBFb1hnT3dpR0x0TFRKVGpsb0doUldJNFViY3dPV240WlVpb0lCQXhuYW0vc3Y0TjZTRGIxaHd4Ly8vQ3dLck9mLyt0Y2Zmd0p1K2V5SXFNUkNZMTlBVXR2Y3VTSVlxY3ZoQW0rNlNKRmFLNmltREZRRUJrb0s4elJMMmdTY1JjVURYZHJxUDZWUE5QUWl2Y3o5K0gwbjlyWFhyZ0wzMHFNeTl0cGxLSm5QUG52NU1nd2hOeTVzMnpnYm1ibHZtWC9sK3BrejV6clZwZW1MT3F2QnBFUHFxZ0tWd0EyY2dUeE0yU2tWNnpCUUhCUVBOS3VYRmszNXBSbFNPR2IyUnBlRDNkelhyb09odndEd2hpOHVJZDJ2WGJ0MDdUWk1JTjkvZjA3L0NIQXphMm9Da2x2blN0d3duREt4bUdESGFKTlZhMEdlREF4VWhLRDJoTHh1dFJPa3pZS2JUQlFlaGxZSXhvQmZySWFJanA3enNPUmdieTZ5OUtVLzNuLy9vOWR1M1hZS2FQdjl2ei9mL1BEc21Oak1pbnNYTnBUQ1haQ2QxYWd3TTNaT1FWK2tUSnlPVUlkSTNCbFFzVmdUNmJCb0JpeU1WbFFZM3JHaTRoZnp0eGZHUnYwTTl6cEs0VWNmL2NLTnZRM1kvem15dDB6bTVqYlBGYmx6d3lDSEdOd2lVS1NEMTZKTURaTDBWZUphSFczaVNkWTJjT0xFMmFVTUZJOTc0QTEzM2Z0L2NkK0czbkRyMHJPWEFIL3p5cFVyUDkyOGVmT25HK2YrL2NZYlR1N0szRTBya05ubWhxS2dJdmFjUFp0dnNXc2hVZEdBQWZVNUpFU2pwV21XNVZuQ2NxYTdkMnpQVWc0KzB0eVpjKy8xbjlJdDJmbXhTYml2UVpHK2hhaUFQWGZoM1F0WGZ2enh5dmVBbGJpUnFRLzE1VlpYaUN0RUNDcVdYbnBtclB1TXdKQVdsakdBb1VVdXRHTmNaeFVFY3M5WTNaTGhzWHlVU3pObXprenhYejVXa3hVYk0zdmJZeTk0eHBYVDBHTHZ2MzNyNXBYUDM5MjM3MlVreDQ4RDk4Z1RldUFtUG1RMFZqWXNBVzRZUmpHYzVzUjQzZEt4RDNEV3luTVVUY0hJb1VBTmltRlVsR0RubDQ2Tkw5a3lQb1pCaW1PaGR5Y0Y5Sm5GUEhJWFNoSDc3WGZmdnYydmYwR3RsRHg3NVp2UDl5RTVmUGk0ekMxN0lDSXFmbVhONmNxR0NrbGRqaW9kTzZDcUc5dEQyV3hXTGM3b2NOUUh4UTVsVUpDQ2d6NHh2c1gzd0hncGhSUk9nUjdjak9yR2d4NTE0OXZ2dnZ2dTZ2WHIxNjlldlhwZERxZ0w3KzZUdVljbDd1NnloK2RFeDZaV21NM1ZIUWt6SVljR0JqUmp3MHZTaDhjMEZnZVBxVkNGOEpQcUZXV3lhSFdVUlZnNk51eWJQanllUGpCQUxjOEpPRzJ1eVlxUGl2Q29rKzlmdis2TTNWdlN5ODBmeiszYjU2VXZPTGo4QVdUb3B0T2JPaXBDMFhCRGRJOXZVV3daN3pZNFRMaUNnYnFobHVaSkdLODRUbXVsR1FyY2dDNkFYQ3BLS2pLM092dUNIRmJ2ZjRmQzZPWk5KeFlGc2h1THVKS2h5emRHb0FLTkZGNENKY21RUGo3c3EwTHFHaGhHWjRXQkkwam00aVJZMnVCZ05PbGpCM3lXSEJoUFovYmsrZmViYXdxUnVySjd2LzMydTZ0aTBseTQ4T1BOSDY5QUFOKzhlZTdjNS92dTVPNUdDc2VtZ3NKRkxVMlFRMWp2ZUxvdmFFTm9lUUhuV1RHY0VWZU5FeVNVVFpKemNLcmU0U1ZyMHNkN2x6YWw1WjV1TGNtTWpjNFgrLzUvenYvbmh4L2twSG4zNVcrKytmemxkMTgrOTgyNWwvZTV4Y1Y5WTIrdHVPdXhVbFI0QjBlWGp0ZGx4dzJQQjJrRkIrU3ZRWjZ2WUhpRytjcGc0RmpjYWh1b0cxNnpwcmgwZkhWZVVwdTVHWmw1RzFMMy9BOC9pS1BjelordWZQUHV2c25rNEVFMzk4anU4dkpWMGZHcG9vZk5BOVBIZXhQcXM0ZTNMQlVjakk2SDhRb0tCOUlYeWdiMGV5Z2NCdEp5WnJ5ck02RXp1L2RBRHRvZmc2aGFWUzV5MGFJVHl1Q1Y3ODk5Zm5oeTdFRlhYSW1HaG5sU1ZqaS9iank5TTZPK3EvZU1qUU1yTTR4SkxCd0tTRjhEaVRGV0VITFBtZEkxUFFYMW5VdXFrOXI2WlhYUkhDc3VkcUg2dm52OCtPR0RCeWVqSGp6c3dRVkRiODJIeUtwb1A3MnBwV204dEtBejQ2V1hlc2ZPWWlZTEIvTVZqbFpFQ25HTTF5bTByR0N6TEIzclZzVWxKTHowKzd4Y2N5dUtxbFZieXgrVHVkLy8rOXovSEQ5OCtNV0RYdUNENk4vQmd5KytlUGgxQ1NwenkvVmlLcG5ORFIyOUNTK3R5U3FJV3pxV2I3QUpBcXRWR2FBT0s1Ri9JWDFwRlVueERxNTB2RGV1dUxpemNrSGJJVEJ6YkxTK3Rnd3RlY0hPTjFEdGZmMzExdysvaU1nSDNWaVIraUw4NVEwUExpeVE4aU1UVjlhQXdoMU40THFNT0FoVzBtYm5TWVVLelhCcU5HK29DUjFycFdsZVJ3dDA5L2lCaE03T3ZMVCsvY2pNK2JBY2hHbmpyZk0zYmtDTGs4Q3ZTMkNSdUc4UzdKRWplM2VYbGFFRlVuaG1SZk1oYzBkSFowOVB3WXJ4c1hSQjBGRU14cUpPQ0hNT0xINDFCS1NSemdDZmhsU09BYmh5UWRPaDFzYkN4Rmw2dEF5RjllQmZvRUI4Lys4akxyQlQ1WU5lMkNNZ2UvZnUzdjBFd3RidVRFZmNYYWNiT243Zm1RWHRwcFNHdUJVSWhNV2hBU3ZRWWw4QzAzWTdpNmYzZGhWWHBmVDNHMkc1UDI4cldvZVd3VUwvTTVEUGR4ODVjbHdreTJBdktsSno5eE8xNlBweWFlRU4zT1hyZGczMWQzUmtaSGVONzFBUW5FUEFUVEpXS2E3M2d6QXRBdXRzTnN1TzNxNU5PUTFEKzhWdEJqMWE3NWNoMFlPVTFmNW03OTdqM21BWkM5QW5FRkNTV29UVnowc0U3dVA3VHlHRnUzbzFCcHVEeDhXeW9VYmJDaUlYSTdRVVRCelFHaXduZXJ1cUZnd083WG9jY2ROQllYSEZYNzd0eVlkQk5wYzlzZnNJVXRrSmRtTEJvNXNwcHp3aXlyeFppUm5BRlJYdTZlbzlZYkd4Q0VzUm1OcTV6d0RhUXNWbWVTdE5mVEJXV2xRRjZnSjNlVWI0ckhuM3pZdUppSWlZQXpJYlpOR0RtOHQrSTZvc2dVWHNHOGYzUGxIMjhLTFpzK2RFUk1TZ2phVG9xS2lveUZuaENBdmMvYU1OUjl1eTZrNVlCbkNXTnhsb1Ntd0xVaC9VMFF4bnNRbzJPME9kNmEzT0d4RzVxNWRuSkliUFFwdFhTS0xoamhGelppOTZ1T3lKdlVjazhJdVN0Z2o3NE96WjByWlpaQ3phT0l0UFRFek16RVpZeEIwOGVuUko5NWtCbkJjc1BNZVp3Tkx5dWhzV29ob1Y5Q1RXYXFQenpWVU5vNGo3K1ByMXE3TXpzdUFPY0ovdzhGaTRaeFFpUDdDNXpBMldzYXRtejRtUnRnbFRNNUdzWEpsZHNucWRoTjAvTk5weDhzMnhFMXFidzI3bFREUkpvbVdLcysvREdLdFNhR0hXbTk1U1BmSWhjRVV3b0ZlWElDa3NMTXpLU2cxSFpCRXNScGNvYjRqYVJrUkh4cVBOUWJRdGluWkdSWGtjUGJsRU80VWpKMGYyK0ZJTWhTc1VDa3dINVZrbCtSZlNpT0dzUEVQUVZ2dEh4em8rL0hCb2FEK1FBZDNZM0lpK1FMWnZYMTFTbUJVZUdSMHgrOEd5V2hjWWhkUm1XQTlGeG1lVWJLOHhHdEZHZFN1OEhqcGtoditmZmpvNit2WFhYNTgvOW5FcHcxdFlyWVptZVlob1RJNHJKVFIrOExEVnl1ckl3V01qY09XbmtweEcwdGRuN0R2OTBicTc3MTVTVjVLUkdCc1ZNZnRKOExHWXlHTHZnVEZPZkpxemZXWDIrc1pHdUxxcHVibXZ1YW1wcWVoWFRlME5EUjBkUjA4ZU8vbUJqYU8wSnF1Vlkyalh2b3E0Z1FYclFjNWlzd3R2SGp2VzBsQmRtWnVic2pBRnZ1QWxJTUFmU1VEeXdzSzY3U3RUQWZ4QVdkbHZqc2lsdUt6c1NSRzdmU3g3dWtMeGl5bFQwT1ZUUlVsS1dsQlZYVjJOTnI0SDh3bkdJb2p1SmFRTk80bXJSRkhGUTBRN1Bqb0o0S3E4bkp3RlNVbnltM055OHZJcUs2dXJHNG9xS2lwV0lvMnA4aklvWGdnTDFRS0d1UGpDbXI0K2hXSjlZM043ZS9zZ3lKdXluRHAxNnA5SW5yTmR2R2kzV1hrVExXL1h1ZlRWVVJpRzRmRC8xSC8rODA5WlJrQUdJUXM2T3RvYUFQcXJocmFtUmdDRGovVUEzbnRFeEQ0TU0xeFdqYkZtNFMvWEdmdEVNUjg0Y0tDcnE3VHpwYTdoM3JFelovUFQwNWN5SmhDR01kQUdDZy95MkJlRmtEWXdFTlFtaHRiOW9lOFBJTStkNk83dVByQWxmY21TSmRuMTljVUZtUmtaQ2NzNjJveU5GWm54a1RFUFFBMStRdW9BaTZQUjFvMXgwNVJmTmlZa1pHUmtGaFFYMTA5UHlLeWZEaVBHMk5nWmk0QldBUkRJS2pWVVJjaFlUNjRVMHF6VjdyZ0k0ckRvNERJTVc3cG55OXJNK3A2TXpwNzZqSUw2WWlBWERmYjNOVDJVR2g4VnM3RmNMTnRsdFkvRVJJWVhOaHVOdVZPYXMrZG5aQllYRnhSMDloUm4xbWNtWkIvbzFxaFVRS1I1d2U1d09MenM3T1BjYjljUUpHMmlrUjAwSk1RZFhHaXpETlN0clFkbWZVYkM5UHBPVUtTZ1lIQ3czeWlDRitzbHJINHhzbkt6c1MxZ1dVMUJKbHpSVTZ4SUtPNlozOU5UdjZadWdPTXRVSkZoc1duaUJadlZ3akU2cmF5dSszbUtHa3dOUlowa2NFSm5NTEU4MUxTQkhYVnI2dU9tWjlSM1p2UmtUaThBYzFlTURKcWJVV3hGNTZPR1VWdWJMMW01UFRlZ2FYcDlmWDJtb3Jnbm9iTWdJUzREc0RzNDBQT2l3dzZ6alFLSm10SEp3ZXpuZmk2SnVnTzBKRlNrUVFTT1ZLaEpudHRUVjVoZEQzYkxBRU5uOUhUT245NDJNdGpYaEZ3OGJ4dnFkakJGaFdmWHRCbzNKUzhyVUdUMTlDUVVaeFNEWHpyWFRGOWJ0Mk5nQU5OQURVYUJ3M0U4eDBKbGxyR3luYVZIREtnSlExTkN2aEJNT29NVkxNME5EUFNpMkV6d1hmTlNaMEpQWm5GRy9jaWI3V0JwQUsrQUhsdTdBb2FaMVdEbHRPVGYxMmRtRnZmRWRYWm1LN0k2dTdyVzFwMFlFQnlvV0hCMkNCbTd3S1BjZFJyWlR6eEg0YkkweEJhWTE2VERGRG9Xb2hESGNaTmw0TVNKN3Q3MEE4UERYWEdabVVBV0xRM2d4RmtyTm01Y01Tc2NQUXMxYjBvcmVxZ1l2RnF3cEd0NGVFdjZnZDd1N2dHTEZxY1ppMDFnU2RJRTMzZ1dRa2Z0K1R6VTlkd1pCbmhVc3hYb095dFlhWXptRERnbmNQbmRZMk5qZGNOYjRqcDdzcVlYRHlKTHJ3TncrS3haZ00xZTEycHV5MDM1L1pycEJUMzFpaTNEZFdQajNYVjdMQlpHeDRGYkdWZ05TZDBBa2xSSEJFM2dTbWpnZ2FWTkVBMlFTeHlod0VpZEd0Wk1PUDdCMmJOTGw0NzFGbmJWdzZSMFlHU3d2Nmw1M2NxTVJMSEpybXR1YmQyVXQrbEFWMXhXZmRlVzNqSFZqck5uQnhTMHpVNnBDQkxEV0xpVmpXY29BbGRweGZXbmg1MmRYQlZFTkFvQml5QXd1SUl3MlM0eW5NTkFZWnpEb3NXWXN5ZTY2N1lVZ2duTllPblc1blhMVjg2ZkQ2MGRKc2EyeWx4amQrK1d0VnZxZWsrY0pWVzBZS2MwV3F1RHROamdOaXFUSFNMYUN1NlQrcC8zdVJISjFOQ1dLQXFTaU5JUUJ0N211R2hDaTBRcjViQnFlWW9YQnZJSGRuU2ZHTkRzQVVzYmQ2MWJ0eHhrM2JwZFp1T20zSm9kUzg5MFF3RHZzQWlvR0RvRTBrcWFiS1Q5b3AzVHFWVTB5eklHQTYxemxtYVA4MWMrenBER0lIdHB5c1JiTElLZHdTbEtjT2dFZ2VEdGhNMUdFWkRSRm91YS9Pak5rZjVEdXg1Zkp3MFVvRzdsUnhnaGZEQXd3Q2tZTzY5ejBMU0Q0UjBNYVNBRXV5QllZS0l3NkxRRWdXdjhKdVBLN0NCcHlJT2lhVkJnSnBnOURWWklCWjV5c0ZxdFRTRGhFMkRjNlpIQkpqUUpnZXo2MUx3cHQ0L0JLQWRqRUt3cVhMRGpOaHROMjdWMkI2OVZFTkRTUVZEUFZRY0YrWG1kQy9MMTlUNU5HSVFSSkVrWk9JTUNiQ3NJV29aZ3JRSmpFaWlCZFBCcWcwUExVYlpUSTRNTklualhvZmEyeWlhQjRLaUxXc3htSXkyVWcrUUZLOHlKak4wbUdCUUV6OUk2OUVBaGFNSUpPemZYOVZ4VXFjWndyVUduWWFCU0NveUtnRklqVUNiU2F0YzZkQnhwSXgyVTlibVJrVFp4RXRyL2FYOUQ1VWVzd1VZTFVIUHNwQVBjYTdMeUZnT3V0bHA1SzRzVDBBbGN6K2E4emdYNSt2cDZIVkJGd3p4VUVKcUJKVExMcVFtZU43RldER2Z0b0pYT1lUSVFEcDRpVzBjRzIyRUcyNysvdjYyeWlDYnNOb3EyMkFtZXN0dDBoTTVxUWs2aXJLeUo0MGhhaDZ1RHZFNmFTZWNIRWRkMzRwbE5KUWJyQngxRnN5VEVrb0Uyc1FyYWFySGlPRyszYWdpN25WUVBRRXlqeCtpZnRqVlVsaW9NRHF1S3NOa05CQVVKZytFOFE1c0F6S0QyWmhDajJPT2Npbzk4VmxQayt2cDZjME9VR2h6MUpScG5XUU5KbVhRNHo3SThUb0xwS0V5d21naTJGQ3c5T2pUNlprZGxrd25qQkY3QlFJcXFkRHdzQ1JRbWFIMnc2TUVaU3F2Vm9xZXMzbHlmQ1Z5UHMxQm9UenBJalI2U29vNnBwU0duYVlNSkE5T3pzSUExd1dwRDJ3NHowSWNqUnp1cTg4VkJSUVh0aHFOSUZpb3NXSW9nWUh5aG9jZHJOT3BBcjdPNWtyNUJ2cjQveDRXTFVXVEQ1d1UrcExRV1BWU2pLWnJSb1IwWkxUWjk1Rzhuang0OVdsMkJhZzNOd0Q5QUdkQnFnTmFSbUFiWFVpaUt2UStNK01pbmdSRlE0Y0xLQjJiOGxESVdGVEJNZzlhcVVFeHdpSEUwRTJncEhVeWltQ1lrZU4xWFgzMTFzcU1oRGoxTGh0OVNoSWpDY1lKQXBvVUtoQUhXYjhJNU01SHI2K3ZVMS9OUXJ0TGpYS3ZyNkVPUVg2QlNnMEh5YXlBcDFFcnhNZkhnVjE5OTNDRWVSVUZvWERNRHhsR05VamxESGVRK0pDSWVuWFFkdlJZeElsWGkrbmdHdE5Mak9PMGtSNjZWU3ZHaE9PQkNtZ2ZibDhobkhwWEtrR0IwTW1PQ1REajhMWWF5QjljSkZyRktqMFBMZ1Q4bjZCVDB4SE5FSVlFL2cvV2dCZ0ZXNHY0dnR0MGd4WUJXRXY4QUFBQUFTVVZPUks1Q1lJST0iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFeigxNSwgInpvb20iLCA2LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUM0QUFBQXVCQU1BQUFDbGx6WUVBQUFBSGxCTVZFVUFBQUFoSXlBM09EWlRWVkpyYldxRWhvT2twcU84djd2WDJ0Yi8vLzhnb1RKWEFBQUJhRWxFUVZRNHkzMlR1MU9EUUJER0w4UUFkbGc1ZG1sOGRaVGEyVGlqWFFwbkloMlR3b1FPeHdlaGkyUEIwZmxLWVAvYjdIRnY1bkFMQm41MzM3ZDdld3NoWFp5dUtYMlBTVDhlZ1VXNzZPRTdFSkZhK0JoSjliU3NVV0ZhZVRWM0dLSGJuOEV2bEI3OWJqU3Y0Vk84alVyNFZkaUhObks5MzhNSFBpZTBZaCtaTHFtR3VOc0o3Q05VUmdld0k1cVBvUkU4Nkd3a0p5V0lCSWZjVWZKcm1NbTBzY2xEeURuUFdtTHlBRGFjbDhqblJiRUdLSW9pSlJQNEVtVTJMSm1JRGZMdkFmN3ovMzdtdjZJVW0wOHB6YlYvcng1ZjFwUEExRm4vaVgzZVMzbmVrQXNsejdnY0d3OWJnM3VxbjZSdXA1b0grdWFUTHBPNHIwU21aVnVVRkUybGZUYyt6MXFyOStCVnRHSnF6cTFSSE5mUWRBdG5yRVc3NVV3dVhPRmd2ajNjcnBDeUR1NlVJcFA5ZlBIWlU1WGtpWVZYdnNYSVBjYytWd3NwelkycFBvckUvTmdDZllLK1FKNStRRkE2ZmpRdDJBNElXdUlXT0RpeGUyRUxjdUlVTkpHTCt6UWxlOTJleFk1cGZESWFBQUFBQUVsRlRrU3VRbUNDIik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMTYsICJhcHBsZSIsIDMsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBUEFBQUFCUUJBTUFBQURWWitWUEFBQUFNRkJNVkVVQUFBQVFFZzhjSFJzakpTSXZNUzQ4UGp0TlQweGxaMlNLakltbXFhV0t5b1lGL2hKdzNYTEx6c3JmNHQ3Ly8vK3UxcFJHQUFBSEtVbEVRVlJvM3RXYXpYUFRSaFRBMTQ1anlRZDdIQ2dmT1RTa0hFcTVRRHFkb1QyVnRJZCtYTUF6N1F6REJadTJaTWdoamRNWkpuREkyQm42NFJ5SW5CWVNPNEg0bk5KL0lLWC9BTzNGZEZvU0RxQVlDb1dEcFdrQjJ6cElyMjkzSlZ0eUZCTW5yVFhWSlBhVHJOVnY5MzN0VzBua0J0MSsvcjZEMnc4TVNmRC9wNlY4THRPeGJTby8vNHNKWHNxZGk1S09iYjRUVS9NY3ZKeUxrWTV1M1ZNTERKeFBrZzV2UXA2Q2wrZEl4N2NMQ3doZVNuWWVMTXdqT0JmdFBOZzNkWVA4NklHbVVkZlh5ZktNRitEZUJiS2M5Z0lzTHBDYlNTL0F3bFZ5TStFRk9IaVZMSGtEbmlkTGcxNkFBMTZCdXhBOHNPWFc3em1iZG4zbVJ2aXNQZkRadENPbjUvTnVubEJ3UnFLb3VjV04xaFo0QW9yMnhnQ2dSYmNBRmgrM0NRNkJFNnlQWDREc0ZzQWhyVTF3QVJ3YzJqaFZKY0hGSnpGeGhVeGtmWGQ4ZHliS2FRbytxVndoWkZoWndZOXloakZPS3JORVdKMHUwK0ppMFZnUnRVdmxCR3U2Q1RCVmJhSUpITlpJeWxBZkNSb3BsSUs2MzFEVUtvSUZWVEdTUVZXQlpMZHE2QlRNZGtUZGdQdTRvMEtOaWc5cDA0ZWJBTWNCOUdZZGlycFBuZXhGSXBHcm91YUhtVjRkd1JHdFJ5cWhKYVZpU0IrVUtEak1qa0R5VkkxT0JWcFVoTEZqbWs5TmgvUk5nRkhUbGZWZ3dTQStOU2EvcTJuaGl0K0lCaWw0dEVRaVZaeGU0OFZJaFZxVUVIWUVHNFJxcG8xMWJDN29QVHVVVFlCVmdQUTZzSWFYSUhLeWtLbVdJMnM0OEc0S2xvb2tYUE5kVXFCNHVNVDlpQjJ4ZytrZnRSMzB2eERzeCtCWjU2NTROUVllelpjSzhhSURIREx5aGVJK0U1eHlCUnY1dkxQUWNRVUhRRSt1QTB2UEJTUGFCWU45OTRxcFF0b0N4KytUdmtya0dlSlE0MkVLamovQUk4M2dvQkVsYjd4QTFUMDQ0bHlDN0h6ZEVjZVpTeGhmOHBVUm5ZUWgzUWVERmppc241R0xrZHFyYWpGa25Dc3c1OUxQRklwMXNQNHBBeFA1OG11dG5VdFlWTXBqV0hGZkEzaVNjSVRYWTBKT0FmeUdjaXhzRUFzY2tNR0k0Yzl5MFMrRFJzSDhpQWtPUW8yRFB3ZDQxQW9zeUlnd1pqK2dYNkRIYkxrNjEwOUxRN1JUSUVlRUhQSGxTRmVPWEVpUXZmbEpyTnh5QjlNb0RiR3lrUjRSNXVnZmJzT3p3VG1DZi82cE93T3R3QVd3YjM5MmJGb01PYmhnSkRvRmxweGdTSGNJN0ZmQkcxVTNhUnFTblFKSG5GeXR6V3Z0T3Y5MWRHdmdVU2U0NURoUlViS3RMeldCaHRMVFd3STdnOGxaY29oTkhWbS9HQUpuN0xjRGxwMWdSekNGQWFvdDE1MW00eit3ai9tWjdZSDdtMnFEbGpaSHgxejlDRE9lVHZ2NGRGdGdJK3FzRFZTamxlc2NadjBTcVo2MkN3WUhSeldrbHZra3hWMUFScy9ZTnRqdUp3Sm94MW5GR3hqNmhPekpqREhwdENseGpSUTVQM3RrQkNwRGRGbjBmdVpMZXVqSTBNQ2VESDRmeUh5MVNYRGFZY0pLR0o0eG9iWlhCZU03ZHFnWHBXOGRZUC8rcUdSR3hBUityYkk4L0kySy9qSmk3bTRpbk93bGZSK3NpVkRqWURaMXhpallsUGhRYS9hRW56WEQ2eGJkbjBaSFpWVVh6TGlEbSthSW1zT0UyUzVXOG9aQUJ3TlR4ZjI2ZEl1ZGNBaGdoVHZGTktvQmt3Mk9RbUZWc2dSNFVuOEtvS3phQXNNQmpqZk5pallqeTJoeG1VWTJobzArdGh1ckRTYWQzaU9iL2FNakt2T1V5WnhMQUxoTURsSjc0WERtVHV4VWNYZXZMZjIzeXRYUXFQMjdlTmV6REh5TGZocFJMcjFzaFIyelV6bHBnY05zZEJMNnVrUzdGakozaTV1YW5ZeDBJMkZpNDZPd3hzNUpzQWswaWRJZ3JVak5VYkNxQ1l5a0NZNnpKVXdmcGp0R2k3RGRNUHpsQ2hhYXdBMlRoT0U1L2FneUcvUHhaVTFKdG5LNmNNMTBEQWJtZzZNRFpZbzZhdTVXM1N1UXBrS2c0VjV4Mms2a0hlRTZvOWNOOForbHhtUnlZSkZONGd4Y1lORW9ZdWZZQ2FOUXZudjM3cjNHRlZ1WFBrOGJnV1lvaWtMTmFlSlNOckF0N0Vab0VOckFnZ1dXbW9maUJCK0NEU1pHdFY2VHRBWWpyN1FCbVBaY1VSNjdnMFZ3VDVyQlJrNnhxMW96cmMwV0lEMm1UWjVhNEt4ZDFhbm1Hd3BPc0U5MTl5MWswS2NZRWw3UnhiblNyRTQwMkpuNzRPOFd6clZ4UVo5eXIzMzYrSEk1ak1ybDRSVGc0WVFhNlRZTEJwVkhWUXBEam9HUHc0TjZPR1ZwT05GRUwyUW1Od0NIM0VzUWVqbFRjWGpHQTU0MlVQcVZTYVp4NmRxb1cyWFRZc1ZLSUFWc2FPWWRQVW9YWDZVTndEN1pOVmVic2RxRlkwU2NjZkZObVkvZHVQaVdhcDZHaGVKc2ROY2lMd1QwZDZLWUUyNzNEUE9VbVdVWjV6WVIxSWFsbTFlTHg5eDhHbHZGckE3UXFZRlBPNVpVclBzbG5USnFYRzNXSktGWmdZNUdWSEQyR05nSWpMb0NZelZ6elhGSFRiUnV4VWl3aGtGRXM3SStTQ3pKYkQ1ZG44VFJBWkFWc3VaQkRoYVkzLzYrOGNMOG9GcW1EakNzbEpPMkN0UFUrdHRRUVp5SVBaOWtNN01wOFM3VHRHVmNNZE1Jc2tZUXRkSkliUi9pN21xMHhSMEJQLy9SWjZ1NC9QdGZxUXMwYlFUR0IzbEpRTHJIRzdkK2ZXZnp1ZE5jZk9sajJucjNPTnZkc1o5ZktuRCtpKzNjdlEzVmZTN2txQlQrODl2Ry8zdHcyM2ZvLzAxd3dndHdjTDdOeHo4K3k4TnQwaFlmLzNqMndNdXpSM3llUGRUMDVqSHU4SFh2SGx4Nzk2amVzNWNUUEhzZHc3c1hVRHg3NWNhN2w0dzhlYTNxSHhvSThiN2llNkFzQUFBQUFFbEZUa1N1UW1DQyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDE3LCBTWzg0XSwgNiwgImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFFRUFBQUFLQVFNQUFBRFJwcUdwQUFBQUJsQk1WRVVBQUFELy8vK2wyWi9kQUFBQVRrbEVRVlFJMTJNNDhFL096b2luam9HQjRjQS9PM3Rqbm44ZzFpRWpZK2FlQXhDV29mR1pCaWpMQ01xcU56UkttUWRoR1J1Yk5JTlp5ZVlRMXA5L3lYYkdNdjl5RzBBc0cyT2VtdHdHQUpjc0l1eGJQRjdnQUFBQUFFbEZUa1N1UW1DQyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDE4LCAidGFyZ2V0IiwgNywgImlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHUUFBQUJrQkFNQUFBQ0N6SWhuQUFBQUpGQk1WRVhVQUFETFN3RFlXbGkvZVFDemxRR2dzd0Rsb2FHQzB3QUEvd0JrNXdEeDA5UC8vLzhOVUJ1QkFBQURXRWxFUVZSWXc2Mll2Vy9hVUJEQUR3Z2hUUmFrcW9KdVRCbVNCYW1OU2pjeUpTTVpvdElOWmNpUUxDeFZuUTFFa08wTjFFVDFpREprZ0NWaXlHRC9jN1VOOGJ2Mzd0NUhxOTZFYkg2K2ozZnYzZDJEZ0pQdzUyVXFkK3k3QUpoblAwNWhJNldUT3lma3NRMUlQbmhXSkx3QVdVcmZMWWpmQlNKZmpJamZCa1lhQm9RblZBWWpZUmMwOGxXSFhJQlcrand5MFJOUWlqakVyeHNRcUhKSUQ0eHlUcEY3TXdFVmlyUXRDSHhVa1ltTkVCRUFWeVZDRGJncUVXcTJTTmNCZ1E1R3Bzckx3K1VxU1piUEF6Wm9HMlFvdmRwTi83K1I1eGFUTmprU1NndC9sQWlKSmFZbWtJbU9VSmlTUUhDdTdDZUpuamwvUTdCZHU0a3FyNnBsb0tUWExVR1NKOFV5a09OMWxERFNrbU1HVXJLVU9TSlpDK1RkQnZIRmsyTVdTUWJTVGt1UnNVV0pwQ2JLa2FFMndJdzMvUndScnF4MHlLTDRTek5EUXNPYTBMV3BaY2pVNXJ4a1dTVkR4bmE3c0dWUmlzejRlTVVheS9vcDB1UGlsVzJVUTZ3VmJVMEk2b3dybTdRcXI1alYzQXNnWkZ4NXBhYStpSkNCU0JjbVB2dlVtV29BVTdvcUtEOEt6YkdJTWt6b0YxdmNIaTBlQlRCNiszbkFiY015L1U0RU03SWZGOER0MGlKa0hvTkk1OUFCK1ZBZmhxcW5zWHdNa2lpZlEwOUZYaVdrVEpDT1FKZ1FzNDhaNUVWR2lQSU9kRlZrOGYrUnZiOUhtdi9paXl2Q1JZeGZGekN0aS92cWs0U1JjMnlmeWJHWlBtZWxBd0VoSS9KeXpYbVBrMzlNVElnNVY0UzVBZHpUdHdObWg4V2k5b25qb3N3Y2pidjAyUTUvamozUllydEdoMUxBRmVNQktiWUxVUzFCTkVrSDZBeS95aDdjY05XaW1TSkR0aUl0bjIvd0tSNmpCZ09Da1V0OUVXdmxwY2k5cWJNZ2NTOWxWY3kzRjJSa1Z6V3Z5SFc3Wld2Y1hnQnVyWTZ0ZG1YOVpZcU1yRlVjN1RvdlI2WmdDOEJDNmtpelRna3NhbUs1aHdPNVQ3dzFlNUszeWhreUJtT3ZoTStQYUl2NFlHcjdjRDlhTFRyWXRxbTV4RWRCczBEbXVLQ3N0TTFvSHVJdDRvT1dlYUlER1RDRHhZMnliNVRSQXJqeDVYREpUZ25iQVdhRGhPcUFXTDYrdnI1UzU1ZWFOUExNWFVZZVQwSjhCNktxakc5RE85SlhFTHVhR2hsRjU0NmVJQ1MwVEpZTlpxdzJEOG1WaUp2M2UyNkRPRVpNcGpVMEZ4RlRMYkdqdlNGNTBEbmk2ZTloZnZIenRHZTY3WG13NnFCM1NvL2swbU1uc3QxYythY3ljZVp5UC9hSTl1aUo1M2FsRnZ5Ky9KVGE5Lzd6dDhqMUZzNGlmd0NtWEJtT1lrbGQwQUFBQUFCSlJVNUVya0pnZ2c9PSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV6KDE5LCAibWVtYmVycyIsIDcsICJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRWdBQUFCSUJBTUFBQUNudzY1MEFBQUFHRkJNVkVVQUFBQlNWRkdhbkprQS93RE16OHg0LzNleS83TC8vLytHREhvYUFBQUNaRWxFUVZSSXg5V1d3WXJqTUF5R2xWQ1lhNmNzNUpxR1FoNWdhT2JhRFlVOFFKbk9BNVNTNjZSTjQ5ZGZTWlp0MlUyV1paZUZYYzloMnI5ZlpFbVJKY1BiTHl6NGQ2R3pNZE0xL3VYY0czUFYwS2VoRlZGbmxoNEJhb3hkbDhCRUVrRjdFY3dVb041cEo0SGVuUkJNTlY2NkM0UWZ4eEkyblRLRmhzWXQ1Q2daQzlGVGF3REl4Ymc0VUtLVVdldkF1dzFBcS9EN05VcTZNOVJiUTJ6S2hrd3BLVm5LMkFXR1JyQ3JjMDRsRXBEZmd5ZzF1OG1oM0VRcVNHTG9TNVFYWS9hNCtYU0tKSUl3a2tOUU9JbFRnRllVY1FxNTlUdVFjcndJMFBEaytNM0hheWgyK1JjQzFzbWtsM0REajFsdGxNUjVvbGQzOEx1dEhUMDRsL0JWQVZmT1NMOWxuWGVsVUJLYUFsdHh0MmdUdjNGdDZ3Nms0c2FqZHRmNnpoTFZIVUhsdHpUd2tJenZPVUdmOVBoT0pKZFZkcGhXUzBZZkZuSlVDclZnSVNtZFRWV1ZuVlFhMTkrWVY5VldLZ29obDIrTVJVRktqYUFYRFgwdFFDdnQwK0hQSUpXbkphaldHVjl3UERQdXRQRmhYczlDSytQTHIxYUpqU0YrNWFVenBPUVk2bXdaVVJXTkNSUk85SlpxNDNpa010bm9nNDR2Mkxsb2pLMUVXNm40ellYejRIcVNiL2dzdHkxcWFXakF0NW83TkFFaUw3SmR1MnZYN0lxSExpa0VJWWR6VUo1Q1pRUWRKSmNKNUdTRTlpNXRDMUJOUjRvYWRHdWI3NkNod3JaZktuNDh3VFJYc0dmclF2SEZRcjBkbXkyNDVvOG5NWUhHb3hzVG9NWklBb1dCQTJxT3pFTVhtVkppSzRuTzJqbjVvWGp1NXlHWnBuNEdmL1FwTkgwOEQrcG42TzN2UXFPR3Vsa0lYMCsxZmJYZDkzVlQrZGtYUWUvU08zRjFma1NuVUJqZ1Q3Y0VkVmRKb2RrTFRiTmtLTHIxTkgxQXBzdFBya2JuSy8zOUI5ZTFIODVOSlBqeHJLN3pBQUFBQUVsRlRrU3VRbUNDIik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMjAsICJob3VyZ2xhc3MiLCA3LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUVnQUFBQklCQU1BQUFDbnc2NTBBQUFBR0ZCTVZFVUFBQUJLVEVxWm01Z0Evd0RKek1oMy8zaXovN0wvLy8raXlWRi9BQUFDamtsRVFWUkl4NzJXM2FxeVFCU0dKd2s2ZGNlR1R2MUM4QUpFTzYwUXZBQ0pMa0RJMDJ4UHJ0dmY3NXBKNThjeDJpZmZJcVQwYVdiOXZHdU5JcmZ0MGhTWDhXcVo0RXR4ZzlITStHNHpRVmRhdE9jRWRTU3Jxa3IzanVGT1ZkTXdRWFFVQzdZbUF5VkxVUFFaMVB4dEpTSjVqczdLWDdqLytwS2tOUjVZMFJFOUlqLzZKTVBGUkZmZWJ0MGNPbWJEN2RaT0VPd1Fnbjdzc253T3JmOHJKQU1wOEtGU3Jud29ybWNRQ1I4UzFIcFFnVDhxVlZYblZDc0pTL3RRemxWNG1NcG1KTFVDWE9pNEkybWdtbm90T0FmcWNKUGlDVUlHTnNNTXVuSmRFcU1qYlArY1FRY09yeCtoblowQkE1WHN1VFF1UFV4d0JvTG5aajk4T3hxL0xhaVRITks0RzM0TUFRajdqZkdoUXFlSWZnSlF6bTdvZkVMY2NVWjVDRHBRaktCTzNMYlVyK2daaEFvOFFoTWw4Rm9DYjRJUWhrdnlVdDdKV2NpQkNuaFVhNVZrSmtrZXhFdHhRM0tqUHZNbHFLRDdoazdmZEYvYkhubFFmb1VVNExnbGdCQ0VsVkNQK3p0SWJRZkRkWGs3T0w1anFIL2p1RTdCQTRwQlVacjhYVEpaTWFkb0taa2xLbHhyaU12U0JxR080bThlakptdXk1QUg5YVRxcTAyQ2J3UFFsZmVZREg5NHppRVdpbHFEVzV4bmlpVVdxNlZVanM2c3pGVG5hdDVTSFl1WGRjbkdBY1RacklOTHJwbVpHSm5xcVhZMjZXTE9OSjdyZnFtNXFmd2gxdlhja1BhaEFoOEhEL0ltanp0N3hKZ0FDTGUzb1owMXhZUTFNby91bVdtR3ByQk9qY1E5NmN5RUV0YWNjODlEckR4NlBrSlFySFNoMmtqZGdoNHVsSDBDN1lJUXVTOFAzbllsRGE5ZWNnMzNPcFVGOFRxbkZ5QjlVaXRJVnVqc0FMU21xcDZnKy81ZkhLVnB4UWZRcU02cTJpZXI3WDVqb0ZkQU1YKytZckV5TWM2aGdQMFJrdW9WWmJ2ZlRxZlU2Z3MvVmJaRzZNM2JtbjVmRTBweGI2eDFPcmk0ZU5ia1kzZitBcml1WXBqUUNPb3hBQUFBQUVsRlRrU3VRbUNDIik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMjEsICJzdGFsZW1hdGUiLCA2LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUVvQUFBQUtBUU1BQUFBcFJscGVBQUFBQmxCTVZFVUFBQUQvLy8rbDJaL2RBQUFBWDBsRVFWUUkxMlA0L2FmaXdKK0c5dm52RHpEOC92UGp3SitEL1NEbWdZUVRCdzQ4N21ubVlZQXd2NE9aQlVEbWovODl6ZndOREJXSmZ3Nzh1RHYvTUpBcEFXUWVPRG4vTUZBQlIyTFBnUU1IWjRDWVB4SjcvdndCTXZrUElERUI4dm8rUzNMN29Nd0FBQUFBU1VWT1JLNUNZSUk9Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXooMjIsIFNbODNdLCA4LCAiaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUZBQUFBQlFCQU1BQUFCOFArK2VBQUFBTUZCTVZFVytBQUhBSWlNQWlBZkVTa29zalN4NGNNUmNuRnpQZ29HYm1OR293NmU3dXQ3ZnRMVFg0ZGJmMys3dTNkNy8vLy9SbzRCbkFBQUNna2xFUVZSSXgrM1ZNWWdhUVJRQTBEMVNwRWl6Y3YwVmcxaDdYSEhGUVFwWlVxVmRXSVJyUkJhRVFDSVdLU3hTQldSQkRvSUlDMEo2WVpIakNnc2hkc0xDd3ZZQjJjTGlDa0hMUTV6TXozY2w3b3c2TzFPa1NKRi9WOGxqNXMrZlAzOE40My84cy9HcW9NVUsxN2ZqY1ZrRHR0dlQ5ZXBSQXdJR1cxN3JRV0JqVXdtVFh6K0hjMkJQU3VnTmJkc1p3YmFsMnQzZVJSZGdPUmszVFNWMGtqVFJ5ZE9sQXRyRElEMFVURXdGdEt0SmtzcW1Dam9kTDVqUEFiYW1BdTZzMDhFRUh0VndmNmdYTFdpUGdKVzFZQ2VSN2kxQ0xMM3NPRWZRQWFZSE1jdXlMdnlrQmIyRTZjRVJyTGl0TDI0S0VvZ1Y1NXY5YnRtU1FHeE1idWZYYThoZWt3am5RaG5mQXZkR0JGZkY5c2xXdkpoaTN5MmtUWkd0K0dZTlhOOGRIL281Mi9rSzZDQnJrbU80NEZNTUc3RUVkdm5tbVVLdkZCL3FMOEo3YnVzN29EWHluVFhQRnp4TC9uS2RRcERCTktkMnk3ejlBUkFTOHZHUTlORmRQK3kyYXJQbnoxT2dVWjJRUnZ4eUh0N0R3c1NiQS93UC9Rb2hwWGhia0hUNHRueVZqZ0xhdHdnaHhSakdyUnZUUElVSnU1bENGQUhkcllmeEh0aHF0WncwVHpvOFlGOFFOYUtvbnpwUzJnOGxkZ0k5L0hWV0wxcjc5VEErN0tVQW5ZN3pGVHVTdW9TTFVvU0ppSENJWTJxT1F3M3J6RVhSZFJ1RGlJZlYvZUJMNnl4R3NlNzZodkFNWXZ5ai9qZHlHdFlCT2w0Q2ZpUDBCK0U3Y2k3K1FDOUlZTk96cktKYklYblF3V0ZMWnhMRFEzeFYxSGUxSUExcmhLaWhBMkdGNk1BcXpJZ20zTlNJM3RhMHJnY1Q2R3RCZlBsVTY5UzdpKzVwUWF4NDdzVWNJQ2FaWDNFakcwK2J5dCtGWFVYSkQvQkJVUjhqRzkrYTBGRVUwdURtZkdqcFFEczRldmhTaUIvL3ZPWTFoSzlSVHd0aWxqblh6YytlSU85eURPR2pUdVh3TjJoOHpGWUVCZWtBQUFBQUFFbEZUa1N1UW1DQyIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFeCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXQud2lkdGggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUV0LmhlaWdodCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFFcyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXNbYUJdID0gYUV0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFeihlMSwgbmFtZSwgYUYwLCBwTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgek1bZTFdID0gbmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1tlMV0gPSBuZXcgSW1hZ2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1tlMV0ub25sb2FkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUYxKGUxLCBhRjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGMigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzW2UxXS5vbmVycm9yID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGxvYWRpbmcgaW1hZ2UgYXQgaW5kZXgiLCBlMSwgIkVycm9yOiIsIGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGMigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzW2UxXS5zcmMgPSBTWzkwXSArIHBOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGMShlMSwgYUYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJzID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMnI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUYwID09PSA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJyID0gYjkuYTFJLmEydTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUYwID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJyID0gYjkuYTFJLmEyeDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMnMgPSAwLjE7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFGMCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEyciA9IGI5LmExSS5hMnY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJzID0gMC4wNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUYwID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJyID0gYjkuYTFJLmEyeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUYwID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJyID0gYjkuYTFJLmEydDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUYwID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJyID0gYjkuYTFJLmEyejsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1tlMV0gPSBiOS5hMUkuYTJxKGNhbnZhc1tlMV0sIGEyciwgYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRjIoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRXMtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFdygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRXMgIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRXMgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFFeSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYUY0LnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFFeSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMLmE0OSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlguYUJBKFtjYW52YXNbOF0sIGNhbnZhc1sxNl0sIGNhbnZhc1s5XSwgY2FudmFzWzldLCBjYW52YXNbMTBdXSwgW2EwLmlkICE9PSAyLCBhMC5pZCAhPT0gMSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWoudmUgPSBuZXcgeFooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFqLnZlLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhdi5kWSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGMygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1s3XSA9IGFFdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1s4XSA9IGFFdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1s5XSA9IGFFdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhc1sxMF0gPSBhRXQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY1EoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRjUgPSBbWzEwMCwgMTAwLCAxMDBdLCBbMTQ0LCAwLCAwXSwgWzAsIDEyOCwgMF0sIFswLCAwLCAxNDRdLCBbMTI4LCAxMjgsIDBdLCBbMTI4LCAwLCAxMjhdLCBbMCwgMTI4LCAxMjhdLCBbMTk2LCAxOTYsIDE5Nl0sIFswLCAwLCAwXV07DQogICAgICAgICAgICAgICAgICAgIHZhciBhRjYgPSBbWzQsIDQsIDQsIDIwXSwgWzQsIDAsIDAsIDI3XSwgWzAsIDQsIDAsIDMxXSwgWzAsIDAsIDQsIDI3XSwgWzQsIDQsIDAsIDMxXSwgWzQsIDAsIDQsIDMxXSwgWzAsIDQsIDQsIDMxXSwgWzQsIDQsIDQsIDE0XSwgWzQsIDQsIDQsIDEzXV07DQogICAgICAgICAgICAgICAgICAgIHZhciBhRjc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRjg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRjk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkI7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkggPSAyMDg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkkgPSAyMjQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRkogPSAyNDg7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWkgPSBuZXcgSW50MzJBcnJheSg0KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gdGhpcy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVpWzBdID0gLTQgKiBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVpWzFdID0gNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVpWzJdID0gLWVpWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWlbM10gPSAtZWlbMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRjcgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRjggPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRjkgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkEgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkIgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkMgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkQgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkUgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkYgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRkcgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE3NyA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5jb2xvcnNUeXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnNlbGVjdGFibGVDb2xvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZMKDAsIGFELmp2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGTShhRC5qdiwgYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZNKDAsIGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGTCgwLCBhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUZOKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRk8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUZQKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRlEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGUigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNjcgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gYk4uZkY7DQogICAgICAgICAgICAgICAgICAgICAgICBnWzBdID0gYUY3W3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBnWzFdID0gYUY4W3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBnWzJdID0gYUY5W3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGTShqQywgbVUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gakM7IGFCIDwgbVU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjdbYUJdID0gNCAqIGJLLmRtKDY0ICogYXgucmFuZG9tKCksIGF4LnZhbHVlKDEwMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGOFthQl0gPSA0ICogYksuZG0oNjQgKiBheC5yYW5kb20oKSwgYXgudmFsdWUoMTAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUY5W2FCXSA9IDQgKiBiSy5kbSg2NCAqIGF4LnJhbmRvbSgpLCBheC52YWx1ZSgxMDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRkwoakMsIG1VKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JzRGF0YSA9IGFELmRhdGEuY29sb3JzRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gakM7IGFCIDwgbVU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBjb2xvcnNEYXRhW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjdbYUJdID0gNCAqIChmOCA+PiAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUY4W2FCXSA9IDQgKiAoKGY4ID4+IDYpICYgNjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGOVthQl0gPSA0ICogKGY4ICYgNjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGTigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZWo7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWogPSBiSy5kbShhRjdbYUJdICsgYUY4W2FCXSArIGFGOVthQl0sIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGN1thQl0gKz0gYUZTKGVqIC0gYUY3W2FCXSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUY4W2FCXSArPSBhRlMoZWogLSBhRjhbYUJdLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjlbYUJdICs9IGFGUyhlaiAtIGFGOVthQl0sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGN1thQl0gLT0gYUY3W2FCXSAlIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUY4W2FCXSAtPSBhRjhbYUJdICUgNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjlbYUJdIC09IGFGOVthQl0gJSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGSygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOUUgPSBiZi5hOUU7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFELmVkIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IGE5RVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYksuZG0oKGFGNltmMV1bM10gKyAxKSAqIGF4LnJhbmRvbSgpLCBheC52YWx1ZSgxMDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjdbYUJdID0gYUY1W2YxXVswXSArIGtkICogYUY2W2YxXVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjhbYUJdID0gYUY1W2YxXVsxXSArIGtkICogYUY2W2YxXVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRjlbYUJdID0gYUY1W2YxXVsyXSArIGtkICogYUY2W2YxXVsyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRk8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFELmVkIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGN1thQl0gKz0gYksuZG0oYUIsIDEyOCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUY4W2FCXSArPSBiSy5kbShhQiAlIDEyOCwgMzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGOVthQl0gKz0gYksuZG0oYUIgJSAzMiwgOCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZBW2FCXSA9IGFCICUgODsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRlEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSAzMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZCW2FCXSA9IGFGN1thQl0gPCBmMCA/IChhRjdbYUJdICsgZjApIDogKGFGN1thQl0gLSBmMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZDW2FCXSA9IGFGOFthQl0gPCBmMCA/IChhRjhbYUJdICsgZjApIDogKGFGOFthQl0gLSBmMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZEW2FCXSA9IGFGOVthQl0gPCBmMCA/IChhRjlbYUJdICsgZjApIDogKGFGOVthQl0gLSBmMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZSKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwID0gMjA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IDI1NiAtIGYwIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZFW2FCXSA9IGFGN1thQl0gPiBlID8gKGFGN1thQl0gLSBmMCkgOiAoYUY3W2FCXSArIGYwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRkZbYUJdID0gYUY4W2FCXSA+IGUgPyAoYUY4W2FCXSAtIGYwKSA6IChhRjhbYUJdICsgZjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGR1thQl0gPSBhRjlbYUJdID4gZSA/IChhRjlbYUJdIC0gZjApIDogKGFGOVthQl0gKyBmMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRlAgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzdbYUJdID0gYUY3W2FCXSArIGFGOFthQl0gKyBhRjlbYUJdIDwgMjgwID8gMCA6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLng4ID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiSy5kbShlSywgNCkgJSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDkgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJLLmRtKGVLLCA0ICogYlIuZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy53aSA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKGVwICogYlIuZXIgKyBlbikgKiA0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud3kgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gdGhpcy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5hRlQoZUsgKyBlaVswXSkgfHwgdGhpcy5hRlQoZUsgKyBlaVsxXSkgfHwgdGhpcy5hRlQoZUsgKyBlaVsyXSkgfHwgdGhpcy5hRlQoZUsgKyBlaVszXSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mNSA9IGZ1bmN0aW9uKGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSB0aGlzLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmVsKGVLICsgZWlbMF0pIHx8IHRoaXMuZWwoZUsgKyBlaVsxXSkgfHwgdGhpcy5lbChlSyArIGVpWzJdKSB8fCB0aGlzLmVsKGVLICsgZWlbM10pKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud3cgPSBmdW5jdGlvbihlSywgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSB0aGlzLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmFGVShlSyArIGVpWzBdLCBwbGF5ZXIpIHx8IHRoaXMuYUZVKGVLICsgZWlbMV0sIHBsYXllcikgfHwgdGhpcy5hRlUoZUsgKyBlaVsyXSwgcGxheWVyKSB8fCB0aGlzLmFGVShlSyArIGVpWzNdLCBwbGF5ZXIpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ0YgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDNdID49IGFGSDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDMgPSBmdW5jdGlvbihwbGF5ZXIsIGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nRihlSykgJiYgdGhpcy5hRlYocGxheWVyLCBlSyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFGViA9IGZ1bmN0aW9uKHBsYXllciwgZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIgPT09IHRoaXMuZVkoZUspOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRlcgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDNdID49IGFGSCAmJiBhQVhbZUsgKyAzXSA8IGFGSTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuajggPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDNdID49IGFGSSAmJiBhQVhbZUsgKyAzXSA8IGFGSjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud3ggPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gdGhpcy5laTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMzsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmg4KGVLICsgZWlbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmViID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdGKGVLKSB8fCB0aGlzLmVYKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaDggPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDNdID09PSAwICYmIGFBWFtlSyArIDJdID09PSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lWCA9IGZ1bmN0aW9uKGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUFYW2VLICsgM10gPT09IDAgJiYgYUFYW2VLICsgMl0gPT09IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZuID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQVhbZUsgKyAzXSA9PT0gMCAmJiBhQVhbZUsgKyAyXSA9PT0gMzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWwgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDNdID09PSAwICYmIGFBWFtlSyArIDJdID49IDU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFGVCA9IGZ1bmN0aW9uKGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUFYW2VLICsgM10gPT09IDAgJiYgYUFYW2VLICsgMl0gPj0gMzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZU8gPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFBWFtlSyArIDJdIC0gNTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZVID0gZnVuY3Rpb24oZUssIHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZVgoZUspIHx8IHRoaXMuZ0YoZUspICYmIHBsYXllciAhPT0gdGhpcy5lWShlSyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVZID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxMjggKiAoYUFYW2VLXSAlIDQpICsgMzIgKiAoYUFYW2VLICsgMV0gJSA0KSArIDggKiAoYUFYW2VLICsgMl0gJSA0KSArIGFBWFtlSyArIDNdICUgODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDQgPSBmdW5jdGlvbihlSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUZYKGVLLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZZID0gZnVuY3Rpb24oZUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGWChlSywgMik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRlgoZUssIGFGWikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUFYW2VLXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUsgKyAxXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUsgKyAyXSA9IGFGWjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBWFtlSyArIDNdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGYShlSyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy53aiA9IGZ1bmN0aW9uKGVLLCBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBWFtlS10gPSBhRjdbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBWFtlSyArIDFdID0gYUY4W3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUsgKyAyXSA9IGFGOVtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUFYW2VLICsgM10gPSBhRkggKyBhRkFbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGYShlSyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdBID0gZnVuY3Rpb24oZUssIHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUFYW2VLXSA9IGFGQltwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUFYW2VLICsgMV0gPSBhRkNbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBWFtlSyArIDJdID0gYUZEW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUsgKyAzXSA9IGFGSSArIGFGQVtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUZhKGVLKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuajkgPSBmdW5jdGlvbihlSywgcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUtdID0gYUZFW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBhQVhbZUsgKyAxXSA9IGFGRltwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUFYW2VLICsgMl0gPSBhRkdbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBWFtlSyArIDNdID0gYUZKICsgYUZBW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBhRmEoZUspOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZhKGVLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmEubWMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBhYy54OChlSyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBhYy54OShlSyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYS5tYyA9IGVuID49IGJaLmFBV1swXSAmJiBlbiA8PSBiWi5hQVdbMl0gJiYgZXAgPj0gYlouYUFXWzFdICYmIGVwIDw9IGJaLmFBV1szXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSAyICogMTY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhRmIgPSBuZXcgVWludDE2QXJyYXkoc2l6ZSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFthRC5lUV0gPT09IDAgfHwgYWQuYUZjKGFELmVRKSA9PT0gYWQuZmwoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHo1KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB6NSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgajYsIGlGOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGUxIC0gMjsgYUIgPj0gMDsgYUIgLT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo2ID0gYUZiW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoajYgPCBhRC5lZCAmJiBhZy5sbFtqNl0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlGID0gYUZiW2FCICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGo2ID49IGFELmVkICYmIGFGZChhRC5lUSkgfHwgajYgPCBhRC5lZCAmJiBhRmUoYUQuZVEsIGo2KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oRChpRiwgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiByZW1vdmUoYTREKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBlMSAtPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGE0RDsgYUIgPCBlMTsgYUIgKz0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFGYlthQl0gPSBhRmJbYUIgKyAyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRmJbYUIgKyAxXSA9IGFGYlthQiArIDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaEYgPSBmdW5jdGlvbihqNiwgaUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRmYoajYsIGlGKSB8fCBlMSA9PT0gc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFGYltlMV0gPSBqNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGYltlMSArIDFdID0gaUY7DQogICAgICAgICAgICAgICAgICAgICAgICBlMSArPSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZmKGo2LCBpRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZTE7IGFCICs9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUZiW2FCXSA9PT0gajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZiW2FCICsgMV0gPSBNYXRoLm1pbihhRmJbYUIgKyAxXSArIGlGLCAxMDIzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNSKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRnID0gZnVuY3Rpb24oZ0QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGFnLmdUW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTS55Lm90W2dEXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRmcoZ0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFGaChnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmc3W2dEXS5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFGaChnRCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRmcocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhRmkocGxheWVyLCBhZC5hRmoocGxheWVyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRmsocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGLmczKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhZC5jbGVhcihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUZsKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRm0ocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRm0ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy53ZVtwbGF5ZXJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmc3W3BsYXllcl0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdMW3BsYXllcl0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdNW3BsYXllcl0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmY2W3BsYXllcl0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRmwocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuZzEuYTJSKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSBhZy5naFtwbGF5ZXJdIC0gYWcuYTJWW3BsYXllcl0gKyBhZC5hRm4ocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYy5nNShwbGF5ZXIsIE1hdGguYWJzKGRsKSwgZGwgPCAwID8gMTggOiAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5naFtwbGF5ZXJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmEyVltwbGF5ZXJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFGaCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUZvKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRmsocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFGbChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUZwKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBhRi5nMyhwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuY2xlYXIocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJNLmFGcS5hRnIocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGbyhwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuakoocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLnhVW3BsYXllcl0gPSBiaC56cS5hRnMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC56MysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFGdCA9IGFkLmFGaihwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFGdC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuZzEuYTJPKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZ1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFGaShwbGF5ZXIsIGFGdCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRnYocGxheWVyLCBhRnQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGdSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFYLnNob3coZmFsc2UsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVy5hOWgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJRLnltLnpXKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZpKHBsYXllciwgYUZ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFGdC5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWQuYUZ3KGFGdFthQl0sIHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZ4KGFGdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRnQubGVuZ3RoIC0gMTsgYUIgPj0gMTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nVFthRnRbYUJdXSA+IGFnLmdUW2FGdFtlMV1dKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxID0gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGdihwbGF5ZXIsIGFGdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFGeSA9IGFGdFthRngoYUZ0KV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmYuZWVbcGxheWVyXSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXguam4oOCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF5LmFGeihhRnkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhRS5oS1twbGF5ZXJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE0USg3NjUsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi54VygyODAsIEwoMTM1LCBbYWcueFhbYUZ5XSwgYWcueFhbcGxheWVyXV0pLCA3NjUsIGFGeSwgYkEubWQsIGJBLm50LCAtMSwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmEyTyhwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUZ1KHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4uekQoYUZ5LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFGdC5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmEyUihhRnRbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYy5saFs0IC0gYjkuZzEuakoocGxheWVyKV0rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmEyTyhhRnRbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4uekQocGxheWVyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuakoocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE1UCgwLCBwbGF5ZXIsIGFGeSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUZwKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWcubGxbcGxheWVyXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1twbGF5ZXJdID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdMW3BsYXllcl0gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuZ01bcGxheWVyXSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5mNltwbGF5ZXJdID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRmsocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVUgPSBhZy5pVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpViA9IGFnLmlWOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlXID0gYWcuaVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaVggPSBhZy5pWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQyA9IGlVW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBpV1twbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVyID0gYlIuZXI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1QgPSBhZy5nVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVuID0gaVZbcGxheWVyXTsgZW4gPj0gbUM7IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IGlYW3BsYXllcl07IGVwID49IG1EOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IChlcCAqIGVyICsgZW4pICogNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLngzKHBsYXllciwgZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy54NChnRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnVFtwbGF5ZXJdLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpVltwbGF5ZXJdID0gaVhbcGxheWVyXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpVVtwbGF5ZXJdID0gaVdbcGxheWVyXSA9IE1hdGgubWF4KGVyLCBiUi5lcyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY3QoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMjJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnR5cGUgPSBTWzg3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShTWzk1XSwgIi5wbmcsIC5qcGcsIC5naWYsIC5qcGVnIik7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IGFHMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5wdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRzEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNsaWNrKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRzAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUcyKGUudGFyZ2V0LmZpbGVzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRzIoZmlsZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjUuYUczKGZpbGVzWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFHMyA9IGZ1bmN0aW9uKGFHNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBhRzQubmFtZS5zcGxpdCgiLiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHNSA9IGdbZy5sZW5ndGggLSAxXS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFHNSA9PT0gImdpZiIgfHwgYUc1ID09PSAianBnIiB8fCBhRzUgPT09ICJqcGVnIiB8fCBhRzUgPT09ICJwbmciKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHNiA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUc2Lm9ubG9hZCA9IGFHNzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzYucmVhZEFzRGF0YVVSTChhRzQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUc3KGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZjEub25sb2FkID0gYUc4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZjEuc3JjID0gZS50YXJnZXQucmVzdWx0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHOChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUc5ID0gZS50YXJnZXQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGFHOS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBhRzkuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhkID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYUc5LCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gY2FudmFzLndpZHRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGogPSBjYW52YXMuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBiUi5hR0EgfHwgaiA+IGJSLmFHQSB8fCBpIDwgMTAgfHwgaiA8IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHQiA9ICJJbWFnZSBkaW1lbnNpb25zIG11c3QgYmUgYmV0d2VlbiAxMCBhbmQgIiArIGJSLmFHQSArICIuIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAudVApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAudVAuc2hvd1RvYXN0KGFHQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoYUdCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdC5ydiA9PT0gMjAgJiYgdC5hNDAoKS5hRzgoY2FudmFzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjcigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR0MgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgIT09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hR0MgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUdDID0gbmV3IFVpbnQzMkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyAhPT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnFxKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnFxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGdELCB0YXJnZXQsIGE5czsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhR0MgPSB0aGlzLmFHQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5cCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyVyA9IGFnLmdoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0geXBbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnRCA+PSBhRC5qdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gTWF0aC5tYXgoYksuZG0oYTJXW2dEXSwgNCksIDIwNDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5cyA9IE1hdGgubWF4KGFlLmE5dChnRCksIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUdDW2dEXSArPSBiSy5kbShhOXMgKiB0YXJnZXQsIDEwMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUdDW2dEXSA+IHRhcmdldCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhR0NbZ0RdID0gdGFyZ2V0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTJjID0gZnVuY3Rpb24ocGxheWVyLCBoSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhLID4gdGhpcy5hR0NbcGxheWVyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhLID0gdGhpcy5hR0NbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFHQ1twbGF5ZXJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaEs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFHQ1twbGF5ZXJdIC09IGhLOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhLOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZFMoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUdEID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMjJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnR5cGUgPSBTWzg3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShTWzk1XSwgIi5qc29uIik7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5vbmNoYW5nZSA9IGFHRTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNsaWNrKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFHRiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEzeSA9IGFELmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGEzeSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUdHID0ge307DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwga2V5cy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0ga2V5c1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEzeVtrZXldaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8IGEzeVtrZXldaW5zdGFuY2VvZiBVaW50MTZBcnJheSB8fCBhM3lba2V5XWluc3RhbmNlb2YgVWludDMyQXJyYXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUdHW2tleV0gPSBBcnJheS5mcm9tKGEzeVtrZXldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhR0dba2V5XSA9IGEzeVtrZXldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhR0cubWFwVHlwZSA9PT0gMiAmJiBhR0cuY2FudmFzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUdHLmNhbnZhcyA9IGFHRy5jYW52YXMudG9EYXRhVVJMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHRy5jYW52YXMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUdIKGFHRyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR0goYUdJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUdKID0gSlNPTi5zdHJpbmdpZnkoYUdJLCBudWxsLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhR0sgPSBuZXcgQmxvYihbYUdKXSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImFwcGxpY2F0aW9uL2pzb24iDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7DQogICAgICAgICAgICAgICAgICAgICAgICBhQjcuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYUdLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNy5kb3dubG9hZCA9ICJ0dF9zY2VuYXJpby5qc29uIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFCNy5jbGljaygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHRShlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZXMgPSBlLnRhcmdldC5maWxlczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUdMKGZpbGVzWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR0woYUc0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGFHNC5uYW1lLnNwbGl0KCIuIik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUc1ID0gZ1tnLmxlbmd0aCAtIDFdLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUc1ID09PSAianNvbiIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUc2ID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzYub25sb2FkID0gYUdNOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHNi5yZWFkQXNUZXh0KGFHNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUdNKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFHTihKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdC54KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnkuYUdPWzBdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxOSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUdOKGFHUCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHUSA9IGFELmRhdGEgPSBuZXcgYTNUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJtYXBUeXBlIiwgMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJtYXBQcm9jZWR1cmFsSW5kZXgiLCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAibWFwUmVhbGlzdGljSW5kZXgiLCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAibWFwU2VlZCIsIDAsIDE2MzgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUyhhR1AsIGFHUSwgIm1hcE5hbWUiLCAyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1QoYUdQLCBhR1EsIFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAicGFzc2FibGVXYXRlciIsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAicGFzc2FibGVNb3VudGFpbnMiLCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInBsYXllckNvdW50IiwgMSwgNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImh1bWFuQ291bnQiLCAxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInNlbGVjdGVkUGxheWVyIiwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJnYW1lTW9kZSIsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAicGxheWVyTW9kZSIsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAiYmF0dGxlUm95YWxlTW9kZSIsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAibnVtYmVyVGVhbXMiLCAwLCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImlzWm9tYmllTW9kZSIsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAiaXNDb250ZXN0IiwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJpc1JlcGxheSIsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdVKGFHUCwgYUdRLCAiZWxvIiwgMTYsIDIsIDE2MzgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImNvbG9yc1R5cGUiLCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImNvbG9yc1BlcnNvbmFsaXplZCIsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdVKGFHUCwgYUdRLCAiY29sb3JzRGF0YSIsIDMyLCA1MTIsIDI2MjE0Myk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJzZWxlY3RhYmxlQ29sb3IiLCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHVShhR1AsIGFHUSwgInRlYW1QbGF5ZXJDb3VudCIsIDE2LCA5LCA1MTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAibmV1dHJhbEJvdHMiLCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImJvdERpZmZpY3VsdHlUeXBlIiwgMCwgMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJib3REaWZmaWN1bHR5VmFsdWUiLCAwLCAxNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1UoYUdQLCBhR1EsICJib3REaWZmaWN1bHR5VGVhbSIsIDgsIDksIDE1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHVShhR1AsIGFHUSwgImJvdERpZmZpY3VsdHlEYXRhIiwgOCwgNTEyLCAxNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJzcGF3bmluZ1R5cGUiLCAwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInNwYXduaW5nU2VlZCIsIDAsIDE2MzgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHVShhR1AsIGFHUSwgInNwYXduaW5nRGF0YSIsIDE2LCAxMDI0LCA0MDk1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInNlbGVjdGFibGVTcGF3biIsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAicGxheWVyTmFtZXNUeXBlIiwgMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1YoYUdQLCBhR1EsICJwbGF5ZXJOYW1lc0RhdGEiLCA1MTIsIDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInNlbGVjdGFibGVOYW1lIiwgMCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJhSW5jb21lVHlwZSIsIDAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAiYUluY29tZVZhbHVlIiwgMCwgMjU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHVShhR1AsIGFHUSwgImFJbmNvbWVEYXRhIiwgOCwgNTEyLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAidEluY29tZVR5cGUiLCAwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgInRJbmNvbWVWYWx1ZSIsIDAsIDI1NSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1UoYUdQLCBhR1EsICJ0SW5jb21lRGF0YSIsIDgsIDUxMiwgMjU1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHUihhR1AsIGFHUSwgImlJbmNvbWVUeXBlIiwgMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJpSW5jb21lVmFsdWUiLCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdVKGFHUCwgYUdRLCAiaUluY29tZURhdGEiLCA4LCA1MTIsIDI1NSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1IoYUdQLCBhR1EsICJzUmVzb3VyY2VzVHlwZSIsIDAsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdSKGFHUCwgYUdRLCAic1Jlc291cmNlc1ZhbHVlIiwgMCwgMjA0Nyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhR1UoYUdQLCBhR1EsICJzUmVzb3VyY2VzRGF0YSIsIDE2LCA1MTIsIDIwNDcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHUihhR1AsIGFHUSwgZ0UsIG1pbiwgbWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBhR1BbZ0VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdRW2dFXSA9IChhR1coZjgpICYmIGY4ID49IG1pbiAmJiBmOCA8PSBtYXgpID8gTWF0aC5mbG9vcihmOCkgOiBhR1FbZ0VdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHVyhmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBmOCA9PT0gU1s0Nl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUdTKGFHUCwgYUdRLCBnRSwgbWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSBhR1BbZ0VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdRW2dFXSA9IGFHWChwTikgPyBwTi5zbGljZSgwLCBtYXgpIDogYUdRW2dFXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR1QoYUdQLCBhR1EsIGdFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUdRLm1hcFR5cGUgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSBhR1BbZ0VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhR1gocE4pIHx8IHBOLmxlbmd0aCA8PSAyMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHUS5tYXBUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUc5ID0gbmV3IEltYWdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRzkub25sb2FkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjguYUdZLmFHWihhRzksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHOS5vbmxvYWQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHOSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgICAgICBhRzkuc3JjID0gcE47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUdYKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHBOID09PSBTWzQ0XTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR1UoYUdQLCBhR1EsIGdFLCBhR2EsIHNpemUsIG1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExZCA9IGFHUFtnRV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYTFkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMWUgPSBhR2EgPT09IDggPyBuZXcgVWludDhBcnJheShzaXplKSA6IGFHYSA9PT0gMTYgPyBuZXcgVWludDE2QXJyYXkoc2l6ZSkgOiBuZXcgVWludDMyQXJyYXkoc2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBNYXRoLm1pbihhMWQubGVuZ3RoLCBzaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExZVthQl0gPSBiSy5wRShhMWRbYUJdLCAwLCBtYXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUdRW2dFXSA9IGExZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR1YoYUdQLCBhR1EsIGdFLCBzaXplLCBtYXgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMWQgPSBhR1BbZ0VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGExZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFlID0gbmV3IEFycmF5KHNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gTWF0aC5taW4oYTFkLmxlbmd0aCwgc2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMWVbYUJdID0gYUdYKGExZFthQl0pID8gYTFkW2FCXS5zbGljZSgwLCBtYXgpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhR1FbZ0VdID0gYTFlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNVKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUdiOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUdjOw0KICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGo2Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgaEs7DQogICAgICAgICAgICAgICAgICAgIHZhciBpZDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFHZDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUdiID0gYUQuanYgPCAxNiA/IDEyIDogODsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHYyA9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhR2UoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGo2ID0gbmV3IFVpbnQxNkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhLID0gbmV3IFVpbnQzMkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gbmV3IFVpbnQxNkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHZCA9IG5ldyBVaW50OEFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucEQgPSBmdW5jdGlvbihhNmMsIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHZyA9IHRoaXMuZ2koYTZjLCBhR2YpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZyhhNmMsIGFHZiwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUdoID0gYjkuZzEuZzQoYTZjLCBhR2cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmMuZzUoYTZjLCBhR2cgLSBhR2gsIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHZShwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIgPCBhRC5qdiA/IGFHYiAqIHBsYXllciA6IGFHYiAqIGFELmp2ICsgYUdjICogKHBsYXllciAtIGFELmp2KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzaXplW3BsYXllcl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRncgPSBmdW5jdGlvbihwbGF5ZXIsIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCID0gYUdpKHBsYXllciwgYUdmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiA9PT0gc2l6ZVtwbGF5ZXJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHaiA9IGhLW2FHZShwbGF5ZXIpICsgYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nNihwbGF5ZXIsIGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuajMocGxheWVyLCBhR2osIGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHaShwbGF5ZXIsIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUdlKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA9PT0gMCAmJiBqNltrZCArIGFCXSA9PT0gYUdmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZVtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuakggPSBmdW5jdGlvbihwbGF5ZXIsIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUdlKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA9PT0gMCAmJiBqNltrZCArIGFCXSA9PT0gYUdmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMualogPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIgPCBhRC5qdiA/IHNpemVbcGxheWVyXSA8IGFHYiA6IHNpemVbcGxheWVyXSA8IGFHYzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZmwgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaXplW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZyID0gZnVuY3Rpb24ocGxheWVyLCBhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGo2W2FHZShwbGF5ZXIpICsgYUJdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mbSA9IGZ1bmN0aW9uKHBsYXllciwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZFthR2UocGxheWVyKSArIGFCXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUdrID0gZnVuY3Rpb24ocGxheWVyLCBhR2wpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFHZShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IHNpemVbcGxheWVyXSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRba2QgKyBhQl0gPT09IGFHbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcyA9IGZ1bmN0aW9uKHBsYXllciwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoS1thR2UocGxheWVyKSArIGFCXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2kgPSBmdW5jdGlvbihwbGF5ZXIsIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUdlKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA9PT0gMCAmJiBqNltrZCArIGFCXSA9PT0gYUdmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoS1trZCArIGFCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZuID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhR2UocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmOCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ICs9IGhLW2tkICsgYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR20gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFHZShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBzaXplW3BsYXllcl0gLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkW2tkICsgYUJdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ICs9IGhLW2tkICsgYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZjID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhR2UocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZzgrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdnID0gZnVuY3Rpb24ocGxheWVyLCBhR2YsIGFHaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUdlKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA9PT0gMCAmJiBqNltrZCArIGFCXSA9PT0gYUdmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhLW2tkICsgYUJdID0gYUdqOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ1IgPSBmdW5jdGlvbihwbGF5ZXIsIGFCLCBhR2opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhLW2FHZShwbGF5ZXIpICsgYUJdID0gTWF0aC5tYXgoYUdqLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ1MgPSBmdW5jdGlvbihwbGF5ZXIsIGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhR2RbYUdlKHBsYXllcikgKyBhQl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdCA9IGZ1bmN0aW9uKHBsYXllciwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhR2RbYUdlKHBsYXllcikgKyBhQl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmozID0gZnVuY3Rpb24ocGxheWVyLCBhR2osIGFHZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmEyUihhR2YpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmMubGhbNiAtIGI5LmcxLmpKKHBsYXllcildKys7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhR2UocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gc2l6ZVtwbGF5ZXJdIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGFCXSA9PT0gMCAmJiBqNltrZCArIGFCXSA9PT0gYUdmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhLW2tkICsgYUJdICs9IGFHajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaEtba2QgKyBhQl0gPSBoS1trZCArIGFCXSA+IGFELmEyWSA/IGFELmEyWSA6IGhLW2tkICsgYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgajZba2QgKyBzaXplW3BsYXllcl1dID0gYUdmOw0KICAgICAgICAgICAgICAgICAgICAgICAgaEtba2QgKyBzaXplW3BsYXllcl1dID0gYUdqOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWRba2QgKyBzaXplW3BsYXllcl1dID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHZFtrZCArIHNpemVbcGxheWVyXV0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZVtwbGF5ZXJdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyIDwgYUQuanYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUdmID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTi56RChwbGF5ZXIsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGxheWVyID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZi5hNVIoYUdmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFHbiA9IGZ1bmN0aW9uKHBsYXllciwgYUdqLCBhR2wpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFHZShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgajZba2QgKyBzaXplW3BsYXllcl1dID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhLW2tkICsgc2l6ZVtwbGF5ZXJdXSA9IGFHajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlkW2tkICsgc2l6ZVtwbGF5ZXJdXSA9IGFHbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHZFtrZCArIHNpemVbcGxheWVyXV0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZVtwbGF5ZXJdKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmc2ID0gZnVuY3Rpb24ocGxheWVyLCBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV6LCBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaXplW3BsYXllcl0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBrZCA9IGFHZShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZVtwbGF5ZXJdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gZTE7IGV6IDwgc2l6ZVtwbGF5ZXJdOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajZba2QgKyBlel0gPSBqNltrZCArIGV6ICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEtba2QgKyBlel0gPSBoS1trZCArIGV6ICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRba2QgKyBlel0gPSBpZFtrZCArIGV6ICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUdkW2tkICsgZXpdID0gYUdkW2tkICsgZXogKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZqID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGV6LCBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRnQgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhbC5qdyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IGFHZShhbC5qeFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBzaXplW2FsLmp4W2FCXV0gLSAxOyBleiA+PSAwOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZFtrZCArIGV6XSA9PT0gMCAmJiBqNltrZCArIGV6XSA9PT0gcGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRnQucHVzaChhbC5qeFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUZ0Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY1YoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhR287DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUdvID0gbmV3IFVpbnQxNkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqQyA9IDEwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHb1thQl0gPSBqQyArIGFHcChiSy5kbShhQiAqIDI1NjAwLCBlZyAtIDQpLCA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmlJbmNvbWVUeXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOXQgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFHcShwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuaUluY29tZVR5cGUgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE5dCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksuZG0oYUQuZGF0YS5pSW5jb21lVmFsdWUgKiBhR3EocGxheWVyKSwgNjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTl0ID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiSy5kbShhRC5kYXRhLmlJbmNvbWVEYXRhW3BsYXllcl0gKiBhR3EocGxheWVyKSwgNjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuanMoKSAlIDEwICE9PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUdyKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR3EocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYjkuZzEuakoocGxheWVyKSAmJiBwbGF5ZXIgPCBhRC5qdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gYUdvW2JLLmRtKChhRC5lZCAtIDEpICogYWcuZ1RbcGxheWVyXSwgYUQuamYpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5qcygpIDwgMTkyMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwID0gTWF0aC5tYXgoYksuZG0oMTAwICogKDEzNDQwIC0gNiAqIGJlLmpzKCkpLCAxOTIwKSwgZTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGphID0gYWUuamIocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5naFtwbGF5ZXJdID4gamEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMCAtPSBiSy5kbSgyICogZTAgKiAoYWcuZ2hbcGxheWVyXSAtIGphKSwgamEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KGUwLCAwKSwgNzAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmpiID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oMTAwICogYWcuZ1RbcGxheWVyXSwgYUQuYTNQKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubzggPSBmdW5jdGlvbihwbGF5ZXIsIG85KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5nMS5nNChvOSwgYk4uZkRbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmMub1UocGxheWVyLCBvOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5hR3MocGxheWVyLCBiTi5mRFswXSArIGJOLmZEWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLm9WKG85LCBiTi5mRFswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5nMS5wMyhwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR3QgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlwID0gYWwuang7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEyVyA9IGFnLmdoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgKz0gYTJXW3lwW2FCXV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2Q7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFHdSA9IGZ1bmN0aW9uKGFHdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeXAgPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJXID0gYWcuZ2g7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWUgPSBiZi5lZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0geXBbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZVtnRF0gPT09IGFHdikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCArPSBhMldbZ0RdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrZDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHcigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFHdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUd4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuanMoKSAlIDEwMCAhPT0gOTkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhR3koKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR3coKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhR3ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqeCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdoID0gYWcuZ2g7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGp4W2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUgwID0gYksuZG0oYWUuYTl0KGdEKSAqIGdoW2dEXSwgMTAwMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLmc0KGdELCBNYXRoLm1heChhSDAsIDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFIMSg5KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhR3koKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhR3ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnRJbmNvbWVUeXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUgyKDMyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUQuZGF0YS50SW5jb21lVHlwZSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIMihhRC5kYXRhLnRJbmNvbWVWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIMygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUgxKDgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIMihtTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdUID0gYWcuZ1Q7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIganggPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYWwuancgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ganhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLmc0KGdELCBiSy5kbShtTyAqIGdUW2dEXSwgMzIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSDMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1QgPSBhZy5nVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqeCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gYUQuZGF0YS50SW5jb21lRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYWwuancgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ganhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLmc0KGdELCBiSy5kbShtT1tnRF0gKiBnVFtnRF0sIDMyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUd4KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYUluY29tZVR5cGUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhR3ooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmFJbmNvbWVUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUg0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuYUluY29tZVR5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFIMSgxOCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUg0KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdUID0gYWcuZ1Q7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIganggPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtTyA9IGFELmRhdGEuYUluY29tZVZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhbC5qdyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBqeFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkuZzEuZzQoZ0QsIGJLLmRtKG1PICogZ1RbZ0RdLCAxMjgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSDUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1QgPSBhZy5nVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqeCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gYUQuZGF0YS5hSW5jb21lRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYWwuancgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ganhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLmc0KGdELCBiSy5kbShtT1tnRF0gKiBnVFtnRF0sIDEyOCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFHeigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZiA9IGFELmVROw0KICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkNbMF0gPSBhZy5naFt2Zl0gLSBhZy5hMlZbdmZdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIMShlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZmID0gYUQuZVE7DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5saFtlMV0gKz0gYWcuZ2hbdmZdIC0gYWcuYTJWW3ZmXSAtIGJOLmZDWzBdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNYKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUg2LCBhSDc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSDgsIGFIOTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFIQSwgYUhCOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhDOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhEOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhFOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhGOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhHOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhIOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhJOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhKOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhLLCBhSEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSE07DQogICAgICAgICAgICAgICAgICAgIHZhciBhSE47DQogICAgICAgICAgICAgICAgICAgIHZhciBhSE8gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhQOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhROw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUIwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhSLCBhSFM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSFQgPSAwLjE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSFUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhWID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSFcgPSBuZXcgRmxvYXQzMkFycmF5KDQpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUhYID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFIWSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSFo7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSGE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhOTMgPSA0MDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSGIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSGIgPSBiaS5lRC5kYXRhWzddLnZhbHVlIHx8IGFELmtDID09PSA4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYTkzID0gYmkuZUQuZGF0YVsxMV0udmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhOTMgPSBhOTMgPT09IDAgPyAyODAgOiBhOTMgPT09IDEgPyAxODcgOiAxMTI7DQogICAgICAgICAgICAgICAgICAgICAgICBhSE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFISiA9IDAuODg7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEcgPSAwLjU7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEggPSAxLjg7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEkgPSAxMiAtIDMgKiBiaS5lRC5kYXRhWzldLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUg2ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFINyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhSDggPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUg5ID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIQSA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEIgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhDID0gbmV3IEZsb2F0MzJBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEQgPSBuZXcgRmxvYXQzMkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIUSA9IG5ldyBVaW50MTZBcnJheSgyICogYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUIwID0gbmV3IFVpbnQ4QXJyYXkoNSAqIGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIWiA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIYSA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUhZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhPID0gYUhPID8gYUhPIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEsgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhMID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFITSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhjKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhkKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIYygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUhlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFHcyA9IGZ1bmN0aW9uKGdELCBhNWgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNWggPiAxOCAqIGFnLmdUW2dEXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIYVtnRF0gPSA2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmE3N1tnRF0gPSAyICsgKGFjLmE3N1tnRF0gJSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhaW2dEXSA9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmE3N1tnRF0gPCAyIHx8IGFjLmE3N1tnRF0gPiAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmE3N1tnRF0gPSA2ICsgKGFjLmE3N1tnRF0gJSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9WID0gZnVuY3Rpb24oZ0QsIGE1aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1aCA+IDYgKiBhZy5nVFtnRF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSGFbZ0RdID0gNjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy5hNzdbZ0RdID0gNCArIChhYy5hNzdbZ0RdICUgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIWltnRF0gPSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5hNzdbZ0RdIDwgNCB8fCBhYy5hNzdbZ0RdID4gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy5hNzdbZ0RdID0gOCArIChhYy5hNzdbZ0RdICUgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUhmKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUhPLndpZHRoID0gaC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhPLmhlaWdodCA9IGguajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIUCA9IGFITy5nZXRDb250ZXh0KCIyZCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYUhQLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZShhSFAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhQLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUhnKGFIUCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBwaygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIRSA9IE1hdGguZmxvb3IoMSAqIGgucGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhGID0gTWF0aC5mbG9vcigwLjUgKiBhSEUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIYygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgYUhoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGI5LnBnLnJWKDEsIDEwMCAqIGFIRyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSGggPSA4MCAvIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoYjkuemQueUooYUQuYTJZKSkud2lkdGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGI5LnBnLnJWKDEsIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhEW2FCXSA9IDEwMCAvIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoYWcueFhbYUJdKS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhDW2FCXSA9IE1hdGgubWluKGFIaCwgYUhEW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUhkKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBhSGg7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5mb250ID0gYjkucGcuclYoMSwgMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIaCA9IDEwMCAvIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoIjkwMCAwMDAiKS53aWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhDW2FCXSA9IE1hdGgubWluKGFIaCwgMiAqIGFIRFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUhYID0gYUhoOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhXWzBdID0gMTAwIC8gKGFIaCAqIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoIjUgMDAwIDAwMCIpLndpZHRoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSFdbMV0gPSAxMDAgLyAoYUhoICogTWF0aC5mbG9vcih0by5tZWFzdXJlVGV4dCgiNTAgMDAwIDAwMCIpLndpZHRoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSFdbMl0gPSAxMDAgLyAoYUhoICogTWF0aC5mbG9vcih0by5tZWFzdXJlVGV4dCgiNTAwIDAwMCAwMDAiKS53aWR0aCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhXWzNdID0gMTAwIC8gKGFIaCAqIE1hdGguZmxvb3IodG8ubWVhc3VyZVRleHQoIjEgMDAwIDAwMCAwMDAiKS53aWR0aCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIaShhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2TiA9IGFnLmdoW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2TiA8IDEwMDAwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2TiA8IDEwMDAwMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFIV1swXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSFdbTWF0aC5taW4oTWF0aC5mbG9vcihNYXRoLmxvZzEwKHZOKSkgLSA2LCAzKV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUhlKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmVkIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nVFthQl0gPCAxMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDhbYUJdID0gYWcuaVVbYUJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUg5W2FCXSA9IGFnLmlXW2FCXSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQVthQl0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSEJbYUJdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDhbYUJdID0gYWcuaVVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDlbYUJdID0gYWcuaVdbYUJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhBW2FCXSA9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQlthQl0gPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGFELmp2OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQVthQl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFIUiA9IGFiLmdldCg0KS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIUyA9IGFiLmdldCg0KS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM0wgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBhRC5qdjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5pVlthQl0gLSBhZy5pVVthQl0gIT09IDMgfHwgYWcuaVhbYUJdIC0gYWcuaVdbYUJdICE9PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIOFthQl0gPSBhZy5pVVthQl0gKyAoYWcuaVZbYUJdICE9PSBhZy5pVVthQl0gPyAxIDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIOVthQl0gPSBhZy5pV1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQVthQl0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSEJbYUJdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDhbYUJdID0gYWcuaVVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDlbYUJdID0gYWcuaVdbYUJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhBW2FCXSA9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQlthQl0gPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucEYgPSBmdW5jdGlvbihwbGF5ZXIsIGUxLCBhSGopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIayhwbGF5ZXIsIGUxLCBhSGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sWCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIayhwbGF5ZXIsIGUxLCBhSGopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoVCA9IHBsYXllciArIGUxICogYUQuZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhRW2hUXSA9PT0gYUhqICYmIGFCMFtoVF0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCMFtoVF0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIUVtoVF0gPSBhSGo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIwW2hUXSA9IGFqLnF3LnlBKGFIaikgPyAyNTUgOiA2NDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQjBbaFRdID0gNjQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhRW2hUXSA9IGFIajsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIwW2hUXSA9IGFIajsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhnKHRvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFITikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSE0gIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybShhSE0sIDAsIDAsIGFITSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGFITywgLWFISyAvIGFITSwgLWFITCAvIGFITSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYUhPLCAtYUhLLCAtYUhMKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTdyID0gZnVuY3Rpb24oaTEsIGk0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEsgKz0gaTE7DQogICAgICAgICAgICAgICAgICAgICAgICBhSEwgKz0gaTQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwVyA9IGZ1bmN0aW9uKGkxLCBpNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTdyKGkxLCBpNCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpvb20gPSBmdW5jdGlvbihhMVEsIGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUhNICo9IGExUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFISyA9IChhSEsgKyBreSkgKiBhMVEgLSBreTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFITCA9IChhSEwgKyBreikgKiBhMVEgLSBrejsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFIbCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSE0gIT09IDEgfHwgYUhLICE9PSAwIHx8IGFITCAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhOTM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuYTNvKCkgfHwgYUQuaDEgfHwgYUQuejEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhOTM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWCA9IGZ1bmN0aW9uKGJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSFYgJiYgIWJyICYmIGJlLmVGIDwgYUhVICsgYUhsKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhSFYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFIVSA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhnKGFIUCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUhtID0gZnVuY3Rpb24oYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhSGkoYUIpICogYUhDW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUhuID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUhDW3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSGcoaGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFITiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUhNID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFISyA9IGFITCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFIWSkge30gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKGhkLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUoaGQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1DID0gaUcgLyBpSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtRCA9IGlJIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbVAgPSAoaC5pICsgaUcpIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbVEgPSAoaC5qICsgaUkpIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUhvLCBhSHA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGFIcTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSHI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUhzID0gYWcubGxbYUQuZVFdICE9PSAwICYmICFiOS5nMS5qSihhRC5lUSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IGFsLmp3IC0gMTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCID0gYWwuanhbZXpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplID0gTWF0aC5mbG9vcihhSEogKiBpSCAqIGFIaShhQikgKiBhSENbYUJdICogYUhBW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvbnRTaXplIDwgYUhJIHx8IGZvbnRTaXplID49IGFIRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoYUg4W2FCXSArIGFIQVthQl0gPiBtQyAmJiBhSDhbYUJdIDwgbVAgJiYgYUg5W2FCXSArIGFIQlthQl0gPiBtRCAmJiBhSDlbYUJdIDwgbVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSG8gPSBNYXRoLmZsb29yKGguaSAqIChhSDhbYUJdICsgYUhBW2FCXSAvIDIgLSBtQykgLyAobVAgLSBtQykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIcCA9IE1hdGguZmxvb3IoaC5qICogKGFIOVthQl0gKyBhSEJbYUJdIC8gMiAtIG1EKSAvIChtUSAtIG1EKSAtIDAuMSAqIGZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSHEgPSBhYy5hNzdbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLmZvbnQgPSBiOS5wZy5yVihhZy5hMk5bYUJdID09PSAxID8gNCA6IDEsIGZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsU3R5bGUgPSBhSHQoZm9udFNpemUsIGFIcSAlIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh1KGhkLCBhQiwgZm9udFNpemUsIGFIbywgYUhwLCBhSHEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIdihhQiwgZm9udFNpemUsIGFIbywgYUhwLCBoZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFITiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCMFthQl0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIdyhhSG8sIGFIcCwgZm9udFNpemUsIGFCLCBoZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqZ1thQl0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh4KGFIbywgYUhwLCBmb250U2l6ZSwgMCwgMCwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhzICYmIChhQjBbYUIgKyBhRC5lZF0gPiAwIHx8IGFCMFthQiArIDIgKiBhRC5lZF0gPiAwIHx8IGFCMFthQiArIDMgKiBhRC5lZF0gPiAwIHx8IGFCMFthQiArIDQgKiBhRC5lZF0gPiAwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSHkoYUhvLCBhSHAsIGZvbnRTaXplLCBhQiwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSHIgPSBhSEcgKiBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUhyIDwgYUhJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5mb250ID0gYjkucGcuclYoMSwgYUhyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSHAgKz0gTWF0aC5mbG9vcigwLjc4ICogZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh2KGFCLCBhSHIsIGFIbywgYUhwLCBoZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh1KGhkLCBhQiwgYUhyLCBhSG8sIGFIcCwgYUhxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUh2KGFCLCBmb250U2l6ZSwgZW4sIGVwLCBoZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZmlsbFRleHQoYWcueFhbYUJdLCBlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCIDwgYUQuanYgJiYgYWcuYTJOW2FCXSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSHogPSBmb250U2l6ZSAvIGFIRFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsUmVjdChlbiAtIDAuNSAqIGFIeiwgZXAgKyBiOS5wZy55NSAqIGZvbnRTaXplLCBhSHosIE1hdGgubWF4KDEsIDAuMSAqIGZvbnRTaXplKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUh1KGhkLCBhQiwgZm9udFNpemUsIGFIbywgYUhwLCBhSHEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSTAgPSBiOS56ZC55SihhZy5naFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChhSHEgPj4gMSkgJiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQubGluZVdpZHRoID0gMC4wNSAqIGZvbnRTaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnN0cm9rZVN0eWxlID0gYUh0KGZvbnRTaXplLCBhSHEgJSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5zdHJva2VUZXh0KGFJMCwgYUhvLCBhSHApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSHEgPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQubGluZVdpZHRoID0gMC4xMiAqIGZvbnRTaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnN0cm9rZVN0eWxlID0gYUh0KGZvbnRTaXplLCBhSHEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnN0cm9rZVRleHQoYUkwLCBhSG8sIGFIcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsVGV4dChhSTAsIGFIbywgYUhwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSHgoYUhvLCBhSHAsIGZvbnRTaXplLCBhSTEsIGFJMiwgaGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNGogPSAwLjk1ICogZm9udFNpemUgLyBhSFM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0MgPSBhSG8gLSAwLjUgKiBhNGogKiBhSFIgKyAwLjggKiBhSTEgKiBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3RCA9IGFIcCAtIDEuNzYgKiBhNGogKiBhSFMgLSAoMC43ICsgKDAuMzUgLSBiOS5wZy55NSkpICogYUkyICogZm9udFNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oYTRqLCAwLCAwLCBhNGosIHdDLCB3RCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5nbG9iYWxBbHBoYSA9IGFJMyhmb250U2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYWIuZ2V0KDQpLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSHkoYUhvLCBhSHAsIGZvbnRTaXplLCBhQiwgaGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMSA9IDQ7IGYxID49IDE7IGYxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIwW2FCICsgZjEgKiBhRC5lZF0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMSA9IDE7IGYxIDwgNTsgZjErKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQjBbYUIgKyBmMSAqIGFELmVkXSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUk0KGFIbywgYUhwLCBmb250U2l6ZSwgZjEsIGFCLCBnOCwgYUIwW2FCICsgZjEgKiBhRC5lZF0sIGhkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZzggLT0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUh3KGFIbywgYUhwLCBmb250U2l6ZSwgYUIsIGhkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoamdbYUJdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFqLnF3LnlBKGFIUVthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJNShhSG8sIGFIcCwgZm9udFNpemUsIGFCLCBhSFFbYUJdLCBoZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIeChhSG8sIGFIcCwgZm9udFNpemUsIDAsIDAsIGhkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFqLnF3LnlDKGFIUVthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJNihhSG8sIGFIcCwgZm9udFNpemUsIGFIUVthQl0sIDAsIGhkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh4KGFIbywgYUhwLCBmb250U2l6ZSwgMCwgMSwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJNihhSG8sIGFIcCwgZm9udFNpemUsIGFIUVthQl0sIDEsIGhkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUh4KGFIbywgYUhwLCBmb250U2l6ZSwgMSwgMCwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUk2KGFIbywgYUhwLCBmb250U2l6ZSwgYUhRW2FCXSwgMCwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJNihhSG8sIGFIcCwgZm9udFNpemUsIG9KLCBhSTEsIGhkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTRqOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZ2xvYmFsQWxwaGEgPSBhSTMoZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFqLnF3LnlCKG9KKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhYID0gYWoudmUueGU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTRqID0gMS4xICogZm9udFNpemUgLyBoWDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3QyA9IGFIbyAtIDAuNSAqIGE0aiAqIGhYIC0gMC44ICogYUkxICogZm9udFNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0QgPSBhSHAgLSAxLjU1ICogYTRqICogaFg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuc2V0VHJhbnNmb3JtKGE0aiwgMCwgMCwgYTRqLCB3Qywgd0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLmRyYXdJbWFnZShhai52ZS54ZFtvSiAtIDEwMjQgKyBhai5xdy54cF0sIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0MgPSBhSG8gLSAwLjggKiBhSTEgKiBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3RCA9IGFIcCAtICgxICsgKDAuMzUgLSBiOS5wZy55NSkpICogZm9udFNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuZmlsbFRleHQoYWoucXcueTQob0opLCB3Qywgd0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZ2xvYmFsQWxwaGEgPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJNChhSG8sIGFIcCwgZm9udFNpemUsIGYxLCBhQiwgYUkxLCBkbCwgaGQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMXI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb0ogPSBhSFFbYUIgKyBhRC5lZF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFqLnF3LnlCKG9KKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMXIgPSBhai52ZS54ZFtvSiAtIDEwMjQgKyBhai5xdy54cF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUk3KGFIbywgYUhwLCBmb250U2l6ZSwgb0osIGFJMSwgaGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExciA9IGFMLmE0QigpWzRdLmNhbnZhc1srKGRsIDwgMjU1KV07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYxID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFyID0gYUwuYTRCKClbNV0uY2FudmFzWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMXIgPSBhTC5hNEIoKVs2XS5jYW52YXNbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFggPSBhai52ZS54ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNGogPSAwLjggKiBmb250U2l6ZSAvIGhYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDID0gYUhvIC0gMC41ICogYTRqICogaFggLSAwLjUzNCAqIGFJMSAqIGZvbnRTaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdEID0gYUhwICsgMS40ICogYTRqICogaFg7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oYTRqLCAwLCAwLCBhNGosIHdDLCB3RCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5nbG9iYWxBbHBoYSA9IGFJMyhmb250U2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYTFyLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSTcoYUhvLCBhSHAsIGZvbnRTaXplLCBvSiwgYUkxLCBoZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZ2xvYmFsQWxwaGEgPSBhSTMoZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDID0gYUhvIC0gMC41MzQgKiBhSTEgKiBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3RCA9IGFIcCArIDEuNTkgKiBmb250U2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmZvbnQgPSBiOS5wZy5yVigwLCAwLjc4NSAqIGZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmZpbGxUZXh0KGFqLnF3Lnk0KG9KKSwgd0MsIHdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSTUoYUhvLCBhSHAsIGZvbnRTaXplLCBwbGF5ZXIsIG9KLCBoZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdEID0gYUhwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZ2xvYmFsQWxwaGEgPSBhSTMoZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhjID0gYUhpKHBsYXllcikgKiAoYUhiID8gYUhYIDogYUhEW3BsYXllcl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdDID0gYUhvIC0gMC41ICogZm9udFNpemUgLyBoYyAtIDAuOSAqIGZvbnRTaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZjAgPSAwOyBmMCA8IDI7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsVGV4dChhai5xdy55NChvSiksIHdDLCB3RCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd0MgPSBhSG8gKyAwLjUgKiBmb250U2l6ZSAvIGhjICsgMC45ICogZm9udFNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5nbG9iYWxBbHBoYSA9IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUh0KGZvbnRTaXplLCBhSHEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb250U2l6ZSA+PSBhSEYgJiYgZm9udFNpemUgPCBhSEUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmYuYUk4W2FIcV0gKyAoYUkzKGZvbnRTaXplKSkudG9GaXhlZCgzKSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiZi5hSTlbYUhxXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSTMoZm9udFNpemUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb250U2l6ZSA+PSBhSEYgJiYgZm9udFNpemUgPCBhSEUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMSAtIChmb250U2l6ZSAtIGFIRikgLyAoYUhFIC0gYUhGKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5qcygpICUgMTAgPT09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSFYgPSBhRC5hM3EoKSAmJiAhYUQuYTNvKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmEzbygpICYmICsrYUg3ID49IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSUEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGguZmxvb3IoYUhUICogYWwuancpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWcgPSBlZyA8IDggPyA4IDogZWc7DQogICAgICAgICAgICAgICAgICAgICAgICBlZyA9IGVnID4gYWwuancgPyBhbC5qdyA6IGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFINiArIGVnIC0gMTsgYUIgPj0gYUg2OyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXogPSBhQiAlIGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJQihhbC5qeFtlel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUg2ICs9IGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUg2ICU9IGFsLmp3Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sUyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBnRCwgaGwsIGhtOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSA0ICE9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gYWwuanhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5hNzdbZ0RdIDwgMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGwgPSBNYXRoLm1heChhSFpbZ0RdIC0gMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaG0gPSBNYXRoLm1heChhSGFbZ0RdIC0gMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhsID09PSBobSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGwgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmE3N1tnRF0gJT0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaG0gPT09IDAgJiYgYWMuYTc3W2dEXSA8IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWMuYTc3W2dEXSArPSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSFpbZ0RdID0gaGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhhW2dEXSA9IGhtOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNVIgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiA9IHBsYXllciArIDIgKiBhRC5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IGFCMFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4uejgoNTAsIHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIwW2FCXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRsID09PSAyNTU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0VCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFCMFtwbGF5ZXIgKyAyICogYUQuZWRdID09PSAyNTU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSUEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGV6LCBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFINyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYwID0gNDsgZjAgPj0gMTsgZjAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBhbC5qdyAtIDE7IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIgPSBhbC5qeFtlel0gKyBmMCAqIGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIwW2FCXSA+IDAgJiYgYUIwW2FCXSA8IDI1NSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUIwW2FCXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IGFsLmp3IC0gMTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCID0gYWwuanhbZXpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQjBbYUJdID4gMCAmJiBhQjBbYUJdIDwgMjU1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCMFthQl0tLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlCKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGMgPSBhSGkoYUIpICogYUhDW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSEFbYUJdID4gMCAmJiBhSUMoYUIsIGFIOFthQl0sIGFIOVthQl0sIGFIQVthQl0sIGFIQlthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSUQoYUIpICYmIGFJRShhQiwgaGMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJRihhQik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhSUcoYUIsIGhjKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJRihhQik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJSChhQiwgaGMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJSShoYywgaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDEgKyBNYXRoLmZsb29yKGFISCAqIGhjICogaSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlEKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXAsIGksIGo7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBmMCA9IDA7IGYwIDwgODsgZjArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBhSEFbYUJdICsgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqID0gYUhCW2FCXSArIDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBhZy5pVlthQl0gLSBhZy5pVVthQl0gKyAxIHx8IGogPiBhZy5pWFthQl0gLSBhZy5pV1thQl0gKyAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSBhSDhbYUJdIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcCA9IGFIOVthQl0gLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSUMoYUIsIGVuLCBlcCwgaSwgaikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUg4W2FCXSA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDlbYUJdID0gZXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQVthQl0gPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSEJbYUJdID0gajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZUsgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZUs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlFKGFCLCBoYykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwLCBpLCBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOSA9IGFIQVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbU8gPSAxICsgTWF0aC5mbG9vcigwLjAyICogYUI5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gMTsgZjAgPCA1OyBmMCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGFCOSArIGYwICogbU87DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBhZy5pVlthQl0gLSBhZy5pVVthQl0gKyAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGFJSShoYywgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPiBhZy5pWFthQl0gLSBhZy5pV1thQl0gKyAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSBhZy5pVVthQl0gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoYWcuaVZbYUJdIC0gYWcuaVVbYUJdICsgMiAtIGkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcCA9IGFnLmlXW2FCXSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChhZy5pWFthQl0gLSBhZy5pV1thQl0gKyAyIC0gaikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSUMoYUIsIGVuLCBlcCwgaSwgaikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUg4W2FCXSA9IGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDlbYUJdID0gZXA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQVthQl0gPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSEJbYUJdID0gajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZUsgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlSzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSUcoYUIsIGhjKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBhSDhbYUJdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFIOVthQl0gKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBhSEFbYUJdIC0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhBW2FCXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqID0gYUlJKGhjLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUlDKGFCLCBlbiwgZXAsIGksIGopKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIOFthQl0gPSBlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUg5W2FCXSA9IGVwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSEFbYUJdID0gaTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhCW2FCXSA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAtPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJSChhQiwgaGMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXAsIGksIGosIGYwLCBtVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqQyA9IGFnLmlWW2FCXSAtIGFnLmlVW2FCXSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUlKID0gTWF0aC5mbG9vcigwLjAyICogakMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUlKID0gYUlKIDwgMSA/IDEgOiBhSUo7DQogICAgICAgICAgICAgICAgICAgICAgICBtVSA9IC02ICogYUlKOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IGpDOyBmMCA+PSBtVTsgZjAgLT0gYUlKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGYwID4gMCA/IGYwIDogMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqID0gYUlJKGhjLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbiA9IGFnLmlVW2FCXSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChhZy5pVlthQl0gLSBhZy5pVVthQl0gKyAyIC0gaSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gYWcuaVdbYUJdICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGFnLmlYW2FCXSAtIGFnLmlXW2FCXSArIDIgLSBqKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFJQyhhQiwgZW4sIGVwLCBpLCBqKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDhbYUJdID0gZW47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIOVthQl0gPSBlcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUhBW2FCXSA9IGk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIQlthQl0gPSBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJRihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBhSDhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IGFIOFthQl0gLSBhZy5pVVthQl0gLSAxOyBleiA+PSAwOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdC0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUlLKGFCLCBsZWZ0LCBhSDlbYUJdLCBhSEJbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByaWdodCA9IGFIOFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gYWcuaVZbYUJdIC0gYUg4W2FCXSAtIGFIQVthQl07IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUlLKGFCLCByaWdodCArIGFIQVthQl0gLSAxLCBhSDlbYUJdLCBhSEJbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodC0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBNYXRoLmZsb29yKChsZWZ0ICsgcmlnaHQpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gYUg5W2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSBhSDlbYUJdIC0gYWcuaVdbYUJdIC0gMTsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcC0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUlMKGFCLCBlbiwgdG9wLCBhSEFbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3ArKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvdHRvbSA9IGFIOVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gYWcuaVhbYUJdIC0gYUg5W2FCXSAtIGFIQlthQl07IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3R0b20rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFJTChhQiwgZW4sIGJvdHRvbSArIGFIQlthQl0gLSAxLCBhSEFbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3R0b20tLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gTWF0aC5mbG9vcigodG9wICsgYm90dG9tKSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFJQyhhQiwgZW4sIGVwLCBhSEFbYUJdLCBhSEJbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFIOFthQl0gPSBlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSDlbYUJdID0gZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlDKHBsYXllciwgZW4sIGVwLCBpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSBNYXRoLmZsb29yKDAuMiAqIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWogPSBlaiA8IDEgPyAxIDogZWo7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYxID0gZW4gKyBpIC0gMTsgZjEgPj0gZW47IGYxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFJSyhwbGF5ZXIsIGYxLCBlcCwgaikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVqID0gTWF0aC5mbG9vcigwLjI1ICogaik7DQogICAgICAgICAgICAgICAgICAgICAgICBlaiA9IGVqIDwgMSA/IDEgOiBlajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSBlcCArIGogLSAxIC0gZWo7IGYxID49IGVwICsgZWo7IGYxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFJTChwbGF5ZXIsIGVuLCBmMSwgaSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJSyhwbGF5ZXIsIGVuLCBlcCwgaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhYy54MyhwbGF5ZXIsIChlcCAqIGJSLmVyICsgZW4pICogNCkgJiYgYWMueDMocGxheWVyLCAoKGVwICsgaiAtIDEpICogYlIuZXIgKyBlbikgKiA0KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlMKHBsYXllciwgZW4sIGVwLCBpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGFjLngzKHBsYXllciwgKGVwICogYlIuZXIgKyBlbikgKiA0KSAmJiBhYy54MyhwbGF5ZXIsIChlcCAqIGJSLmVyICsgZW4gKyBpIC0gMSkgKiA0KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY1ooKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSU07DQogICAgICAgICAgICAgICAgICAgIHZhciBhSU47DQogICAgICAgICAgICAgICAgICAgIHZhciBhSU87DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFJTSA9ICJBYmJhc2lkIENhbGlwaGF0ZTtBY2VoIHM7QWNoYWVtZW5pZCBaO0Fmc2hhcmlkIHo7QWdobGFiaWQgRW1pcmF0ZTtBaG9tIHo7QWtrYWRpYW4gWjtBa3N1bWl0ZSBaO0Frd2FtdTtBbGFvdWl0ZSB6O0FsbW9oYWQgQ2FsaXBoYXRlO0FsbW9yYXZpZCB6O0FuZ2V2aW4gWjtBcSBRb3l1bmx1O0FybWVuaWFuIFo7QXNzeXJpYTtBc2hhbnRpIFo7QXVzdHJpYW4gWjtBdXN0cmlhLUh1bmdhcnk7QXl5dWJpZCB6O0F6dGVjIFo7QXVsaWthcmEgWjtCYWJ5bG9uaWFuIFo7QmFsaGFlO0JhbnRlbiBzO1MgQmFuamFyO0JhbWFuYSBaO0JlbmdhbCBzO0JlbmluIFo7S2FkYW1iYSB6O0Jvcm51IFo7RSBCcmF6aWw7QnJpdGFubmljIFo7QnJpdGlzaCBaO0JyaXRpc2ggUmFqO0JydW5laWFuIFo7QnVraGFyYSBaO0J1cmd1bmRpYW4gU3RhdGU7QnV5aWQgejtCeXphbnRpbmUgWjtDYWxpcGhhdGUgb2YgQ8OzcmRvYmE7Q2FvIFdlaTtDYXJ0aGFnaW5pYW4gWjtDZWJ1IFJhamFobmF0ZTtDaGFnYXRhaSBLaGFuYXRlO0NoYWx1a3lhIHo7Q2hhdWhhbiB6O0NoYXbDrW4gWjtDaGVubGE7Q2hlcmEgejtDaG9sYSB6O0NvbWFuY2hlIFo7Q29uZ28gRnJlZSBTdGF0ZTtDcmltZWFuIEtoYW5hdGU7RGFjaWFuIFo7RGVsaGkgcztEZW1hayBzO0R1cnJhbmkgWjtEdXRjaCBaO0VneXB0aWFuIFo7RWxhbWl0ZSBaO0V4YXJjaGF0ZSBvZiBBZnJpY2E7QWJ5c3NpbmlhO0ZhdGltaWQgQ2FsaXBoYXRlO0ZpcnN0IEZyZW5jaCBaO0ZyYW5raXNoIFo7RnVuYW47R2FsbGljIFo7R2F6YSBaO1JlcHVibGljIG9mIEdlbm9hO0dlcm1hbiBaO0doYW5hIFo7R2hhem5hdmlkIHo7R2h1cmlkIHo7R29ndXJ5ZW87R29yeWVvO0dvcmtoYSBaO0fDtmt0w7xyayBLaGFnYW5hdGU7R29sZGVuIEhvcmRlO1MgR293YTtTZWxqdXEgWjtHdXB0YSBaO0hhZnNpZCBZO0hhbiB6O0hhbnNlYXRpYyBMZWFndWU7RSBIYXJzaGE7SGVwaHRoYWxpdGUgWjtIaXR0aXRlIFo7SG9seSBSb21hbiBaO0hvdGFrIHo7SG95c2FsYSBaO0h1bm5pYyBaO0h1c2FpbmlkIHo7SWRyaXNpZCB6O0lsa2hhbmF0ZTtLIElzcmFlbDtLIEp1ZGFoO0luY2EgWjtJdGFsaWFuIFo7RSBKYXBhbjtKaW4gejtKb2hvciBaO0pvbG9mIFo7Sm9zZW9uO0thYWJ1IFo7S2FjaGFyaSBZO0thbG1hciBVbmlvbjtLYW5lbSBaO0thbnZhIHo7S2FyYS1LaGFuaWQgS2hhbmF0ZTtLYXpha2ggS2hhbmF0ZTtLaGF6YXIgS2hhZ2FuYXRlO0tobWVyIFo7S2hpbGppIHo7S2h3YXJhem1pYW4gejtLaWV2YW4gUnVzJztLb25iYXVuZyB6O0tvbmcgWjtLb3JlYW4gWjtLdXNoYW4gWjtLIEt1c2g7TGFrb3RhO0xhdGluIFo7TGF0ZXIgTMOqIHo7TGlhbyB6O0xvZGkgcztLaG1lciBaO01hY2Vkb25pYW4gWjtNYWphcGFoaXQgWjtNYWxpIFo7TWFsYWNjYSBaO01hbWx1ayBzO01hbmNodWt1bztNYXJhdGhhIFo7TWFyaW5pZCB6O01hc3NpbmEgWjtNYXRhcmFtIHM7TWF1cmV0YW5pYTtNYXVyeWFuIFo7TWVkaWFuIFo7TWxlY2hjaGhhIHo7TWluZyB6O01pdGFubmkgWjtNb25nb2wgWjtNdWdoYWwgWjtOYW5kYSBaO05ndXnhu4VuIHo7Tm9ydGggU2VhIFo7RSBOaWNhZWE7TnVtaWRpYTtPbWFuaSBaO090dG9tYW4gWjtPeW8gWjtQYWdhbiBaO1BhaGxhdmkgejtQYWxhIFo7UGFsbXlyZW5lIFo7UGFydGhpYW4gWjtQb250aWMgWjtQb3J0dWd1ZXNlIFo7SyBQcnVzc2lhO1B0b2xlbWFpYyBaO1FhamFyIHo7UWFyYSBRb3l1bmx1O1FpbiB6O1FpbmcgejtSYW1uYWQgU2V0aHVwYXRoaXM7UmFzaGlkdW4gQ2FsaXBoYXRlO1Jhc2h0cmFrdXRhIHo7Um9tYW4gWjtSb3VyYW4gS2hhZ2FuYXRlO1JvendpIFo7UnVzdGFtaWQgejtSdXNzaWFuIFo7VHNhcmRvbSBvZiBSdXNzaWE7U2FhZGkgejtTYWZhdmlkIHo7U2FmZmFyaWQgejtTYXNzYW5pZCB6O1NhdGF2YWhhbmEgejtTYW1hbmlkIFo7U292aWV0IFVuaW9uO1NhdWRlbGV1ciB6O0R1Y2h5IG9mIFNhdm95O1NlbGV1Y2lkIFo7U2VyYmlhbiBaO1NodSBIYW47U2hhbmcgejtTaWFtIFo7U2lraCBaO1NpbmdoYXNhcmk7U29rb3RvIENhbGlwaGF0ZTtTb25nIHo7U29uZ2hhaSBaO1NwYW5pc2ggWjtTcml2aWpheWEgWjtTdWkgejtLIE15c29yZTtTaHVuZ2EgWjtTIFN1bHU7U3VtZXI7U3VyIFo7U3dlZGlzaCBaO1RhaGlyaWQgejtUYW5nIHo7VMOieSBTxqFuIHo7UyBUZXJuYXRlO0UgVGhlc3NhbG9uaWNhO0dlcm1hbiBSZWljaDtUaWJldGFuIFo7VG9uZG8gejtTIFRpZG9yZTtUaW11cmlkIFo7SyBUbGVtY2VuO0UgVHJlYml6b25kO1RvbHRlYyBaO1RvdW5nb28gejtUb3Vjb3VsZXVyIFo7VHUnaSBUb25nYSBaO1R1cmdlc2ggS2hhZ2FuYXRlO1VtYXl5YWQgQ2FsaXBoYXRlO1V5dW5pZCBFbWlyYXRlO1V5Z2h1ciBLaGFnYW5hdGU7VXpiZWsgS2hhbmF0ZTtWYW5kYWwgWTtWaWpheWFuYWdhcmEgWjtSZXB1YmxpYyBvZiBWZW5pY2U7V2FyaSBaO1dhc3NvdWxvdSBaO1dhdHRhc2lkcztXZXN0ZXJuIFJvbWFuIFo7RWFzdGVybiBXdTtXZXN0ZXJuIFhpYSB6O1hpbiB6O1l1YW4gejtaYW5kIHo7WmhvdSB6O1p1bHUgWjtZdWdvc2xhdmlhO0tvc292bztTaWtraW07S2FuZW3igJNCb3JudSBaO1dhZGFpIFo7RXRoaW9waWFuIFo7Um96dmkgWjtTYXNhbmlhbiBaO0UgVmlldG5hbTtTaGlsbHVrIFk7SyBBa3N1bTtHd2lyaWtvIFk7VG9ybyBZO01hbGluZGkgWTtLIExvYW5nbztLIE1hcHVuZ3Vid2U7Unl1a3l1IFk7SyBDeXBydXM7SyBKZXJ1c2FsZW07R2FyaHdhbCBZO0sgTmVwYWw7SyBDYW1ib2RpYTtDaGFtcGEgWTtIYW50aGF3YWRkeSBZO1BoYXlhbyBZO0sgU2FyZGluaWE7SyBTaWNpbHk7SyBHd3luZWRkO0sgU2NvdGxhbmQ7SyBEZXNtb25kO0sgUG9sYW5kO0sgSHVuZ2FyeTtLIENyb2F0aWE7SyBCb2hlbWlhO0FsYmFuaWFuIFk7SyBHZW9yZ2lhO0sgUG9ydHVnYWw7S2hhbmF0ZSBvZiBTaWJpcjtLIFJvbWFuaWE7Q29zc2FjayBIZXRtYW5hdGU7RHVjaHkgb2YgQm91aWxsb247SyBJcmVsYW5kO0xvcmRzaGlwIG9mIElyZWxhbmQ7SyBJdGFseTtSZXB1YmxpYyBvZiBQaXNhO0lkcmlzaWQgejtBbG1vcmF2aWQgejtBbG1vaGFkIENhbGlwaGF0ZTtNYXJpbmlkIHo7V2F0dGFzaWQgejtTYWFkaWFuIHo7UmVwdWJsaWMgb2YgU2Fsw6k7UmlmIFJlcHVibGljO0sgS3VzaDtNYWt1cmlhO0Fsb2RpYTtBeXl1YmlkIHo7TWFtbHVrIHM7RWd5cHQgRXlhbGV0O0sgRmF6dWdobGk7UyBTZW5uYXI7UyBEYXJmdXI7TWFoZGlzdCBTdGF0ZTtTIEVneXB0O0sgRWd5cHQ7RW1pcmF0ZSBvZiBDeXJlbmFpY2E7SyBMaWJ5YTtSZXB1YmxpYyBvZiBFZ3lwdDtSZXB1YmxpYyBvZiB0aGUgU3VkYW47VW5pdGVkIEFyYWIgUmVwdWJsaWM7TGlieWFuIEFyYWIgUmVwdWJsaWM7WmlyaWQgejtIYWZzaWQgejtLIEt1a3U7UmVnZW5jeSBvZiBBbGdpZXJzO0d1cnVuc2k7TGlwdGFrbztUZW5rb2RvZ287V29nb2RvZ287WWF0ZW5nYTtCaWxhbmdhO0JpbGF5YW5nYTtCb25nYW5kaW5pO0NvbjtNYWNha29hbGk7UGllbGE7TnVuZ3U7SyBTaW5lO0sgU2Fsb3VtO0sgQmFvbDtLIENheW9yO0sgV2FhbG87QnVuZHU7Qm9ub21hbjtHeWFhbWFuO0Rlbmt5aXJhO01hbmtlc3NpbSBZO0sgRGFob21leTtPeW8gWjtLIE5yaTtBcm8gQ29uZmVkZXJhY3k7S3dhcmFyYWZhO0JpYWZyYTtCdWdhbmRhO0J1bnlvcm87QW5rb2xlO0J1c29nYTtUYW5nYW55aWthO0t1YmEgWTtLIEx1YmE7SyBMdW5kYTtZZWtlIFk7SyBOZG9uZ287S2FzYW5qZSBZO0sgTWF0YW1iYTtNYnVuZGEgWTtDaG9rd2UgWTtLYXplbWJlIFk7SyBCdXR1YTtOZGViZWxlIFk7TXRoZXRod2EgWjtCb3BodXRoYXRzd2FuYTtDaXNrZWk7VHJhbnNrZWk7VmVuZGE7UmhvZGVzaWE7S2FydCB6O05vZ2FpIEhvcmRlO0toYW5hdGUgb2YgQnVraGFyYTtLaGFuYXRlIG9mIEtoaXZhO0toYW1hZyBNb25nb2w7Tm9ydGhlcm4gRnVqaXdhcmE7S2FtYWt1cmEgU2hvZ3VuYXRlO0FzaGlrYWdhIFNob2d1bmF0ZTtKYXhhO1JlcHVibGljIG9mIEV6bztKaWFuZ3hpIFNvdmlldDtIdW5hbiBTb3ZpZXQ7R3Vhbmd6aG91IENvbW11bmU7R29qb3Nlb247QWxhaXllO0JleWxpayBvZiBCYWZyYTtLYXJhIEtveXVubHU7S2FycyBSZXB1YmxpYztLIElyYXE7QXJhYiBGZWRlcmF0aW9uO0thci1LaXlhIHo7QmFkdXNwYW5pZHM7TWFyYXNoaXlhbiB6O0FmcmFzaXlhYiB6O01paHJhYmFuaWQgejtTYWZhdmlkIElyYW47U2hlaWtoZG9tIG9mIEt1d2FpdDtCYW5pIEtoYWxpZCBFbWlyYXRlO0VtaXJhdGUgb2YgRGlyaXlhaDtFbWlyYXRlIG9mIE5hamQ7TXVzY2F0IGFuZCBPbWFuO0VtaXJhdGUgb2YgUml5YWRoO1MgTmFqZDtLIEhlamF6O0ZhZGhsaSBzO0VtaXJhdGUgb2YgQmVpaGFuO0VtaXJhdGUgb2YgRGhhbGE7UyBMYWhlajtSZXB1YmxpYyBvZiBLdXdhaXQ7SyBDb2NoaW47SmFmZm5hIFk7TGF1ciBZO1BhbmR5YSB6O0phdW5wdXIgcztKYWludGlhIFk7SHlkZXJhYmFkIFN0YXRlO1RyYXZhbmNvcmU7VWRhaXB1ciBTdGF0ZTtNYW5pa3lhIHo7TGFuIFhhbmc7SyBWaWVudGlhbmU7SyBDaGFtcGFzYWs7TGFvIElzc2FyYTtLIExhb3M7UHl1IFN0YXRlcztBdmE7TW9uIFlzO1BlZ3U7SyBNcmF1ayBVO1RhdW5nb28gejtTaGFuIFN0YXRlcztBcmFrYW47UmFrdGFtYXJpdGlrYTtTaW5naGFuYXZhdGk7RHZhcmF2YXRpO05nb2VueWFuZztIYXJpcGh1bmNoYWk7VGFtYnJhbGluZ2E7TGF2byBZO0xhbmdrYXN1a2E7U3VraG90aGFpIFk7UyBTaW5nb3JhO0F5dXR0aGF5YSBZO1Rob25idXJpIFk7TGFuIE5hO1BhdHRhbmkgWTtKYW1iaSBzO1BhbGVtYmFuZyBzO1MgRGVsaTtTIExhbmdrYXQ7UyBTZXJkYW5nO1MgQ2lyZWJvbjtLIFBhamFuZztLIEJhbGk7QmltYSBzO0sgTGFyYW50dWthO0sgQmFuZ2dhaTtMdXd1O1MgQm9uZTtDYXVjYXNpYW4gQWxiYW5pYTtLYWJhcmRpYTtDaXJjYXNzaWE7SyBBYmtoYXppYTtFbGlzdSBzO0F2YXIgS2hhbmF0ZTtDYXVjYXNpYW4gSW1hbWF0ZTtLIEltZXJldGk7SyBLYXJ0bGk7SyBLYWtoZXRpO0Nyb3duIG9mIEFyYWdvbjtFbWlyYXRlIG9mIEdyYW5hZGE7SyBNYWpvcmNhO0Nyb3duIG9mIENhc3RpbGU7SyBIYWl0aTtDb2NvbGzDoW47WmFwb3RlYyBDaXZpbGl6YXRpb247TW9zcXVpdG8gWTtTb21vemEgUmVnaW1lO0lyb3F1b2lzIENvbmZlZGVyYWN5O0NoZXJva2VlIE5hdGlvbjtWZXJtb250IFJlcHVibGljO1N0YXRlIG9mIE11c2tvZ2VlO0sgQWxvO0sgU2lnYXZlO0sgRmlqaTtLIE5hdXJ1O0sgQ2hpbGU7TXVpc2NhIENvbmZlZGVyYXRpb247RWwgU3Ryb25hdG87SyBDaGltb3I7SnVuZ2xlIFJlcHVibGljO0xpZ2EgRmVkZXJhbDtTdXByZW1lIEp1bnRhO1dlaW1hciBSZXB1YmxpYztLIEJhdmFyaWE7QnJlbWVuO0ZyYW5rZnVydDtIYW1idXJnO0sgSGFub3ZlcjtIb2xzdGVpbjtMaXBwZTtOYXNzYXU7T2xkZW5idXJnO1BvbWVyYW5pYTtSZXVzcztTYXhlLUFsdGVuYnVyZztTYXhvbnk7U2NobGVzd2lnO1dhbGRlY2s7V8O8cnR0ZW1iZXJnO0hlbHZldGljIFJlcHVibGljO1JlcHVibGljIG9mIEZsb3JlbmNlO0R1Y2h5IG9mIFVyYmlubztSZXB1YmxpYyBvZiBDb3NwYWlhO0R1Y2h5IG9mIEx1Y2NhO0R1Y2h5IG9mIE1hbnR1YTtEdWNoeSBvZiBNaWxhbjtQYXBhbCBTdGF0ZXMiLnNwbGl0KCI7Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBhSU4gPSAiQ29ycnVwdGVkIEVhcnRoO1JldHVybmluZyBOYXR1cmU7QWJhbmRvbmVkIEFyZWFzO1Jlc3RyaWN0ZWQgQXJlYTtDb250YW1pbmF0ZWQgQXJlYTtCdXJuaW5nIExhbmQ7QmFycmVuIExhbmQ7UmF2ZW5sYW5kO0RlYWRsYW5kO0Rhbmdlcm91cyBBcmVhO0RldmFzdGF0ZWQgTGFuZDtTd2FtcGxhbmQ7UGx1bmRlcmVkIExhbmQ7T3ZlcnJ1biBBcmVhO1VuZGVhZCBNYXNzZXM7Um9hbWluZyBIb3JkZTtMdXJraW5nIEhvcmRlO0ZhbGxlbiBUZXJyaXRvcnk7R2hvc3RsYW5kO0Rvb21zdHJ1Y2sgTGFuZDtJbmZlY3RlZCBFbmNsYXZlO1BsYWd1ZWQgTmF0aW9uO0ZvcmJpZGRlbiBab25lO1RveGljIEdyb3VuZDtTY29yY2hlZCBFYXJ0aDtSdWluZWQgQ2l0eTtDdXJzZWQgTGFuZDtEaXNlYXNlZCBDb2xvbnk7Rm9yc2FrZW4gRmllbGRzO1pvbWJpZSBPdmVybG9yZCIuc3BsaXQoIjsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFJTyA9ICJQcm90ZWN0ZWQgWm9uZTtRdWFyYW50aW5lIFpvbmU7TGFzdCBCYXN0aW9uO0J1ZmZlciBab25lO0xpYmVyYXRlZCBBcmVhO1Jlc2lzdGFuY2UgWm9uZTtSaXNpbmcgVGVycml0b3J5O1JlY292ZXJlZCBSZWdpb247UmViZWwgU2VjdG9yO0VtZXJnaW5nIExhbmRzO1NhZmV0eSBDb3JyaWRvcjtJc29sYXRpb24gQXJlYTtGaW5hbCBTdHJvbmdob2xkO0d1YXJkZWQgU2VjdG9yIi5zcGxpdCgiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1aiA9IFsiSyAiLCAiIFkiLCAiRSAiLCAiIFoiLCAiIHoiLCAiIHMiLCAiUyAiXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSVAgPSBbIktpbmdkb20gb2YgIiwgIiBLaW5nZG9tIiwgIkVtcGlyZSBvZiAiLCAiIEVtcGlyZSIsICIgRHluYXN0eSIsICIgU3VsdGFuYXRlIiwgIlN1bHRhbmF0ZSBvZiAiXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUlNLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBleiA9IGE1ai5sZW5ndGggLSAxOyBleiA+PSAwOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJTVthQl0gPSBhSU1bYUJdLnJlcGxhY2UoYTVqW2V6XSwgYUlQW2V6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM2EgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFJUSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUlSKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEucGxheWVyTmFtZXNUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUlTKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEucGxheWVyTmFtZXNUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUlUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUlVKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSVEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhRC5qdjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4WCA9IGFnLnhYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpmID0gYWcuemY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyTmFtZXNEYXRhID0gYUQuZGF0YS5wbGF5ZXJOYW1lc0RhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsYXllck5hbWVzRGF0YSB8fCBwbGF5ZXJOYW1lc0RhdGEubGVuZ3RoIDwgZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeFhbYUJdID0gemZbYUJdID0gU1s1NF0gKyBheC5qRCgxMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4WFthQl0gPSB6ZlthQl0gPSBwbGF5ZXJOYW1lc0RhdGFbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJUigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMCA9IGF4LnJhbmRvbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFJViA9IGFJTzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSVcgPSBhSU47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaEsgPSBhRS5oSzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFJVi5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudFs3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4WCA9IGFnLnhYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpmID0gYWcuemY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGtkIC0gMTsgYUIgPj0gYUQuanY7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4WFthQl0gPSB6ZlthQl0gPSBhSVZbKGFCICsgZTApICUgZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWcgPSBhSVcubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBrZDsgYUIgPCBhRC5lZDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhYW2FCXSA9IHpmW2FCXSA9IGFJV1toS1thQl0gPyBlZyA6IChhQiAlIGVnKV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlTKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQuZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeFggPSBhZy54WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6ZiA9IGFnLnpmOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllck5hbWVzRGF0YSA9IGFELmRhdGEucGxheWVyTmFtZXNEYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhRC5qdjsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhYW2FCXSA9IHpmW2FCXSA9IHBsYXllck5hbWVzRGF0YVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlUKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhYID0gYWcueFg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgemYgPSBhZy56ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuanY7IGFCIDwgYUQuZWQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4WFthQl0gPSB6ZlthQl0gPSBTWzEwNF0gKyBheC5qRCgxMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSVUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUlYID0gYUlNOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUlYLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMCA9IGF4LnJhbmRvbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhYID0gYWcueFg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgemYgPSBhZy56ZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuanY7IGFCIDwgYUQuZWQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4WFthQl0gPSB6ZlthQl0gPSBhSVhbKGFCICsgZTApICUgZWddOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNzKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJWSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJWiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFJWSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSVogPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFJWS5sZW5ndGggPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUlhKHRoaXMuYUlZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFJWi5sZW5ndGggPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUlhKHRoaXMuYUlaKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUlhID0gZnVuY3Rpb24oZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZy5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0uZUYtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1thQl0uZUYgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMCA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZjA7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNoaWZ0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0SiA9IGZ1bmN0aW9uKGlkLCB5cCwgYUliKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mMih0aGlzLmFJWSwgaWQsIHlwLCBhSWIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSWMgPSBmdW5jdGlvbihpZCwgeXAsIGFJYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZjIodGhpcy5hSVosIGlkLCB5cCwgYUliKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZjIgPSBmdW5jdGlvbihnLCBpZCwgeXAsIGFJYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFJZChnLCBpZCwgeXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFJYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJZShnLCBpZCwgeXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSWQoZywgaWQsIHlwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGhUOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IHlwLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGhUID0gZy5sZW5ndGggLSAxOyBoVCA+PSAwOyBoVC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnW2hUXS5wbGF5ZXIgPT09IHlwW2FCXSAmJiBpZCA9PT0gZ1toVF0uaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJZShnLCBpZCwgeXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB5cC5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyOiB5cFthQl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZUY6IDM4NA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNZKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpmID0gbmV3IEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54WCA9IG5ldyBBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTJOID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxsID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlVID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pVyA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaVYgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlYID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nVCA9IG5ldyBVaW50MzJBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMud2UgPSBuZXcgVWludDMyQXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdoID0gbmV3IFVpbnQzMkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nNyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ0wgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdNID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mNiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucDIgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLml5ID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5peiA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueFUgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpZID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyViA9IG5ldyBVaW50MTZBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuemYuZmlsbCgiIik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnhYLmZpbGwoIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hMk4uZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGwuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVUuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVcuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVYuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVguZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ1QuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2UuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2guZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZzcgPSBuZXcgQXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nTCA9IG5ldyBBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdNID0gbmV3IEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZjYgPSBuZXcgQXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wMi5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5peS5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pei5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54VS5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56WS5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hMlYuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNxKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCVCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUcubGsocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELnozKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5hMk5bcGxheWVyXSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy54VVtwbGF5ZXJdID0gYmguenEuYUZzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYLnNob3coZmFsc2UsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVy5hOWgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUS55bS56VygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTVSKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjUygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qeCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuancgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qdyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQuZWQgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2FCXSAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmp3Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qeCA9IG5ldyBVaW50MTZBcnJheSh0aGlzLmp3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBhRC5lZDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFthQl0gIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qeFtlZysrXSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFJZigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSWcoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUlnID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGwgPSBhZy5sbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrYyA9IHRoaXMuang7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFOID0gdGhpcy5qdzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUFOIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsbFtrY1thQl1dID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtjW2FCXSA9IGtjWy0tYUFOXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmp3ID0gYUFOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUlmKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdUID0gYWcuZ1Q7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2UgPSBhZy53ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6WSA9IGFnLnpZOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp4ID0gYWwuang7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGp4W2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1RbZ0RdIDw9IGJLLmRtKHdlW2dEXSwgNCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWsuZGcoZ0QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ1RbZ0RdID49IHdlW2dEXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSBnVFtnRF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlW2dEXSA9IGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwgPj0gMjUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6WVtnRF0gPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2VbZ0RdIC09IE1hdGgubWF4KDEsIGJLLmRtKHdlW2dEXSAtIGdUW2dEXSwgMTAwMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgYTBWOw0KICAgICAgICAgICAgICAgIHZhciB0bzsNCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFJaDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5rTCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMua0sgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSWggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rQyAhPT0gOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUlpKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJaSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFJaiA9IFs2MCwgODAsIDEwNSwgMTUwLCAxOTAsIDMzM107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtMID0gWzAsIDAsIDAsIDAsIDAsIDBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rSyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuanYgPD0gYUlqWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rSyA9IDI1NiAtIGJLLmRtKDI1NiAqIGFELmp2LCBhSWpbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5qdiA8PSAyMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtMWzVdID0gYksuZG0oTWF0aC5tYXgoYUQuanYgLSA2LCAwKSwgNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rTFs1XSA9IDMgKyBiSy5kbSgzOCAqIChhRC5qdiAtIDIyKSwgMTAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rTFswXSA9IGFELmVkIC0gYUQuanYgLSB0aGlzLmtLIC0gdGhpcy5rTFs1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rTFs1XSA9IE1hdGgubWluKDE3ICsgYksuZG0oNjEgKiAoYUQuanYgLSA2MCksIDEwMCksIDE3OSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rTFswXSA9IDUxMiAtIGFELmp2IC0gdGhpcy5rTFs1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmtHID0gYUQuZWQgLSBhRC5qdjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEubnVtYmVyVGVhbXMgPSAoYUQuanYgPiAwKSArIChhRC5rRyA+IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5wbGF5ZXJDb3VudCA9IGFELndBID0gYUQuanYgKyBhRC5rRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEudGVhbVBsYXllckNvdW50ID0gbmV3IFVpbnQxNkFycmF5KFswLCAwLCAwLCAwLCAwLCAwLCAwLCBhRC5qdiArIHRoaXMua0ssIGFELmtHIC0gdGhpcy5rS10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNVLmEzWSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRnogPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFJaC5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXI6IHBsYXllciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnODogKDE0ICsgYXguakQoMjApKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgIT09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhSWsoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJaygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUloLmxlbmd0aCAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoLS1hSWhbYUJdLmc4IDw9IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWYucEYoYUloW2FCXS5wbGF5ZXIsIDAsIGFqLnF3LnhzICsgYWoucXcueTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSWguc3BsaWNlKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZDcoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUlsID0gMjI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUdBID0gNDA5NjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lciA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZXMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZiID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52WCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudlkgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZjID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lTSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWFwU2VlZCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudlogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52YSA9IG5ldyBhSW0oKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52UiA9IG5ldyBhSW4oKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNXAgPSBuZXcgYUlvKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlIuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTcgPSBmdW5jdGlvbihtYXAsIGFJcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZTOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWFwID0gbWFwICUgdGhpcy5hSWw7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwID09PSB0aGlzLmVNICYmICghYUlxKHRoaXMuZU0pIHx8IGFJcCA9PT0gdGhpcy5tYXBTZWVkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmEuYUlyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBheC5hM1oobWFwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZU0gPSBtYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcFNlZWQgPSBhSXA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUlxKG1hcCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUi52Ui52U1ttYXBdLmFJcyA9IGFJcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5hQngodGhpcy5lTSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2UyA9IGJSLnZSLnZTW3RoaXMuZU1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lciA9IHZTLmk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVzID0gdlMuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF4LmEzWih2Uy5hSXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXAuYTcoW3RoaXMuZXIsIHRoaXMuZXMsIHZTLmxxLCB2Uy5sbl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUl1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhby5hSXYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFwLmFJdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSXggPSBmdW5jdGlvbihtYXAsIGFJcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZOID0gYUl5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE3KG1hcCwgYUlwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmEuYUlyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZlAgPSBhSXkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXIgPSBmTi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXMgPSBmTi5lczsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmIgPSBmTi52YjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlggPSBmTi52WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlkgPSBmTi52WTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmMgPSBmTi52YzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZU0gPSBmTi5lTTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFwU2VlZCA9IGZOLm1hcFNlZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZlA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzdSA9IGZ1bmN0aW9uKGNhbnZhcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjYW52YXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YiA9PT0gY2FudmFzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lciA9IGNhbnZhcy53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXMgPSBjYW52YXMuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YiA9IGNhbnZhczsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlggPSB0aGlzLnZiLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhID0gdGhpcy52WC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5lciwgdGhpcy5lcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZjID0gdGhpcy5oYS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lTSA9IHRoaXMuYUl6KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcFNlZWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudlIudlNbdGhpcy5lTV0ubmFtZSA9IGFELmRhdGEubWFwTmFtZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJeSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXI6IGJSLmVyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVzOiBiUi5lcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YjogYlIudmIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdlg6IGJSLnZYLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZZOiBiUi52WSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YzogYlIudmMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZU06IGJSLmVNLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcFNlZWQ6IGJSLm1hcFNlZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lTCA9IGZ1bmN0aW9uKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUIgPT09IDMgfHwgYUIgPT09IDcgfHwgYUIgPT09IDkgfHwgYUIgPT09IDIxIHx8IGFCID09PSB0aGlzLmFJeigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjAgPSBmdW5jdGlvbihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFCID09PSAyIHx8IGFCID09PSA3IHx8IGFCID09PSA5IHx8IGFCID09PSAyMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUoxID0gZnVuY3Rpb24oYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhQiA9PT0gMTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUl6ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hSWw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCeCA9IGZ1bmN0aW9uKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52Ui52U1thQl0uYUoyID09PSB1bmRlZmluZWQ7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSXEoYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKGFCID09PSAxIHx8ICFiUi5hQngoYUIpIHx8IGFCID09PSBiUi5hSXooKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM3QgPSBmdW5jdGlvbihwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBZLm1hcFR5cGUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcFkubWFwUHJvY2VkdXJhbEluZGV4IDwgMTAgPyBwWS5tYXBQcm9jZWR1cmFsSW5kZXggOiAoMTAgKyBwWS5tYXBQcm9jZWR1cmFsSW5kZXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwWS5tYXBUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBZLm1hcFJlYWxpc3RpY0luZGV4ICsgMTA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCeSA9IGZ1bmN0aW9uKHBZLCBhSjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwWS5tYXBUeXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFkubWFwUHJvY2VkdXJhbEluZGV4ID0gYUozIDwgMTAgPyBhSjMgOiAoYUozIC0gMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwWS5tYXBUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFkubWFwUmVhbGlzdGljSW5kZXggPSBhSjMgLSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJbSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hODMgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMDMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFKNCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUo1ID0gODsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjYgPSAzMjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjcgPSA4Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFKOCA9IDMyOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFKOSA9IFswLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzcgPSBbMCwgMCwgMCwgMF07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaVAgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFKQSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpCID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUlyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hODMgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuYTgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTgzID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlQID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFwLmFJdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFhLmEwOSgpID09PSA3IHx8IHRoaXMuYUpCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSkEgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hMDMgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjQgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjkgPSBbYlIudlIudlNbYlIuZU1dLnZ1WzBdLCBiUi52Ui52U1tiUi5lTV0udnZbMF1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNzcgPSBbYlIudlIudlNbYlIuZU1dLmFKMlszXSwgYlIudlIudlNbYlIuZU1dLmFKMls0XSwgYlIudlIudlNbYlIuZU1dLmFKMls1XSwgYlIudlIudlNbYlIuZU1dLmFKMls2XV07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKNSA9IGJSLnZSLnZTW2JSLmVNXS5hSjJbN107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKNiA9IGJSLnZSLnZTW2JSLmVNXS5hSjJbOF07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKNyA9IGJSLnZSLnZTW2JSLmVNXS5hSjJbOV07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKOCA9IGJSLnZSLnZTW2JSLmVNXS5hSjJbMTBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYUpBKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hODMgPSBzZXRUaW1lb3V0KGFKQywgMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSkMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52YS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gOCAmJiBhSC5tMygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hODMgPSBzZXRUaW1lb3V0KGFKQywgMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmEwMyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSXMgPSBheC5hSkQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBheC5hM1ooYlIudlIudlNbYlIuZU1dLmFKMlsyXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXAuYTcoW2JSLmVyLCBiUi5lcywgYlIudlIudlNbYlIuZU1dLmFKMlswXSwgYlIudlIudlNbYlIuZU1dLmFKMlsxXV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF4LmEzWihhSXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVAgPSBhcC5hSkUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEwMysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFKQSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4MyA9IHNldFRpbWVvdXQoYUpDLCAxNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9ICF0aGlzLmFKQSA/IDEwMDAwMDAgOiAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSAoYlIuZXMgLSB0aGlzLmFKNCAtIDEpIDwgaiA/IChiUi5lcyAtIHRoaXMuYUo0IC0gMSkgOiBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdyID0gdGhpcy5hSjQgKyBqOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdELCBlUzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVwID0gdGhpcy5hSjQ7IGVwIDwgd3I7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlbiA9IDE7IGVuIDwgYlIuZXIgLSAxOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVTID0gZW4gKyBlcCAqIGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IDQgKiBlUzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGg4KGdEKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSkYoZ0QsIGVTLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUpGKGdELCBlUywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod3goZW4sIGVwLCBnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKRyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSjQgPSB3cjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFKNCA+PSBiUi5lcyAtIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5wdXRJbWFnZURhdGEoYlIudlksIDAsIDAsIDEsIDEsIGJSLmVyIC0gMiwgYlIuZXMgLSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFKQSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4MyA9IHNldFRpbWVvdXQoYUpDLCAxNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSkYgPSBmdW5jdGlvbihnRCwgZVMsIGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpIID0gTWF0aC5mbG9vcih0aGlzLmFKOVtlMV0gKyB0aGlzLmE3N1tlMV0gKiB0aGlzLmlQW2VTXSAvIDEwMDAwKSAtIGJSLnZjW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKSShnRCwgYUpIKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpKID0gZnVuY3Rpb24oZ0QsIGUwLCBhSkssIGUxLCBhNzcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSkggPSBNYXRoLmZsb29yKHRoaXMuYUo5W2UxXSArICgxIC0gZTAgLyBhSkspICogYTc3KSAtIGJSLnZjW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKSShnRCwgYUpIKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFKSShnRCwgYUpIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUpIID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZjW2dEXSArPSBhSkg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIudmNbZ0QgKyAxXSArPSBhSkg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIudmNbZ0QgKyAyXSArPSBhSkg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSkcgPSBmdW5jdGlvbihreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCwgZTAsIGFKSzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN3QgPSBreSAtIHRoaXMuYUo2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKTCA9IGt6IC0gdGhpcy5hSjY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd3MgPSBreSArIHRoaXMuYUo2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdyID0ga3ogKyB0aGlzLmFKNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE3dCA9IGE3dCA8IDEgPyAxIDogYTd0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUpMID0gYUpMIDwgMSA/IDEgOiBhSkw7DQogICAgICAgICAgICAgICAgICAgICAgICB3cyA9IHdzID4gYlIuZXIgLSAyID8gYlIuZXIgLSAyIDogd3M7DQogICAgICAgICAgICAgICAgICAgICAgICB3ciA9IHdyID4gYlIuZXMgLSAyID8gYlIuZXMgLSAyIDogd3I7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IGFKTDsgZXAgPD0gd3I7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlbiA9IGE3dDsgZW4gPD0gd3M7IGVuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSA0ICogKGVuICsgZXAgKiBiUi5lcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoOChnRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKSyA9IHRoaXMuYUo1ICsgKHRoaXMuYUo2IC0gdGhpcy5hSjUpICogdGhpcy5pUFtlbiArIGJSLmVyICogZXBdIC8gMTAwMDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoa3kgLSBlbikgPiBhSksgfHwgTWF0aC5hYnMoa3ogLSBlcCkgPiBhSkspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwID0gTWF0aC5zcXJ0KChreSAtIGVuKSAqIChreSAtIGVuKSArIChreiAtIGVwKSAqIChreiAtIGVwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTAgPj0gYUpLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKSihnRCwgZTAsIGFKSywgMSwgdGhpcy5hNzdbM10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUpLID0gdGhpcy5hSjcgKyAodGhpcy5hSjggLSB0aGlzLmFKNykgKiB0aGlzLmlQW2VuICsgYlIuZXIgKiBlcF0gLyAxMDAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhreSAtIGVuKSA+IGFKSyB8fCBNYXRoLmFicyhreiAtIGVwKSA+IGFKSykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTAgPSBNYXRoLnNxcnQoKGt5IC0gZW4pICogKGt5IC0gZW4pICsgKGt6IC0gZXApICogKGt6IC0gZXApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMCA+PSBhSkspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUpKKGdELCBlMCwgYUpLLCAwLCB0aGlzLmE3N1syXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBoOChnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJSLnZjW2dEICsgMl0gPiBiUi52Y1tnRF0gJiYgYlIudmNbZ0QgKyAyXSA+IGJSLnZjW2dEICsgMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd3goZW4sIGVwLCBnRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChlbiA+IDEgJiYgaDgoZ0QgLSA0KSkgfHwgKGVuIDwgYlIuZXIgLSAyICYmIGg4KGdEICsgNCkpIHx8IChlcCA+IDEgJiYgaDgoZ0QgLSA0ICogYlIuZXIpKSB8fCAoZXAgPCBiUi5lcyAtIDIgJiYgaDgoZ0QgKyA0ICogYlIuZXIpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSXUoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChiUi5lTSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpNKFsyNTZdLCBbMjU2XSwgWzAsIDIwNSwgMjU2XSwgWzUwMCwgNTAwLCAwXSwgWzAsIDAsIDBdKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiUi5lTSA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpNKFs1MTJdLCBbNTEyXSwgWzAsIDM4MCwgNTEyXSwgWzUwMCwgNTAwLCAwXSwgWzAsIDAsIDBdKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiUi5lTSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpNKFs0MTBdLCBbNDEwXSwgWzAsIDEyMCwgMjEwXSwgWzAsIDgwLCA2NDBdLCBbMCwgMCwgMF0pOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJSLmVNID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSk0oWzUxMl0sIFs1MTJdLCBbMCwgNzAsIDE4MCwgMjAwLCAyOTAsIDQyMCwgNTEyXSwgWzUwMCwgNTAwLCAwLCAwLCA1MDAsIDUwMCwgMF0sIFswLCAwLCAwLCAwLCAwLCAwLCAwXSk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlIuZU0gPT09IDIwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSk0oWzUxMl0sIFs1MTJdLCBbMCwgMzgwLCA1MTJdLCBbNTAwLCA1MDAsIDBdLCBbMCwgMCwgMF0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFKTShhSk4sIGFKTywgYUpQLCBhSlEsIGFKUikgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGVuLCBlcDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGkwID0gYUpOLmxlbmd0aCAtIDE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSlMgPSBiUi5lciArIGJSLmVzOw0KICAgICAgICAgICAgICAgICAgICBhSlMgKj0gYUpTOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUpUOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUpVOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhSlAubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhSlBbYUJdICo9IGFKUFthQl07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGExUTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFKVjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFKVyA9IG5ldyBBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQXggPSBuZXcgQXJyYXkoZWcpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUpYID0gbmV3IEFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYXAuYUpFKCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChhSlIgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpSID0gbmV3IEFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSlJbYUJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpXW2FCXSA9IGFKUFthQl0gLSBhSlBbYUIgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBeFthQl0gPSBhSlFbYUJdIC0gYUpRW2FCIC0gMV07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlhbYUJdID0gYUpSW2FCXSAtIGFKUlthQiAtIDFdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSBiUi5lciAtIDE7IGVuID49IDA7IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBiUi5lcyAtIDE7IGVwID49IDA7IGVwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSlQgPSBhSlM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGkwOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKVSA9IChlbiAtIGFKTlthQl0pICogKGVuIC0gYUpOW2FCXSkgKyAoZXAgLSBhSk9bYUJdKSAqIChlcCAtIGFKT1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSlQgPSBhSlUgPCBhSlQgPyBhSlUgOiBhSlQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExUSA9IGFKUVtlZyAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKViA9IGFKUltlZyAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAxOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSlQgPCBhSlBbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMVEgPSBhSlFbYUIgLSAxXSArIGFGUygoYUpUIC0gYUpQW2FCIC0gMV0pICogYUF4W2FCXSwgYUpXW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSlYgPSBhSlJbYUIgLSAxXSArIGFGUygoYUpUIC0gYUpQW2FCIC0gMV0pICogYUpYW2FCXSwgYUpXW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSlkoYlIuZXIgKiBlcCArIGVuLCBhMVEsIGFKViwgZjgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFKWShlMSwgYTFRLCBhSlYsIGY4KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChhMVEgPCA1MDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGY4W2UxXSA9IGJLLmRtKGY4W2UxXSAqIGExUSAqIDIsIDEwMDApOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGExUSA+IDUwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZjhbZTFdICs9IGJLLmRtKCgxMDAwMCAtIGY4W2UxXSkgKiAyICogKGExUSAtIDUwMCksIDEwMDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGY4W2UxXSArPSBiSy5kbShhSlYgKiAoMTAgKiBhMVEgLSBmOFtlMV0pLCAxMDAwKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2MoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSlo7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVtID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1byA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUpaID0gbmV3IEFycmF5KGJSLmFJbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbMF0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogWzAsIDUwMDAsIDgwMDAsIDEwMDAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMDogWzIyMCwgMjUwLCAyNTUsIDIyMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0o6IFsxOTAsIDIyMCwgMCwgMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFsxNzAsIDIwMCwgMCwgMF0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbMV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogWzAsIDQwMDAsIDUwMDAsIDYwMDAsIDEwMDAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMDogWzI1LCAwLCAxMDAsIDAsIDI1XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSjogWzI1LCAwLCAwLCAwLCAyNV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFsyNSwgMCwgMCwgMCwgMjVdDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUpaWzJdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IFswLCA1MDAsIDI1MDAsIDI5OTksIDMwMDAsIDMyMDAsIDQyMDAsIDUyMDAsIDU3MDAsIDg4MDAsIDEwMDAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMDogWzE1LCAxNSwgNzAsIDQwLCA0OCwgNDgsIDI1MiwgNDAsIDQwLCAyMCwgMzBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNKOiBbODAsIDgwLCAxOTAsIDkwLCA0NiwgNDYsIDI0OCwgMTgwLCAxODAsIDkwLCAxNDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYwOiBbMTIwLCAxMjAsIDIyMCwgMTEwLCAzNywgMzcsIDIxNywgMTAsIDEwLCAxMCwgMTBdDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUpaWzNdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IFswLCA0MDAsIDE4OTksIDE5MDAsIDMyMDAsIDQ1MDAsIDYwMDAsIDc3MDAsIDg0OTksIDg1MDAsIDk1MDAsIDEwMDAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMDogWzEwLCAxMCwgMjAsIDEwLCAzMCwgMTAsIDE2LCA0MCwgNTAsIDU1LCAyMzAsIDIzMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0o6IFsxMCwgMTAsIDQwLCA1MCwgMTAwLCA0MCwgODAsIDEyMCwgODAsIDU1LCAyMzAsIDIzMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFs4MCwgODAsIDIwMCwgMTAsIDYwLCAxMCwgMTYsIDQwLCA1MCwgNTUsIDIzMCwgMjMwXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKWls0XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiBbMCwgMzAwLCAxNDAwLCAxNzAwLCAzMDAwLCA0MDAwLCAxMDAwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTA6IFsxMCwgMTAsIDIwLCAxMCwgMTAsIDE3MCwgMjEyXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSjogWzIwLCAyMCwgNjAsIDEwMCwgMTAwLCAxMTAsIDE3MF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFs3MCwgNzAsIDE2MCwgMzAsIDMwLCA2MCwgMTIwXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKWls1XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiBbMCwgMTAwMCwgMzAwMCwgMzUwMCwgNDAwMCwgNDUwMCwgNzAwMCwgNzUwMCwgODAwMCwgMTAwMDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwOiBbMTAsIDEwLCAyMCwgMTAsIDUsIDEwLCAyMCwgNSwgMjAsIDI1XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSjogWzMwLCAzMCwgNTAsIDEwMCwgMzAsIDEwMCwgMTQwLCA2MCwgMTQwLCAyMDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYwOiBbODAsIDgwLCAyMDAsIDEwLCA1LCAxMCwgMjAsIDUsIDIwLCAyNV0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbNl0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogWzAsIDcwMCwgMjY1MCwgMzIwMCwgNTAwMCwgODAwMCwgMTAwMDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwOiBbMTAsIDEwLCA2MCwgMjU1LCAyNTUsIDIwMCwgMjAwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSjogWzEwLCAxMCwgNjAsIDI1NSwgMjU1LCAyMDAsIDIwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFs4MCwgODAsIDI1NSwgMjU1LCAyNTUsIDIwMCwgMjAwXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKWls3XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiBbMCwgNDAwLCAxOTk5LCAyMDAwLCAzMjAwLCA0MDAwLCA0NzAwLCA1NTAwLCA2NTAwLCA5NTAwLCAxMDAwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTA6IFsxMCwgMTAsIDgwLCAyNTUsIDI1NSwgNTUsIDYsIDcwLCAyMCwgMTU1LCAyNTVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNKOiBbMTAsIDEwLCA5MCwgMjQ1LCAyNDUsIDE3MCwgODAsIDE5MCwgMjAsIDE1NSwgMjU1XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMDogWzgwLCA4MCwgMjU1LCAyMzUsIDIzNSwgNTUsIDI2LCAxMCwgMjAsIDE1NSwgMjU1XQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKWls4XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiBbMCwgNzAwLCAxMzAwLCAxOTAwLCAxOTAxLCAyNTAwLCAzNDAwLCA2MDAwLCAxMDAwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTA6IFsyNSwgMzAsIDMwLCAzMCwgMjU1LCAyNTUsIDMwLCA0MCwgMjBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNKOiBbMjUsIDMwLCAxNTAsIDE1MCwgMjQ1LCAyNDUsIDgwLCAxNTAsIDcwXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMDogWzYwLCAxNzAsIDE3MCwgMTcwLCAyMzUsIDIzNSwgMzAsIDQwLCA0MF0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbOV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogWzAsIDQwMCwgMjAwOSwgMjAxMCwgMzMwMCwgNDAwMCwgNTIwMCwgNjUwMCwgODAwMCwgOTUwMCwgMTAwMDBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUwOiBbMTAsIDEwLCA4MCwgMjU1LCAyNTUsIDU1LCAyMywgMzYsIDIwLCAxNTUsIDI1NV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0o6IFsxMCwgMTAsIDkwLCAyNDUsIDI0NSwgMTcwLCA2MCwgMTYwLCAyMCwgMTU1LCAyNTVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYwOiBbODAsIDgwLCAyNTUsIDIzNSwgMjM1LCA1NSwgOSwgNzIsIDIwLCAxNTUsIDI1NV0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbMjBdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IFswLCA1NTAwLCA2NzAwLCA2OTk5LCA3MDAwLCA3MzAwLCA3NjAwLCA4MjAwLCAxMDAwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTA6IFs1LCA1LCA3MCwgNzAsIDI1NSwgMjU1LCAyNTIsIDEwLCA4XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSjogWzIwLCAyOCwgMTkwLCAxOTAsIDI1NSwgMjU1LCAyNDgsIDkwLCA2MF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjA6IFs2MCwgODAsIDIyMCwgMjIwLCAyMjAsIDIyMCwgMjE3LCAxMCwgOF0NCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhSlpbMjFdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IFswLCAxNTAwLCAzMDAwLCA0MDAwLCA1MDAwLCA1OTk5LCA2MDAwLCA5NTAwLCAxMDAwMF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTA6IFsxMiwgMzAsIDEwLCAxNiwgNDAsIDUwLCA1NSwgMTcwLCAxNzBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNKOiBbNDUsIDEwMCwgNDAsIDgwLCAxMjAsIDgwLCA1NSwgMTcwLCAxNzBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYwOiBbMTIsIDYwLCAxMCwgMTYsIDQwLCA1MCwgNTUsIDE3MCwgMTcwXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUl2ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGEgPSBhSmEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFKYihhSlpbYlIuZU1dLmksIGFKWltiUi5lTV0uZTAsIGFKWltiUi5lTV0uc0osIGFKWltiUi5lTV0uZjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudlgucHV0SW1hZ2VEYXRhKGhhLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiUi5hSjEoYlIuZU0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUpjKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSmEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGE7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52YiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52Yi53aWR0aCA9IGJSLmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudmIuaGVpZ2h0ID0gYlIuZXM7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WCA9IGJSLnZiLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoYSA9IGJSLnZYLmdldEltYWdlRGF0YSgwLCAwLCBiUi5lciwgYlIuZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIudmMgPSBoYS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhhOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFKYihpLCBlMCwgc0osIGYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYXAuYUpFKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBpLmxlbmd0aCAtIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZk47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpkID0gbmV3IEFycmF5KGVnICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUplID0gbmV3IEFycmF5KGVnICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpmID0gbmV3IEFycmF5KGVnICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpnID0gbmV3IEFycmF5KGVnICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gZWc7IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSmRbZXpdID0gaVtleiArIDFdIC0gaVtlel07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUplW2V6XSA9IGUwW2V6ICsgMV0gLSBlMFtlel07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUpmW2V6XSA9IHNKW2V6ICsgMV0gLSBzSltlel07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUpnW2V6XSA9IGYwW2V6ICsgMV0gLSBmMFtlel07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYlIuZXIgKiBiUi5lcyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGV6ID0gZWc7IGV6ID49IDA7IGV6LS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGY4W2FCXSA+PSBpW2V6XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZk4gPSBmOFthQl0gLSBpW2V6XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZjW2FCICogNF0gPSBlMFtlel0gKyBhRlMoYUplW2V6XSAqIGZOLCBhSmRbZXpdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZjW2FCICogNCArIDFdID0gc0pbZXpdICsgYUZTKGFKZltlel0gKiBmTiwgYUpkW2V6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUi52Y1thQiAqIDQgKyAyXSA9IGYwW2V6XSArIGFGUyhhSmdbZXpdICogZk4sIGFKZFtlel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIudmNbYUIgKiA0ICsgM10gPSAyNTU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSmMoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFiLnNOKCkgfHwgIWJSLmFKMShiUi5lTSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpoID0gYWIuYUVjKFNbOTNdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSmkgPSBhYi5hRWMoU1syMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUpqKGFKaCwgNSwgMC41LCAwLjUsIDAuMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSmooYUppLCAyLCAwLjUsIDAuNDUsIDAuMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUpqKGExciwgaGMsIGVuLCBlcCwgZ2xvYmFsQWxwaGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLnNhdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLmdsb2JhbEFscGhhID0gZ2xvYmFsQWxwaGE7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLnNjYWxlKGhjLCBoYyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5kcmF3SW1hZ2UoYTFyLCBNYXRoLmZsb29yKGVuICogKGJSLmVyIC8gaGMgLSBhMXIud2lkdGgpKSwgTWF0aC5mbG9vcihlcCAqIChiUi5lcyAvIGhjIC0gYTFyLmhlaWdodCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLnJlc3RvcmUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzYyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBnRCwgZW4sIGVwLCBhSmssIGhSLCBmUDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqID0gYlIuZXM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZk4gPSBpICogaiAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpsID0gYUFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKbSA9IGJSLnZjOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGkgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBhQiA8PCAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKbFtnRCArIDJdID0gYUpsW2ZOIC0gZ0QgLSAyXSA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmTiA9IGkgKiA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGogLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBhQiAqIGZOOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKbFtnRCArIDJdID0gYUpsW2dEICsgZk4gLSAyXSA9IDM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhSmsgPSBpIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhSID0gaiAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gMTsgZXAgPCBoUjsgZXArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZOID0gZXAgKiBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSAxOyBlbiA8IGFKazsgZW4rKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IChmTiArIGVuKSA8PCAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmUCA9IDEgLSAoYUptW2dEICsgMl0gPiBhSm1bZ0QgKyAxXSAmJiBhSm1bZ0QgKyAyXSA+IGFKbVtnRF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSmxbZ0QgKyAyXSA9IDIgLSBmUDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVuICs9IGZQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTVtID0gKGkgLSAyKSAqIChqIC0gMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE1cCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYlIuZUwoYlIuZU0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlIuYTVwLmFKbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSLmE1cC5hSm8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTVuID0gYUQuamYgPSBhNW4gLSB0aGlzLmE1cDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTVvID0gdGhpcy5hNW0gLSB0aGlzLmE1biAtIHRoaXMuYTVwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUl0KCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgcE47DQogICAgICAgICAgICAgICAgICAgIGlmIChiUi5lTSA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gIkRZRHoyRVNOdS0wVVlDQ3JTOWMzcEJVcktIYzk0QmhJQmhJSnBJSUJuTUlBQUlyS1NTcEtBQm1nZjllN1g3ZWNYLTVQMGJhT3kxOTFYWFg3ZWVnZjltY2ZVcnJ4cktwcHBwS3BLU3J6VU1NTVNLS0tySmNYY1hjbWdjWG5LSUtCbW5DSUpvbkNLcnJTcnJTU3hTUzlYY0puQmU5WGVtbVdYZVg5OWNoTUlBRXByclNycnRicnhJck1LQm45ZUJjZWNYOVg3Zjk5WDkwZTU3N1ZYMVZjT1dYMTZYWDdYOTk5Y1g3ZVd5WFhjY1ZWWDZyVVNycndVcmx6cGJicnJVNnh6enR6eHpyenR6YmFPdGFPYTUtMFdWLTc3ZS05MTE5SGNYWFplY2NjY2VYWFg3Y2U5WGNjZTllOW1lZVZvZjkxOWVlOVd6eTVYZVhZUzlLQmNYZWVfSGU2Y2UxZWUwenh6dGE1VWFYOTljMW1YY1hoRUpwOWNOSFdjVE45QmNuQXpKb29ySUJlMGMtLW5JSm9vblNJQmUtT1gtTk5PWFdiY0JneklIWDl4SHpTOW1jQ1NJOS1uQnJyb3JLOVZjUC1qSGU5X0JoeHpLSGNXQzltWnA5LTNuOWZCblM5NzBhNnpzN2VncklBQUlSVUtvY1hYOWd4OW5wS2FVeEJwcEFCZTVPZEhwQmUtQUM5LTE3VE9XQUJwS0k5LTdKbW5DNnpHdHhJQm1lbjllZ3A2YVVseU96YnJiYnFVenhIWGdqS0tCYy1aZWhseG9lZW94T2Jvbm94OVhvbkFVYnpTOWVmQmRDQUFySG1qSVNCaEVKbkFvZkJVSUpncnBvY1h4SUJVb3hIVm1uQm1tWEFFeG9VeEFCbWRBSUJnbkJvbklBQzZveEhWZ2ZNSGNYY1VYQUFHeElCZ2Z4SmNoOWMzZW5DTXpTQmU5ZVhvbXhIZUJnbWVDU0JncEtNcDloekhmSUV6SG5BclN4SFg3cFNyVUhjbkNNclVwU2E1VUlvbkFCclNCY2NuQm9wSnR0emJ4cEJvbkhYcElFS01yTVNyeHBLeHpVemx0eVV0YVRPYU9hT2JhVDVVek5UT1YwYzExNnJNTUtTS3J4SUtwSnBLTVNLTUd4SVNDcktNU3BLTUtyU3BTcEk5eHA5X3BNTU1NU0JveFNyeVRVVXhhNVA3LTB0dGJXenp6eHphTjUtTk9XVk4tLTBXYTUtMFgtMFZOVk43VE96YU9XekwwYmJYMHk3Tk41VWExN1YxMTE3NDljNzllMWMtVi0tLS0tT3c3LS1ONTctT3phTjBiYTE1NmJ5Tk5UNnE1T3pXYVQ1NS1Pc09YMTc3N09hNTUtNVQ1VVgxNnR6VU95VXR6cnB6VXJTS0tTU0FvZW1uS0NJQUlJQ0k5S0huOUNLQmhDU0hnZW5TQUpuSUp4U01NS0tTU3BLb29wS0tIcFNvb3JTenhwV3hNUy1VS0lTYU94TU94dHR5T3p5NU96YmJ0eVRPemJ0YVV4eVV5VFQ2cG9yVXJTenR6ek1TcDllY2Vvb2dlWnA5WnhKeDlnZWVlWGU5ZVpnZUM5Z2VnZW1wOWdtcEtNU29uU3hLcnJiYVVNSUtKcE1LS0twSUFDQm1lY2NWNzFYWDdWMW1tbW1oQ0NDS0pvbXBLS0pwTUtTS1NLcEtNSnBLQmVlY2VlbktwekhuQm5CbWNlZWUtWDExMTdlbWVtZkJuOW1mQ0JtZ2VtZjltZkJtZjl4cm9tY2VjN1VzOEhlMHU5OWNXdGJjLVBlQ0NTOVZlY1puQm5CZW1mQm45WDljNmFPWEE5OTdZOTk3NTVWWGM2dFhYbVY1T3MtT2JWTjB5TjBiemFULTdlYzdONzBXYS1PVi01ZWdnbkhvbjlmOWVmQ0JwTXpvcDk3ZXBDS0lwU0lCcEtyclNLS0lLS01LTUplaHpLS0VySmVBQm5JQUpjNzE3ZjllQm5BSnpySGU3VjlkOWVmOWdtb3BLVUtDOWdtY1Y2dFg3M2VDSUpvb25JQm5CbkJnbkNIZ2pKZVpmQTltZWdlZWdmS0NJQ0NKbklBOW1lWmY5bWZJRU1vZjlYY2VYZTk3WC01OVhkQ0lLS3BLS0NKb2VWY2Y5N21abVZWVjE5OVlKbVg3Z2NlWTlncEVPeE1NSmVjclNTR3pPeFNyeHByU3h6SnpVb3BTckl4S0JwVU1JcE1wclNyb3BFTUhuQnJwcHJLOTFBSnBKcElJQ3BCb3BJQ0NKb25LQm45bWNtZTlWY1g5ZWU3WDdlOWVjZTlYZTE5WGNYOTFYZWU5WGNjZTlWVlZjY2VmQUFBQmU3ZW1oQm5TU0tNU0lKaENJSnBLSnBwQ0tLSUlJSUNKZ3BJQnBBSUhwQmNvb29vbklLTE9icEJuS2x6cktJS0NKcENKcEJuQnBVenJyeHB4U2Jid1V4elVwcnBwcHBwSnBwTU1JcnJTU1JVYldzT3dVelVsdGJ6cnh6VXpTelVicnJUVFVVclNiYlY2V2JhVE96eHp5TjVUTi1UNVRPeGJ0dHM3MS1YLTcwVjBzT1dzT2JiYVQwc1RPYnc3MHRiYnpieGJ6enlPdHlVdGJ5VWFPVjEtTjBjVk4tNTBhT3R6YTZ0emx4elV4U3J6VXpTU3hVU3p6T3p6czVPeU90eU95VXp0eU9iYU5PdGFVclV4cnJVU3JyVXJNU0pyU0lNU3BLSVN6S1VTcFNyU1NyelNNTXhNU3JNU3BTclV6U1N6enJUVU1TcHByU3pNU3pVeFNTSUVVU3J6clVTcE1LS3hwS3JLTUtCbW1ySUtCZ3BLcnpzNlZPc1VhLS01T2J6eU43Ny03WDdlOTcwVi01T2E1T2J6eFN4cnp6U3JLTVV3LU9WMTdYN1gxWDk5WDk3WDlYOTljWFhYWFg5NzdPYU9WWGVlZWVlY1g3Y1g3WDdYMTc3LTctWC03MS03WFg5N1g5N2NYN1ZWVjEtLVZPYnM5NzBjVk9idHpidHlPYnJ6eFNvbWRLS1NTTUtxVE41Tk4weHJNSU01VXJLS0twRUtyU01TTXByU3J4TU1VenJ6cnpTclNyU3JIWGVuT3R4cnJ4cnh6U3JyU3JVcnJTclN4TVN4eEtKcEtLS0puS0tyS0lVVVNyU3JLS3pLeEtyU3JTd1V4SUJucnhwU1NwVXp5T3p6enp5VVN4elJVcENCZWU3ZWNYY2U4OW9tZWdwSUJycHh6U3JNSm5Lck1TRlQwdGJyTUt4S0wwVk9ieHByU1NsWFYtMTEtYy1YLVd4enhGVWFQY1g3NzdPenp0enJTck1WLVY3NVg5Nnp6TUtyVWE5ZS03VjE3Z2M5WGVWOTBCZjk1N2NWT3pyTU9YMTdYN1gtWDdYN1YtTi02YVV4Q0t6VVVLcHJjWC1VelNyTjE3V3pyeHJOWDdlY1YxN1d6emJhT3RieHJhT2JyT3hyYnh3VXhwVXpyenJhT3k1T1ZPV3R6eU96enhielZOWGNjWGNYY1gxLVYxOTdWLWVjNU95NU4xLS01NTVVeU4tTjEtLS1WT1dYMFd0Y2MwYVVNTXlPcy0tLS1aYzUtVE90c09XWDdjMHh6TE4tTldieU95VXlVenJieEplOWdmVFV4QU14cnh6bGJ6YnpicTVVS3JKbkFBQm5BQUlDRVRVdHhTcnpycElwS0lVU3hyYU9hT1ZOVE9ieldhNU5PdHh4eU95T2MtNUE5WUJtbkJmSGNlWDctWFhjWDllOVk5ZTVPelVieFN5VlVYNU9jVWExLVVNcU5OVWJ5T3RzVVd0V2JXYU9idHpieVVXeTZienBKbW9oOW5JVUk5OW9naFNVenJyclNIZUhvaEtDSmdyS0plbWdjclM5bnJ5NnhTclVNU3R4elVTenFVcmJyVXhVU3h4cnJwclVVNnpTcmJydHpVU1VTenhNS3hTTXByTUtJSUlvb25JQm1vaEFJQUhnZjllSGVlbWZJOW5BOW1mOWM5bjlaZVhjOWQ5bjljY1g3Vlptb2NlZUhWWDFabjltZVplZ2VnZWdmQmhBQmVoQUJvbkFIbkFCaENJQmVtZWU5ZUJmQmVlY2dlb2hDVXh6VWJ6eEk5ZWdlZ2ZBVVVySG1lZ2VtZWNXY2ZDVXA5bWVYOUJlZWVmOW9uclNwQUFLS0tJeU96eVV6Sm5CalNyeFNTSUJoTVNIZ2NWWUt4Qm1uenJST3pwenh6U0tLQ0tVektCbm9VenpienBKbWVnZnp5VXpGT2J5VXpycnpwS1VTbHpyeTZzVXlVVk4tN05PemJ6emx6cnpVclVTcnJVUlV4emJ6c1RVc1VXdHM1Tk9XYTVPYnpyVXhydHlPV1dhT3pNU0puSUFJcHJNSm9yS01JclNLTUtLcFVLQ0JvbktNSm5DSnBDSUtJS01KbXBLSU1LSnBDSnBCeEJvbkhvbW9lbW1lZ25IZjlmOWNYN2NlOTllbWVjZ245aDllQTluQ0hnZkJuQUlCZkhoOWVYWGNlOWVtZWM3ZjllYzFtZTg5ZWVjZW1lODlmSGVlbVg3Ny1jZWVlZW1lWDlYOWVlZWNWLVY5ZTlYZTdlOWVlZkJuQmVlZkJmSG1uQm5CbktCcElFcEt4TVNLSm5CcEJuQm5CbWdtZWVYOWNYWFZjWDdYY2UxZVhjWGU3ZWU5ZVhlZWVYOVg3VjdWNzdWLS1YY1hlZTdlYzdYOWVYWGNlWDlmOWVlZWU5OTdYOVZlN1plZTdXYVg1WDJCZS1jZWUxN1gtLTB0c1VidGFUMHRhNS1PYy0tN1hlLVg3LS1PVlV0YlZULS1RQTluQm1jWFYtLTk3WDllbWVtZ2duQmVjSmNlZVhtZS1jWGRBQmVYZVg5N2NuSGdlZUk5SUE5WGNWWDdlWDk5ZTllOW1nZVhlWGVtbWNlWm1YZTljZVhlbVhtZ2dmOW1tbkFJOVgxZUlIY1hmQmdoQm1mOUJlbWNYOVk5VmU5LS1KbVplY2NYQTlYZDljWDlWWFZWYzctVi1YZWVfQm5KaElJQm5KbkJtb2hCZ29oQmNtbWY5ZUhmOTlIZjlIbW9tbW1tVjVOLU12eHBweHJJSUNXenNPeFgtLU9WNXMwaTFtb3BNS3BwelRPYU4tMFhYY2VWLS0wbEo3LTkwbXpCbFYyTjd0Um9mOUpxVXNPYVc3Yzhid3JySmNocEs5LVg3UEJmSGpLb2djUDBKZDkyU01Vd1VseE1TRXJIZWducmx4STlYN2NZOTllN2hTenhweFNJSVVIb3pvZ21nZWNZSUV4eHhycnJLcEtyU3JNTXJybHh0eVV0eGJseFV5VFVieVVVU2FVeTZXenR0YmJjNU41TjdWN1hXYVQ3VjZhWmVWV3NWOW5JQTlYMkJtY1djN29vYy0tZjlJQm9tVi0wY25JQ0JlWGduOTBXYzVUT2E3LTEtNWNYLS0tZDExLS0tZXNELS0tbThELTFWdkFZcVYtOTJnbEM1LS1ORUVpcVYtN0hzamswMTRJNHdvZ25CeHdPczBXYy1ENHk0Z2NULS0wWThYLTBXYWxBay0tMHBIWC0xV3N5NkVWLWE3RURoQ0J0YVQ5LS1YM0lJVi0tX1ZKVjBOZGVwbXpxMS0wWGVKYkQtNVhodnJDcVRlLTA3aUNucHRlVi03aWVqay1pQXRDeEVJcnJYNzEtMnNta25uRVVVcHplLWUtYy0xQnRNQi0tMkticS0tWU1telYtc3FQbXJGNy0tQ3VsYy1IQ3d5eHhjVi1ERVdYaHRlLURaN216b3JTcjU2ZVgxNzBMRy1yVVNyU0l0ek91ZVZjOTNjLTVaSC1yclJQOS0yZDYxM25IZFJVUjZrUDctQ1pWWlVFS1V5VWU5MWUtMlpZaG5UUFYtdDhPTW55Ny0xSFpyVC1EWmYxNkE5bWpGVXpsc1YtLUhoX04tMUhseUItQ1poQ3JTcHpya1g3Y1gtMlppYkFyLVZNZEM4YnJTcnpVeFNTSUJ4cEhYMTdjOENySmU3cnJVSXBTclV4eHpTck1JTU9zNU9WVjdYN1g3OTc3Vi03UDE5WGNjZS0tOEROSGstTEljUFNwTjctME9EdGduTU4xLTdaejVVU3h5WDljLS1KMkFzLTlKMkNTdS0wOEZIU3JSN1YtMEc1eFYtT0g1dnFWLTBMRW9WME9MaUFuTU43MERfZjRVS0lCblNCZ3pTclN4U1NNU3hwU3BwcHpjLTVUVFVNYlY3MTZzMTE3WDFYY2NlLWNYWEhjWC0tMFJzN1YzZFMwNG5Lb25wU1NrVjctLS0tVE1HUHhyUy1WNy0tTU4tYzBITVluQm5ySUFJckstT1dWNzVWLXRURUhvdFYtcU1vcVNNVVViZTlIWFYtbU5jYXducjZ4dGNWZS0zYU5pVUlxMS02YU93TUlTbGMxLTZhU2U2clJPZWMtOGFjOWZJU3p1WC1WMXRmLTFtbkJybFdhTi1OYWpNWTlnZ2Vvb3BDVFRUVE42YU4xSGRna1hvb2hBQm5LOW45S0ptcG9nZVYtMFhKZW5wcFNyVXpKZ2dob21ocDlWbnhJQUF6T3hXYmJySUJuSm1lbkJlZ296bFd5T2J4SUtCb25JR2FPVlQ1MHhTazZ4SnBFcElIbkJvbkJvcHR4cHI1Nnhyenpib25DQm5DTU1Tb256eEptb3BDSUpvbVg3bWNlSGNWN25KeFNBQmhyYnhFS0NJSmhBQTlIZ2VuQUJyVU1icVVwU1VycHJTcmJ6enA5aEFCZVhjZTlZQUhjb29tbkJtbW5CbW1ucHphVFRVcnp6TXB6V1dibGJ5VVVTclVyeGJienpibHhyVVVicnpTcnR6dHp3NmJ0VjE5Y2VXWFd6cTBhVTZhVE90YTBhMFY1Nzc3WGNlN25BOTdWT2EwWC0xN1ZVVlYwVjE3LTE3WDdWNy1WLS0tLTEtVi1WY1g5QTljV2JienlWLVU1VDVUT2E1Tk5PYU9WMVhlOWNlOTltWmVlNU90Y1diYVRUVFRUT1dlOVplWGNtY1hWVjM4Z3RSbkNNelN3MVg2VmNWMDhodTRycTktLXRpR1JyYWMtMVFmYmctZGF4NHpycklLb2VCeEVyVWx6U0diczBWUDNlWFg5N1hWLTlSMEtDc1YxT2xYanByclA3WDctSFJRc0NwVmMyVFJnTHhKcktCZUtLSmU3QmhJS0tCbHdPYVVyTlRVc05OTmNOUDkxVi0tLVBTNlZnb3BWTi1MYkhScks5OTllenJ4eG95NVRjNy0wYkpHakYtLTZTcHktNWJVN3JTYnVYVjR0c0lZcEtTU3JTcDUwYVgtMTc3ZS0yYmFOTUM1LTJPdGQ3bkhycE9iYTdjVjJ0djJkbklDeHotVWs3Y2MwbVVJa1JuQnBDQnBDSUpPV2EwVk5PdGMtMTlVUW5CZWVnbW5JSVN4Sm5zNTZ6YU9XdHU3VFYtLVVSV04tLVZETGMtZVZFN3pTclVYN1hjLTVXTTRCTjFEV1RJZ2dwQm5FS0tLRVNDV1Y1VDVXYS1OMGE5VnNQNllSbjljbVk5Smdnb2dnelVLSGZBOVhtY1A5WFpmSUpocm9uQUJmSVNweHJVcnJJOUFCbkJnZ3J4eG9lOWZIbWVCZENEVVVySGY5b3JVb2dyenpKZlVVNnpVemJiYnpydHk2YnJicnh4ejU3T3RzTjVPc041VjVWVDVWNTdONTZ5VFV0c05OMWNOTlZWNVZOZWVlWmVXdHU3Ny1YWC1LZ3hDcVdWVi1QOHc1cVYtdUFqdHo1YzE1WHdoQm9vb3BCb25JS0tKTk41LU41LTZXVk4tOGNrbXpBclVPVmVWLXVEb1d4TlYtLVlvQTctVFlvWVJveGE1Ny0xX1AxVC0tOE5LRC05ZE5TMkFDQVV0YS0tLWRRenItRFBNNzltbWdjcEk5Y2hNS0NwcHh4eHJTekliWGMwYVQxV1ZPeGs3LU4tOWMwZWF1WmdmQUtyU3JyU2xhLTUtN245LVYxZVZFM25LVXdOVmNWMGVXWmluQ0Y1TjBUY2JrQ01TcnpyNU9WUFhDQTlWWFYtMWIwdVYwZXpVQnhVc1hjLS1taFRjLS1uOV9jMURuVEl4Q0NTTUtDOWVDS0Nsc1Q1T3NOLVY3Tk5WNlFKY1l4elVTeHpTd1VhN1g5STk5WGQ5WC1CaFc4RUU2clV3N2NlVjZmWGtBcEJtZjlmOWhLR2FPV3p6ek9iVjFWLVB1aXBScEo1LS02aWlhcnByUDc3LS1EcmhMLTBpdi1mTi03ak5LakV4elhjYy1ZMWtzaEtLLTUtVi13RjJ1bVdzLTAzRVdzLTAzX01zLTIzZ2R5LXFsbXlBQ0ptY2dmQm5DSUlyS3BJQ1VTSXByVWEwVk9WNU41LS0tVjUtLS13Um5GcnU3LUU2a01DbFgtNGx3SUF6cTljLUE3ci16NVY3Z2RrOG1vbkJnZkNDQ0VsemJ6eHNOOTk1LVQ1LUtnaVN1bkJuQUJtZWVJSHBycktKeHBJSVNLSUNKcEtwclV6T2NPenpVVE4tLS0wVi0tNTBhTjEtMS1QVjdYWC1TbkNlWTlmOW1uVVNTS3pNdGFPV2E5VlgtLWJCeTFnelN4WC1lLTRuRk5FQXFUYy02QzdXZ3MtRUNfREJqTi0wblZiMk4tM25fRVlCeU4tLW5mV25WMUJ4OFpvclVhVjktQ25xZ2JLSVNyTk45LTktOG81YUFDclNWV1hWLUMwZ1BrLWpGUndTTTZyc1c5VlYzaDIzVG1mQmpPeE1VdGFYMTctNkdZZkUtMFVIU2p3ZkV6YnhwVVVxMTdaY1hlVi1oOHJxci0tM29kWDZNRi0tOG9nenZNSnJOLS1WMXhBSTRucEt3VDdjVjBYcC1ZZjluQmVlaEtNS3J6elN4clN4clVTenpTeHJTTXpTenpWLVQtN1YxMFdhNlZPV1ZUMW1tZWVlZ245ZWVlWG1jWDk3Vi1JSkduQ3IxLS0ySlZ2RC1CcDdnelN4dzZhZVpjVjBoSFg1bWVydHMtRUpqVWhxNy0ycEdNdkJ0Vi1oSm1WejEtMXBKb2ZxVi0wS1EzYy0wS3p0Ti0wTDVrNy02TFl2RS0tSUxZeGhUTmMtMExaNTctQUx1MUNhVi00U0lxVi1oU1EzbmEtLUtwalgtLXBwa25WRVNUUGtuQmdtZ245ZjlmOW9uQm1lblNwTUd6eGJ0YnpiYU9WNnpiWDktTk9iV1YtNFRtbVYzU1RvTG5CbkpuU1Q1T2EtMS0wcHgwWUQtMHB5bHZELS1MM0dlLS1xNTRJVjJDV21XblVVejVQY2VjLW5PLVVSaEJvVXk2VlgtMXFGdVFHYy1NT2NhZ3BSLS0tQ2NFUnMtMFBRVWMzTVBzOGdlaENselN6Ynp6VXp4TXI2dHlVenpiemFUUDBIZ21jVlhlZ2VlZVhlaDllWDdlLUpxcVVFS0lNcHp6NVQ3Y1hYOTctYlJCcFNLb1Q1WDctLU00ZzEtZ3JNSWJCZWNlbWdmTXhVcHpNek9idHU3VjB6cnJxN2U5ZVYtTVRhRmhPeTlWZkxudDItOS0xNzExN1ZjWDEtMVg5N2NWWFg5MTc3Vi1WWFY5LVdhT1NNU1NTU3JyVVNLTUt4cnJyVVN4cnJVenNPVjctLU4tdFZOLS1OMGJLSUtLUUNLUm5LUUNVdHJUVXRVU3hwTXByclVVS3hTcHhycHByTXJ4Ri1FY1ZHeFRYIjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiUi5lTSA9PT0gMTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gIlFSRWM3bFI3b1ZVWUd5X0tKT0pLS0tLdUs0T0tUX0s0S0dfdV9HSkpPXzNLX0tLS0xfNEtMX19LS180X0xLS19Nanp1T09LX0tLS09LTEtLTExVanpqaV9LS01neXpkTWp6Z3p6ekVzenp5enpqdnVRdmllZWlkX1BPT3Z6a3p2enlfVHZ1T0s0R0tLdnl5enp5ZEpRaV9PZEtLYUxPTGFqZE9QdXVlYVlCenlkSmRQT3lidmRiamV1dml6d3p1anVRbnVubDJ3Qm5CRTItRVlCejJuazJrRnp3Qnp6bkJ5ZG53em5FWXdubkVCbm53a3l2d3pFZ3puenpFd3d3d3pubnhLNEtHT0oyemwybnppZnZ3eXctSjBHR0owNDJudnpFdnp3em5KRW56bEc0MnpnMDJLS0dGenpFenplVC13b0tLM0V2b0tMT0pCbkJuekUyRXpubndud3puem56cEpLS0tLT09LR19HX0xLRndsMnpLOEs0Sks0S0tLS0tLS0tLS0tLRl9nMzhFQmVtWGVlZWVlZW1lZW1nZVhlZWdmOVhnZWVleEN4enp6b2VuRXJNcm9lWGVlZWdmRXpTUzllVmNnaG9lZW1mOVlCZTllZTllWGdocnp6ektCZklVenJielV6enpicnlPeHJ6emJic1RYZTlnZVk5ZWdlZUJlWTkxY1V5Nno2eHR4Ynh6Ynpsek9icng2enR6dHVlNVV5VDZ6emJ6YmFlN1V4eU96emJ6emJidHp5VXlVdHp6dGJ5VXp6YnVlY1plQmVYZWVlY2dlVi0tMVZpWi0wMEpKSVYzNzl4d09MS0tnenl6SzJ6RjVnNGNjQmdjbjlnZ2VwVXhBcHJ6enR4dHlPemJ6emJlOTBmOWNYWDk5Vi1jQVFBT3gtUEZMcXFtZW14cDl6enR0eklBenJyenp4enp6ZTdYOVplY2VYNWVjZS0tLUFvckYwQjR1VWdoenphZTktNlZqSmhfVXpuSy0tLU5VWFYxTkJFcE9MWW56bEotLTBYMVgtLVZsNHBrLUI1S1lFYy1EMjl2YXpKLUhrUDlEbWV4enh4enp6cmJ6dGJzZWVlSGVZSGNlWFYtTkM1dVVGLVI1WVlDeVgtMlZwYzBqQ0YtLTVsTTctMTJUdU0taGtRclpyUzlYN2Y5ZTllbnJTeHJ6YVV4eDlmOXp6SGh6VXhxT2FPc09iYnpTeG9xVXh5VVk5OTljOVhjZWNjZTdlVjVORHJTT0xhdVV3enp6ekVHSzRLXzBGMlo2WWZFVW9lZlV0elV6TXlOTmU5Y2VlYzBhMnpkTFFkeWp3eW54S0tGem5wR0dKLS0xLV9YLUFXMFpwanZuekNLS0otLTEzMDktLTAySE8tLS1XckRWMXNHZk9Panp6bjRLSy0wRllOMXFQLTJXN1J0ZmtGNko4Ry1nZWVlbWY5Z2VtZWdmRWJxVXJ4RWJ5VGdlY093VWJieEVieVRUVWFjLUgzY3JyakNMRUUxS29RQnJvZkhlZ2VlY0JlZkJlZWVnZkFBQ3hVSGVtZWVlZWVneHJTcnp4eG9lZVhYZTllY2RBelVvbVhleHpyenJvZVhlZWNjNzExX3JJOW5VU3h4S01TcnlVenJ6VXB4S3g5Y1Y3Y2NlZ2hyckpuSm1oQmU5ZWU5VlVyeHkwYTUtN2U3VlZYLTdYY2NPVlg5OWVlZktLQUFNeE1JVXh6TXJ4SzlYWFhYZVhjZVhjZWVlOW14eHA5b2VWOW1mOWVIZ21lZVdzWG5IY21mQTlvZW5KZjlYY1hjT2J5OTk5ZXhLS3pNSUpjY2VZQmdnZ2h4ckk5ZTllOTlweHpwSGVjY2NlWDExMGNYZTdjWFd6clV6VXh6enJ6cnR6YmFPY1ZjY2VYY2NjZTlYY2VlZ2NjZTZlbWVaZTk2YnVYZVhvZTdUWmhCZTJCbWM2ZUlCZEM5ZUM5ZkhjSGNBQzllcnhIZWQ5MEM5TVRVem9oOVpqSmVvZklBekhnaEh6STluSFlBQ0NBOVZ4SUhjZng5Z21tbkVKcktFckp6U0M5eHJycnR5VE9hVWEweFN4S3JveE1TU3JJTUtxVWxjNmJ6dFd4NTEtLVA3T3lPeTB0Y1g5OTdWLU5QNldzVWFVYmFPYVg2VlRPenp6eHhwSG5CbkJnZ29mQ0tTcEp4VVVvNnB6emJ0enlVemJ4U3pvZ2ZBQmVjZWVmOW1wU3pvcHBJOWU3WDluQ0NLTU1LOWZFSTllZTE5bWZCZ2VtaDlXOTFXdUk5Z2Y5ZTVlWDE3TjVOVVhjMGExbkJlblVIZlNvcnBNS01ySFhoOVhnbVk5bk1KbVYxbklJU0M5M2ZBOWduS0JlbXA5ZTlYeEtvZWVlQTlmU016cnhycE1TeE1NSG9ySUtJSTllZWNnZWNlZWVlOWdtZ2hyS0tDcEtDSUpvbk1vektKcDZ4eVV6U3BwcjVPdHR6enp6V1d0eU41T2JjVi01T2FPV3R0eVRUTjVWV1diYnp6cnJ4YU90YnlOVFVVcnJTTU1TcHhyclNyVXh4VVVwU3pTTUtvbklPYU42YVZjVk5PelVyTDE3Y2NYY2NWUGVjY1g3NzE3Y1hYLTVWMHpiekp4T2JvVUtyS3JyVXh4cnJTeHhyU29ySUtTck1wVVVJU3h4QUVTcEd4cnNWV3pQN1hYV3pycnhWTlhvY2NXY09jWC02eHJWNnR4MHp4elV0YnR6cTk5Nzc3V1dWVVYtNTB4YVYwdHNOVWJ6cFVVenA5blVycEl5T3phVXk5Z2UxOTdlNnpsYmJiemJieVV6b21taHhvbkNIZUl4eHJ4cnhyVVN4clVyck1Lb29nbW1lY21lZVpjY2VYN2VYSGVlZW1tbW45ZWVkQ3pIZm9lZWVaZV9JTXpJcG94SFhLelVKeHhVb1VVcHJ6YTB6eHh4clV0eU9hVVVsYnhJTUtLS29vcENJSnBKb29tbWVlZVg5QTltbW45Y2NlOVhlOWVlMTllWGUxN2VBOW1nbkNLcEpuQmVlN1hYWGNlZTdYLTk5WFhlZWU5OTkzY1hWMGJhNS1YVjBhT0E5MTlIZ21lZUJlWTltbVg5ZW1lbWVmOWdnbjlnaEE5bVhjbWVlY1g3Z3BDQ0NCbkFBQUFCbkNJSUNJS3BKb25DQUJuQmdmOWhCcEJuQm5DQ0NKb25CbkpuSm9uQ0lLcHJTS0lNS0twSnBDSUtJSUlIclNNcEpqSnhNcHo2ekh4Q3JyTU1VU3ByS1NJck1yTVVVTXJTeHJTclNyclVVeVRVYmJ0ejZ6YnI2eHh4dGJ0eU90eVU1NnR6eVVUVXh6clNweEtNVTZsV3h6cU5VU3hwVXhFTUtKeENKbk1LRVVIaElDRU1ySHhTVU1Tck1TclNwcHBwTUtNU1NNS3BLQnhNS3BwcEtLQ0JuQ0JvcElLSUtDRUtDS0tNTVNwcHBTU1NNTU1NU1NLS0tLcFNLS1NLU01NTVNyU1NTTUtwU1NTcHBLSUNwcE1yVVN5VFV6dGJ6emJyeGFVcTZ6dHRiYU9iYU9hNVRPYTVOT1dXYTVUVDUtTjUwVjdXV2JhVWJidGFPWC1OLTctMS0xNzBjVFQ1T2JhT2E1T3R0dHR0YmFPYTVONS0xNTEwYzVWLS0wVlZjWC0xLVY1MS1ON1gtV1dWNTVONTU1NTB0YTZhTk5PYTVPYTVPYU9hT3RiYU9hT2FPYU5PYTU1Tk5PVjUwYTUtVDUwV1dWLU4tLTduQmY5bWNtZ2NtbW1lQmdtZWU3WDE3ZVdiYTExWDdWWDdYNzlYOTdKYzdWNy1WNzExN1g3Y1Y3LS0tVjEtWDdYOTctLTdYMTExMTExNzExLVZYNzdWNy1VTU1NU01Tck4wVjUtVUtLQ014cHByU1NTck1TU0twcnhyU1NTTUtLU0tyTXJyU3JNS3BwclNyS3JTU0NLS3BwS3BveE1VT3phVE96eVVhVFV0dFd0emJieU90cy1PeVViYnp0Vk9ieU5OT3lUVi0wV3hXV2FOTk43WDdWWGNlWFhYMTctN1dXSUJuSUJvbkJkOWVBQTlWYzdOTlYxQ0lLOTExNy03OTdYN1ZYMTExMVdiV3kweFV6cHJTU1NwcHJVeHJTeHhyelRVYnFQNnpyU0twcnh6eHp6VFVVVXp0enp0eHp6YnR6U1NVU01TenByU3JydHpKbW1mclNyU1VTemFUTjc1NnhLeENTU0lLTU1LS3BTS3BNS3ByS3ByTUtwU0twcHJNTU1NTUtySnhTU3JTYU5OT3RWTjZzLS0tMFdWMTdOLVYtMGFVV2J5TjBiYU9hT2FOTk9XYnlPc043MGJ0YVVMMHhMVDZvLVVNNmxYNmJyU3BwU1NTVVVTcnBwRUY2cFNTU01LS0NLVlVNVUwwdGJhLVVTU1VLU0tTU01Lck1LcEtTS0tDS3BJS0lNNnJTU3B4TVNwcEtTTUtTU1NwU3JTeHJVU2x3VDc3N1ZWLS0tNzc3WDdYWDE5WFhYLS03VjFIYzEtLU4wVk41NzBjNmJ6S01VenJTeHBySzZ4TXh4cnBDS1M1TlRUNmNOMHpsdGFUT2EtLTU3LTExLVY3WDdWY1g3YzdYNzc5NzdWTi1PYTBhVE9iYVVVb094cEtwcVA3MGJ0eU93VXNPdzc3NnJTNnR3VWtVT3RXYU9iWDZ0YTBiVmNPY1d5NU4tNVQ5NlhXYVdjY1plV1d0YVg5N2NlY1d6VXh4cTFYN2NWWDc3Vlg5OTk3NTBhNlZPdHR3MVhlY1huSUJlOS1WWmNlWDdWMHpUVC1PdFdXYnJ6U3BDQ1VKbHRXYmJienh6VXBveG9weFRVVXhwclM5ek1NU0tLeEd0YVV0elYxNzcxNzdjWDdYN1g5OTctT3RXYU5YMTUwYTZWNnJ4VXh0YmFPVi1OTjBXVi03NS0wVjc3Nzc3WDcxMS0xWDE5NVhjY2NjWFplX29uOWMyOWM3OTllY1ZPV2FOLTU1TlAtVC1UVXp6enpsenp6c1V6eHp6cnhBcVV5VXp1QTk3NzBWLTVVemJ6T3pTU1VyT1ZPYWM3V3p6eENyU1VNSmdwSUpyS0lIZ3JTSnhTck1TclNyU3JyU3JTclNyclNyU3JVNTUtWDc3VE9lNzc1T3hzWFg3WDE1V3pNY1hjY1gtWGVlNzctVlgtVXprT3pTcTdVYnp6eHpTWDVPVk5VYmFUUDZ4enJ6Y2NjY2NlMVhYZWNjV3p6c1A3Y2UtVTZyU3pTemJ6VXh4eHp4elV3VXFYY1BWVFQ5OVhYY2U5ZWVYelM5Y1hYWDlYY2VYZTllOWNlOWNlY2U5ZTllY2VjZWVlZWVjZWV4eHh4ckhlZTdlY2U3VWU5b21lZVhlZWVlZWVlY2NYOTk5ZTllZVhnZWY5ZWVYWFhlY2VlYzVlWGVmQzllV2NQbjlXZVhlZWVmOWh6U3hIY2Z4OWNCZTllbWVlOVhfU3A5ZTlYZTk5OVhXeWNlN1g5Y2VlZWVYZXJwOWVlZWNlZWNWZWVlZWVuOTdkOWVjX0JlbWdlZW1WVE95VE5VYnR0WFZlOWNjZTllZWVmOWUxZWU5NWVlZWMtLTNtSjMtMDFSY2ZWLU5Jb09VRjhSOHVMZ2Y5aElIZWVjMVhlOWZCZWg5bWZFenp5VXJIZW54eVV5VXR6eVV4enpieVRUTmY5ZTBhMGNXRXZLZEtfS0tLTEtPS19hSmFQUE9PVWVLZFVkZExUeUV1a3l2aXpqenp6R0s0M0czMzIyRUJrd0J6a3d3end6d3p3em53b0tLSjBLMVgyQUJycHp6b3p6emFVV3RhY21lOWh4QmNYQm9lVjktLTdLWjVSMEsxaTVRcHhVeHpVeVV6Ynh6dHlYOWU5b2U3ZUFIWGU5ZVYtLUt5Y0YwZ0FDLUJmOXJVenRhN2MtNTRkdGJWLTYxcWJBQXktLS1MenRGMW9BV3FFVXpyenh6YmVYZWVjZjlWLTk0cEw2eEYtLUFndTctLTR4bDMxMjI2YUlCb2dmQUJmQmY5bnh4TXlVenR0dHR0emJiemJ5VXR6YnNYOWY5ZTk5ZWVlYy0tNUhMWi1BMjhNUXJ5OWYwNTVMVnFLS1BLT2FPZGRhS2FLT09kX2JpenZ5X01lT09PS19MUFBLNDJCbkpGenN6RW8wRzRhTEtPVWp1T0xPX19HS0tLS0pIS0czMktfS09LYm56emRLT0xPZU9PXy1Fb0pHNUtLX0tLS0dLMnd6RWxHTEs0SzQ0SkdKS0xMTEtGbkxMT0pGMjNkTExMSzQzX09LX0tPT0tGcUtPS2VLNEtHNDNLS0dHR09LS0dLS0pLS0tLRzBPS0ZfRk9LX09LS0tQTEpLX0tMS19fX19MS09LS09MTE1qaWRienpkUFBLT0tKT0cycE9LT0tMTEtPVXVfUFV6enp6WXd6d3lkS2RhT09LS09PS0tMS2FPS19PT19fYUVlT0xUZHp6RUJ5ZGFhS2RiRW56amZCbnV6ZFBMTE9fT0xMT0tfT0xMTFV6RW5uRW56RW53d256NDJ6dVJ6RXd3d3d6bksybm53ekVuRUVFbm53ekV6dmRLS09MT19PT2RPVUVud3pubnpZd25rRUV6eUVpdVV2anp6enZqbnlhVHl1aXowMnl5YXdCa3llUWVlT3VlZGRhVWlidVBKaV9fOWd3bnlhT09QVHZ1UEpUYmVMekVpWXVFaWFRRWVSeWRpZGRkZGFKLXg0SzRkZWFkZGRhYV9kYWFPZGFPYU9kZGVQYVBPYWF1ZGRldWZFZWFMaXVPZmV2ZHVhemp1emZ2aWVlZXVQdWVlZml2aWllYmVfM0t2ZmpmRWZpdmVlUGl2amZpdWlFLUZHSi0tMy0tNC1GRkYtRkYzM0YtQi0yMnZqeWplYXVlZmVpaXV6ZWZ1amlkYXZ1eXVpdmZpdXV2ZmVldWVQYVBpdXZ2amlpeXl6eWl2dnZ2dnl6aXl2emp6RW5uRXZ5dml2aXV2aXZqanp2anl5endFaWlfdml1dml1by0ydmpmZmRLSFBkaXZnRWlqamllRWlnemp2Zll5Zm5vMy16MkJ6dnZqZU9paXZmZmRpZGVlZWllT2RlTEtiZUx1T09PT2VkYWVPZWlkamdudWVhYUxPYWFmZXZlTHl5dml2ZmZpaXV1aWlpaWlpaWl2ZXZmaWlpZWlpdml2aXl5dnZ2dnZ2dmppdXZ2amVmZXVlaWVpZWVlZGR2ZVRlZmVhaWVlZWVRZVBldmVkZWZmZXVpZWV1YWVlZWFlZWVfZmlmZmlpZWVRZWZmaWRldWZqMzMyM0Z3RWpkeXVNZXVhdmVUdVFldUxFZXVkRzMzX2VMVnppenZkamZ6aV9KaWJlSkY0NGZ6ZWV1MnZjM0JFZmR2ZGpmeV92dmZ5RXZkX1R5ZnllVGd5WTJ5ekZGLXd6MnpKR0YzRi1rei1GMjJCbi0wR0tHNDNGLTJCd3pGazMtQm9GQzQzMDAtRXl6anpCbzMtbDAtenp6d3p3ekVCazJCLTQ0MC0wNDQ0My1FaXZ6amp2enp3d2trQm4yLUIzMjJCQi16eWFkWTItQjItbkJray1vRjAtby1vMndCbm5Cbm5Fc25FMkV6c252emsybm4zMi1uQi1ray0tQkJsLTItMjMtMy1CRi1CLXlzbjIta0JCbkVCQmtuMjItQi0tMDAtMDBHS0s0M0dHMDNKRzQzS0tPR0pfNDQ0T09GZGRGMjNCSkhKR0dHSkpLT2RkRy1rQktISjQ0Ry1uQi1LMy1GMy1GNDAzSkczR0pLNDVLR2RHSzhKM0c0NC0zRzA0SjNfTEsyQjIzSks4RzNGRXhLT0xLX19LR0c0S09LRy0zSzRPSExLX2FmZmVkYUstRy1uMi1GLXduM19hT19fX0thUEo0YU9lYWRhT2FMZEczRzNHR0s1T19PT09HR0pGRzNGRkZGLWstMjItLW4tLUdKMks0S0tfS0tHX0tGMm4yLTItQy1udTIyLTItbkJuLUtLS09LX09QYWVPZGRfZU9LME9fS09MSkc0NEozMy1GRkYzLUYtMi1CLUItazJFMjAyLS1uLXduRTJ5RUVFQjJ5bmt5Z0VmeW5FdmlqejJ5MkdKMnpnekVnd3lnd3l6dnlpZ3d3emlpaXZlYWFpZGZ1dWV2ZmlFMjItay0wLS0tRi0tLS1rbkJuQm5ubm5CbkJ3ekJubkV3eC1Fc25HSkVua0NKQkJCRmtCMjJueWFMZGZlYUJrbkItRXNuQm5CLXp6bnpLSzJuenpuRXp4MDNCa25CbkJ3em5CeUV3ekJuekJ5bm56anpkTEpfT0xfYU9pZ3dubkJueUVuekVFbmxHT0pLNEZwRi1GbkJPSkdGenl3bndrb0pLT0tfT0tfX19fYU9KQkVCd25FRUV3d2tud3p6enp6enp6enp6RUJ3bm53ekVzd3d3ay1uQzNMSzJCTEtLMnd6bkpLNEpLMjNKNC1GellzQ0cybEZvSkVDMzMySkNhT1RfYUxQSjhfT09KMzRKQkZuRndCRUs0SkYzRzQ4S180XzQ0SExMUGRhUGFlT09hTExRaXV1ZGVPZGFMT09PT09MS09lZVBQZHVPYU9kR09kR0pCM0cyRkZuQkItbkI0SzRfR0c0NEdKQzNHSks0S09LRndCLWtHX0YyQmtuQm5uQnduRUJ6Qnd3bnp3ekMzRXp3bkVqekVFRUVFNEtLMC16aml6d3d3d0Z6enZpaC15QzAyeWlqRW5ubndrRjJFejJDSkdHS0tkZU9LYU9fR2JkX19fRm8tbkVCNDhPX2FPRzJrMnBLM0VCekYyMDQyd3d3bnp6bm5FRW5sS180Ri0tQm51Ny1ENVAwTWo0LU5GbmVIbjk5ZkhkRXBBOWUxbXJVck1NeTZyYnlPYmFjVlVic1hjLTk1VlFxVS0wUkM3MmdmckxUVVg5V0w3UEdIT0tPTEthTExPX2FPemp6ZEtLOGZ5eTJ5dnp6enpqbnZFeXN6bi15dnV5amlfS2pFemZ2dmRlZExPT0tfYXVfS184S0s0T19PYXZ6bnd6ajJ2WXlpaXpkUWpqeXZqdnpqbkZKNDNGRXZ5eXZ5c0VWMnZrRy1vSkotSjJ2QzJuemZ2ZHZjeXZCMkVnd2t6bm9IS0pFS0Y0NEs0NDRGd2t6ang0SkV3b0xLMkVHS0ozNEtPR0ZDRksyQzNHS0tLTHVqbnp1S19hSzRLMkJsMEtLX0tfX09PZF9pZF8wMzJFLXd3d3puS0stNWtveTVyeHp6eWU5WGVWME5RR2ZRenA0MDlGcjJlbWY5Z2VtZW9lbWh4em9lZW5yenp6enp6eG9lZWVlSGVlZW1uclV6ekpyNnp6enpieVV6dHR0ekl6cnpydHphUDVVeHkxWFhjN1RPVk5PY1hlbW5DQm9lVk9YOUlIZVg5ZWM5Vi03UXlNUi1PMlZMWUNyek9jVFhlVi03UjdvUi00Mlc3dkVjLTE2VGtiLS0teFpKVjJzVWV4T2pqRXp6bEs0S0otLTJ5ekgtLTEwQzgtLTAtZ0ZWLTdWTkVSLTAzOHJZVi03V2VQUi0tM0ZpWC04WDdWT2l6dmxHSkYtLUdBbmMtcTdiNHFhdnp3ejQzS0otLTNJbjktLTE5M1ctLUc1WUJrLS03dXpvLTAzU1ZJLS0tWjZuRi1KSDNKZ3RWMU5aRmZPaXpuQ0dKLTAzWlVuVi1OWnktT2stLUhVQzctMThFcHItLUc5bmNzLS04U0IzLTIzaW5uRC0tMU8tMC02bENQVG1tbkN6emJXYTljLS04Z2xKLS0zcU8xLTNYUllDYnpLLVhsSUpqbWVnZW1lZjllZkRVendVeng5ZkhmQmZ4eVRUVFVwc1RVeHpXdHRmOWVlV3R6dTctMTlWazYtMmxKSDJuVXplOVZLY2YyMk91SzVPYnp6dU9MS1V6dmlhS3p6emZ6dnd3ekV3d3d6WUJ6QjBHRjVKR2FLT0pPR19fM2FfT0pCRzQtUGxOWFBtZkJuQm5Cb2ZBRFV6SnpiYmJiYnpweHpiWGUwY2NYOUJjNnMtLTFtbXgtNmxZT3dtZXh0elVyUDdjYy01QlNaYlYtNDVIQzJUNy05QmRoTXhGNkpPa3F3ZW1tbW1mOWUxOW5KZW1tbWVuenJ5VXlUVFV5VWJiYmJ6YnR6dWU3LXFCc3RxS09PWXZFRUJvLTQ1VG1BcVYtMUJ6eHEtQ0djREN4elM5ZEVNcnhvd09YN1YxOVgtNllJTkthT2duay0tbGVoM2xWLWNxWm5Rby1BR2hMem5BU3B4cE9ieGEtY1hjWFYtLXNqOUYtLVJqWWMtOURPOGFSay1KUm9kQzVWMU50dDZPS3Z6bkNKLS02RmxtLS1ZZjQ4ay1CVFhKaGMtTEVKN2FUWUMtMEJUa3dqSmh5UDdQMUxZdFFkX0tQUExiZVBMbnVhZnAteUVlZGR6ekV1T2l5ZGVLT0dkemVhS19qempqdUtLYU9hT1VFbnluQnp2bnpWeXp6RUU0Rm5Cd0JHR09KQkYzMzRHMC0zSktKRWtuQkJsS0tLLXduQ0YtUlVJcWdqdS00WXY3ZGFMbkItLTZ2b0gtRVl4eXRfdWVhWUJCRTI0Ri13VWp1Z29xT1djMDlGNEs1T0dPT1l5ekJ6RWxLLTFtMDJObkxOUC0tMzJoNC0wbTBxZ25xVi0xRlBDcS0tSDJHdXMtLUZSWEotLTdHdWUtLTM4dGQtNkgzemltZkd6eExQV2FYLS0zRTdDLS0xNmdCVjJPM0NaT3VMZWNuLW4zLS1SWDdqZ3lQLS0zRzVDLS0xOFJYVjN0M25iUF8zX2lqdV9IejItQi0wM1hXQWdmeHlUY1YtMDQ3S0YtLVhqeTctLUdQSEowVzdpQzZDU0tLSUlDSm5DQmVtenFVYlY2c1VhNVBYNncxNzExLVYwZDR0OE9Pd3dvLS03by1QLTNaUDNwaW40LS0xQ1ZCVi04NW1FTjBkN3JQdjloRUlCZVhySUN4cENBSUJ0eHJ0YnR0enRXVi0tVVdjN2VjLS1aUlZPay0zWV9maS0tM1NXbC0xSEUxdXJxN1YtMDZZWkYwSlluS0JnbHR6eTljLTFHdUVxLS0xRXkzVi04N1BfUi0tOEIwWC0tM2FlcC0xSElMOXh3N1YtMDhqZUYxUlp0MkJveENLTFY1Tk9hVGVWLUxIWGs1T1VuLTNCX0tqUm5FSnhLNnhTSUJuR3NPVjUtNS1ON2UwUFpmcHBkUWl2ZXZpdnZpdXZpdXZmZmZpdmlpaXV1aXZWMnZ4SkczRzQwMC1GMnpvRzQzRzNHM0c0M0czMDQzRkpGLUJfWEhDLS0xSHJIYi0tMU1sOVYwT0JQU1R5a0stLW1QR3V3LS0wQ2RDRi0zYlFyZy0tXy1iR2stLWMzdzctMUoxVGItbkhXU05tbkJtbkNCbkJvZ25BeEFBQ096enpVYnpPeklBQUViYU90YnBJQ3h0YU5IVzlXV3R0Z2UtT3U5ZEhjZTB1WFdhT2FOVGMwcUpfajVUZnVpeWZ1dnluLTQzLUM0R0pKRi1aZFotQ0VOLS1xS0Y1TWl2dnpvR0dKSi0tOWZabS0tNE5WRzBPSGo1SW1nbWduOW1nZ2dnZ2d6YnhseVV0dHhVeHJsdHp6eFVwOW1jZWdmOW5CeDlIeklDQm5JQ0NJS01iYU9XYTBjNTVPV2FVbGFPYVV4eHJJSm9nbXFUVXBLNmFOTk9hTjB4TVVOVDEtWFhjZWVlN2NONTc1ZWMwY2VjVi0wUDlRRi0zaGgtRC03X2pLbmFKMm55Wi1ZQV9uWUJuQm5FVXR0WFZPYzhhTUNtVExMS2FhTEtQZGRiaml1aWV2aXZpaml2Zml2eV9QUGVhZWZmanl5dmpqdnpFbnpzbzMtRi0zRzQybDRKLTJ6dkVCR0cwMExMdUpGLTNLRkswMDNHRkV5eEctbkV6dnAtQjMzR19KSy0tbXVJOXctNU9TSlN0YU9lamktLXdCenp6S0dPSy0wSmllTndtZUN6emFWLVRNUWdEenZsSkotR0FrMnZyeGtQZTctLU1WOG8tNkF0MEFDNS0tT1VSWHktLWdqcU1FcmFlVjJPVXJxdWVUZlZGbDIyRi0tanZ5Ti1QTkFneWRjbkYtWW4xV1JyU3BwcE1KZVlySm5yVUtxNmNlN1d6VFV6VVVVTlZOVXRzWDdWSmVjZTlYWFg5N2MtLTU0NDAtMkkyT0huSnNPVi0xTnhSNS1CbjZ6Mm1nZWVnZW5CemJ6elVidHNOLS0wXzcyRi0tbktsYzExT3hYRExLS09fT0tMUXZ6d3d3ekVubm5uS0YwUm55ZEJnaE1NTk4tLWRPZnlwUE1kZmlidmV1ZWVhUGFPT18zZWFmZF9KOEtPS0thYU9hTHVMYUx2Y3lFaWVRZXZ5MmwtLS1HRnBKRnp6LXlud3d6enllaXl2LUJ4M0ZFamp6VkV2VjJzMnVmazJHMC0tM0ZGMjAyMDAwM0pHMzNGLWRDX05ZQUFTS29wU2J0Vi0tNzctLVF1ZlotLUN4WVgtNWItTkNialkzRi0tc0dSNy1EUlNRNnY0LS0yWlRGVi1PbUZ1UUYtLXRXcDctLVJyazMtMkRSUWZGLU9iR19wX0xLSzRMUWp2dnZ2amszQkItLTJjbmtWLTBvcGRGLUJ1VVVFLS0xU1A1Yi0tMmZPUFYtMHFROEYtSnZMS0JsVi10dFlrT2dCLS1FS2ZtLUdiaW1PYmp6anp6SzRKT0pKLVFFVzYyOWZBRVU2YVQ1LUtieDQ4YU9HZVFpdi1uelZrMUstLTQtQmVpLTJjNGJfYUVGLTAwZlg3LS1Wc29aLS1GWUhILS03YndLLS0zS2VWVi0xOXltRi00NTZXZy0wY21tNHMtLW9QQi1vLS1QQ0RPT2stNDZGOWktLTd2amQtLW9Tc0JsVi11RU1JUVkzLTBHd1N2LS0xRWVNRi0wNnRUYy01WjJaTGstMkhVeVl1LTBkRzR0WS0tM2RoY1YtMUtoZkYtMDl3SWMwZWEweTVPZGRlUGZpaXZjLWtrLS0tMC0taEI4NWhJcS0tLVBQcXFRLUFDRGhZQmVnZjluQm95T3lPdHp6eEFVelV4cnh6eEtycVVTSG5FeVV6ek96YmNYWGU1ZTlYOTdYWFhjY1g5WGVlLS0xVXBBRi1TRmN4aE9YLTFlQjB4Z28tLUpkMzEtLTlLSlMtOXBCVnltZWZCbktNVVVhT1ZOTjcyWGRiLUxNdmVpdUxLSktNaW56enp2ZlkyQnpqRXp6WTNHSzNGSzRLT0dLRi0wSmkxNy11ZVpjTEx5dnd6WUdHSy0wS0s4aWdwenphOWNjNGFlY3c1ZVFlZWZlSzNpaWZleVZ5eWFQeXNueml2Vy15dml2amYzRzMySmRGRzVPSkctMy0tRUIyMDAzLUNfR0dGLTBNNFBjLS1mWVZKLTBMMVZJVi0xa2pTRi0wTk9RNy0tZ1hlSi0tTElkbS0tQUFYaC0tS2FpbWstLWgyWUotLUxZTW0tLWZIT2xWLTRRTW9CLTFmUXpHYlYtT00xRFFVS3JTVjE3WFYtUHNHdlEtLTBSOHhjLVBpOWhMZWUtLS0tNG43Z1YwdXVLOE92d29fRi0wU1BGNy1UaWhmNWppb0czLXJNTHFJTVN4SmZNcHA1MS1VazctWDdtVi0xdkgzRi0wU2lNNy0taXZKSi00TVUtWUwtLTVqMF81Vi0tTVc0bS1GZm56NHVlYmNudS1FMEszLS00dW1GVi0xeFFRRjBLVUxkaEpuQ2FPWC0tNWppOTZvLWpNdDdZQ0tCcHJvTk41NS1LQzktNy1QanA0TFBidy0tLTR6dVZWLTItcDdGLTRWZEVCLTNnNXI4YXdvLTZxM0dUbklCbkJsYU9hT1YtLWtYTEotME5KNUlWN2Yxd0ZPZVBlZHVlaWZmakVCd0ItRkZGRkZHMEY3cFdWNkNKZkNBSGNYQm5IZ3BJTjVPeDZsYnhySnBNU3hicE5ON1Y1NnJNRjUtNy1YNTc3Vi0tbG8yWi0wTzI1QVYtMjhvUkZKX183eUJtX0lDQ0FFSmdjbkJkSm9uQ0JnZWduSnBTOVhYZTduSUtDU1NLcHhwcENwS1VyYnpLT3phVVVvVXpLTE90dHhHVlY1NTctT1d0YlZXVjBhNnJ5WDdYNzBjWDEtY1V1LVV5OTB6YVBjWGU5MFhYLS1BQThFUi0tT2FwOS0tZ25RZGtINGIyVGhTcHJTclVTck1TU1VTeHBNS3BVU3ByTUtyTUtTcHByVU1NU3JyU3JTUjZyYnItLU4tLTBYNzFkOS1WVjdlN1dhV3UxWmMtY1ZlOTVCY1plNzkxN1g3Y1hWN1ZYOWVlWDktLUJ3LTQtLUxYSWFrLTlvVWthc0YtS2RaSGg1LS1RS09TUUYtMGY3QWMtRHBabkxRQy0tNWlmVlYtMk1fVEYyX2ctUmhDS294S1NSNy02eFg3T1ZoOS03N3VxQ3NMT2FPS0tLNEs0NVBLYWFkdWRhYWVkZGFlanllZWRlVHN6LS1vLWswLW56dWFmaXVlc2t6bkczRkIzRkczRUJua25FczRfT09HYV9LMDNGLUJCenZueXd6dnZ6RUJCa2stRVE5M0FTckYxNy0taGNWOFYtMGhvM2MtMXIxOGEtS0xzS3RuOWdoSUtvcEp4R2J6bHo1UGNPV1dWNmJaZVZYVi1lckNoTGJ1YXdvM0YtMFFnUklWMEFTX29UejRGLTBpcXNjLUxyVkVheWgwRi0wakJ3Ny0xcmFhTTBzcXd0aW1tbW9jQ3JVektyVXpieEplWUJleHJTSW9UNTB4TVVVU3J6cnJ4eHhycHBNTUlySTlnbkp6emFVT3pTclNVVXp4dGJYN09zVS1VT3pyVXh4U1NTcHhTcnp4enJyNTdjV3VlLUJjVlgtWDdYMTBicU43ZTdjZTctN2NYN2VYN2VjY2NYY2U5ZTk5OTdlQmhIbWhCbkJtZTc3OTEtNTExOWNYVi1BVFplUi0tUXMwWC0tQ3hGNC0yTS1FSHJNTlZWLTFzMThiLTBNMDlScmMtM2kzM0djeTMtN3IxcEJtaEV4cFNyY1A5LTctM2k2VGhiekotMHIya0xteFYtTHNUOWJ5d0tGLUNsOGFqYy01c2c3Nm8tLVJOeVAtLURCY1MtLXI3NUR3LS1BWlA4Ti1DUllMWUlyV2NWLUFaX2dSLWhSYjBROWVmQlVVenp4cnE3VmU5LS1ESWNHLS02OVgzVi0yX0tYRjBDbXJOQnhVVE43ZS0tRE0yeC0tTUJOc3MxcXRiR1RlZWVpZWJmZXZpdWZpZmpHLUZGLUZLLTJGLUYwLUYtLTZDRW9WLTJiMEVGLXBueDdoS2xWWC0tRFdCTy1JckdYNXBKZ29tZDlCZWVmcnI2clV0dHlOVXNXYU45Yy1pdU9MTExQamNuRjItLTBwX3VjLS11d0FKLUlTWm5uQ0lLV2EtLS1RZ2JkVC0wX3FKN0Nwckt5NzkxNy0tRG82MC0wTVBkd3BjMExpck80ZUx6amV6eXl6enp5eXpqemp6enp2dnNGRWl5bjNPSkZLS0pGRXd3S09LSkpLR2RfR0tLRzNKSzRLSi1FU3gyblNyUDc5LTVqMlhLYVBWbi0tX3Q0Q2dqdGMtMXdZR2EtLTZaUFhWLUFtYTlOLUNUSzRuVVNYWC0tMm4zLUYyNHRoemhySGNYbklxVXR0eGJjZDk3LTNqQ3hwdmgwLTFyYmlacEVhMS1KakVUZF9henpnem56Q19LSzRGLTBUVHoyVi0ybnJ3Ri1DdHZ6Z3MtRHd5LUxFcC0tTWNhZ3MxMXgzdUxLS0xQTExMT2VOd3pCa25ud3d6RUNGLTB1QUdjLWF4NGU1aWlpMzAtLS02ZFllVi0ycERXRi0wdjBwYy11eGh1NUt2eml2bkczR0YtMHZTOWMtVHhpbWF2eWw0RjBHVHRSYktwS0tLSU1Lb3JTS3hjUDc3LS01MGNWMS0tWC0walNNOHgtLU1sRkhzLVB5TXlyaXYzSi0tNm5qbVYtQXVJUlItLVVLcXU3d2pmMUdhYWVPZGlhUGRlZWFlYWRlUE9kZF9PR0czRks0M0c0NDNHM0ctbkJCLUVuMkIzUF8zSEtKS0dKSkhQZE9LSk9fYU9lT2FhUWVfSzRfRjNHM09fOFBLT2VMT1BlT0s5VGRkSjAxT2FQUHVfYU9kYU9fX09LS2FLX19fR09PT2FMTExPZF8tOVBQZWFQUGVmZXVlT0hfQWZlZWV1ZXVhZWFpZWVlYWFkZF9PZHZ2aXZ6eW53bm53bkVuenp6enp6bkJuQnpFRUVFenpud3pFbnd6enp6dml6eXp1dWF2ZXVlUHYtd25Cd3duQm5FZVBhT2FQYU9MRXdCa251ZWFhTXd6ZWVlUFB1ampjenZ5dndubm5FdXV1c0VubkVFRUV6em5FQkJCa24yQm5FMkJrbmtuQm5Cd3duMkJuMkIyQkJCa2tuMi0tM0JrLWstRjNGM0owRi1CSzhKLTAtM0ZsNDNKMEpKRkMwMjIwLUZGQi0tNDM0X0YwMi0zLUZvRi0zLS1VTEsxLTlqazZfX0tQenNuQy0wcnMydXh1Ny01ejZvTG8tMFVhN1ktLTJ5VHVGRnB6RWVnbktDQUhZU0lFSUJnbW5CZW45bWhKb25LS3BLcEtJSUNDQm9wS01LcENNTU1TeHh0YmJ5T1ZOTjUwVjU1MFZONTBWTjUwV1ZOLTBhLS0weExOLVYtLTcxMS1WMFI0dy1QZkJKLTVzQ25NcFVTekdjVmNYLS0zNkRQRi1hM1QyQ3BYNy0yMVJrYi0tN0w5aVYtM0NkeUYtRDdLMUUtLUUzeXlMUEItQXNkcnlwck1TclVNVVhWWFg3N1g3LTBsTnVDYi0wc2gtY3BzVi0yNHo0YS0wTzVza29QLS1ISmNPLS04Y2pjVk13dldfUGVQZmZ1T2VkZGRhT2RfT0xpdmVkYUxPUXN3d25uQndubkJCRUV6MkVrbkJsX19fSkpGMi1kZEZKQkIta0ZKRi0zT3hvM21yeVVlOS0tb05vMGstTF8wdEJ0Vi14OVVYUFZrMEtkXzJRQ0NLSm5LTVU2V3k2eDBhNU90V1dhQTlmOWVYOVZOaEJlZU9hT2FLX2FPYU9PT09PT09MS19fX2FMTExMX2FMYnpqampFbm5uRUVCbkVCbkJ3d3pFekZuQnpCbm5uQndrQk9KMy0tOVEySlYwaEZEV1BUajAzLTBlc2FJVi00TTNwRi1EZnhxQ1YtMExQTTMtOGZiWW5CeTUtQ3E4X1dhZFl6RXdMSzMtLUE1OUZWLUNaWGJSLTJnaERZay0tTFFrXy0wdkNzUG5UVi0wT25jWi0tZ3hFZS0tTFhidC00UUdMTm5JTWFUUDlWLTRkNE5GMERvWUdCeEJ0dFdlLS1MZFR4LS1BSmpnVi00ZkRnRi0xcTFuNzJiUTBUcV9menlhTHl5X19KYnpqeWl5RXZuem9Feno0SzQ0R0c0NDBKMEdKLS1BUWFvVi1oajR4UVctLVFVdFRzLTBRekJaLTJoenVJdS0tTTBXMC0zUVZwWHpVU1g5WC0tcjk1NGstNi1MVkQtLXM2dWRrLVUxMnBCVWUtLU5LYk8tLUI5bmtWLTU1Z1VHQUlMQVUtZWU5ZWVYZWVYZWVlOWVlWGV5TjllZWVlZTlYQXpienp6VVV0enh6cnphMWZ6cnpzN1hlOVhtZWVpVXpyV3p0emJ6enNVenRieVVVcnp0elV6enlVVmZ6TXp6enp6enp6enp5VXp6enkxU3pTeHpyelZjenpTcFV6YnJ6enp0enp6enJ6enkxY1hYZWNYZTl6enh6VjllZWVlOTlVU3p6enp0elN6enp6enp6enp6V3R6TVViVXp0VVN6enpyenpzRDJ4enhyemJ4cnpiVmVYVXpNTXpienR6enR5VVdWWDdjWDdYN2NjWDhydFZYMlZjMWdWV3JWTk90YTFVYmJhVDZieU95VE1xWGdncEZlbW5CbkxwVGhTY1hYb3BmSnBwVWhTenRfVVNVcnhTeFN6VVVLd2VwenpuTXpVd2VmTXpTQ0pYQUtSZW1nZWdlZW9lZWVlZWVYZTk5ZUFDTXh6VXJ4elV6enpQbWVjZWVlZVhlZXB6cnp6enI5ZWVlOWU5ZWhVcnh6cnpyeVV6enp4d2ctM3NSVWxnekstMXdHZkJyVVhjLTFzXzIwY2stOGxBUlFNc2MtNnNha1dhVVlzRy0tQkpFeVh0eWdTUjBLR013emtLS19LS19LSktLNEpSbkVFRUV6RW53em56d3p3enp6d3p6d3pqdzN3a3pubm5rS09LR25FendFRXd6QjB3bjJ2eWl6ejBuRUVxUHZuenp6d2pqRWp6RUV3em56ekV6endudnoyamp2dnp3bmtUenp6ajJ2em56dnp5enp5enp3enp3enp3end6enpFbndua256Zmp2dXpFQ2ZqRHpFQkJ3ekV3ekV3end6ekUydmZ3ems2bmp2dy1uekVFekV6eXp2anZMaXp5eXp6enl6enp6enZ6enp6emVPUFBLZF80YVB1d25hTEtfYU9lempFd3pubm4yRUVubjJ3enpFbXd6bnpFbjJud3d6em53d255d3d6enZ6RXpud3duRFB6end6enp6dnpFdnpuempFeWpFRW5ud3p6enp2enZ6eXd2aXd6ekVCd3p3enp2ZXpueXV6akV6enp3em56and6and3enRmdnp6bkVFRW56enp6enduMkJ3dU9fZml6enZ6emp6akR5d3pqakVxS2Z5dnpFT2Z6enlManptenpuMmhQampBd3pqdmplenZuZnp6empBemZqanFLT09fX19PTF9LS0tPS19MS0xPX0tLYUtLT2FPT0xPT19lUExpS0tLTEtLTEtLTE9PS2EtLXdOLXd3LS1EQmc1Ti00bGF0SXljLU1ZVWZhUnlDRjA2NnExQ0p4YTVYLS01RjZtRjd6OUJ1Z2ZFVVNyU0FyenhCZWZCZUpjcnJ6YnR6VXpIbWZVenp6dHRWWDdYN1hYWDdYWFg5LS15S0dHVHNGLTJta3cyay0zdFFzdGp4NC0tQmtkc1YwRE5LN1B6R0YtNkI5a2ktOXRYa09fS196em5sLTBSb3ZYcmMtLU9lWlctSVJxVFhvZVhlZlV6enp4SFlVeVd6enp1OVhabVplNy0xdG1BV3pKLTBuYmVZVjBEUnhZVHZHLS0yRHRvNy0wYllsSi0wbm02di00RFRkQlR6eXp2enZsSktKSzRLLTh3eEpUcnJyenJ6T2NlWGNlOVYtRFRnOVItZG5zYllFeHhyeVV6YWVlY2VlYy02YnoyTGstMm81R251LTF1MllPdjMtMG9DeUFWLWlhTEFVcC0tQ0NYUlYyRGIyb09Pd3p2bnBLRi1wcFlXMGJWVmFPeVV6enpyeHB4cHpQay0yZUJNYi04eEdvZXJVVXh6cnk5WGNlOVhWMnlkUTJPS19PampuQnduSi0tcEMxOS0ydWxpTkV5ayI7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlIuZU0gPT09IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiA9ICJKSkFmMnVQNnktMG5FaWl1eXl3bnl1ZXVUYmZldmZ2dmppdml2aXZqZnZpdnZpeXZ1dXlFZ3pqanp6dnZpeXZpenZ2aXVOeml5dmlqdmlqZnZ5dmd6dnZ2dmZldTAtRi1uNWFfR0c0S0pHR0czRzNHM0ZGSkZtS0dKNEpHR0dHM0dKSkZKRzNHM0czMjNHLS1rTFBlZHVhS0dGR0dHRzQ0M0pKSkpKSkctLUItQzBGSktfXzQ0My1CSi02NndtcEJuSm9wQ01KcENDQ0lJSUpvb3BLS0lDS0NCbkNLSmdvb29wTUlET3p6U3pVemJ6elVTeVRVeHhycnJyclAxWGNYWFg5SGNuOWNjZWVtZWNlN2NQSW9lWDBzV1dhT1dWTlRPY1ROTmNOMFYwVjUtTjBhT2EtMFYtLU41MGE1T2J5Yy1NMHozVFBPZGdCbkJGME5PcHhwTVY3LU0ybU1pTGJpbnowM0Ywc1R4OG1mck5ULTJsNlFFZE13d3AtNVhYN1VNVFAxVjFHSXV2YU5uLTVYZnhycHc1WFYxR05URWZuNC1fWHZ6akFBQTltZkE5ZWQ5ZnB6eVRVenlVYVV5T1gzbjU5TlRLTExLSFBQUE9fTEs0aWlkZWFfT19RZWlkZWVhTE9MTEpHMy0wZWVkZE9hUE9fT0tMS3pFem56amdubnpCeWtrbkJ5RVluQnl1Zy0zMzMyRWxKMjIyLTJ3QmtvMkJuQm5Cd3d6d3gtOVk2ajZycnJrY2NjLUU1Y3RFaXpwSkYtYURZZ1NNR3otWDEwRzZWeWppeXV1UGVpdXpqaXZoM0czSzNHLS1rLTlKR0ZBUEVJWlNLQmdoS1NNSXBLcENKbkk5Z2NYZWNjZWhIY2NvZVhCZW9wcEtJSm9naElIbkNKbkptZW1tZWNtZkE5anlUVXp6emJieGJWMFdhVFQtT3RXV1dWMHp4dHlVTjZ5VXpTeHJTcVRVenRhTjcxMTkwVjctNVYxNVZVeS0tVi1seEhFZy0tMzNvTC02N0RoeXUwLS0zRm9MLS03YWh3LUxHWW93Znp1LTBIRk1JZkYtYUhXV3d4eHhjWFgtRThaclVkZlZsLS1USUpMelNyMTdWMHdjREx2aXZqeXNHSzNHNFhhSmIxenBwSUpwQmNjY2NnZTdmVXh4OWVvY1g3Y1hYNnk3WTk5SGVnZ2VuOW5KZEFIcDlYbnA5SUlKZklDSUJkQ0tLSUlNTUptZTE5ZVh4eHA5WDlWVmZFTU1NU0Jwb29lN1hDU0JvbWNjeHhwSGNyS0tDTUhtWFhtY3hvZVgxbXBKZTcwQnJNSm1WVi0tZ3hFeElwSmNYNzFuS0NKbWhDS0tDSUpvb3BDS0tLSFg4S0hkOW5LcktCajZ4clNyS3B6NnhTTU1TcktwcHdPYmFQLVV6U0NBSUNJS0NJS0tLQ01NS0tDcENNTVNycnJLcEtwclVTcHJNVVNNclNwcktyU3BTclVyVVN4cHhwclNyTXJNcHJTU1NwcE1LcHJTcHJyU3J4S1NVU3FVR2JxVWJicnhyU3hyU3JLSFhYZWdnZVlCbkJnbW5CbktDckpuS3BJS3BCbktDTU1yU1M5Y2hLS0lCZVg3N0VJQUU1T3hJSUtLS0lJRUtTS1NLS1NLS01LcEtwS0tTTVNTU1NyU3p4eHh6bHp6VXp6enp6VXhyTU1NTVN4eHhycnhycnh4eHh6VXpPenJieHpyeHp6enc2dzZ5T3R0dHR0eVViYnlUVFRUVFRUVFRVdHpJcnpiemJ6YmJhLTcxLVZWVjc3Vi0tNzcxMS1WMS0xLS0tNTEtLTEtMS1WMGNOLU41Vk4xZS1lZTctMW1jNzFYZTlmSUJjVlYwV2J5T3p4WC1WVjdWTk41VFV6VXUxY2U5bWVuQmVjbWY5Z3hIYzdjN1YtNzc3LS0tNTBWUC1WLU4tMFd4cHBTSnByNnp5T2J6dHRWNnJNS3BVeU9idHRicnlVYnpXYVAwc05OT1g3NTdYOTdYN2NlOVhYWFhYVmM3LVYtWDdWWDUtVjdlZUE5bWVuQTlmQm5DQm5JSUpvb3JNSVJPYnBJS01KcHBwU1NTTVNvZVg3MS1WNzc3N1g5N2M1Vi1jY1dWMFZYNzctLU5ONTUtTi0tN1U1MTExY1hYZW5CY2M3ZkFCZ2NYMTE3WDdjLWdmOWVtVi0tLTEtLVhYWFZYN1gxNzU3OVZWVjExN1hlZDlYZWNYWC0tV1Y1VXp6Nnp5VXpyU3JVVWFOVWx4dHpYWFhlZTE3NzdYMWUtNU5PeS0tV1Y1T3R0dHRhVFV6eVVyeHh0enp6bHpNVXJ6enhhVXR0YmJ4V3p4cFNvbkJtcENDSnBDS0NJSnBKb29lQUNIcHByU3hhT1Y1NzdVNnNPV1YtTk5ONzBXVk9XendUVFQ1TlV4cnlVYmE1Tk5PYmExY2M3OWNYWDE5OVgtOTFYOTltaElIZkptWGd4eHhwSGU5WGNjWDk5N2M3WDB6Vi0tVi1ON1A2azQ5VjcxMS0xMTFYLTc3Y1g3OW1tZUhlY2NWMW1kYm5fVW5vLURLTlZTbzEtTzlrYWlLS3p6RXpwSy04X1NMRXp6emVlZVYxSGluempoMy04X1VzTTltanR5VFZCSGs4QWZpeXZpdml6cEc0M0czR0ctLTBPSXpWMm1uak1hTEVCeG4yOW1jNFNTcHByU1NTVXBycktwclNTcHBwS01NU3JNcnhyS0lLSGhLSGZJS0twSUJwQ0lJSnBJSm5JS3BTS0pvMUFLS3BwcHhwclNwcnBNS3BoSUtoTVVTckNLTVJwTUtyclNNTU1NU0tVVlV4eFV4U0plMTllZkFLS1ViS25NeEtLVUtJS1VTdGFTclVNVFVyemJ6eHhyU3p6VXk1U1NLdGJxcHJUcHJ6U3h4U3JCWGU5Z2hTck1NVXlVenpieVNLclVLcFVTcFNVTXRWLS0tRC0tMGFOLVg5OTk3OTc3VlZlOVhELTE5WFgxLTlYY1hYWFhZeHpVdHR6YlYtN1ZYNzhieTByVVNwcEtNYnM1LVY3N1Y3N1gtWDcxLS0xNy1YLTdWLTBXV1ZOLTZieVRPckplcEtwU3JweHJVU1NJS1NLU3pycnJzNzk3YzE3MTFPYlVTeHhwU1NTU1NTeTUtLTc5OTdWVjZ6X3JyU3J4cFNwcnMtN1ZYMTdYZVhWWE4tMTEtVFVVU3h6dHlUVDVPYnpyU1NyemJ0YmJ0VUt6cnhyU3h6VXJ6VXpTaEtoTUtyeHp6enh5TXR6cW5BQTltZ2ZBQUFDS0lDQm5LemJiV1diYU90YmFPYVRVYnR5VXlUVFRPYU9hNTU2enlNeHJVdGFUVXpyeHJycnpTenh6YnRhNU4wcy1lZTk5N2NYOTdjWDdjWDdYNzcxLVYtYVQtLVYxN1Y3WDEtLVY3WGVhNnR5NVQ1TXRzNS0tNS01NTBhVDU1TlVfeVN4eHRhNU9WRC0tMFZONU5ORC1OLS04YTZhNU9zTjFvZzU1T1ZWT3RhLTc1T1RTcWhDTXJCbWhNYmJ0enp6enRhLS1OTjUtOFVzMFYtTjFlRC1YTjBWT0twcHJhVDE4enMwU3lPVWFPYTVPYU4xLVZjWDdYNU9TcFN4cE1TcmE1Tk5PYlY1LU4xOWNWYy1XX0tNU3JyeHh6dHpzTkQtLU1KcEtNcnpiX3B5VE16VWE1LTBhNS1YLVZPSU1NTVNCbktLU01yTXpwcnphUUJlbjFjZWVYY2NjZW1wcHJ0elVVU3Y5bW1mTXJ4elVNeHBVVVVyemJ6dHJ4eU96VXhyck16YldiSnBwU3ZDN2dtZW5BOW1nZ2dmQUJnbkJmOW5CcHBVcnR0YnpVekNLclNTeHpiYVV4UGZNU0twS25KaFJwSUFJSUtyU3pVTU16eHp0eVRPYmFUT1dXYVRUVFVienpyemE1T2JhVE9XYmJiVXJTclN0enlVVXpieU4tLXM1VDJycy0xWGVYZWVmQm45N1ZmQm5JQmVtZjk3Y1hjWDdiV1YxMTExYzFlaU43Zi1BQmE2czE5bjc3WDdnOTdjY2VYN2YxMVV6VXBwcnktTjBNTUFJS3pWNFVXX3JKb3BwemE1NS1UTVNzTk9ienRhT2E2S3pWLTc3Ti1TS0tTVXpiYU9hT3lVdHp6enlUVWJ0enhyc09hT2J0dHRTcmFPV2FPYnp6enp6X3B0YVVieU16enlVdGJWVXlVclV6enp6elV6enh5UU16elV6enplZWVlWGVlOVhlZWU5ZWVlZWZLTUlLY2Y5Z2duQUJlbWVmQ0NLenJMZjk5WDFmQUJnZWVYQUtTU01LeHh6VVNyU3JhTVJwU3hyUUE3WDdYOW9vcEJvMU45Z25JS0NJSm1tbW5LSUtKb21uN2VtZk1CYzUxOTk3Y2VuS01VelBtZWdtZk1NU3p6eU5BOU96elVVSUtNVUtyS3BTU3JVcnh6YTZTck1TcnJNU3JVVXh6cnh4eHJVU1N6U1N4U1VTeFNyU1NyU3JwVXJNTVVTcHJyVVVVVVNwS3J5U3pTcnh6enhwelNwcHBycnpVclNwU1NDU1JwclNNS0twTUtyTUtLQ0lJSUJvaElCb25BQUFCbkFCbWdlbWhCbW1tZWVuQm5BOVg5ZWNjZWVYWDdYZW1tY2VtZ2VmOW5BN2VuOWtlY2VlOWVYZVgxLWVuQmtlWDdYZVhjZTkyVlhYOTljZUFDQm45WFg3N1hWVlYtLVg3WGVtbWdlZVhYWDk5N1ZWYzc1T1ZlWDloQUFBN2VlbWU5ZVhlOVhlZWVlOWU5Y2VlbW1tbWY5bWVlZ2ZIZW5CbWZCbkE5bWdnZ2VtbkJnZ2ZCbklIbW1la2VlY2VYOWU5Y1hYWG1vZWNlZVhjZTlYY2U5OWVYbkJwQ0JwU3JTclNyTVN4enp4eWVlZWVlbWtlZW1nZjlwcHJVelVIbWVYWGVtOTllOWVjZWVmMWRiczE3ZWNlcEtyTWdnOVhlWGNjWC1YZWVuN2NYZWVuQm1uQmdoQ0JnbkJBQ0NDTUNLSm9oQ0NNcnp6enlVenp6enFvZ25CbW5DS3ByTVNNQUNLcHpfd21vb2dlcENLck1TTVN0VVprZWVlZUFIMTUtMTEtWDloQ0tNU1JvbWNncEt6cHJwcHJzMHpfcktwcHpyU3J6U3BJS0lCZ1htcHJyVUtJS0tydHRwS3pTVUJvbW05N2doSnBTeVV6U3p6elVienpVdHJ6ZkFJOWVwbkhjZWNlZW1lZ2doVVV6eHpXYnp6cmJUb3BNU3RhNU9WT3J6elVTS1VVeHJzT3JweFFDU3JJSUtTeFNyU3pTcnpVclVVdHR0enRVdGJ6eHhNYU9WLXNPV1Y1LS1OTk9VelV6eHp4elVVclN4cnJVU3JyU3pyclN4U3ByU3BwcHJTcHhycnJVVXJiYnR6cmJicnp0enpyYmJ5VFQ2YlN5T2EwYVRPYU95NVQ2YVRPemJ6cHh4eHhwelVTeHM3WEVTckt5T1VydGFPYTE3enlVYVRPYU9TeHByS0NLZ25JQUFBQm5CbktwcHBwcHBKbkhuQ01KbkNDS01TclNTS0tJQ0NLS0tLcHBLby0yQVlGREItLU1QbnMtLWo4dWstMFR3UVY3bXpPNmlldnl5dkZHSzNGLS1xTlgwenh6eHJYY2U5Yy0zbUtVdy1ET0p1enc5LWxCa055dXV1dml5empKSzQzRzAwMC1PYVBKRXByelNLTXJya2NjYy0xOTk3LTJDOHBEby11UE9xd2Y5bW5iYnR5VFYtMkp6di0tNWdYVC1DQ21TVXZ2R0ctLTV4c3ktMEQtckUtNGItcXpTcVg3LS1zTW1rLTBsTkVWLUlaMG5rLXRtNkVuRk4tUnQzQnZnRi01UmVPVWMtb3ROQXZpc0czMERSb1p6VXp6enJ3UDllZWVjYy0zdUpwczBlU1NLUnJNR3pyenJyTS1WLWVYWGVYLS0yZnBuLS02TWlULTBEb1hELS02VUxELS1FMmxnLS1UR2hzLS13cmtrLTB1TkFWLW5weXp4LTBia0NFRi02RWVMNmpHLTVicEpRQUViYVYwbnV1YnZwLTBkeWEzbWhyay0tQnpNS3pGMjh6TU96ck1VUDc3OWMtZ3ppWHVma0ctMmJ5QlFyY1YtSi1JaFY0OTBlbG9wSUtLSnpsWDcwVi0tLTJGQ1B5Vi1IVmxheHBYNy14MF9oenZ2R0dGLTEyX0NWMW82TENhZUItLS1WeTRzLUsxNXR1Ui0wY0gzRVAtQUZhbHlQZi0tMXU0NFd4eHhyMTdjYy1DRmtxVHVzQkctMmNPNWpNY1Yzb0UzWXV1aUIzRkYwUDd0V3JyZTktNEdMUlVoLS0xOXJSVi1KTjhuay0xQjdpVi0zT1FBLS1jcE56VjhvUXhyamppenl5dzRLS0c0NC0xZC1lekdWLV83N3d6dkdGMGVKUVpteEwwVi1DOWpsdkYwOU9JMHJUWC0tSm9JMGstUFREeXlWLTQwb0stLWU1QWJWN0syOU1fT0xNZmd6bkVCNC1JZnJFTUFTcFNVU3EtNy1OZWUtQU5hU0R5eDNGMEE2OW5wTC0tMXFvUDZidlZGLXF0bE54Q0tDVWEwVjdWMHhxT2d1dWRhTnpuay1HMy1MdnEyUnJPYy0yTjdTT2Z2bEctMmczTEZtbktVcmxhLTdYLS1WZzAzMUExQUpnb3hNU3Bvck1TU3ItWFYtLTEwYU5YZVYteTdDVlFmejBHRjBSSWNOcHRhZTAyWGRzaUxUZXp2enl5eXpqekdHR0dHR0dHRzMtLUdSVlQtUVh0MFRUeXl6d0s0R0otcjVLMGdlbkN4dHdULVYteUJub3RUdmctRi1SUjRXeVZCTnVDdGRlanZZeWkta25CTE9GSkpGM0JTQWpuTVN6VWJzWDlYZVYzdDB2Zl9menYtR0Ywd1o4YnhyT2U5LS04QVFBLS1ITjFtLUNabEdUTFJ3eC1jbU9Oekl4cnBycHBLcHJVeVV0cy1YY2NYMWU5N2NYYy0tXzdwdzAyOVFiZ29vbkpVUk9WNS1WLWlKcmd1aWs0LS1tZGpZLTB0UUFkYVJrLUJpQ3NzLWFNUUxUakotLTNqVWFWNHRVcUF2anp4NUtHRi1ZQjdyd2Z6d09lVnVPWGxPX09fX0tiajJ2aXp1dml5dXV2ZmV2ZVRpdml5bnZZemllZmlpZWZ2ZmlZdmpCLTQ0NEczRi0wLTIta0ozMDRLM0dHRzNKRzM0LS1GM0dKLUlCYkd4Uy0tM3lPdzhQUGRfR2FhaUMtRXVlaWJ2eXZ4LTMwNC0tQy0ySUJ6Y2dnbWVlbkNNU3J3T2FPektIbW5yVVN4elRPdS0tVjdWVlY5Yy15UEZWUHVmMC1GMGd0MFpwS3MxNy1hVFBoT2lCRnhSeTJabWduSmVlWEFJQ0JuQmVuSnpTcktLcnJTU3JLcE1LSm5CbkNLTVNNSUtNcnhTT1YwVjB6elVLU3BwcFNLU0VLSUVTT1YtT2Ewc096VXJNS1NwcFNVTU1rUDc3Vi0wYTEtLVZQLTE3LS03MS0tNy1VeFNycnJyU0pwcU90enpPWDc3MGhCY1g3VjUtLVhYVjExY2M3MTdYN1g5WFg5OTk3NzdYN2UtX2NoRExMaWlpdllFbDMzRzMtVm9jazI5ZlNwU0tvbkNNVTVPYU5WLU5OWDdjMkRhUVl0UGp6dmpmaXl3R0szM0czRy0weERsenBVeVg5VjVQU3gyanl1elZHR0stMENGWldud05WMXVYRjBfZkJvMUlKSm9TU0puQUNDQ0twcFN4eVVWLTExNy1ONzExLTZldmxhdjQtSnBTeVFLVVNTU3BhWDUxN2MtYy15ZzZsdVB6azNGMENOSlFweTktaXVtQm5hTEtLZXVkT0tHX0tMS0xMTHVlTE9hUUVFakVqeWluRXl6ZWpqbnNrQm53QzA0M0YyLW5uMnpFMkVFb0tHS0ZBU09kcG9ySFg4Q0JoenhyYVVxVXpTbHpTWDc3ZWVlWEJjMFYtTGhpa3ZXLS1LbWxMLUVmZWJETFRza2stWU1lLVJyTVRWN1YydXlDQ2FQRUJDLTVxMXNqSzZhN1YtQTJJaC1BcTg5MnJNVU5QN2NjLVRsQjF0di0tQU5zVkJqVjJ2NmQ2YU93bnAtN3FJR0FJSmxhTlYxaW1RUU9Qc3ppdnd6RThHR0dHSjB2T0R1UmhDcnBwQ0JwVUxONU43Tlg5MFdYLTZncHBxUGstR3FTWGZCbnFPeHRhVWVtZWMtNW5uVHMtWVBEMnd6NnJlOS0zUUdtel9fYm5uby0yUEpRRC1LaEtuVGFhVG4tbkYtMFBnX04tYXBoVXpqNEZLaGhSYm1oVXJLSG9oSXpNcHhycEtLS1NNS1NLeHJVNU41T2FVTC0tWDExNzc3SGY5VlgtTjctLTVQLVhIWGUtMGhoY2EtV3F0cU1DcHBwcFNKcDZsdHo1TlZYVi1YMTdlVjBRVUpiakotblJFZnduQndPdGJhZS1JaUdHYUxQdkVrMC1FcjdlSTluQ0twVWEwVi0tMXZfWlNmY2wtLTBUN1pjMFR3c0xQTnpnejhLNC0tTWRDUC04ak1UcU1uby1RVHY2QmZEVXMtQ2pTZ0xkakJHLS1ya25ZVjB2dHRsZlctMEN4VDJtY1VWNlF2NGRhZWZma24zSjNCLUVVT1hCamExQ2ppZmlPdmRfTGRLS2FhT2FLLS1uQnc4YU9GRmVlS2JmaXZ6aml4M0VuLTJFbm56LW4tMy0yVVlUaS1ia0FRNUxMS2FSemd3bnpuR0otTVdKQ1JyNU5WMHdCeWxjd0YwRDZqYW9sYS0tQkpaeC0tTmZnWC02bFJrYXYzLS1zeF8yVjdSVW5VYUtfYUxMUWp6enotYXRCckk5bWdtbklDQ3BDS0xUT2FPenMwYU5PV1Y5Yy1FOXN0c2thaU1fLXBJSm5Lb3h4enh6clVycnh6VXh6U3JVU3pTcElTeHp4Ynh6enp6cnp6cnp4YnpyelV0YS0wWUJlN21mOWVlVi0tUDllZWU3WFhjZWNWWGVYY2VBOWVlZVhYLWM3VDlCZWU5OTduOVgtMHdxQzJ5bEY0aVE1ZnJ4U1V6SnpxTlg5Y1g5N1Yxd3I2RXVzbEYtWWJZM3hTVWFlWC0teDFKeGMtLXVEbm4tNlM4d0thUGVkdm4tRkZCLXplYTZSZkVTclNxNy1XWC02cFBWcU54LWR1bjlySUlLTVNyU3JTeHhCemJ0czdYZVg5N1hYN04tLS0yTVhHRjNpbERNbnJTcHBHYTUwVmVYY0hqUzBqT0xLT19MT2FLX0tfS19MS0tfSktLNEs0S0dQZWRhT0s0NEtPUGFLXzNhZWZmZmVUeml2aXp6enl1dmtCend6c3pFRW53bm4tbnp5end6djAzRzAwLUIyRXpCRUJ3ekJ3bkVFMi1vdzRTRUlKbWNjY3h4clVKbkJvblNycnp0enlUT3RzLTlYN1ZYN1g5LVl2Qk4yd3d3d3p2dmpqenprMHpPWFRVeVV4elYiOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJSLmVNID09PSAxMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSAiQzBEWDBOUDFWLS1RcWVhZG56emp5bkVFenpqaml2ZGl2ZmV6amoyQkJ3enduRXp6enp6RWpubnZZQkJCQkVCbnp6LVVWLWhmbHpVVVNyclV6U3hTeHprMGExLVY1MEstMHBNaXVkZXZmLXp2ZmVCbnl2aVZGLUYzMy15emdwM2JWVjAySUtVckhuVXp6cEh6NVV6VXpTS3JVcnpieU5OLU96enh6VVVVU3JTcnJydHp0dHpXYU9hVFV6U3h4YU9hT3hyS0JuQ1NLQ0lNU0tLS0tJQnBJSm9vbklKb3BDSnBKcENDQ0JuQmdnZVhuOWVjY2M5WDdnZVhYbjllZkhmQm5BQmVtY1hYOWVlY2U3WEhYZVhlY2VnZWVWVjFlZTllWDllY2M3MGVYY1hlOWVuQTlmQUFCbkJuSnBNS3BLSm5CbkhtbWVlWFg3WDdjY2VYWGNlOWVlY2NYVlZWVi1WZVhlOTdYY2VlOWY5ZVhlWFhYWGNlV1ZXQmMyOWNYN1YtNmFPYVRPV1dWLTFYWDE3LU5PdFdhTlZuQm45N1gtN2NmOW1tbkJlbVhnZWNlOUk5ZVhYb21nZWg5ZVg5OWVlZWVtZjlCbW1lSGdlZWVnZkJnZ21uSG9lQUJlZ2duSUJnZ2VlZWVjVkk5ZWVlbWVYZTdjWDEtWm1mSUtDQ0lKb29vbklJQm5BQUFBOW1tZ25JSUJuQnBLQ0JuQ0NDS0tLTVNLSm9vbklCb2hCbW5BQm5DQUJmQTlnZDltaEJvcENJSm9uQUJnbW5Kb3BDQ0tKcEJuQm5CbkNKbkNDQ0puS0JvZ2dwSUtDS0otVU1TR3hyTU1LS0lJSVNyS3BTS0tLS0pvcENJSUtLS0NDQ0JuSUJqU3JTU3BLcHBxVUk5Y3BLSUtycnJLU3p5VXBLcE14UzVVS3hNU3JTeHh4cFNyU0twSXJIeHJTTVN6SGZyeHh6VVVVU3hyU3JTeHh4clNyclNyU3JycnJyclVVeHJ5T3R0dHpidHR5VXp6YnR6elV6enh6elV4enJUVFRUVWJ5VFRUVFRVYmJ4eTBieVV0enlVenlVenp6enh6cnJTclNTU3BwU1NNclJOLU94cFNNenR6Ynp6elZVckxVU3BwclV0eEtieEJmclNLSnBLS0pvbklDcHBLSG5LS0pvb3BLSVNwcFNyTUtyU3JyVVNTcHh4TVN4cHJVU01NU1NwS01TdHR6ekk5ZjloTU1NU3JLU01LcHByS0tIbkNTU0twTU1TU3JLS0tLS0NJSUM5Z25Kb25CcEtBS0pwSnBCcEtCbkNwTUtLQ0tDS3BLU1NTclNyTU1NTUtyTVNTTUtTU1Nwck1NTXBVS3BwU0pwS0tLS01LU1NwcElNSXBLS01TS1NwS01TU1Nwck1yU3JNTVNTcktwcE1NS1NTTVNTU1NTcHJTTUtLU0tCbWdwclNTcHBTSU16eENVenByTVV5VE9iYnlVenp6YU9hVXp6elV0enp6VVVxT2FVeHkwYnp6emJidGFUT2FUT2FPYU9iYU9hNU9XYmFPdFdhT1dhNTU1NTU1Tk5PV2FPYU9iYU9hNTctNldWMFdXVi0tTzk3VldXV2FPYmJidHlUVXR0eVRPYU5OTkhWMFYtTi0tLTktVi03Nzc1Nzk3NzUtMHRhVE9hT2FPYnlOT2E1T2FPV2JiYVRUVFRUVXp0V2JiYmFPVk9XYU9hNS01Ti03WC0tVi01MTdUNy0tLTctV2EwVi1YN2NjWDctNy03N1ZWLTUtNy01TjE3WDdYVi0wVk41LU41VE5OTk5ONTBhTi01T3phNU9hT3RzT1dXYU9XYU9XYU9hT2FPYU9hT2JhT2FPYmFUVFRPdGJhVE90YU9hT1dhT2FPYU5PYU9XV1dhTk9hNU5OTk41LU9hNU5OMFdhVDU1MFdhTk5OLS1OMGFONy0tMFdjZWZJQmY5ZW45Z2VlY21tZjllQUFBQmdlZTllZ2ZCZ21lZWU3Y1g3WDc3N2NjZTVUVFQtVlZYMWNYMWM3MTk3WDk3N1g3WGU3OWVYMTVoSFgxMTcxNy03LVYtVjcxMTc3VlhYN1g3Y2UtVi0xLTEtLS0tLTExNy0tY1hYNzdjZTEtVlZWLTB1N1g3NzcxMTc3NzExNzdWNzcxLTcxN1ZWLTk3N1g3N1ZWVi03WC1PV3hwU1NNU3JNS01TU3JTclN5NTE1MFdWMFY1T3pKcEtDS0NDVXpTclNTU3JLclNwck1LcHJwTVVNTU1wS0tTcHpTeHhyVU1TU01LcHBwU0NLS1NNSVNNU3JNTVVVcnJTclVLU1NwcHBNcFNTU3B4cnJTS3JTcFNNS0tKaFNNS3BwS0twcFNLS1NTcHJ4dHphVVRPYmJhT2J6enpieVVieTVPdHpydHpXc09iYmJ0enR0YnR6dHphVFRVcy1vLTlTdXZrcEYtLS00R04wLS1Ba3VldmtrLTBaLTVEelVVenpVTU1TclVVcnJ4enpWMGsyNG5iRUYtNzJ1UHMtMzFsZlItWDB6dkJncE9zTi0tLUZqaC0xVmFoVVItMDMzcGx2aXZDNDQtYlZwMTJDVXp6cnhwenR6enp5MkE5NzllZVhkOWVYWFZHa1BjaF9PTEpLS2FfT0x1amp6bnd3a3pvLUVuby1xMzJXUnJNS3BrVjctVi0tN2pYazItSXZXOWUtN3h5U3BWMmtaLXZhYXprMC1IV0FPaktIcHJzV3h0YTdjY1YyRmF2WWl2bDNGMmNJc0FwcEtNd04xMTdYLTgxZy1pZm9GLUw0TjlVcmtjVkRGZlB6X19fYmp2ampFQjNCeXZFR0pLSy0tV1FsdlYwa244UWpvRjBOUG5HclNjWC1FMlY2eVB1RUYzLUQ2LUlTR1gtNDJiM3JoLTBOWUhfb295LTNQOGVFT0pGR0dJQi1CLTAtMjA0M0xhUGRhZWVpWjMwMDAzRzAwMmotMDMtSkdGR0otNEstMDNHLTMzMDMzMzBOQnpCLVV6ekIzRHZ6dXpCeXlmaWl2aWVpdmlmZXZlZmp6eXctRDl2bHhxWC1BNTh2YU9Zdy0wN25GLXJGUFY0bGJNNGFhYWJCbjNCLW1DNmZCbW1qU09hNU4tMjVvMzVvLS1DaVlOLWdRU1pQVHcwLS0yUWlYLS02NllKLTlGVDZDTi1CSFE4amFkSFF5ZGRjeXZHMjIzMi1GLThIcjhrLS1kY2ZrNmRJZXpuOVlwSUJoQzVPYTZ5NVVyV1ptWDcwQzJKVnRVenpwNEotbVhFandvcnJxNTU3ZS02SVFteXY0LS1kbW1FVi1KdUNNay05U1ZsazNLRHhSdVBpdWVPYmlfSkdUeXljbkJrLS00LUJGLWVpY1BvczAyS3FSRExQZWZlVGl1aXZpdWstSzMzRi0tLS0tNmY5cWZCblVXVi1qTUQzaU9fYU9hUE9pd0JuQm5uLS0wZXZPRW41VTVjMV9UNWt0TEtLR1R2anp6WXAtdzBSZzlzNkFCbWVXQm1naEpvbkt4Q0lLSUtLU0tXYTZ6enJvNVV4bHRiZTllNU90Vk9XYU4tTjZ3NnkyQUJjWDE3Y1hWLVNXVTJQQm8tYWxIRFJlb3BzT2EtT09ZZGlQUFBnbkUwMC0tQnNQdS0tT281Si01b0tqeC1BeGVVeHRhZWVUZWVmZmV1ZVBhdXV2aXZpamZpZWlpdmVQZ3l2dkMwMDAwMDAtMy0zRzM1SkctMkJGMC0zMC0yRkZGRi0tM2hsV0lTRDEtRVI1bzVldlYwLTBldTdfUmpTU3ByenJTcmNYN1g3WDdYLS02S0R0LUhpckRqQm5CbktNYmE1NTUxLTNyUWJ6YWFFQm5wRkpBbWh4bktTU1NTS0tLS29uSUtLcEtwTUtyU0tJcjVVck5WNzlWMS0tLS1WNTVOLTFWMS03LTctWDc5LUlVQnJpTGFnd0MyLTNqbTdZS2tWN2pVdkpMYUxNZXVkZVBfTFBLM1BmZWFMZWFhX0Y4YWFMTE9hT19fS0hkT0s4X19LZWVQT2RhYWllZWVpaWVmaWZlZWRkZGRhYVBhZE9QZVBQZWVpaXZldWVhZWVpdmZlaXV5emp2dml6RUJ3d3d6ekVFMi1ra0JCMi0yLWtCLTItQjIyMi1CLWsyMi1CQjItQi1CQjIyMi1rLWtGLUIyMkJrMC1GMzJueWV2ZzIyMC1GRi0wLS0wLUYwMDNHLUcwLUNsMGFiOWVlZnh6emJhLUFYNU9EdWtsRjJSS0ZVb255VVVhUFhlVjlzZ3dyZGRhTGFQTm4yQm5FRTBGM1JVTHBuOW9weGJiYnRYVmUtWV8xcmlPX0xLZnZFaW5rLS0wQmZDSXB5MVYiOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJSLmVNID09PSAxNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSAiRWNBMjBFUDl0LS00NmlkYVBhZGVQT2RkaWFldXV1ZWJpZWVpaWl2dU9fYVJudWZlemlqenp2emp2ZnV1UEtKRkpHRzNHUEtHUE9hVGlpaWVkYWR1dXMyRVl1aWVkbjJueWZmZHYzMi0tMDIwMkV6ZVJ3b0ctLUV6empldmNrMjAyMDJ6ZXVmaWs0M0JGQkZLMEc0LTBfSi0tbnlpb0MwMy0wMDAyLW4yMnd5ZGR5amZ6dmVuM0V5djNKSjIwLXp5bm5FeWpubnZqaXpqamVqenl5X3d6bm5CbjJ6dm56eXZ6QmwzR0czRy0tMjNGRm8wLXd6QkI4bS0tWklTck1VVVNwenJ4eHJLcnJTS3BwcEtLSUFDQm5BQTltbWdmQmNlZTljWGVmOWdlZWVYVmY5OTk5MTk5Z2UxN1Y3SGdjZTdjMTVBQmVlOTllZVhlZ2VnZWdmQmdmQTltZ29tZWVjWGNYZ2VYY2VYbkJyeFN4eHpIZWNlZkFVVUpjZWNjZ2NlMEF4QmVYWFhlY2VZOW5UVUpnb2VwQ0puenp6eElCZnJNcElKbW5wSG1jNThFSm1uclNick1yVUtKbklLeHJIZ3JVenJ4S0NidHpwcnp4S0lTcHh6VTVVbHpxMGEtTk96enh4elN4cnByU1NweHhyenJ0enR5VXRhT2FUT2J6eHB4clV5T2JhT3hNS0JuOXBNS0lDQ0tTS0lLS0NNS0NBQ0JwQ0FDQm9uSUpuS0lIaEtCcEtCcEJvbkNCbW5IbWdlbWUxZ2dlZWVYMTdYYzdWWTllN2VtZEJlOTdnZkJmQmZCZkJmOWU3WDdjWGVYYzE5ZVgtZWNYY2VYOVZmOWNlZTdWLVAxZTljZWNYN2U5WDdYLTBYY1g3Yzk3ZTlWMC0tTzZnbERrLUJqbkJuSnBLS01TS3JyTVNTcFNTcnhNclNTck1LTXByU0t6VXp6U0k5Y21nb25DS0lKcHBJOVlLQ0tDS0tTS0tTTU1yclV6enpVU01TclVVVVN6cnpVenJ5VWFVeVV5VWJ4bHp6czctVjE1WC0tLS1WLS0tTk5jY1gtY2NjMHkxMFdlZWVlVi0tNzBWNnhVenRXeE1TemJiYzZ4dGExMWNYOVg3VjctWC1lSGVnZ25DSVNwS0hYMVYxWC03LU9hLU41WGU5OEhlVlZWZWVWMFg5NzExLTMtLVhqYWJ2QkctMHM3blNyeEdjOS1CRk91bmVkZWR6aXN6QnpHMC1HLUtGMk5EejZyU3p6dTlkOTktMEZWSU9iazE1M0xpUmVlbkFVYmJ4enh6cnB4cS0tZTllOWUtQTFKVGF1a0NGMDdKMjNwcTctLS1jVk0tLVdOM1FWMWtoeV9hd3hGLUg0a0lSanlWLW9DR252angzSi0xNi1OeS1VMmlTRGp5ZmZ2MzNHNEYtQ1d0RzJHeFNVbFY3OWUtLTJuYkItLTZqMXMwUkVoaXZpaXprSkc0LTRYLXZZTUw3Ny1aSEozUHYzLTFjWmVOcG9uR3RWLVY0bERJcmVPaXVCbC0zLURBRVNqVDktcjRjZ1RMTEtLT2FRanp5dmduM0ZCRUItLTFwbkgtRTR6UXlhZm5HLS01QktiZ04tM094d3MwaUNEYXpJS3hLTU1JcjVPVlgxVjc3NTktMDVob2EtNFlQd0l6VFhjMG9TNC1PYU9hYW53bkIwLXFZb0RBOXBJcnp4enB6cEt6enp6VXpyV1ZmOWNQMWNlY2VWZW1jYzdjVjBIOXVNdkYtZUdVOVVTU2J1WDk3NUpZdnNPTEtPS0tLNE9hTEpLUHVlVHpqRXpqekJuMnpqMy1CbnduLUJfSG56QnBJenlOWDdWMW1pN2JmejNKMDlMLXBTS0tDU3JzNVA3Vlg3LVlCaldpZXVldXVzRi1GMDMtMGRoeF9uSUxOLTAzdkFOdWFRWWwtLS02YjU2LWpmNlZjQmtuQkJuLUJrMkJuRUJrQmtuLUJuQmtCdy0tLS0tbjJCay0tLS0tLWtuMDRHS0tLYU9hT19fS0tLUExPS0xLR0tLTEthS0tLS0tMTEthT09MR0tLSzNLYUtMS09hS2FPS0tLRzNHNDNHM0ozM0YzRzRHNEpHem5uRTItLUctRzMzMzRMMzNHNDNKLTMzSkczS0czMDNGNDMzR0szSzNHS0czRzNrM0dLT2ZmYUYtLUdHLUZHMy0tLUYtM0ktM0YwLTAzMDNGNDBHR0ctRzAzR0c0RkYwLS1GRjItLS0tLTAtLS1rLUctRjMtLTA0MzQzRy1HM0tHMDMwLTAtR2stMkR3a0c0M0YzRzAtMzAtRjNGMzAtMDAtRzMwLTAtRi0zLS1HMzNJLS0wM0ZHMzMwM0YzLUkwLS0zRi1uRHRmZWZldXZmaWRlZXZpaXZmaXV2aXV6d24tLUIyQkJCMjItLXduOVBlTGVlTGVhUE9manp5dnVpdmV1aWZoZmlmaWl2ZXZlZmZmamlhZmppdWlmZXlwZWVlaWl2ZWpFaXZqaWl2aWpmaXVpZWlpdWV1aWVlZWVlYWZpZWVldWp2aWZmZml1enppdml1eml2aWVpZmlpZmlmUGl2ZmVpZml2UHZ5dmlqdmllZml2ZXZldmFmaWVlYU9ldWVldmZlZXZlZWV1aXVmaWFlZWZpZml2aXppenp3bXpuRXp6Qm5FekJuQm56bkV6enp6d3p3RXp3bkJuRW5BeXp6Qnp6Qm4tbkVuQnpuRXd6enduQm56ekVFekJ6bm5uQnpuRWstLTIyQjJ6a3p3bm53bnp6bkJubkV6enptdndFRUJrQmstQjJ6bkV6RXpuQm4tLWtCbkJFbnpCenp3LS0tNC0tMi1uLVJCMkR2ZnpuMG4ta0IyQm5CMm5Ca25CQkIyLW4tMy1LSzNKRzAzMDQtRzQzR0xKSktfSzRKSkpLSkczRjQzRzAzRjMtRmszLTMtay0tRkxPYWRlT2FPYU9PYVBPYWRhX19hT2VfTFBhUE9LX0tPR0dLS0tLT2FPS0tKRy1LM0drLS1uQi1GRi0zUmstSkdHS2FQUGVhUFBldWllVzAwLUZGM0czRkZGLS0yLUowLUdKNDNHM0pHLTBLSzItM0czRy0zRjAtM0cwMC1GNE4yem5CLTNqRXp6QmstaXZ6emZqRUJBemlldml2aXZpZWV2aXZ1ZWl1aXV1Zml2enp6dml2enVpdml2anZ5dnplanZqd3p6dnl2endubkJ6bl9lakVCenpFQjItTE9LT2FNQkJ6ekJuend6aXppZXZlZWZpZmllaXp6enZ5enp6bnl5dnp6bnZqRXp6d3pCaWp6anl6em5Eenp3bm5FeXpuenpuRW5FRXcyeWFqekRqd0J2bnpuRW56a3pFem5pdnZoZWVqd3pqZWZpZXZ2ZXl6Qnl2bm1leml1dmZpeXZ5empuempCd25remFlT19QT19kTExHNFBQdmppdmppdmppdXZpeXZpeXpqd3p3bkUyekJuQm5CMi1rLS00MjIyQnpFT09hZWllanhQZWV1dXV1cWV1YWVldXVlZmlmZWZlZmVlZmZldXVpZmV2ZWZmZXVlaWlldXZmaWl2ZXVmaWl2dmZldXVpdWZmaWVldXVmdWZmaWV5dmppeWZldmVpdWlmZmlmZWZpZWV2dWlpdmZqaXZ2and3bkJuMkJCLS1CQm5uQnduLS0yLWsyQkJ3ekUtLS0wLS0wQjNGLWsyLWtCQi0tay0tLUpGLTNCLS0tM0YwMy1rMi0td2t6RW4yLUIyd0VFRTJCbjBCQjAta2tuQmt3RS1razIyLS1lVVNDU0pyTFQ3VjcxSzBZTHRldnZ5bDNLRnp3R0otRFdjUlJxUC1oRzdLeUxhZml6aXZ3d0cwM0cwRi1hY2pwU1NLeS1WWC1JSmx0TGVQdlYtLS1QZVNWckJnbW94cHJNUlRUT2E3N1g3Ny0wTjN2azdlb0VsbklJOTNuelNLQm9vVVNYMGFOWDBhNVYtMXBmTlV1Z0JKLTlpT2RVTlYtNHYxei1TZnMtekJnbVg4TUtBeHk1Tk96S2JzZTdWLTBVLUZrLTF5LWxWLTR4LTYtLWc2YmotM0w0a2JhVFluMkotYXBtRUNJSmxhTi0tTVI4RlRQUVlFd3BHRi0yVzlHVi02Mkh6LTdpNWNNS0tHVi0tLXkyZHdRdno0Sy1OZ0lNd21uVXpKb3BLQ0NLS0lKbktLcEtTS0tTS01Lck1NYnJXYld0YVQ2YTU1MFZOLS0tWDE1N2NWLVZYNzdWVlg3Y2U3Vi1uWlQ0NU9LSkxMUHpqenpCejJ3TEpGMEk4MFR3cENwenBPV2E1UDdlZVYtOWZuai0zcE9aNkpPWC0yZjVkY3MiOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJSLmVNID09PSAxNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSAiQ29FLTdsUi1ZV1JhMkFFSmVuTXhKcGJxVE9iYU9CY1g1TmVXX3huVnRvNVVVenpyelVydHh0eHJNS01VU1N5TjFYWFY1Tk5PdGFVVXh6enR6VXh4cFVTSUJwU1N5Tk4xYVVyU3BDQ0lKcEtzNTBXVk5OLS03TjZiYnpyenh6cnJwU01NU1NNU3pzOVg3LVgtVlZWWDk5Y2NWVkRVVjE5RC0tOTk4YTZyenRWWGFPVjE3NzEtNzhWTjBWMFYtN1YtLS1ZVjdYaDE3WE9XV1YwVjZwVE9zLThWN1hYcENGNS1OLU4tTi1OMFZPYlN4clNyU1V5Ti1hTk9zT2JyeE1BQm5LVWFVcy1WMS1ONU5VenJ4VVdielVTeHByekNLSGVuTXR6S29vcFNTU3p6eHhyTUNKbW5BQmVnbVhPczFBQm1uQ1NLQ0tJQzc3Z2NlcHpTS0JlOVhmS3JIaDllcHJ4bW5LTUtMbWVoS0NVclNySUk3WG5NVVN4clVTSU1wSUFCcHJ5VVJwTWJ0eHJyU3JNVVd0YnpTbktLQUJnbkFBS1V4enRyTVV4cnNPYld0V3p6VXR0cmFPdGJVdGJiVmVmYU9yeHhwU3R5U1N0elZYYU5UTk41U0poU3J5MXp6U2dtcFNNOW1tZ29mS3B4cnlVX3JVU3hyUFhtaE1RSUtTeHJVcnJ4U3hycHJLTHBNYS0yVjdWYS1PVjFYWEFJOTdlZTltOGE2VE5TeFN6enJ0eVRTdGJ0enlVYnp6YnR6dHp6enlPYmFOT2JhT3lVdHp6YU90dHlVTXktZl96enR6dHp0enp4eHJTb3BLcHJLS01TenJ6enh6enR0dHlPdGFPYU9abkJuQm1uOW1tbXBNemJieldhVE90YTVVeU9idFY5ZWc3WG5CTk4tNy1PYnJUVXp6dGFPYU9hT2FOT2E1NTUtNEtDQ0NCbklCbkJuQm5CcHp6U3p6eHpiYS03LS02V1YtMS0tNzcxLVZWLS0tLS0tNzEtLS0tLU5OLTUtLS1PYVRPYU5OLS0tMFdXV2FOTjU2Ynp6YmJhVFRUVFVDS1NTcHJyU3JNcnJTTUtwS1NVVXJTeHp6enR0YVROT2FPVk4tLS1WVi0tWC0tMU4wV1ZONS03LTBhTjc5ZW5LQm1WWDllOTE3Ny1YNzcwV3M3VlgtV2JWY2NPYS03T3R6YVV6eTFXYnlPYmFNeHlONlVWNHJVVXk0enphT2FNV3h5T3pyenhyclRPelVVVXJ6dHpVenp6enphTk4tLTc3MGFTU1N6dFYtNnJ4emJiczUtTk9Venp5TXh6VXh6Vi0xWDk3NzdlOWdmOWVnZTk5N1ZYN1g5WDcxTU1yVi1WNzUtZ25BSG9tbW1nZjllbWVtOWVlZkJtZW5BMUFIbW1mQ0M5aDltOTFBSUhlZ245ZW1uQUFCbklCbVYxbW1lZ29uOWY5bVhlbkk5ZmJWMWdlN3R6Vi0tY2dvb245OWdjMHM3NnRWOTluQ0xvMTk3N0ViczUwVmYtQUtKY2MtMWZNTUtyOWM3LUFhLTFtcEJtZTljLTVPV1dWLVhWLTUwYTBWVlVWLS0tMU4xOHh5MTEtLVYxNzE3Vi0wYTBWVjExN1Y3LTBWY1dhTjdPYTZhTk4tLU9WVjBTcld5VXh6VmU4VXh5Tk43WDJiVlNNVk41MGJieldWWGhIN2FOVFNyYVRPYmJXVjBVczBXVk9hTjU1T2FPYU9WNS1Pc05EMHRiemFVcnJ0VlhYNnJyVi1YOTFWMFYtTi1WN1gxN1g5OWYxN1gxWFhlZW1YY2dlQTloQmNlMTdYcEExN2ZLS0NLOWU5N2hTclNIcG9tZjlBQnBTeEhwS0lLSGhIaElKaE1VaEtuS1VyS0t5SUNDQm5BQnBBQUpwS0JuSUlDQTlvcEJtZTloQzluQ0tROTctWGhKbWZJS0JoSm9YQTllbXBtcEhoTVRlaElDSUJlaElLU1JrZ29tZktRMTk3MWhLeFFCcHByU2doQ0NKb25DS0txcE1TcEJYMTdYaFNuQm9wS1NncEtvcG5LcElKcEtTcHBJSnByU3p6S01UVFRVUUtNcktycnBzNS1LcFVLS1NTcE1wcFNTS3JyS01JOWZCbkJwSG5LNzc5bkFNclN4endvbkJtWFhwcFFBSTlmQ0xtaEJvcC1zMS1XVjFoS0JBSnBCb2ZCZWdwOW1lZktycHFmQUJmS3picElBS01LSHBLS0JwSUJwcW1wS0tLUm5BQm9vcHBLcExtbktKcENCcEtBQm9vbklJSnBCcEJuSUhWWDllOWY3Y2VlY2VlZ3BTUmU3ZjltbW9uQ0pwS1NwU1FJSUhuOTljWGVlOW1nZjlYY2U5N1YtNU9WNTExNzExLVYtLTdYMS0tTXJTVFQtLVZjTlVVV1YtNzk3MS0tWDc3YzEtVlYtVjEtLS1BSlhOLS1ONS03ZVlXczE3V2EtLS1jWGNXczJhT1ZnYzFjYTB0VlZELS0tVjBWLS01NS0xZVg3WDUxMVYtOFY1LWdlOXBNS3BLSm9lcElJQm1lZ1hjLWZDQm1nZkNJQUJmSUJvZ21uQUMxZ25CbkJmQUFCZ205OWdnZWZCWFhjY1hmN1ZYZTlYWDZiYS1YWFg3YzkxWDdWVjdYMVZWMS1EMHM1NS0tNlVTck1TTVNyV1dienMxbWVuQjFON1ZVc04tLS0tMmJWZW1BQ1VTS0tCay1WVmZJQ0tTcGc5Nzc3LS03aENTSnBDLS0tLS1ic04tT2FPYTU2ckpuSUtUMGE1U3J0YVVzOTkxNTB6eTUwdHktNTVPYmFPemJvcEhwTVdhNTU1VXpzOWVmNzlnZjllb3BCY2duS1JrQUpvbVZhMFYxZGE1LWduSUJtV1ZWVldXelYtVlhBTUxrVlZYTk9WemEtMWhSbVZORXRTcnJwTVN5MTdWVE4xbWdYN1gyeU41NnpyTVRVdHp0elN4ek1yU3RidHlNeFNwcEtTVC1WLVVUVXJhVXkxWGUtT2FOOW5IcEtMZWdBOWExY2NYMW5JQmNYWFhjWGNlZkE5Z1g3VlZ6czlYVmJ6eVVWZWYtT2J6czkxVVYtZTlXV2FVV2FVenJVU3JVcnB6elVVcnNVcnM3ZWZCOTk5ZTk3MWNlWFg5ZWM3YzRyTXlUTjExWC1TcHJNTU1iVmNZYTR4enpySU1wcnkxWC1WMTlnZS16emE1T3pNVVVVS3BLcHMxLTFPeVRTektNS25JS0tTeTFWMFd4elQxOVhYLVYtWGNmN2dla2NhVWJ5MTlmOW1kdHlNdGJ6eHR6U3JXVXpyU3lPenpicnRyVjlnWGYxbWUtZWVjYVRNczdjWDhhVFRNeFNyTXRyeHR6cktLcy0tVlhET3hTU1NTQ01VeS1YVXM3Z1Y5N1Y2dFY2eHByVjd0VkE4eVNyVkV6enhSb3B6YlZYT1ZhVXpidHpLb3B4UnBNclY1U3R4enJ6VVY3VE9WZ2lPdGJhVXpiYS1lbVZPdGJhVE9idGJ6Ynp0YnM5ZW1nZjlmQmdnZjltbkFLUnBnbW1uOW1tbjllZ2dlMS0wdHRWOW1tbWU2YS1pVWJiemFPVjdOU3M1T19zOGJhTlVWYU1UMGJyczU0U01NVUlDTWFOT3p6TXNEMWVlY2NYVVNzOFdWT2J0dFZWZ2ZBSVY3MWc3WG1rWHRhVDJyeHJTcnlPeU1zQXhzOGE1VUt0V1d4cEt6dHlPYldzMW1tb245WXktWDdOOW9uOFY1T1dWYU5NTVNyU3RWWFZjVjBXYVNULWFONTVPVmZBQmRhNmJVdGhNU3JUMTdYTjFmVlVfdHR6eVV3cHJzMnp6YldhNnMxZW9wQUE5OWVlZjl0dGJ5TjlnY1gweS1WRE1wdHpzOWNkVjZzOFd2S3kwenkxNzFPc1V4VDBWMmJyQnBNczhzNTFrVFRVeHp4enh4clYxN2VzMW1mQS1lZ2VpVFRPdFY1NU90dHRwcFN6VU1WMTk5LThiYnJVVmNBdFNyczdYWDdnbkJuQTllVE9zMWNUNVQyV3hScHpidHlOOWJzOUFCa1lXYmJhU2hNc09XdF9RTUlLS3h6VDE4VlhUVFVULTFoUGVjVk9VVmJhVXpVVV9yU1NVVlZYOHR6elVULWNlOWY5VmVtZWVBQmZCOGE1VXpiV1dXenpiYnM2dFNyVlZXeHJWNzlmNzU1T1d0eVVzMS0wYU4tT1VLTXByeS1jMTdhT3pXVUlNS3ByVVVJTWEtMVg5MThWNzcwYVRPYnlVeElLU0lKcENVVk5ONS0tc05PTVZONTZfcEtDSnBTSm9vbktNVk5OT2EtLS1PVnNPcHRhS01UNTVOTlVyS3h4ck1NVDExMTE1TjdzOWtjOVY5VnR0TVQwVVROT194VV9uSnBVczdOVVN6elNLS1VNVXRzMWUxVC1jNVRPVk5PYU9hVXkyVjUwX3pTVVZYMTE5WDdVU3hzNy0tT3pTQ1ViYktTenNVeFJuQ0JuQ0NCbktyQ0lLSm5JS01fcFVWTjVOTi03VDUwYTVPV1YwYU5OTk9XV3hLS01CbkFNeHBJS0tJTWFTeHMxWDZyVi1ENlYtc1QtVVVWWDFlOU9zN3p5LTVTTVVUT3RwS3lTcXBDQm9lOW5DVFVSbkJweU90X29vbkJuS3R0VV96VjdhLTUtdFdXV3R4eHJxcEtUT3R0U01zT3JTeGhCcFQ2YnhTeHJ0VVVJS0FBOW5IcEhuQmdlZWNmMWVlOVhuTXh6eHJVelVRQ1V4U3M2U29tcHlNcy0wclNUVXh0VE16enJyclVWMS1zU3hzNzc3VXJyclVNVXR6VXBNSm45ZTllZS1WaEtnbk16VXJ5bkt0V3pyenp6VXhKcFNLSm5BQ0tLczBXYmEwVi0tVVRPeHlVcnh6eHlVeHMteHlVcnh6clV6cHJ6VXJwelVyclVyU3lNclVTcnJTVVVVU3hVYVNmTVQ2eHJTenJVclVVYnkxOFNyU3J4clVwTVVUTlNVVXpTU0tTTVNyTUtoU3pUS1NwTUxwTUNTQ0NKb3BDSUpwSm9uQm9uSUlIbkFCZ2duQm5BOW5CZjlnZWVnOWVjY2U5Y2YxZTltbTltZWNmMWVlZWNlOVg3Y1hYZkJuOTdWOWVBOWNYN1hmTVFCOTdjWDk5OTdWVjdjZVhYbktTeHhwU0t4U3h6UU1VdHh4aFVyOVhzMUFKbWhVelVVU3p6S1N6MWhVVV9Tel94cnJTelVNVUtyU3hwcnFuSDE5cFNLU3BCcFFBQmhNcktTeHJLU3pNQnB4cnBwSU15Z3BTckJvcHJ5S3B6S3kwbk1NemJhMHJyVU1TdFVTcFNyTXJ5TXJ4emJ5VVVNVXR5NS1PcnRiczc4Vjc3WDc3LS1YZTc5cEhmQmc5OTdYN1g3WDc3Y2UtWDctelRPYTBWVjc1VFVVelVycnhTcnJVcnp6d2ZBQ0tyc09iczZUU3pfenhyenhycnJ0Vk41U3ktNFdfQlFDcTBjLS01WFVjLVg1ckNCeE1hN1BWRE5VSy1uU0pwOTcxX0VTSGUtbW9jbWVLenhJSU94dHR6c1RULU90YTBlZS0wNTdUbEJwTU1NbHNPVjdYZS0tLVo0MVY2TlpWZ3BCbVhKZ25LTXByNldhTlQwYzctLTNYWnlZSzU3LURYYWluQVNyclVzLWNYYzBEOXE5QmhyS3BNeTZlN1ZIVlYtMTlxRUItLTFoaW0tN1hqRXZJb2h5LS0wREEzNWdnbktFR3pUT3M5MFg3LURBTmRoVDctN1h0X3ZJU2JhOWMxMUFvRUJuQUNCeHJTeFNhMFdiYmE3Wm1jV1hWME5sLUxwVVg3LS0yMzJQLS1ZNGhuLTFObUhjbW1uVXk1LS15QnRFQ1NLcEdhTlAxOTctMFlGMG5OLVFZS0J2S29mb21oTVV0emJhLTFXY0JjVjE3cjlabnB6c1g5LTRZV1VVS2FOYy0xREhxQjAzWWFSUUpqSGM5SzlNcDlYbXJIaHJKaHJvbWdoVXhvT1ZUNU96TXh0VjVWTlQtLTdWQmMtLURWZWMtNURYUXhWLTlFV09Tay03Y3lLeW5CcEJuQUJvb3BKNU9hVFQ1Tk9zLU9jVkg3emp0blNJQUhjZ25DQm9tbjlnanpVeHJ4Q0JlbzZ5VDVVYzVXenhydS1lLVd5MHMwYVBjLTM5Rno3Z3BLU0JjQ0hnY1dnZ25JcFJPYnp0YnhIZ2dwb2VocnlQNnRiYVQtVk4tMTctLS1aRkZyVi10M09UcGE3LS1HSjJjLS1HSkZOLTVHTDN4Yy05R1BpZ3EtVDg0ZkxwQnBBTUhwU0JmQUNvZW1lb2VmQ0FDQUpyenR0YVVNNVRVYTVUVUlFcnIwV1d4T3RXYU96eU5OTk43Nzk3N0tBQ0tCbkFDOTBhVE4xVk4tN2MtZUdQdmhTcnEwY2VWLTFHUmFELTlaTzhqU3BLRi0tNy0tWlBaRS0tTzZWS3lWMU82cUpwcE9iVlhjLWFISEdnb25VYlZWLTFaWnVyQXMxWEhRQ1JuTXpNcHBvcERPVk5XYnR0YllCZWMzbWdjZS0tLUhXZk4tTEhZOFNTNVgtLTA5YWhWLXRBdUVwTi0tVEk0aHhEVVQ3Yy1QSV9RenJxWFgtM1p4TnpIelYtLVp5WUVWMGRFbDBwS3NWLS0tSjA2cy0tSjcxTi0tSjhpcy0tSkR3cy01SkZjUnMtLUpLck4waUpRc2dub25DQ0w2eGJhNnlPV1hlOWUtLV82QlVWMmRIREFyU1VyejFYWFg5LUVfQURySUNNS29OMTc2WC0tMEkyQVY1OEprZ21nZklJSUNDVE9hVDB3Tk4tLVBLSXh6VVRjYy0zX0tQaklxVi0xX01EYkNWMHlLWXRTSHBJcENTS0habHpMTlYtMTBWNTUtLTVLY2l6Yy05S2VNd3EtLTBNUElWLWRNcHhyYy0tX1VsNlYwT016QW5TTjctT19XZDZwcFNwcEtNd05QLTdYOTdWNy1GX1puNkN6VXJNT1g5WGM3LS1fYTgyVi0wT2NJVi04T3hIay0tTFcyTi1ETGFYeFRYLS00ZkJILTJfZnd6TFBWLTBRRlVWM09RbjZ4S01TeHkwWC1lZTctRl90akVCZW1oVDZ6elA3Ti0xX3lyelI3MXVNdmx3eElCZW1lZWZTdTZ6cDl6VE96cS01VFV4eFdjOUE5Ny05TjFUVTVWLTBWYTBWLThXLXBzLS1ORkRzLS1ORkxOMGFOSzBVS3B0eHh4clVOWFhYOTk5N1YtRE9CQXpUWC0yYUpmUUJ5LS0wYTJoVi0wYTNTVjA4YVUwelQ5Vi10YVVFbnRjLTVPdEVTVi1lUDJNelVTazZlOWMtWFBJd3hNU043VlYtZGRGQXJjLTdhYWZycFVxLWU3LVRQcXVSblRUTmMtbVB4WHhycktsY1ZWOS0zYW1DYlNrVi0tNW9YYS1HYXQ2elNTenJVUjdYN2VjNy1IUWdQd3h1Ny05UjF6elAtMXRrekVtZ2o2enpYYy0yYjNEckxQLS1PbDJycS03OGxxenJIZWdyenp6S0VVVE42c2VWTmNnZVgta2JBRnZCZ2hDSUtJSUJwQm9nbklKcE1LU1N4VVNyU1N4VXJwSy0tMG9nUFYwT3BJVW5CT3MtU2JTcHJwVVNJOWp4YTZhUGVXeno1WGVlVi1QU3lWd3BFc1YtQ2JYc3pLQ0NHV2JzVjctMGJabXpOLS1iYlR2LS0wdVRsVjA4dVVJbkRUVi1PdWxicVYxdHVxUW5DTUYtNVVlLTJiaDdqSlAtLTB2SjZWLTB2amxWLU93Q01xVi1Pd1ZDdy0wdHdkS29qRlROVjNkd2RiblVTTXpzLVBDQTkxVi1IVURGQnJhVi01VUtzU2MtRFVSNUJ5UC0tNnJxYS0yYnN1Yk1jLS10eU9BcGE3LXlVZG9qSm1uSXFPdFdWOS0tYnh1blYtMHpXZFZBT3plVW54Qm1mcnJJQ3JVVVVVcnBIeldWY1dYMTE3NVgtWGMtLVV6SnMtOVZFTGhrLS1lMERHcFgtMmM4eXZFNVYwUDFZQW16VFgtRmM5ZUVCaEhnbjVVdGE1Ti1PY0JZNnBTcklBVUpnVE9hLTA5V2U3LUdjRU5iTVNwcHp5ZTk3NzdjLTlWemdndFYtOTRJVXMtOVdPNlNOVi05NV9zcy1EV2RhU0RQLW1jUjJNQm9nZ3hycFV6ektTRXp4VXFVeVg5ZWNXYU5WZTc5Vjc5Yy0tV2tFcy05V29Cek5WMnU2SThyTUpwR2FPVjdYYy05V3hlUnlWMTk3WDVvbnJzTjktMWNYck1FYy11WEVsek1LTTU3NU5IZS0wOUFIcnBOUC0tMUFaclYtZUJDNHJYLS03bmRxLTRjb0g2RVRQNzBIWUtXeFNNT3h4YzlYV2JrZDlWLTlFZHprLUhaMHhoeVBjMDlaN3BCbXBTeHB5NU85Vjc5LS04MkNhLS04Nlp1LTJkQWd6VWNWLVBJLUJxLS1lSVFjclgtMWRLdUFETi1IX2sxVXJYYy05X3FXU3NWOHVNUEdtek1UTlVVVVNFTVN4eHplN2U3MWMtWEhlZTctSGEwdnpTY1YtLWFMZnMwMWFPMXdveElDNmEtMHR1Yy1EYVV0U3E3LTZkaDU2cE0wWDctN2RwMnpNU1ItWC0tYWJXZWdtalVPV2MtRWRzemZBS1N6VjVVTmU5VjFQVVEybkFCVXpjNy01Ynk1VS0tLWNBdk4tLWNIcHMtNWNMR2hWLURjT056UjctLTk4dEwtNGU5ZU1yUjdWLUhjaVV4cFg3LXVkQm9TSmZFcmxidVZYLTI5YVZmbXhJcEdhN1AtLURkakhSdHUtNmVXN0VLU04xMS0tOVhlRC1qZVpGckJmQ3BDU3hwU3J6SjVUVWNPemFPWGZCaDlYOVgtLTFjLTFlR1lSLTVlZldyQ3JhY1YtMWZYclYtdWZ5V3hrVi11ZkF5Qm9lZXpVcnpWLVYtdWd3b3BhNy0tZkpOTi1MZlB3U3BrVlYtOWl5enMtLWZxZXMtaWZzblJ4enh5WGVjVjBlalo4bk1iZTctOWZ0bXpQLUZ1amJwb3JTSXpTcE1VSVNDeHp4LVZVenJyVGM2enk3WGg5ZWNWV3VYWC03bWNWSGUxLS1lamNfeGMtM2V6TXpLNTEtNGV6T01LR1Y3LTFnLUR3LVJmLW5RQUE5Z25wTXR6enpidHRYWFg3ZS0xZi1vSVRWLWFnRDJ4em9sYTlYLUZmMmJqQVNyeFNyLTk3VlYtNGY0N01KeVA3LTlnSllVUC0tOWxXUnMtcWdfYUJmSnhyenMxMTctLWdhdnMtUGdocVVLR1gtLS1mQ0Z6LTA5blZPcHFWLS05bmp4ay0tZ3lPTi1EaDRJeEw3LTJmR1lFRU5WLTFvYjhWLXVwVE9wYTctLWhWd3MtWGhiclNwTE9jWFYxZXFpQ3BLUjB5WDctLTlxazZrLVBoalNTOWM2eS03ZlItclVyUjdYYy1laHNUQmdycVVzY2MtUGlKMWhBU2FWLWJmYUE2QUk5TU1NSGh6cFViek95T3oxWDk3LTFnZTdWLTF0eklWMXV1NjluQ3J0d1AtZS05ZmZDVXByVWtWWGMtNWZnVllDTTUtVi05dnBzcy01akgtRS0tSGpULXd4dS0tWGpZSHg5eFNWTi0xOXlQcW9nbnlULS1wZnVnYlM5clNyU01TcnpwYVVwU1VNU2tWVi1WVlZQSGdjY1gxWFgxYy05aml5ejVWMFB6X0duU04xLTRnMHJNS1ItNy1Ia0JWeGx1Ny0ta0NLNzBMa0dVU3BNU3JPenVYV3NlN1g5LTRnNTdqclRYVi1Ea1Fmd3hYLS1COThULS1nOUVuLTF2MXkwcEtvck43LTctLWdEbTZWLXYydkN4TlYtLWwxMk4tUGwzNFJ4VWNYLTBnSFhuRC03Z0hoYktycTdYNy1UbEIxeE14Y1ZjSjFsQlNTclNTcHB6VXp4cHpUNnhTU3JLck1Kb3BCbWNYY3hyTVJVU3BNS0JnYzdOMWNYOTc5NzFBTUhZU1NyTUhjY2U3ZVZWTjc3WFZYNy1PYzFkTVNIb29lLVYtQ01LU1NLcTFWVXBrVVNyVVNDTU1NVVN6U3ByS0tIZXh4clNTeFN4eHlVU3p6U1VVU3BTcFN4S0tCaFVwdHR4NTdPYVAwV3lPYVAtOS0wVjdYNUNIY1Y3N1gxVlZYWFYtOTdjVi0tLS0wYy03VlhjWTk3WDdlY2UxWEFCY2M5LS0yM3l4VjN2NDJpbkNNS3JiVkJlLTB4WFYtQTRVZ2stYWxpSXdwSU1zLS0tLUJTNEQtMmdTQkVSNVYxdjZmR3BDQ3B0Vi1YLS1CVG5xLTdnVlV6S0tULVZWLS1tMUROLXFtMUZSZnBwcE5WTjdOLURtRXN4VDktUWdaVWpDU0tFS1I2eEdXZTU3Ti1abVZWMEE4UlF4UjctLUE4VFVrLWltVDV4U1RUVGQ5Y1Y0UTh0aHhwcG9uU3BUTjctWDc3Vi0tbVpjTjFpbW1UVU1TS0NLTVIxNlZVU3ByR2J4a1hCY1ZjWDc3VjdWLVRtbWtTcFVWY1YtdW43blNyTVN4a1g3OTdWMUFCY2twTWJhOTktMGdvNU1OLTVncEtqTU1YN1YtUUNTTW5WLXZDbGxwazctUG5fN3dwcGMtLTZndV9qSUlxTjctM2d3Q0VVUDEtSGd3R3pNTU1TeGx1N1g3WDFWMXZFVHJteFNyVFZYMS0tQy0wRC1FaDBSRVNveFNSTi1YMDktLUFGcmJrLS1vSW9zLWFvTVRTSUtGTjUtLTVoNTh2SVJOTlYtMkdpdFYtdkgyX3BzVi0tb2MtczBhb2NfeEtNU0plOUpVVXFONVAxN1ZWLVhvaW1TSTVPeWNWLWZIeGpuay0tQ0I1cS0waEhjYk4tVmhIbDZLcEFTU1NLSU14c1ZXeVA3N1ZYVi03LUhwRUt4VVg3LW1wS2JSb2VLU28tTk4tLUNORGktN2hPY3p4elRjWGMtLXBib04tRHBpQXdwVi01aFRtTXBSNVgtMFFNanJuTU43LTFoVVFBVDctSHFCb3hLLS0tRHFXWlJyLS1JaGROcktyU3pPVjVRQmVYM2UtOWhmVklCcFV6WDE3LS1DZnBELXBoZ2JqQm1jY2pNSnJ6a2U3Nnpyck1NU3JVcnBTeWMxN1ZWWDdYN1g3LUhxbVhTU1gtLS1xbXZzLS1xcUVOMEhxdHFTcnhLRVNyTk43WGMxWFYtMlI0bFYtZlR6cG5rLTFod05VVFY0UHJyMnhNSm5JQzlFSXJKb21ucVVLS0NKZUlJTU94cDlNS3pLU3I2WFg3LS1WNTdPVjcwV1hWLTUtTjZhLS1WNWZVVUVvZkhjaHBLTU9iYTdYNVVUUDctMGh6cUVQLTJpMXJNU1gtMnZWbU9uSHBwbHhrLVdjVi05c1M3eDUtMmZYTGhuRVNveHU3VDE3LTJpQ0RVUlAtM2ZZS2ZySzlmSVNyNnMtNTctLS1zcTFjLURzcUJTVFgtLURGdTUtMWlIY2pSN0JtdDl3eG9nY2Y5NUlJRVNwQUFKZWd4VUpmeEk5b25KZUNycnJVclNVU1NyU3BNS1NwVVNyTUtyTU1NU01TcHBTS0N5VVV6NU43MS0wYVA1T3p5T3pVU3JVTjZhT1gxMHR5LTctMHMtN2NWLTdYMVgxLVZYOVhYN2U5Y2VjZ2UxNnlYLVg3WDdCbVhYY1YtMmlIb01VY1Y0UV80X25CcnB5T3pTcTVjWFg3Yy1IdEdXU3BYNy0tdFVHcy01dTBwemMtVHU2YVVTUy0xNy1UdTdWeEFDT2EtLS11N2lOLTV1RVlTLS01dUVjei0tYXVGbFNLcU5POTktMmlfYVVHdVYwUWR3S29ueTctQmljcE1Kck1TYzEtNVYwZmVFQXBTV2NjLTV1WXJTVi0xdWY2Ui0taWdwTVY5dmZZVXBwS0hleHhNenh4clVST3R0WDFlN2NXOTdIWDE3LS0yZllmVi1RZl9vcS0wQWZqX3JMN1YwdmZ3TXBNYVg1VjNBZzdvcEJwS3BUNTc1LTctLWZnUFNuYS00aXFlakFvT1YtYXZRSXh4cnljY2UtMGlzUVVGLTFpc19BR2MtTHZrRnpNNVgtLWZqcWJyMS0tRHpfVC02ai16akFTcTc1LTFqMWp6bGMtOXdMNXd3LS0ybE5wVi1mbFNVeFgtM2o1TWJNNVgtSGo2SFVKbV9wck1Tay0tN1gtLXZsc0lwazctSHdhZHdqT1YtMXdlcFItMmpBVDZJYS0xZm5UVHhIbkV5MFgtLUFuYXJrLTl3dlJ3dFY1UW9zcG5veE1TT3pyMGFObjlYNzk3Vi1RcDBycS0tUXBHNG8tMFFwUjBteGxYLTRqTDByU3EtYzBYeFBCQmZCbkVNS0t5Tk5UT1ZOMWUtNmpNWFVKbHoxMS1FRWdxd2VjWC1zNU9hU3MtQWpWLWpLcHBxLTE3Yy05eS1oU2tWM2ZzRDlwcEtJS0ROTk9WVjE3LVR5M2J4SnAwVi0tOXlFUnd3LTBBeC1fbnBWLS1BeDJJay05emZheGtWLXZ6cjJ4azctQS0xQlJ5LS0zLXp2Vi13MGxwcVRjLUkta2l4ci1jLUEwTVBFTlYzUjU1U25CcEtrV2EwekdWWC1ua05yZkFDSmVvbk1yeFNycnJTclQ1NS1JQzllLTB6dFZOWDdYOTktLTM1SUJWLVI1VUNxVi0zNWlxVi13Nmx0cFdjLTYweGp4LS1BMVB1Z3lWLUI5NXdzLUUxY3BncFYtLWtpNElWMXdBcVhwVVRVYTFlZS00a2w3QUNPYTctMDJMaE4tMDJZd04tSTJhb0JqeTctZjJmUVVLclNjVmMtLUkyZ0V4Uy1WLWIydHZTcHBvLTdYLTBreVdVRi0xa3laTXE3LTAzNk5zLU0zNm53aHItLS1SRlVucVYtQkZ2S2stMDNLZ3MtQTNreXhOVi13STM0cDU3LTY0NHd3Ti02NEJjUy0tMDRQU04wNjRQVlNLU1RVRjE0SGNXYy0tQkw0VWstNjRja1NWLTA0akJON3I0alF4SHBwS0twTUp4SGU3VjEtZWNuSUlLQUJvb3BVU29nbkJuSUFVdGJvdHlPeU5Pc05UVVNKbktxMGE2enRidHRWT3pPVk9YLTVjMGE1T1YxWFg3WmU5anBJOTc3QUk5Ny0tbFNXai1GZ01SU21mOXpicnB6TUtjMGJ4cktFU3hybFZYSFZVYmJwU2tWN1hjY29tWFg5WmNQNy1FNHh3d2phLS1sWHZqVi13UUlucnNjMFE1b3pTcEtFcnlPYmJ1VmdjZTFjLVE2NE93aE1XWC0wbG1aYmstMGxweTZQLS1HdEZELTJsdTVqS1ZWMFJVYjZtcDZWLTBtOWVyTi01bUJUMkJqTk9WMHdaTHpwVWs1WFZQQlpXcm1tbW1uSUpyTVNyU1NTU0tTTVV4S3BLclNFU3BieFNTck1PdHM3LTdWZTdjbkE5MTE5LU9hMFdiYTdWLS0tVjctLS1lY2UtY21LSlFCbXA5Z2d6enJTS01NeS1PeVRUT1g3WDk5N1gwNm1MZEVCZ25BQm5JSUlJQ0NBSm5KcENDSm5LSjBhNU90V2E1NU9hMFdiYVRPYmNWMFdXVi0tSThRR0J4czctVThSSWdwenM3Yy0yOVdfdy0zbWRnNkN0Yy0wbWd1RTUtWm1sT2pLQm1tb25VVVVVYnctT3p3Ti1WSG1jMWVWLXdnWnByc2MtckFOYmduS3JVdFgxN2M0VUFoQmhCZW5IWUJvY1ZncHJTQ0habnJyVU1TeEhuSUtMT2EtMFZPYmFVenhXemEwYnNOT3kxWDdYZTluOWNWLTFuOFhqRE4tSUJrdnp4WGMtMkJsWWktUm5CanpJRU1NS3BwS0tGNTEtMS0wVi05LS1uQnpNVlhCcDdzbW45ZjlYZWhCbkNBSUJvbW5BQm1jZVhlWmVnY2NabW9uQUFJQm5LU01Tck1WYzU3T3lPYVZVeld6T3p4eHp6enR4enh4cnJTcnRiVk9XdFZOLU9WUDdWLTBhVC0tUnN0U3EtLWd0Sm5xUC0zbmlsckNxNy1Bbml1ZkNBTTBiYmNWNFVFRkhCb21naElIb29uQm5DS3BLSUNTS3BNeElCbkpPdFYtT3NUT3RzTjBhVVg3Vk4tLS02ek9hLS03ZkplMS03bnVZbkFDcnRWYzBFRlZ6Z2ZCb2ZLVVVhT1YwYTczekgyU2hLSUNDQ0NJQ0NJQmduQnBCcENJQ0twS0NLUk41NU4tNU41T1YwYTBhTjUtTk5OT1dWLU5QNy16SFRNd25KaHBKNS1PVlAtNW9pQkVDU2tWLTBoQlZBbjlNNlYtSUlERGd6WmMtMklnQVItMXBIbnJSLS0yS0g2dy00cEx2VUlPYVYtMEtVd045MkxtRWdmQmZCZ3FVU0NyS0tLQmVWVVg1LVg0Sm1vb2NYLTU3Tk5tY29uSGRCcEpjZTk5cEtwcHBwS0lLb3BNcnR4eHhwcktyTVVTdGFONy02eVV6YS03WDk3NzVPYnp6U3RWLS01MS0tTi1QY1hYNy1JTHhPd29PVi1VTUNVZ2hNNU4tLUFNUWRTTlYwU1RRR3JTY1gtOHB0bHJDQ0N0YTEtMENUbllucVAtMFNWRnNyTS03MEVxMXNmSG5BOVhjWUNwcFNLS1NFcnJTU0N6cFVVektUT1dhTjBWMFdYN1ZYV2EtMktCbWUwV1gxOWMtNHFPRG5IclZOLTJPbmhCLUNxYjEyQ0NLSi1VY1dWLUlxampRU3JLQU16VE5WN1ZYYy1OcXU5ZkJuQUNJSG5TTE5PV1dhT1YtLWhqbkZyWC0tci12SS0xeGtGWnBwck91OTdWLXpyNnpBQXBJQ1NVcHpLVXhseVVyd1V4S1Y1NmE2YTdWVlhZOV9IbW1lWFZYMVg5VjRDbVJWcDltck1hVFV4VC1lN2MtT3JBZGZKbktyclNycnNOMFg5NzlYOS0wckZUUVAtLU1LZFgtLU1fOFAtRHJlVm5DQ1NyelZWTmVjLUFWRmdCVFYtVDAyRnlWMEwwc2xNczFjLTZWVERFYy02Vl9BamMtQVZfSkJ0Vi1ENWhzay1iXzdpd25TUk9YMS0tT1BCYS0xdFF1ckROLVlhODB4RVJUTlhWIjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiUi5lTSA9PT0gMTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gIkR3Q2Qxc1Awai0tUmFPX19kZGVkZGRpZnYyRUV6bm5ueWZFZVJ3eXpCQkJCMkJuMDAtMTctMmZFTUs5ZENydHpVcnJNTXFOLVgtNzg5Vi0tLS1TZi1ULS15ZnpJcnpvaHJ4eTZrWDZyU2sxNms3LS0tMTFKN1otMzVDSVNvT3hzVUtFU3BFUDZxT1Y2cEpwOW1lYzE3Y21ocHhVU29nZkJuTU1HV3hwdHlVVXpjNVVydHR0enBvVE9WNmxWVlptZS1nY2ZCYzVjVXJ6dGJWNzNjV3p0YUVPLTFJNWRMT2Z2a3lnekV5YU9kemp6c2wya252ZzJFVzJ6RXpudnp6eXp5Znl5enp2anVNeXpkemppdnZ2eXlpbnlhVFZ5eWR6dWZ2ZXZqZ3dCb0ctem56ZGlFZGJnMnZreWpFeWlhenVLXzRPR2FKYVBqelluenpqQndudnlmaWlnRW51UF92anVpYU9NZGV6ZWlmaWZpaUVmZ3pmdXNuRWVPX2l2dmlFdXZqenl6aXZpdml2ZzNFanV5amllempqaXNudnZFZmZ2em52aXl2aVlFWXl6anlnbkJ6MV9GbC16aXZqRXp5dXduQjJ6MDQzNC00RzMwNC00NC1DR0pGS0pFSzQyQm8tMzhHLTM0MDQwM0xLMmtsNDRHX0dGbi1HNDAybDJ4MjQzMzQzMnZ1dmZ2WTQtbC0wLUZrRjNHLUo0M0czRkozLUc1SjItLS0yMEwtWS04Q3FMS096dkVqWW4zR0Y1TjBBM21ySXBycklyeVQxV2FjZTFYVjBGMk1LWW8tSDA1YWhTVlYxUjFSSE9LZWZpem5uMC16NEtVeTVNRWUxN1g3WGExN1g3WDdYN1g3ZTdYNy0xN1hlMVhlWDFWWFQwYU43WDdYOVg3VjE5WDdWMTctWGVjN1gtN1g3N1g3VmZCY3RhVC0xNzkxNy1YLS03VjBWLTlYZTE5WDFjWDk5MWhKcEtKcEtNU0tNU0tVSU1Vck1wclNyTVNyS01TS3JLS3JNU3JTS3JNcHJTck1wS01TTU1wTVNLcktLQ0tNVXpyeHJTVU1VS0lBQmNlVjE3LVhjWDdYNzkxN1g5WDdYN2UtLTBhTi03VjE3WGNYNzdlY2VWWDdYMTc5MTlYMUV6eVRONVQtYy03WDc3WDdWMTk3WGNWWE4tN1YtMTctWDE4VlhELS0tWDdhMTEtLTdhMTctOTkxNzdWY2U5MVg3WFgxY1ZYZTlYVi1OLTdhMTExNzdWVlgxMlYwVi1WWDktTjBWVlZYMS0xMTcxNzc3czBWNS1ON1Y3VmEwYlZOMFZVVi1WTi0yVnMtLWEtTlROMFdiVjUwV3NONS1ONS1ONS1ONS1Pcnh6U1QtVlhjYy1WTi0xTjUtVjUxLTE1T3hVU3hVcnhTeFNKcE1zMFYtOFY1T2ExRDE4VjkxMTkxWDExLVZWWDE5bkNTU0tTU1NyTXJLUUtwSzdjWFhYN1hjcy0xWDFWWFZWNzc3NzcxOS1jc043NzE0eVVTcFVTU3J5Tjc3YzdYMFYtMTZhMFZlbkI1LUQwV1Y5WC1hMFdXVk4tZ3BDN1gtZ20xMHRWMHlON05OTjFWVi1OMW1tLU4tLXMtN1dXeU4tLWZMb2NjY0FBQzk1NTVOVXNTcHktV2E1NTUtYy0taElKcENDQm1nNU5OLU5OTjhfeS0tTjBWRC1lcG5JS0NDTFZYWVdWLTkxOXByS1NDOWNWNzctVjBWYzExMTExVFRVVlZna2YxOTkxRC1lMS1jZVhYN1gtV1dzOWNYWGdjVXh5MTBWYTFjWGVpMW1vbklDSTdnOS1YZ2VnbVZnZW03WDZ4eVVWYzhiYnRhNmJidHJ6TVNULS0xNU5BQTllZ2VtZkFCWG5CbTluOVhtZkJwTUk5bWdnZkExZWNlZWVnbjllZVhlOUFJQm1lN2c3VmVjZzdkVjltZ2VjVmZXenp5VXp4U3ZDTXRidGJ6eHRVcnlPenp0dGJ0YU9hVE96czk3ZWEwVmVuQm1ONU4tWE45WDlYaU9hNU9idGFOTk5OT3R0VmdnZ25CN2UxN09WTjBXYnRULXRXVjVNVjB6dGJhVXpNeTJhT3lTdEk3ZkNNdHhyenpiS3JVeVVhNU9hMGJVc09hMW1lN2Y5Y0QtMTk5Ny1WVE9XYVVWLVdXcnp6eHByV3pVcnFuQm5DS3JTU3p5U1N6YTE5RXM5YU9zLWMtV3NPYU41MFYtTk9idHRyU1N4enpidHlVYnp6VVV6VXR4clVVVFV5VUxwZjdoS3lUU0JwTXpwb21wcXBTeFVyU1NyS3ByVVNNTVVUTXhTcktTS3JycnBwTUtNU1NwclN5NTBieU9TemFLZ3B4emE2elV0YnpfelVtZ2Y5bUExZWdtZ2Y5cE1zT3pidHpNeVRPenpNYnR0V3kyV3JLS0lLU0tTVXRWT3NVQ0xuS1V0emE1U3pVeFNTclNTelVTck1yVXpNdHRTeHhNU1NIZW1nbkt6VVN6cnp4enlVcnRiYnBTcnpLdEtyU0FNS1NzLVQtLS1YNTVVYnNOOWVlbTdpT2J0enR5VV9yUU1LclVTTXp6U3J4VXp6YnlVeHh5VXMxOHMxVWFVcHJ6eE1LSmhTck14cHBzLVYtNzk4VlV0YU9WT1ZELVhoSEROLTZWOVhYbTdjZTdWVnRWLTk1MS1PcnMxOFdhLTctMTc3LS0xLVVWY095VWJ6TVRVYlVSb3BJS0NJQTdmMWhNU2hKb25JTVRVTVVTVUtLVU1yU3JSY2hNSnBTcnlPeHhoSU1wclNKcHhycy0tLVdhNHh4clNwckttcEtLeFVTclVUNU9WN04yYS0tNy16dFZZVlhjVlYyYU96cnp6eHJTcmJySU14Sm9nQU1TTVNVVVNycktKZ3BRSm5BSlg5N2hNTVU3ZkhlWC1lbjk5cFNyeHdvcENJQ0JtY1hYY2NYZWhTcnByVXh6Ynp0VHBLSm9uS0NCZkhlWG5DTHBCbVg5WHBTenJwS3BBQmVlcFM5bktuQm9mS3duQm9wUnBCb3BDSnBLcEtLTUtJS3h6U3p6enhLTVNTU1NLeEtTSUt0VFVXeVRPYlVycnh6cnpyYnJTenJNU3JwelV4eVNyeHh6cnJyenpidHp0enlNeHJVS1FLS1NTcHBNS3BTS3B4cHJyU3JVVVN4eHJNcHJydHRWRDVTclYtYS1OTjcxLWNYNzc5MS03N1ZWVlZYNzEtVFQ2V1diV1dXVk4tTk44VjcxMS1WNzc3WDExWFZjY2NjZVhWWFhOTk44Vi0xNS05LVZWNzkxZFYxLVZWWDdYMS1zTk90cnR4dHh0eVN5VVZOU3RVclVycmJVTXJwcHp6cmJicnk2cEtLck1NTXJNTUNTVVVLZXBLeHMwYVRUTVVVVV9yTVQtT1ZOLTZULTctYS03NzdWLTUtWE14U1N4eHJ4TVVfcHpoVXhTbXByYTZRS1ViU3lPU1NuTXhTeVVLU3hDTUtVdHByeVN6cnh4S3R0YnpiU3JiVE4weHpVS0JweVRTcnJNdHR0enByclNTck1TcHByS0NJTHBKaEJoSUJvbktNS0xuS0lDSm5CZ21tcEJtOW1uQUFCZ2dnbWVvbW1uQUFBSmdoS0tLaEtnbXBBQUpwSUpvcENJTUlNSUpwQ0tKcEtVYS1zNTUwVjJWTjUwVk5UMHM1T1dzNlZUNU5OVFRUVFRNeVVTU3hRSnBKcEFBN2ZCcHJ4cHR0V2JiU1NRS1NTU01NelNydF9yVVViVWJhTXlUT1Z6VE9zNzc3N043MFY3MF9wektLemJiU0pwQnAxMWhJS3FuS1V0SUFKbW5KbkptbklCbkJuSm5LS0xwQm5KaEk3ZTk3NzhWMU41LU5UMFZPdGJhTk45Z21tbWtmSUNDQUNCZ29uQ0JwUUlDQm5JMWZKbzlwU1FKb2hCY2hLaENLSm9wU01LU1NNclNNQ0lCb21vb2VuQUJmQUlBQmduSUlNdHNPYU9iYnhJOW1tb245Z25LVXdwTUpwSnBKcEJtcFNDU2hNS0NNS0NCcENLMTBWNy03N1gxLWNWVi03aEtLQ01LcnBwTUtTS3BJQUt0eHp4U0tweG5IZ2hVeVNydkNJQ0JmQ0pwTWJuQUlCaEJnb21wSUlNQzltZ2ZDQ0tCb29uSUlJQ0JmSUlJQ0JvcElJSUtLQ0tLU0tNVUtwS3hwU1N4eE1VTUtLU0t4cFVwS3JTS1NLU0tuSUNDSm5DQTE5OTktMUE5ZS03LWNYWFgxN1Y3MGEtZjdWVi0xLS03WFhtOTk3Y1hYOUFBQzltZ29la2NjWGc5N1hYQUJta2Y5ZjlmQTllbVhuOWVtZ21nb25LdHhnbkJmSTluQmVtZWYxWDktOWduOW1lZVhBOWVlbWVnb2VmQm1nbkJuQzlnbkM5ZWVnZ25DSmhCcEJuS0puS0tLS3hwSUtyUmhCaEFLQmhLU0tLS0lNS0tLRjdaMk1rVF9fNDRPT2FPX19PX0xMVGJZdmt5ZmZCa0VjdzJrbnlhYWlCa3lFQy14LW5sMy0zVlEzUU1zYy1PLXR4YU9qenprNEtfLTdWUy12Q1N6YzdWMEoycUVQZXZqRkYzRi0tNm1UVi1GR1JsVi0tOTJUVjBrTG90YngtYTdBdVBuSVVVb3h4emJ6cktycEtLTVNTU2xXeHJVc1d0ektselRVeU96Ync1MTZ4U1V6V2JzWDZ3TmdjNTVYYzdtY1htZ21lSm1vZm9tWFhJQmNZSGNWUFhaY1ZUVWNlWDFkOW1lMTdlZTktQTBZNnFpb0MtYXNCb2VuSUJqU1VJQmpVU0plOWNlVjcxNzdlVjdmQzlncHp6SGVlSUN5VXhBOWVmSXJ6TTB6S2FQNmtPeElNdHh6YnhCZ2VmOWdmTVN4eVU2dHRhVXR0ekd6cnlPYS1PVjFYQ0pjOVZjTjctLS00MGVrcVEtLU5ERUR5Vi0tUmVkLTZWdW1uTVVhY1gtLTBwY1ozUDJmSUJucm96S29jWDdYN3BveG9nbkJVNnpiem9qSHhJU3J5VVdYLVUwWFYtLVY5WUhYNy0tNk0tay0tRG8wVkRGU3k4X19iZnVlUFBhRXlrRmtrMDNDMi0zVndDYkFNVi0tMHQ2by05Mm9VUzBWNEZVQ1NhT1F6Qm40LS0teXdlLVkxM1k1S09qdVJ5YUVCRzJGLS1HV19WMEZadGxpLS0tM2NvNy0zOEdnUi05M2tDRVAtMWthUXBlTm4tLUw0QldCbjVULUJGZFpTX2VQT3Zqampqd2szLUZKR0Ywc0w5ZXBDeU45LW1raEFoYWVmZFBPT2FPZF9lT19kUEx5aWl2ZWVleUVubkVpRXdCazJuRW5CbkVFRW5ud3d6bm5GMzMzM0dHS0pKRzNHNEtLR0otOTRnOUNrVi0taXBXLVZXVmJBQnhyTUt6NU96SnhzTk5OVlhtWGU5Yy0tQjQ5Ri0tUG5PVi1GcWNTVjdzUUxxbWVlcHBVVVNTeHRhVFU2eVQ5Nzk5N2VlTUMyYS1MS09hT2FPaV92ZFBpdXpqZF9kdmlqeXVfS0ZKR0YzMzMwM0ZDMi1vQkJCNEtMT09hYU9pYWVkdWFlZWZmZGl1enp6eXl5ZEtLSkxmaXZqampZQnd5dXl5bnp5RW56bnZzemt4Rnp3emp2RUJHMEcyempneXV5WXZ5YnZ6anlpZUtiZllCa3d6aXZZdnl2eUVpdml5dmZ1dXVQZmVQUGFhZHZ2dmpqZU9MUF9NZE9LS0tfVWVhUE1lZnZqall6WWtua2t6em5GenlFanpqZnl2dkV6amVRZmpZdnp6bnp5aXlFc3l3end6WXZFZ2tHNDNLNEdKSktHSkpLMy16anNFempqdnp3eXl2dkMzSjJHM0ZKMnlqRkcwNEZLNEY0Sy1PS0dKR0pHMEdLNDNFQjRHRzJFRXp5dnZuMnlkdXl2anlpbnp4MzNHMDMzRWl3LW8tS0Yyay1HR0plS09fLTBQTF9KQkZHS09GX0tPSEs0R0Z4T0hLR0dGd3AwOEoteUVZbmxLS0ZKQndGSks5ZU9GSExUZEota2tuMEtLZEZQUGVfMy1CM0hlT2FKXzItRWVWQy0zSktMZGlfRkhLMjBkUEpGazBPX0pCbDNLVF8zSzVMTGZqZEpldV9GbzNfSmllUEpGMzAtbDNGR0pGb0dGLVg2ZEpCZkVPdHNWMEZ4T1diby1ENnVDUzZYMXYyenA1XzRmdV80aXZFZGl1UGRLSkY0NWFpaXZpdnl5aXZpaWlqc24tem5Ca0JGMjM1Si1HR18tbkJsLXc0NGFLS0ctS1gyX25DRXJTU1NrT1dhMTFYZVhMRzFnOF9PS19PT09fYVB1S09kYWpzeWRRanpuenlkTEtLXzVLYWl1eXp5dnp6enl6anZqaWRMSzNLS0dLS0tLS2FRZmVmaml6anp5dmRlZmlpem55enp5RXd6bkJ6d3prbjJFaWZ6anVmd3l5emp3d3ctLUdQT18tLXpWQm52Z0Vla2szSzNHRzNKR0dGRkcyQi0zMzMtMC0tMDNHM0hLNGVQZWVmZVFpYU9LLS0zLTAtSkZLaXlkZUpIS0oyQzQwR0dfZGRLRm5CMi1KRjBjV3lNbW15VE4tWkdmdXRlMi0tLVpBV1YwRzhJaGkzLS04QU83LS1JMHNrLTdhV05rLVJJRnB1RUYwMTh2S2dwS0VNNnRXVjdYVi0tTDVNay1OZ2VZbFY2R1V6Zl9lY3pmMjRfLWstMUMwbEItSTVaWnFPeW5rcUstNVlKQklBcmxYLTFHZnU4X3lDLTZZT2xuS0lPVi0tLTVxSkItRENnZHdqYS1DNjFfTFR2b0cta1lnRTJLSUpuQUFNVXh6VXJPeHpUT1dhWmNWOTE3NnFYZVg3Y1ZEbHFFaF9QUGVmZmlqam5FQkMyMDNGRkdKLW1EbTNCZkVNdHlQODktQzZWSVRkVG4tLS0ybUVULTI2YlNxay0tRU10czJ3VVF6dWlpamlpYmZWLUVZbm4zRzRMSkpHRjFzemk3bkpucjU1MGUtLTc4cXctMUZTaHktMjdKN2FSLWVGY3pCeEtvVDctVi1vV2kxdExnd2stOUZ5WEVOVjdIN09mX2Jpc3l3eW9HSkctR1pTZ1lCZXB4eHB5TjVYOTctZ1ozQnRmdzMweVpYNkU5bVk5ZWVtZW1YZWVmU3p4elQ2eHpVck1vbW1jZUtJQUJoQmVNVVN4eU9XYmJieHpIcEFUVFRWNU96eHpTeTE1VWE1TzkzZW1lOWNYV1diYnlWY21WQW1LNU1peWlhalkyRWlsM0c0NDVKLS1IcC1zLS1hTVlrLTBDZHBWMkhXOHh1dm9HLTI4R0dMbWVteHI2dHNWLW9jekRRaXMzRjExSlk4QmduQm9wcjZ6dHp6Tk9XWDdlN29tWC0wbVpSeF9Va1JkSFJCbktNS3BNSnBwSnhwb25Cb3A2YmJ6eHB4S2xiV2EwV1dXWC1VelVVck16bHhyV2FXWFZkOW45V1ZWYzkxZTk5WDdlZVZqSGNjY09lMVYtLWRETEYwT09XTG1weTEtNkFJU2F6Ry01X2hNWXJxM2UtMm12TEdleW4wNC1DYTV3NjluVXJTcTE3LS1RQkRWVWl2enpsSktKSi1xTllhd296enlObjk3YzIzbUtDT19PTGRpZmZnd25CQkJsLUotNU9QUWhWMHduR0lPZWV5aW4wMjMwRjV1UEFzU1NVckhwck1TSTlCZW5DSG9lWEFJcnJVVVV6VFV6eU41NnJ6YlYwYnhidGNPeU90dHp0Y21lZkJnZkJuOWVmOVg3VlhYN1g3WDdWOUlHX2phYWVpdnpCLXBGbjJLSjA5UGUyUmhienp4eHU3Y2VtYy1DQ1JveWR6LXAtLTVrNXEtSUNaS2lQdmprMzQtLTVucFQwZERFdzVPZXVhdWZkZXVfUGVpakItQkJGa29GRzJFZnN3RmszLUpMSi05VWw2eGstN256Z3JhYU9lUWZWQkItbi0xWFZnbmdoQ0VwS1NJSUlNS3hNTDUtMFdjMGM1VjcxLTctQzBjY1EtQjkycFduQUJuSUJnbXhVYS1VYnRicnp6cnRiYnVlWEJlZTVQZWMtQzIxS3RrNmU2STRySnBJQnJNTTBjLTB6emJhZTkxYzdRaDJ0cE9fZGRlZVRiZWVpaWR1dWZmZWVlZnlkYmVmamllZGVlYWlqWS1ubkJ3bnpuRUJubkV3ay1udmVlZmRiWXczQi0ya29GRm55anVldVR3MkZ5dmZpQi0zMkcwLW9HSzMtT2R2ZWVKRkZGbzNCb0xLMEpGLTQwT09hT2FfOEtLRkIzT0tlZmRkRkYwLS0wMkYtMDBHMi0tNWNXeHpNU1YxVjBKTkhNYUItdVlJOVJuS01HV1dhTmUtSEpSWW5fYWF5dV9qamplQkMtRkpGRkVqaXdDNDRGMnVFY2dwSnhJSXk1LU5WVi0wN2N3ay1QR2pobFYzb1pjcmFPUHprQy01ZUhLX25BQnBLS3JLNTUtNTc1VFQtZTBmSE8ycWFhYWJldWF1UWVpZmZlUWZmRi0zMy1ray1CQjIyMm40SjNLLS05TENscy1DQVdSdGstMVFYclZJSzdXZF9fXzRhTHl3eWl6WXpZRXlFQncwSk9KT0pKLWVkRXZScEs1T3MxVjFDS0xmT2RPeXN6eXdrR0c0LTVldFBiS3RhZS1qS1dObmVlUGZpdWlpZmlpamlmaXcyeWZlaWktemVmZWVlZWVmWUJCbi0tMDAzM0YzRjAzLUctM0YwMy00LTBHR0dLSi11ZkI0TUhqU3pTb21jWGZNcHpTNnhLS0tLTVNzVi0xMGE3Vi03NU91ZWMxNy02TGJ4NUpFLVBmZWlmQTllbWU5QUp6cnp4enR5TjU3LVNWVzV1VS0wcWtwclJ4TVNLU3BLU3J0VjdYN1gxNy0tVi01OHQ2LUxnVkxiQnBJS3JXelNxVjBWN1ZlLS1PMFNCOExvTHB4Sm5CZ21wSUNCb21vZ245b2doQm5JQnBVYld4cE1PenpWVXNVYmFUT2E1NU9ieG9uS0VTeVVTenJ6UlV0V3p0c1RVenJNdGNWVi1WLWVYLTBaZWdlZTk3N1hYLWNlbWNZOWVjVjhxX19VX09kdWpFdm5CbUszMC0taER1clYtNXZmejM3aHpqejlnZW1lY2Y5Z2Vuckk5Z2duOTdnZWdlZ29lbkJnb3BDSm9uRUpVenBDS0tJS29uS1NLTUtLS1NNU3BVS3JielYwVjVOTi03N1ZWLTdYLVdXVlYtTi0wYU5PV1dic04tMHlVVVV4enJ6U01LclNJQ3BKbklJRXJMNU5PYVVTeHBTVU1TU2tPV1dhVjEtMS01NS0tVmM3WDVVeHJwVVNVeHR5NTEtY1ZYWDk3VmNYWmVjVjlyMWVwX0xMYXN6bnZneXczNDNGLUFaNEtrNnBuVTF0THVhT0c1S19hX09MTFBLZU9kZFl6d3d3ekVuekVud3pFMkUyQy1KRjMtNGlkNVlJTVY3LUNzX2Z0a0l2cFFPbW5BOW5CZ2Y5WUJvb29vZklDQmVlQ0JvcVVVVXh0emE2YU5VV2JhNmFPYU9XYmE1VDVUSGNWN05MS3ZkdmVlanpHLTMzRi01cTA1YkF6eTlWQ3ZYSzhfZWVpeXZ1amluMzA0Xy0zLTBGWlQtOTVtbWNnZkFBQ0JuOWdnZUFBOW1tbkNVdHpycHJwVVNBQUlCZ2dlY21tZ2dnaE02dHpOT3R0dHlUVFRVYmJieHpLYTVOMGJiYmJiYmFOVFRUVFRUVXk1NTFjY2ZBQTk5WFhjV253NWhHX09MS09MS2FPX0xLT0tfUE9PS2RhUE9hUE9hYVV6Qm5Fa253a256RTJFbjJuekVuemVLYXpFeXp6am53enp6bnlzemd6enp3eml5emp2dnpqRW51ZU9PZGF3ekVubnd6RUVud3d6RUVua25FbkIwSkxKSl9fT0owS19KTEs0SzRfRzhLNDQ0NUtfNDhMS19PSzRHNDRLNE9LR0YxVEVUYW1uTVRPVmMiOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJSLmVNID09PSAxNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSAiOW1EUy1GUC1GLS0wVGVkUFBPWG8wSENHU3B4ck1wdFVTclV6dHp0YmJzVXRhVFRPenp6elN0elN6U3JTclNycHBULTBidGFPYU5OVXR0Vk9hLS0tNTZ5NmFPU3JVYU41T3p6dHp0YU90VE9idGFOTlV6YU9TclN2SG9nbWdmS3BLU3JDSmduSUlDTUtyU3J5VVdzLS0xN1hELS1PYVV6YU96eU9ienp6dHpyclV4VUtwcnJ6eVV6enp6enpyU3JyYnpVU3p5T2FPc096enp6dGJ6enJBTVNLenJVenpVU3JVcnJNS0tTenp4cnJ4cnhyclNyU3JVU3BNSm5DS1VWNmFTeHhVU3hyU1NNenp6V3p6X3p6enp6enhyVXp4VXp6clN6cHhweFVTVXhyeHhTcnJNU3JTS0tNS01TS0t4clNLeHp4cEptZWduS3pXenpvZWVwQnBBQmdvaEJuQnBNU0t5T3NUNVQtLS1PV1d0X29uS3p6UzllaFNyVXp6enpyenpLS0FJTG1mSG5CcFV6dFdzVDBXYU9hVXp6elVyVXJTenB4enpyU01Tcnp6elNLS0tLcHlUVWFPenh6eHJ4eHJ4clV6enh6enp6enp6U3J4clVyU3JTek1TclNTclNyVXByTUt6VVVVcmJyYnJicnJTTUt4S0tLcElLS0tNS0tLSUJwS0JuSm5CaEJnbkNBSUJuQm5CbkJnb25JSm9vbklKbkJuS0JlbjE3QUtJQ0lLS0pncEtLQ1NTS0tDS0pwQnBLSUtCbktLS0NBQ0JwS01JS3BvbkJnZkJuQ0hvb25CbkFLQ0tLQ0k5bkJlbkJuQmdtZXBDQm45Y2VjZWdYLTllZW5IbW9nbkJtZWdlZkJuQmVuQm5CZW5CZ21vbkFLSUNDS0tDS0tLSUtLSm5DSm5CbWZCbkJtcEJuSUNJQnBJQm1wQm1uQm5BQm44YU9iYmFPYTBiVk9WMW45ZkNCb25JSG1vbkNNcFE5aENBSm5KZ25DQm5CbXBCcEJnZkE5bkJtWDllZWVYZVhjWFg5ZWVlNzdncEtyU3J6U3JTckpuS0tycnJyS0puQ0JuQ0JoQ0lCZ2VtZ2dlZ2dlZjllZW1tZWVjY2VBS0tyS0lDSnByb29tZ21nZWVlOVg5ZVhmS01TTUFLTXpyTXlPdHhyS0NCZTdWY2ZCcHJyQkFJSG5LaFNLSUJwOWVtZ2ZCbkNCcFNNU1VTeHJyenpyS0tMbW5CbW1uQUJwSUtJQm1nbW5LU3BTS1VTclBrZjllbjluQUlLcElCZ21YRVY5Z3BCN1ZlOVZYOVhiclVWMWNjOVY3V3MxMWNoQmVhTjd0VjdBSUM3WE4xTjE3NzdjMlYtYTVVU3kxMTdhTk4tY2VlZjk3T2EtV3p5MU4tMTdXYnlNTUtTQ0tyczEwV1YtV3M5NzhWLTUtRDUtcy03VmNnbWZNb3BDU3BwSUE3WFYtLTEtMmJzNzE3VjE1LS1hNTJhTi1YMS1jVk4tWC1WLXRzLTBWMFZPVjFPYU9hMS0yV1Ytc09WLS03T1YtVi0tVlgtNy0tNy0weU43LS03LVgxT1dhLS0xLTBXVlQtLTlON09WLS0xLU5OLS0tVi0xN1YtMTVVcy0tVi0tMTVOTjctLS0tVlgxTjctLS1YNzEtLTE3ZVg3WDdYWDFWY1g5WFhjWDk5OTlBNzdlVmVYOUExN1g5Y1g3WDdYOWNYN1Y3VlYtLS03MTdjVjE3MTdYNzE3WC1YN1g3MTE3N1gtWDcxTjE5LS05N1gtWDctWDdjLTkxWC1YLTdYN2c3WFZlWDdXcy0xNzctMTctNU9hNU5Pc09hNU9hT1YxWG1YN2VWY09WLTk1LS01LXNVV1ZOVDVOLS0wV1d0enRhVFQ2V2FPVjctMGFPYU96emEwYU4wYS0tN1ZPVjdzLXMtLTZWLVgtLS0xN1gxVmMxMThWNU9WN2VYN1hjWGVtbkNDQmZCbkJvcHJTcDlnbjljVjE3ZWUtOWVlZTdlVjRrREpfYWVpd24tRkotdTI4bWdwTVN6c04tWGVWNUZvcDZhZWVjQkJrLUYxdDVaZG45eHhycy05LU85UVp5ZWV2ei1HM0ctWWNtSzZDSUlyVXJyU3JycnFPYTktWDlYN1g5Y1YxX2JlVHVPUE9QZnpud3dDMy00LUpoNzhyQmVlanByclNyTk4tLTctVDVJVFB3MzBVOEUzQmdvbkJ6cnRXenphTlZlZVY4dDlYdGFPZE95ekJ3bkVCS0stQW1QRHZDeHJyLTdYN0J5SlQ0T2RLYVRpekV5ZExRaV9HNDhfT1VkT3ZFdnl1di16eWV2dm56eUJGemp2eUJuenp6bkUwS0tKSkpLNDNKSkczSkYwR0tLLTJCaVNScHh4cFdYN1hjIjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiUi5lTSA9PT0gMTgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gIkRnQnkxdlItQVY2MFlCbm9way1PXzlEQ0lzNHJVVXJTU01VclNyU1NTTUt6eXBLU1NNUnBLTVNyVUtNU3BLU1NyVXJTS0lLU3VlWGduQ0tCZ21lOVhlbklLS01CcFNLcEtNTXhwTHBwS0twbkJvb3BLTU1NTUtwTUtLS0tyU3p6emE1NU9ienpVVVN4cHBwcENDU1NwU1NyUm9wU3JyU1NTcHBNTVNTcktTelV0cHhyeHhwaFNNVU1VU3JyVXp6YU90YmFPdGJiYmFPeldXYU41T3M2eU4tZWUxMTdlbWU5N2NYLS0xMTE3WG1tY2NWYU4xLVh5LVhELU5ULTZzRE9hMHktY1d0enJyS3JyU3BwdFdTeHMxV19yTVVNTVVUVVV6cnJyclNyU3hLU3JLS3pLU3JNU3J4eHByVVV6VXlUT2EtTi0xLVgtNy0tMS1WVjFELUVVVWFPdFNzLVN5TXp5LVhlMVhYZTk5OVhjZWZDSUtLVVVuN1g3ZVhlZThhT1YxMVVVVWEtWDdYMFNzMU4xbVZjZjllY2VrZ2sxQUptbkFCZ245OW1uOWhJSmhLS01CNzc5N2VlMTd5MTdWNzlWZTc5bkZYOHMxOW5BSUtJMW45cE1LS1Q1SnAtaEZnVjFnb1YxbklGLWhCLTFrT3NONTZyU3BwcE10VlgtNzdjN2E1Ti1ENTUwVi1PYmJhVFROLU9WYS0tLS1OLS03czUweTBWVE5OLTltYU96VjE3Y1ZlZXBBQm5CcEtLQ0JuQm9vcElLTU1TOXBLS0tLS0tJQldWLUQtWGVtZ3BLQmU5Z205ZU96YnlPYTVPV1YxNU5ONy1OLS1WNS1PVjU1LTUwYU9hT2EtLS0tOTllNzdYOWU3NzBWMU9WWC1jY2VmQUJuOTk3WGM3N1ZjY2djZVhlZ2ZCbkg3Y2VnY1ZYOWVjRC1WVi03LVhWN1hjczVPYVVUMTU1LTUxWEQtLVV0eVV5LS16V3p6VXpyYnp5TVQ1T3R6dHlPYU96S3B4eElLS0tLcElLS1NNSUtTS0tTenp0emJ5VXh0YVVhTk41T3lLcy02VjBXVjBfeS1TcHBTSUNNS01UVFRPdFFCcFNDTVNzU3JNU3p5VE1TcHJTcHRTVWJ6enlnZkt4VWFPYnJNSnBUT19wbXBVeHJhVFRPdHR0VlV0YVNTcHR6SUFLOTllWGVnZktncENMbXBNclVTcHo3ZktCb29oVXR0clNyVXJyU3JTQUtLVVVyYTRwU3piYU5UT2JhVXlVeG9wQnBTcnpiYU95TjEwYmFTcnJwektwU1NVdFN6cFVzLTc1TjdjYzkxY1hvWDdWN1dzMS01VFViYU9hT2FTeVN6enpyenp6VXRhTjBWOTcxQTllZW5CZWVlN1hlOWNnY2ZBQTlnZ2duS0pncGdlZWU5ZUE5bWZCZ2Y5Z2VWVlg5ZkI3WDZiYU9UVE5OT3RhT3R5NTJ0elZOTjltN1hjY2U5NzE1TjVPYkt0X3ktOHJNYnpzOTBNeTZfczRyYU9VeHJycFVNcnpfckNNVXJ5LWVYVXpycHlTcnh5T2JyenRyelVNVXR0cHp0clZNcnpyTXNVUmhVeHBzT3BDVWJyenFtZW5NdHptcHpiX21mS3pwb29YWDFwQnB4U1NLcFNNU01LS0NNS1FLbkNCbW1lWGNjNzExNzEtVi0tWHBJSUtLbklBQUlCbkNNTUNLcHJ6V1Y3c09iS0tyS1VNc05ONVV5TXp6ckJwenR0dFdWYVRPYldfeHBJOTlnaEtLTXh6dGFVVWJ6enpNeTZ2QmduQUNVdHpfeVRNclV6Ym5JTVV0dHRWLVVyVVNyU1Nwck1TU015T1dWWC0xOGEwYS0weVRPYTVOT3pyclJvb25CcFNLQnBDS0NDS1NuQ0NCaEJtbWU3ZWZNU1VTelVVYU95VDVPYU4tMGFVeHBvb3BNU3pUTjk5V2JWMlZWWFg5ZVlWMFdhTi1WLU90dktLVVN6TXJzMTc5N1Z0cHpWNnJyU1NyekJoS0NLTVNyVC1XYS1WMFYtWDc3Y2EtLVV6enp5SHBNVC15VC03LXNPYU9iYnlUVE96VXRzVUlNU3BTUm5Nek1UMFdzVE9zOTdoSUJlWC1YN3RWVnR6VmM4V1dhVW9uTXpiS1VzVFViU3hybk1VS0Jvb25KbkpncEJwQm9wdGFOT3R0YVQ1TlV4cHJDVVQxLVZPYmJ6clV6enlUVXp6enkyelN4eHh6cnktMS1XcmJ0YnM5emJ6VjlVVjE5LWZhLXRhVE9wVVd4TXNONzE2YVVLeVVwczB4emFOTjBWT1diYVV6U3J6YU1yelZjWDE1NU9WT1YwenRieS0xOTlmMVhPV2EtTi1UT1dhNVVhTlVhT2E1T2FVdHp4dGFON2VnWXktVlRPYVVybk13bkt0enhwemFJQ1Rtb29tZW5DS1M5ZTloU0t4emJyU3JTS0JncE1LcldzLV95VE5NYk15VE96ckpuSG5LeHJLcFNNS01TcHByS1NTTVU5ZkJvcEtLcGNmS1NNQUlLU3JVTU1wU1NyVXpWYnJNVVVUTXltcEtyU3JVVXpNQm5LU0tyU3hwSnBNclVTU3BTS1M5N2NYWFhYY1hYWFg5OTk3Y2NYN2M3WDdWMTExNzFOLVYtVlZYMS03MTExNy03LVgxOTk5N1YxbW9wS3JTeHBNTUtwUGVWWDdoSmZLQ0NLTU1NTU1LS3BwclVhNkJwZXBLQUs4VjFtZW9tbW5LTVBncEFBQ1Jlb25BQ0JvcEtTSUtNTUNLS0tLS1JwS0NLSm9wclV0YmJTU1VzNE10YVQtNzhzVXh6endweHhweHJLS1NTU1VTcFVTU1NTU0tLS1NLS01LU0tKcEtLS0lLS0tKb29wQm45bWNjZ3BLSUNBTUlLS0tyS0NKbklJQm9wTU16eHhyclN4eHhyU3BTTVNwS0FCb2ZCbkJuOTc3MTBWQTExMlYxMTcxbW1nbjlrN1Y1MS03WGVjWHBBSGhBSUJvb28tWDc1Tk4tWGVYbkJuS0lCbkNDS0JuQjlncEtwcnJ5VV9wcFN6eU9XVk9icnp5VFNoUGZJQm5DSzloS0NDSnBLenJ6eHByU3JTU1VyeHhxZWVlaFV4elVyckFCbklCaE16c094cnhTbWdweG5NSG5IaE1uTUlDSG1wTW5IaFN5TUJoTG9wQzlmSU1oQm5CbkNKb21tbWZBQTFuQm85N2M5bk1NckZoQmduQmVoQmdmQUJmSUtTeDlYMTdOMWVtWEFCZjlnbW5KZXBKbWhSbW9wS0NNU1VTeHJNU3JyVVN4cnJ4clNyU3JNU1NNS0twcENLS1JvZ25CZ2dvZ2VlZkk5bXB4cnI5bkJnZ29vZzctLU4tZTk5OWZBYS1YZkpWMTdzN1hBOTdYY2dlY1dWN2VlQUpwS0tKb29wQ0tCcEtLS3JUVE1NS1N4UnBLclN6cnp4eHJTdFNyVVVVU1NwTHBDTVNLTVN6TVNTUmVmN1hjZTdlOVg5OTctY1g5LWMtNzc3LTExMTk3VlhYMTdYN2NnYzBWMFZOTjFWT1YtMS1XVlYtNzdWY1Y3MS1WLTcxLS1BSlZWN1hoTUNCbWZCbkM3OTdnLUFDSTctT2EtLTExLVZjLTFYVlg5OTc5WDE3VjEtVlY3Y2VjOW9wcG5CbjFnWG83MW9vbWUtMW5IbWdmQnBLSUJnbW1jZW5JQm5CbkJuQUFBSUE5bW1vbkk5ZWdvWG1nZ29wQ01LS0tMcFFDSUJvb3BLb3BKY2duSUJwOWZBQ0ptZ2U3WDc3VlZhLTExLVY3LVZWVlgtVjcyVjctNy1WVlYxMS1WNy0tLS1WLS0tTjc4VjVOTi1WNnM5WE95MWNlcGdwUUlBOWY5ZTdYNzc3Vlg3VVRVYnRhMWVla1hYN1gwVmNYOTFjLS1nNy0xMWVtWGNlZVhYOWVlOTljZTlnN2NYOTk5WFhYWDk5WDdYVi01LVY3Y2VlZWdlWDdYOTc3WDc3LVg3WFZWLTUtMS03LS1lY0QtOWhCWDk5b25BTVNLSU1KcEtTcEtyTUtKaElNS29wU1QtTk9hT3JSb3BJQmZJTVNTTXp4elVwelVVYVVhVWJ0dHlVYU9oQnBJSnBwTUtwclN4clVycktNS3ByUm5CbjlnZ25CbXM5Z25JQ0lLOTllZkJvbWNlWGduSUJjWGNlZWVYZWVmQnA5ZW1jZWVjZWNlZWdtZVhYZWVrZWU5WDlYZjllY2VlN1g3LTVOLWEtTi0tTk9XVk4tLVYtMS1WMS0tNS0tLTcxMTE3MS0tNTUwYU41LS0wVjEtVjc3LTU1LS0tLS0tLS0tTi03WE90YTZhTjFnZ25CbW5JN1ZELVZOTi0tTk4xZ2hLQnBLSUtLSnBLSUlLQ0tLS0NLSUtLUm5Cb3BLS3JLU1NJSnBJSUpvb3BDSUpwS1VLU01McFNLS0lJSnBLS01TbktyVVNTcHBLcE1TTUtwU0tyS3A5ZWVwVXJwU1NLcFNwcnJyenp6U3Jyenp6clVyenhyVXpVelV5VFN4bklDS0NBQ0NDQm5BQm5CZ25CbW5BQm5DQm5CZ21uQmdtbW1nZ2dnZ2Y5bWVlbWVYZ2dmOW1nZW1tbWVuQUFBQm1tbW1YaEE3Y2duSUlBSUJuQm1oQm5JQm5LS1NNU3BnbkNLUm5LS01LS3BLU3ByUU1RQ0lLS0NLTUtDSnBLS3BNQm9oUm1uQUJmQi0xVjlzUVI3M3EwOWtDSUJlZDk4OWNDSFpwTVVNTVNNU1VPeGJweTBiYnhTcmFPYU9jN1RWUDI5QzlWYzBWQmVjVi0tN05WVi1OOEg5dy0tYzlCZ3JYLUJWaFFJQ0tyU3NWLTFWa05CMURuOWNob2VBRUhwOUE5ZUFLS3A5ZkNJOVhtZTExOEJnZWNYN0lLS0FLckpjZTcwY1hYWGNYTVNwcEN6U3BKeFNNS1NLU1Nyay0weHB4eHpiYS0xN094dGE1NnBhT3NOTlRPeVRPYS0tVVNrV3pNVVV6cy0tVldicnhyclZWLWQ5ZTdWSHNGR0ZwQTlCbkN6eklJOVg5N3B4UzlYSFZab29ncVV0enFVeVV4eDUwV3NUT1htZ2NPdVZPWGMwVDRDb2hwb2Nob3B4enlON1g3TlhWLWNOV3VyWC1BV19tUTlob3J5V2EtLUQ2SkFCcU4tNTFXWjRhTjc5LTFYT0oyT2MtNThfSUJOLWk4aHJDQmZJdHphLVYyTmQ1b25FSU1MT3MtWC0wc2UzZ3ByT1gxVjVOZXpIclM5ZUFDcHJweHkwYU43Y1ZWMDdoNFpweTFWM3NoRUZuS01VcnpjVk43STkxVi1jaGdSd1AtLVh2YjZWMzdqTzJtZlN4clViYTc5Y1YzY2pYVHBKcEpPeVRPWDdnYy0tMUI3MGktNlkxMDJLdHRYZS00WTItUUJyV1YtcUJrbEJvcHR6dGY5LTctYUJ6ZXd6enlQZWUtLVlHZzItRHNwdlpvZWVlWG1lQTltZ21vZ245ZlNBcHJhMHR6V3p5NnR6emJ6enR6YS1lLTFZUjBmUi0tUERuaWhLdFZYLVNZaTBuTVM5VmVjbk1TVXp4YzdVTk41ZVY0SEUzTHhIeDlIZkE5bkJ4cGFYNVRVYnpVcEtETlVLQmg5ZTVCZkNNU0ZUNnpVYmFPZDlWMGFQN09aZWNXVi1kWWxMMkFBSUJtY296TW9wb2hwelUtLS1OT2FPYTZYOTctTEVIWkJ6YmVWMDd5RnN6cTlWLWN6OUZyWC00WXh3YkhjNnMtOUZKcEJ5VjBkMGtYblVUN1YtLUZUYWMtNUZ2QkNWLVhHRmVCbkVVYTEtNjg2SE1uSm14Q0lBVFVwVXpWNS0tNTdlVjJ0NmREbkFCcGx5VWFOMWMtLUd4TWMtOUhCNWd0VjM4ODYybkNCb3BhMHRhVDdWMGQ4QXlwcE43LTFUSE9VUm1vY3BBS3BCYzl6U01VMGFONTUxLVVTTC0tLVdaYmlmQm9nbjlnaENVckxUVFRPeU9XczdlN1YwOEY1bW9vNS00OE5HU216Sm1WQ0tLNmxzLTBWLTFfbWVRRk4xOU1JR0JyS0tLS29wS3pXYVVic1g3WDc3LTE3Yy0xUDgwRDA5YWJsUUtCeHJTU01TeHpVU3BTclNyU3ByTU1VU1ZWVlZWMGJhWFg5OTdYWDdjY1hWWDE3WDdjLURROXZCeFgtUGJsR0lNTVNyTU1Na1ZWT3RlOTdlWDctRFVEVUNMMS0wYndtZkQtM2MtU3ZDNTUtTmNBUGZwcHBwU3JTcjExMTdYMTcxLUp1NDJabjlnbWQ5Y2VjZUFNU3JTcHBLclNJQmZyS0NNVVVLay1UOW1jVjVVYTVVYno2dFgtLTBhT2ExWDkwMmNLYnJDS0tKcEhwSUpuSUtCbkNDQmZCZkVyeU90dFZPdTVPYVRONU9YMGEtNy0tMS0tLWNSeU0tLVA5ZXNuVm5lRzl4bkJtbjlncktLSm5JSnBLU0tNS0pwb3JVb25IZTJJQm1tbkNCcENLclNyS3BwcHhyU3pVenh4clY1LU5OTk9WLVdzLVhWNTVVclNyeHlPYzc3NS03ZWdvZTUwV3RhN1g3NzdOLS03Vk94clNWV3RielVVU3FWNmJXYU4xOWNWWDk5Z2VjZW1kOWVjMXhkRm4yU3JKZUNwS3JNU3JLcFNLU0tJS0tJSUNDSTlYS01LQ01TSUk5Y29tb21uQUFCcENJSnBCbXJUT2JzMHRhVDVPc05PemFVU0tNVXRWLTBhWFgwV3hPemFPVjB6cjE3NTB6ckdXWC0tWFZWVi03N1g3VjBWVi0xMTdYWFhjSFgxVjM5TnUtbktyVVV5UDdYOVhWRmVUVzB4ckk5OTdLQmNYQmduQ0FKcHRhNTBhVXBJSUJuS1N6YmEtMFZWVXpicU5YMWMtLWRBX2MxOWVHb3dnZ2duQ1NTR1dXV2JhVXNVVVVjY2VlNzA1ZWpIenJ6VVV5TkE5ZVhlVjE5ZkZ2b25PYVRYLVJmX1VmS0NCZUlTSnhyVC0wV2JiVk5YZS0tQWN5WC0tQWVudS1sZnpBQUJlY29uSm5VUDVVclNwS0lweExWMHpNTDUtVjctLTFYNy0yZ1RKZkFPVi1BUXgzay0tc1UzYzFUdkIxQm5LQ0lLSUtDcE1TR3pyLTBWTi0tNzUxLTE5LTBpdXIyazBGa09yUUJnY2VaZ25LS01NS0tTSm1YeHBTU3ByTXM2ckpuclVyYTVOWDctWDEwWDBhT1ZOLTFjVjcwYzE2MjU4Z2ZBOWZKbW5JTUt4enlPYU9zLU5OTlgtN2xFbEFNcnlYZTctMDQyb2MtQTRBS2hOLTdnS2JjbXBJclg2enJ4ck16VVZlVlgtZ29jVlhWLTNNbVZWLTNOcEhWNHdOcTNtbW1yVVVyTVVUUDc3LVg3LS1sYXpZVjNSUTZpbWZyclNwcnMtMVg5LTdsaU1RRU94c2U3MEU2VElCbVp4bHh4S09hNzdWVjBJNnZYQmVmS01JTTVPdGE1MGNWLVJXNFJ3LTBSVzVjbks1LS1PbTVFQUJwTUtCaFN4eHMxNy0wVjVYLS1INUgxLTltQ2FZQm94YmFQNzBlbUNjMk1TSUJlcEpmSUlCbVZQN21uQ0lBQUNDS0lsVjUwYnhxVVY2enh4cENLcHJ6emFVS2E1NzdjV1ZOVXJPdFYxN1YxN1Y3WGNjLS1IRVAxLTBtSTVJRi0wbUxnUUYtYW1UMVlJQm9uSUlJQ0Jnb25HYU9hTk9XVk5PV2JhLTAyQVMzaEtJS0lKTjBWLTUtLUFCeWZDc1YtQnFFNWstNkN0TWdOLTBENHdjRHpETFFDQ0NCcElJQUFVSm1tZkJuQUFKb25DQm9vbWdnZ2ZBQnBBS0NKZWVjbWU5SUJuS0tLck1KclNyelVTS3BNS3B6cnR0dGJ4cE1iYnFPYVV3VXhPYnpycks2YVRUVE9hNTU1MFZjMTU1T2JXYU9zOS0tMFdXYnR6eU5jZTljYy1OZTdWY2M5MHpiY1YwenR0ZTkwYnlUT1hlWGVlZVZOWGVlVjBSdXBUbkNsVi1obmdIMkNDQ0NKcEtLS3BwVVV0emJ0YTUtVjc3Ny1YMTc3WFYxd3hfWm5JS0thTi1WLVBudnJZQ0pvb2VyU28tT3p1WFZUT1Y3MU1FanRnZ2VlZWdnbklBQUNKb1RVenJNVWJidHR5Ti1BRXlraEQtLXgwR1pyc2MtMkZZMmctNG85Z1FDU1gtQ2pGc2VCb25Ib25CZjllbjllZWdmOVhmQ0lCZkJwQ0tNTUhoQ0NLcENLSUNJcE90elNNTUtLSUp4VWJiczdWTjEtLS1WVjVPYmJ4cktDRVN6VXBJU3kwYmJic2UxY1g1LVhWY1hlVjZ5NmFUTk5OZkJtZWhDQ0JlZTE5Y1ZWLTBhNmJ6dHR5VXlUVXR6d1V0dHRhTk5PV1YtMW9JbVFMLS1BR1EwQ05WLXg1SWt4a1YwSUlJWVhtMlY3WFhleVV0YTVVVi00NmZ5VjBDNzhCclQ3VjBTODNxbkF5UDJJb2lkbkNTcHJyU3hyU3pyVU1TeHBNeHpVVVNTTU1NTVN6U1NyclNwck1TcE1TU3hyU3h4eHBycnJyclVyeHJTVVVidGFVVUwtLS0tV1gtNU45N1g5ZW1WUDk3NzE5ZWNYLTBhTmNnbW1lNmE5ZVg3MTk5ZTc3Z2VjVlg3Y1hYWFhYY1hYNzdYN1g5ZWdlZVhYOS0yb2l0QUNzVjBoQW9KbkVic2MxRUlYMEJnZWVuOWdmOXJTYU96eld5VXJ6cU5YOS0wQ0UtWG54VlYtNEZxZVYwU0dJdW5PYmUtMXA2MjJUNy0wSlJEYy0wSmZHYy12SzBDZ2dnclV6YVQxOVYtQ0xERHMtNkt1MENWLUFMTWJFTlYtQ092QmstYkxvUmpTclItY1gtOHBwNzJJSm9PV1YtLTRUM0hWLVNUWUJxLS1oVGJQb04tNnB6eG5CcFQwWC01cTRUZkNHYU5WLXhYRkhwTjctNk5faGgtLTJOZnNCLU5xQlVRSGVDQ3R6U1NTelQxY1gxMS0xQ1otTnBwclgxNy03cU1YbkNNeU43Yy1JT2ItQm5hTi0wT3d6YzJmUEFsQmdnZ2Y5ZkFIb29uQUFCZ25DS0NiYmFUNU9XYU9hVE90YmFUVE9hTi0wUGlONy1NUGtKQmY2dFYtNGZMdVYtU2dPOWxWLXBoTFQ3dFYtNGdxTlYtNGhsNVYzeGlGd25BOW5BUk96cU9hT1hWLVNpZmFuVkdLd1dGT2FPVjZ6enp6VVV5NnR6dGJLdGE1NnMtV3J6enNOLTVUNHJLcHBwU0tTS0tLTS02U2syUm1tZVhnZWdnblRVYnh5VFVieU9lLU9Nbm0wYTUwYU9WLU5OT3lOT3h0eU4tZlJadWdlbnp0dHVjNk1SZzJnb29lZjllZW1lWDdYZWVlQTlZOUJlaENJVXpyTVV6emJyeHp0dHp6dHpVenJ6cVV6emJ6enpiYnpyenpWLTlmQTllZVgwWGVCZWVZOWU3LURyQTh2U3pyT3RhWGVlYy0wUzd1Ny1yUzh3QmhDVWJ0dGNlYy1iU0dDZ25DemFOOS1Cckw2UUJlenh5VFBYVjRocFlMbWdmQ3R6eHpTdHRYOWNlLSI7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYlIuZU0gPT09IDE5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiA9ICJFY0N4LVZRQ08xaWlxT0xPS2VlZWRhZV9kZGFkYWRhZE9maXZlT2VMZWVlZWRhZGFQaXV1aWVQUGVleWVlZWVPZWFQYWRhZWV5ZFBlT2VkYU9QTE9lZWVPYWRMT0tMS0tMSkc0RzNHNEc0RzNGLTNHSkc0RzRLS0c0NDNHM0czRzNHNEszSzNLM0dLS0szRko0MEYzM0dLMEswSzNHM0YzRjJuQm5CbkJuQi1Cbi0wNEctLUJ6endFQnl2bi13Ry1Cbm5CMkJrRzQ0Sy00S1BLUXlkZV9LLUczR0tGd0dQS09fT19LM0o0S0c0S0tHNEtLS0pHNEtKS0szMDMwNExPSkczR0tLS0tLUXZqenV6eml2aXVlZWFLYUtQS0tLS0tLS0tLM0tfZU9LT19PZWRhS2FMYU9ldmVkYU9HT2VPZWVhT2FPYU9lT2p6dmp5YVBlT0tLS09LNDNLX0tLYXZlSkdKMC1KRzNHM0dGM0czRzQzS2FLRjNHNGFPZWRhT0ZLTEs0X2VlZV9kSkszM0tlYU9MT2FPanZlZUtMT19PYU9hZUtMUGVpdmplYU9lT2FKS0dLSjRQZGFkYWZpeWplZExQZXVlSzNGLUczMEYzRzMtM0xPYU9qZUtMUGVfT19PZWFQZmllaWVleWVhT2FQT0tPZWVkZU9kYWRhX2RhT2RhS2RfT19hT0tQT0tMS2FLZEs0TEszTFRkYU9kS2FPS19LTFBPYWFPX0xQS0dLS0tfS09hTE9fYU9PYWFPZGFQT2RhT19PYUtPZGFQT2RhUGVkZU9KRi0tMDBMYVBkZWFlT2ZleWVpdXVkYXVlYWFQZGJlT2V1ZWZlZnVpdmZpZnVqaWZpZXZpaXZpZmVlaWRfRy0wNE9GMC0wM0thUHZpZXZqaXpmZWVMSjAtSkctS2RPVHZmaXl2aXl1amZmdml1amVpdWZlaWVmaXZpdmZpdnZmZWV2aXZ2ZWl1dWVpZWllZmVlaXllamZmdWl1dWl2aXV2ZmlpZmlpZWVQZWVhaWVpZXZldWVQZGFQS0pLZWZlZmVmaXV6enZ6aXZ2aXlmdm52anZ6RXp6anp3enp6Qm56d25uazJCd2tuMnp6a25CLW4yQm5FQnp5enpCenpFd256em56enpqZnpCend6em56aXoyenduQm5CQmtCLS1CMkVCem5FekJ3bkJuQnp6QmtuRW5FQnl5d3p6enp6RXp6Mnduemt6em5FQnd3RW5FbkV6em5Fenp6enp6enpFend3RUVpeml6aXppdmp2amZ6bm56eXl5dml2enp3bnl2aXVpenlleWVLYmlmaXVpenp2aWZpZWV1eXZpdWl1ZWZpZV9pdmlpeWp6dm4zRjNCbnctQm5CbjJCbkJud253bnduQmtCQmsyMm5Fbi1FZWVpZUtkZWl1ZGFPYU9QZWRhZWVQZWVlX0tLTFBPZWZ6a3pFRWp6d2syQi1rLWtCQjJ5aWl1aWV1ZWVhZWVhT09hT3Z6enpCenZqaXZqdWl1eWV2aWVpZmllZGFPZXVldWl2aXZpZXV2Znl2enZ5dnZ1dXZ3enp5eXZ6enZqaXZ2aXZ2anl2em5Cbm4yd3p6bndvTEstejJCa256RWl2ZVBQTE9PdmpCd25FZmZldXl6ZWZ6dXV1am5ra0dHLXl6RUV6Qm5FQm5uQnduRUJuem56enZ6enpuenZ6ekVCbnpuLWstay1rLTItd0IyQi1rMi0ybkJCMmtCQnduQnctbkItMkJrMjJCdy1Ca2tubkJCQkJCbkJFLXpuem5ra0VuRTItLWtFQmtuQkJrQkJrMkUtMy0yQmstazJCMjJCQjJrLWstazJCQm4tdzItMzJrLUMzRi0tay1GRzBHLTIyLTItRkItLWstMi13LUczMkVuLS1uQi0ya0tMZVBMZEZKRzMtRjAwMzNHMDQzLWwzLUczSzNKSy0zMkIzRzRLNEYtLUItLUItLUZHTEpHSjNGMDNKTGFlS0ZHLS0wLS0tQkZLLS0yMDNGR0dGRzMzRjJuQkZHM0ZHSjRHSjRLMDJHS0YwMy1HS0tHM0swSkZLM0cwM0YtLUctLWw0My0tQmstLWtHLUZGM0YwM0ctNDAzRy0tLS1sMC0tLS1HLS1CbjMzR0pHMzQwSkczLUc0S2FMS1BLRy00LTNGM0YwMy1CLS0tLS0tLUczRkowMC0tM0tHRi0tMC0tLTAzRzAwMzJUNG1mZ21lZ21lWDdmQm5KbktJRXp6enpicnB6emFPYnRWT2FOWDljOWMwSk45Y1FmanpHRzBGNE5vV3luQnBKbkt6enpWLS0tWGMxUmZNbE9PdmZ2endFdzNHS0tGLTBnQUlWLTJPSzItM2FvYXpCanMtcElVZHlPYUthS2FPZnp6dmdCbkJGLS0tMWdJblYtNE9hQS1CZXhlcktFU3JzLVY5VjNxNmU2ZGF1Vm4zLTBmUEhCcE1zLWMtU2lxV1F3SjFtdFJTVVNLS0tLS0tKT3p6eHJST2MxMS0tVFgtWDdWN2VlVjRNZW8yYXZpMmtDSy0tRWNOeS1PVUpmaUxLZFR6c0JrLTBrQ1ByRjBmVlZSaml2ZXZlaXVlT3V2ZWVlZWFObi1uMjItQkctLTAzMDMwM0szRjNCNi1ubkJuQnJTcjBhLS0tRXNUWFF1ZGV2aXZpZWRhemstMi1HLTAzMEstNGwxdE1Da09jLTU3TUlzLUUzSWhTNVAtQ1lBLURMZXctLWtvSXlBOWVtbWZBQ01TclV0Ynp6elRUT2JyVXRWN2dlN1g3ZWVWOFFuWnhkZGFlYmp3bkItMzBGM3h6QlpuTUtDTXpyYTcxLTdjVjN3QTRwX1F6em80RmZ5NXlhbkhwSUtTS01LU01TU3JLS01vZkpwcE1LU0tyU3BTTUtTenJ6enJVdGFPenNUTjFvYzVPYVV6ckhuQ1RPdGFQNzU1TjUtVC1OVVROTi1OLTUtNS1OLVA3WDk3Z245Z21lZWU5bjltZWVYOTdjWDdlVmVYOWNYViI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgKG5ldyB2SygpKS52TShwTik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFJbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy52UyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpwID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hSnEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpyID0gWzEyMCwgMTA1LCA5Ml07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29zID0gWzEyLCAxMiwgNjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKcyA9IFszMDAsIDMwMCwgOTgyNywgMjYsIDE4LCAzNiwgMzYsIDgsIDMyLCAzLCA5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSnQgPSBbMTQwLCAxMzAsIDEyMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUp1ID0gWzEyLCAxMiwgNzZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKdiA9IFsyNDAsIDEyMCwgMTAyNCwgMzAsIDE5LCAzMCwgNzAsIDgsIDIwLCAzLCA5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSncgPSBbMTMwLCAxMTcsIDEwNl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUp4ID0gWzEyLCAxMiwgNjhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKeSA9IFsyNzAsIDIxMCwgMTAyNCwgMjgsIDE5LCAzMywgNTAsIDgsIDI2LCAzLCA5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlMgPSBuZXcgQXJyYXkoYlIuYUlsICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzBdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTM2KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiAyMzAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogMjMwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxxOiAxMDAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiAyMDAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJczogMTczDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1sxXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDEzNyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogODAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IDgwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiA1MCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXM6IDQzDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1syXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDEzOCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogNTEyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IDUxMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTI4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiAzMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXM6IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzNdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTM5KSArICIgMSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogOTYwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IDk2MCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogNjAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG46IDgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUlzOiAwDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1s0XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE0MCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogOTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IDkwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiA1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJczogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbNV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNDEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IDEwMDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogMTAwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiA0MCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXM6IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzZdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTQyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpOiAxMDAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGo6IDEwMDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbHE6IDEwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbjogMjAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUlzOiAwDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1s3XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE0MyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaTogMTAyNCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqOiAxMDI0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxxOiAxMjgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG46IDMyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJczogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbOF0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNDQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IDgyMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqOiA4MjAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbHE6IDIwMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbjogMTAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJczogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbOV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNDUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IDEwMjQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogMTAyNCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTI4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiAzMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXM6IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzEwXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE0NiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnU6IGFKdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2djogYUp1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKMjogYUp2DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1sxMV0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNDcpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ1OiBhSncsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnY6IGFKeCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSjI6IGFKeQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbMTJdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTQ4KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2dTogYUp3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ2OiBhSngsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUoyOiBhSnkNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzEzXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE0OSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnU6IGFKciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2djogY29zLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKMjogYUpzDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1sxNF0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNTApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ1OiBhSnIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnY6IGNvcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSjI6IGFKcw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbMTVdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTUxKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2dTogYUp0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ2OiBhSnUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUoyOiBhSnYNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzE2XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE1MiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnU6IGFKdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2djogYUp1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKMjogYUp2DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1sxN10gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNTMpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ1OiBhSnIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnY6IGNvcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSjI6IGFKcw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbMThdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IEwoMTU0KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2dTogYUp3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZ2OiBhSngsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUoyOiBhSnkNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzE5XSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDE1NSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdnU6IGFKciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2djogY29zLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKMjogYUpzDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52U1syMF0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogTCgxNTYpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IDEwMjQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgajogMTAyNCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscTogMTI4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiAzMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSXM6IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZTWzIxXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBMKDEzOSkgKyAiIDIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk6IDk0MCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqOiA5NDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbHE6IDgwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxuOiA4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFJczogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudlNbYlIuYUlsXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiIg0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUpwID0gbmV3IFVpbnQ4QXJyYXkoMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDEwOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSnBbYUJdID0gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFKcFsxMF0gPSAyMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUpwWzExXSA9IDIxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hSnEgPSBuZXcgVWludDhBcnJheSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCAxMDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUpxW2FCXSA9IDEwICsgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSW8oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QsIGVuLCBlcCwgZk47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpsID0gYUFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKbSA9IGJSLnZjOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSmsgPSBpIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoUiA9IGJSLmVzIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gMTsgZXAgPCBoUjsgZXArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZOID0gZXAgKiBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSAxOyBlbiA8IGFKazsgZW4rKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IChmTiArIGVuKSA8PCAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUptW2dEXSA9PT0gYUptW2dEICsgMV0gJiYgYUptW2dEXSA9PT0gYUptW2dEICsgMl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSmxbZ0QgKyAyXSA9IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhby5hNXAgPSBnODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpvID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpsID0gYUFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSmsgPSBpIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoUiA9IGJSLmVzIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IDU7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IDE7IGVwIDwgaFI7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZk4gPSBlcCAqIGk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZW4gPSAxOyBlbiA8IGFKazsgZW4rKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSAoKGZOICsgZW4pIDw8IDIpICsgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFKbFtlS10gPT09IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKeihlSywgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBNYXRoLm1heCgoaWQgKyAxKSAlIDI1NiwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhSnooZUssIGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFKbCA9IGFBWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExZCA9IFtlS107DQogICAgICAgICAgICAgICAgICAgICAgICBhSmxbZUtdID0gaWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFlID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlViA9IGExZFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVrID0gZVYgKyBlaVtlal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUpsW2VrXSA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFKbFtla10gPSBpZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMWUucHVzaChlayk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFkID0gYTFlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gYTFkLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgeEI7DQogICAgICAgICAgICAgICAgdmFyIGFBWDsNCiAgICAgICAgICAgICAgICB2YXIgYTNmOw0KICAgICAgICAgICAgICAgIHZhciBhM2c7DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYTNiKCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoeEIgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgeEIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHhCLndpZHRoID0gYlIuZXI7DQogICAgICAgICAgICAgICAgICAgIHhCLmhlaWdodCA9IGJSLmVzOw0KICAgICAgICAgICAgICAgICAgICBhM2YgPSB4Qi5nZXRDb250ZXh0KCIyZCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiB0cnVlDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICBhM2cgPSBhQVggPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICBhM2cgPSBhM2YuZ2V0SW1hZ2VEYXRhKDAsIDAsIGJSLmVyLCBiUi5lcyk7DQogICAgICAgICAgICAgICAgICAgIGFBWCA9IGEzZy5kYXRhOw0KICAgICAgICAgICAgICAgICAgICBiOS5wcC52ZChhQVgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjZCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGY4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgaTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGo7DQogICAgICAgICAgICAgICAgICAgIHZhciBtYXg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhSzA7DQogICAgICAgICAgICAgICAgICAgIHZhciBsbjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFLMSA9IDEwMDAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUsyOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUszOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs1Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs2Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs3Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUs5Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE3ID0gZnVuY3Rpb24oYTJzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhS0EoYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLQigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtDKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhS0QoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpFID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtBKGEycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGEyc1swXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGogPSBhMnNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBhSzAgPSBhMnNbMl07DQogICAgICAgICAgICAgICAgICAgICAgICBsbiA9IGEyc1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gbmV3IEludDE2QXJyYXkoaSAqIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gaSA+IGogPyBpIDogajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLMiA9IG5ldyBJbnQxNkFycmF5KG1heCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSzMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLNCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUs1ID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhSzYgPSBuZXcgQXJyYXkoaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSzcgPSBuZXcgQXJyYXkoaik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gaSAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSzZbYUJdID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gaiAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSzdbYUJdID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhSzggPSBuZXcgSW50MTZBcnJheShpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLOSA9IG5ldyBJbnQxNkFycmF5KGopOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLRShlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFLRiA9IGF4LnJhbmRvbSgpICUgYUsxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxxID0gYXgucmFuZG9tKCkgJSAoMiAqIGFLMCArIDEpIC0gYUswOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtHKGFLRiwgbHEsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS0goYUtGLCBlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxxID0gYXgucmFuZG9tKCkgJSAoMiAqIGFLMCArIDEpIC0gYUswOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtHKGFLRiwgbHEsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS0coYUtGLCBscSwgZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLMlswXSA9IGFLRjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAxOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUsyW2FCXSA9IGFLMlthQiAtIDFdICsgbHE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLMlthQl0gPj0gYUsxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLMlthQl0gPSBhSzEgLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBscSA9IC1scTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFLMlthQl0gPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLMlthQl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBscSA9IC1scTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBscSArPSBheC5yYW5kb20oKSA+PSAxNjM4NCA/IGxuIDogLWxuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBscSA9IGxxIDwgLWFLMCA/IC1hSzAgOiBscSA+IGFLMCA/IGFLMCA6IGxxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS0koZW4sIGVwLCBhS0osIGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUtKKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtLKGVuLCBlcCwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS0woZW4sIGVwLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtLKGVuLCBlcCwgZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjhbZXAgKiBpICsgZW4gKyBhQl0gPSBhSzJbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLTChlbiwgZXAsIGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4W2VwICogaSArIGVuICsgYUIgKiBpXSA9IGFLMlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtNKHZhbHVlLCBlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBhSUosIGVLOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhwID0gdmFsdWUgLSBhSzJbZWcgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChocCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFJSiA9IDEgKyBiSy5kbShNYXRoLmFicyhocCksIGVnIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSUogPSBocCA8IDAgPyAtYUlKIDogYUlKOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUsyW2VnIC0gMV0gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVLID0gZWcgLSAxIC0gYksuZG0oTWF0aC5hYnMoaHApLCBNYXRoLmFicyhhSUopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVLID0gZUsgPCAxID8gMSA6IGVLID4gZWcgLSAyID8gZWcgLSAyIDogZUs7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAyOyBhQiA+PSBlSzsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLMlthQl0gKz0gaHAgLSAoZWcgLSAxIC0gYUIpICogYUlKOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhwIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLTihlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLTyhlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtPKGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAyOyBhQiA+PSAxOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLMlthQl0gPj0gYUsxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLMlthQl0gPSAyICogYUsxIC0gYUsyW2FCXSAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLTihlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGVnIC0gMjsgYUIgPj0gMTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSzJbYUJdIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSzJbYUJdID0gLWFLMlthQl0gLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS1AoYTFkLCBhMWUsIGVnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExZFthQl0gPSBhMWVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLUShnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBnLmxlbmd0aCAtIDE7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IGdbYUIgKyAxXSAtIGdbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZ1tnLmxlbmd0aCAtIDFdID0gZ1tnLmxlbmd0aCAtIDNdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLUihhNEQsIGdhcCwgaFMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLMy5wdXNoKGE0RCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSzQucHVzaChnYXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUs1LnB1c2goaFMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLUygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhS1QgPSBhSzMubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhS1QgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLNFthQl0gPiBhSzRbYUtUXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS1QgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUtUOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLQigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLRShtYXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtQKGFLOSwgYUsyLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLSSgwLCAwLCB0cnVlLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLSChmOFswXSwgbWF4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLUChhSzgsIGFLMiwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhS0koMCwgMCwgZmFsc2UsIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtRKGFLOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhS1EoYUs5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLRyhmOFtpIC0gMV0sIGFLOFtpIC0gMV0sIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtJKGkgLSAxLCAwLCBmYWxzZSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBhS0coZjhbaSAqIChqIC0gMSldLCBhSzlbaiAtIDFdLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLTShmOFtpICogaiAtIDFdLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLSSgwLCBqIC0gMSwgdHJ1ZSwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhSzZbaSAtIDFdID0gYUs2WzBdID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLN1tqIC0gMV0gPSBhSzdbMF0gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtSKDAsIGksIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUtSKDAsIGosIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS0MoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUtULCBhNEQ7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLVCA9IGFLUygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSzRbYUtUXSA8IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNEQgPSBhSzNbYUtUXSArIGJLLmRtKGFLNFthS1RdLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUs1W2FLVF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtVKGE0RCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtWKGE0RCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLUihhNEQsIGFLM1thS1RdICsgYUs0W2FLVF0gLSBhNEQsIGFLNVthS1RdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhSzRbYUtUXSA9IGE0RCAtIGFLM1thS1RdICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS1YoZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZywgYUtXLCBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRTAgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFLWCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYUtYIDwgaSAtIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUUwICsgMTsgYUIgPCBpOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSzZbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS1ggPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gYUtYIC0gYUUwICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS0coZjhbZXAgKiBpICsgYUUwXSwgYUUwID09PSAwID8gYUs5W2VwXSA6IChhSzJbYUtXIC0gMV0gLSBhSzJbYUtXIC0gMl0pLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtNKGY4W2VwICogaSArIGFLWF0sIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS0koYUUwLCBlcCwgdHJ1ZSwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLVyA9IGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFMCA9IGFLWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFLN1tlcF0gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLVShlbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnLCBhS1csIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFFMCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUtYID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChhS1ggPCBqIC0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRTAgKyAxOyBhQiA8IGo7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLN1thQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLWCA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWcgPSBhS1ggLSBhRTAgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLRyhmOFtlbiArIGkgKiBhRTBdLCBhRTAgPT09IDAgPyBhSzhbZW5dIDogKGFLMlthS1cgLSAxXSAtIGFLMlthS1cgLSAyXSksIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS00oZjhbYUtYICogaSArIGVuXSwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLSShlbiwgYUUwLCBmYWxzZSwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLVyA9IGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFFMCA9IGFLWDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFLNltlbl0gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLRCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVuID0gMDsgZW4gPCBpOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSzZbZW5dKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSAwOyBlcCA8IGo7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUs3W2VwXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLWShlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLWShlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGY4W2VwICogaSArIGVuIC0gMV0gKyBmOFsoZXAgLSAxKSAqIGkgKyBlbl07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTYwID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhSzZbZW4gKyAxXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE2MCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IGY4W2VwICogaSArIGVuICsgMV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUs3W2VwICsgMV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNjArKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSArPSBmOFsoZXAgKyAxKSAqIGkgKyBlbl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmOFtlcCAqIGkgKyBlbl0gPSBiSy5kbSh2YWx1ZSwgYTYwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRlMoZXosIGYwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBleiA+PSAwID8gYksuZG0oZXosIGYwKSA6IC1iSy5kbSgtZXosIGYwKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24galMoZjgpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4ICogZjg7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE1RShleiwgZjApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV6ID4gZjAgPyBleiA6IGYwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQTEoZXosIGYwKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBleiA8IGYwID8gZXogOiBmMDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYTdRKGV6LCBmOCwgZjApIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGY4IDwgZXogPyBleiA6IGY4ID4gZjAgPyBmMCA6IGY4Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS1ooZjgsIGVnKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IGJLLmRtKGY4ICsgMSwgMik7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZjEgPSBiSy5kbShmMSArIGJLLmRtKGY4LCBmMSksIDIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmMTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUdwKGY4LCBlZykgew0KICAgICAgICAgICAgICAgICAgICBpZiAoZjggPCAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUtaKGY4LCBlZyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLYShtQywgbUQsIHMyLCBhN0EsIG1QLCBtUSwgczMsIHNrKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG1DICsgczIgPD0gbVAgfHwgbUQgKyBhN0EgPD0gbVEgfHwgbUMgPj0gbVAgKyBzMyB8fCBtRCA+PSBtUSArIHNrKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtiKG1DLCBtRCwgczIsIGE3QSwgbVAsIG1RLCBzMywgc2spIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1DIDw9IG1QICYmIG1EIDw9IG1RICYmIG1DICsgczIgPj0gbVAgKyBzMyAmJiBtRCArIGE3QSA+PSBtUSArIHNrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB2VShmOCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcighIWY4ICogKDEgKyBNYXRoLmxvZzIoZjggKyAwLjUpKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGJ1KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRtID0gZnVuY3Rpb24oZXosIGYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoZXogKyAwLjUpIC8gZjApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hS2MgPSBmdW5jdGlvbihleiwgZjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKGV6ICogKGYwICsgMC41KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNxcnQgPSBmdW5jdGlvbihmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIH5+TWF0aC5zcXJ0KGY4ICsgMC41KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucG93ID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5wb3coMiwgZSkgKyAwLjUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wRSA9IGZ1bmN0aW9uKHZhbHVlLCBtaW4sIG1heCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHZhbHVlLCBtaW4pLCBtYXgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hS2QgPSBmdW5jdGlvbihmTiwgZlAsIGZSKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5taW4oZk4sIGZQKSwgZlIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hS2UgPSBmdW5jdGlvbihhS2YsIGFLZywgZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTEgPSBlbiAtIGFLZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpNCA9IGVwIC0gYUtnOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFLaCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS2ggPSBpNCA+PSAwID8gTWF0aC5QSSA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLaCA9IE1hdGguYXRhbihpNCAvIGkxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS2ggKz0gaTEgPiAwID8gKDAuNSAqIE1hdGguUEkpIDogKDEuNSAqIE1hdGguUEkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFLaDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubG9nMiA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcighIWY4ICogKDEgKyBNYXRoLmxvZzIoZjggKyAwLjUpKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZzEwID0gZnVuY3Rpb24oZjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgubG9nMTAoZjggKyAwLjUpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUtpID0gZnVuY3Rpb24oYUtqLCBhS2ssIGFLbCwgYUttLCBhS24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhS2ogPiBhS2wgLSBhS24gJiYgYUtqIDwgYUtsICsgYUtuICYmIGFLayA+IGFLbSAtIGFLbiAmJiBhS2sgPCBhS20gKyBhS247DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndTID0gZnVuY3Rpb24oaGosIGhrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGogKiBoaiArIGhrICogaGs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkOSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gbmV3IGFLbygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJ2ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFLcCA9IG5ldyBBcnJheSgzMSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhS3E7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUtyID0gZG9jdW1lbnQuYm9keS5maXJzdENoaWxkOw0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFLcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLcSA9IGFLci5uZXh0U2libGluZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuYm9keS5jb250YWlucyhhS3IpICYmIChhS3IudGFnTmFtZSA9PT0gIkRJViIgfHwgYUtyLnRhZ05hbWUgPT09ICJJTlBVVCIgfHwgYUtyLnRhZ05hbWUgPT09ICJCVVRUT04iKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhS3IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3IgMjYyMzogIiArIGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLciA9IGFLcTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudSA9IGZ1bmN0aW9uKGUxLCBhS3MsIGEycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLcyA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtzID0gdGhpcy5ydjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMSA9IDU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJ2ID09PSBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLcyA9IGFLcFtlMV0uYUtzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLcFtlMV0gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ydiA9IGUxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUtwW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgha2QgfHwgZTEgPT09IDQgfHwgZTEgPT09IDcgfHwgZTEgPT09IDggfHwgZTEgPT09IDkgfHwgZTEgPT09IDEwIHx8IGUxID09PSAxMSB8fCBlMSA9PT0gMTMgfHwgZTEgPT09IDE1IHx8IGUxID09PSAxOCB8fCAoZTEgPj0gMjAgJiYgZTEgPD0gMjgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IG5ldyBhS3UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkID0gbmV3IGFLdigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZTEgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUt3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gNCB8fCBlMSA9PT0gOSB8fCBlMSA9PT0gMTAgfHwgZTEgPT09IDExIHx8IGUxID09PSAxMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IGEyczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkID0gbmV3IGFLeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZTEgPT09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUt5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IG5ldyBhS3oodC55LmFMMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IGEyczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSAxMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IG5ldyBhTDEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSAxNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IG5ldyBhTDIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSAxNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IG5ldyBhS3oodC55LmFMMyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMTcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMTgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMTkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUw5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxBKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxCKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxDKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxFKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxGKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMjkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxIKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlMSA9PT0gMzApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2QgPSBuZXcgYUxJKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkLmFLcyA9IGFLczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS3BbZTFdID0ga2Q7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBrZC5zaG93KGEycyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS3QoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhS3AubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUtwW2FCXSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMEwgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hTEoodGhpcy5hNDAoKS5hS3MpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTEogPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFLcFtlMV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnUoZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucnYgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLcFtlMV0uc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhS3BbdGhpcy5ydl0ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhS3BbdGhpcy5ydl0ucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ydiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5zZXRTdGF0ZSgxMyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFLcFt0aGlzLnJ2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZC50bikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhS3BbdGhpcy5ydl0ucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFLcFt0aGlzLnJ2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZC5ndCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkLmd0KGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwVyA9IGZ1bmN0aW9uKGVuLCBlcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhS3BbdGhpcy5ydl07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2QuYTBXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2QuYTBXKGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwdSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBhS3BbdGhpcy5ydl07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2QuYTB1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2QuYTB1KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwWiA9IGZ1bmN0aW9uKGt5LCBreiwgZGVsdGFZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFLcFt0aGlzLnJ2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZC5hMFopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZC5hMFooa3ksIGt6LCBkZWx0YVkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihjb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IGFLcFt0aGlzLnJ2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZC5hMTQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZC5hMTQoY29kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYUtwW3RoaXMucnZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtkICYmIGtkLmlxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2QuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJ2ID4gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTQwID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUtwW3RoaXMucnZdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNDEgPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFLcFtlMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFMSyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFLcDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLeihkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTE07DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKGRhdGEudXNlcm5hbWUsW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiSC5jbGVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhkYXRhLmFMTiA/ICgi8J+UhCAiICsgTCgxNTcpKSA6IEwoMTU4KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5hNDAoKS5hS3MsIG5ldyBydygyNSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogZGF0YS5ydCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnU6IGRhdGEucnUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0gPSBuZXcgcFooYUxMLnRlLGFMTygpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTE8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxQKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxRKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMUihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMUygpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmFMTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxUKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTFUoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEuYUxOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTFYoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTFcoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTFgoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMWSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxaKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxhKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMYihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMYygpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZChwYik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxTKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMTU5KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxmID0gW0woMTYwKSwgTCgxNjEpLCBMKDE2MiksIEwoMTYzKSwgTCgxNjQpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMCA9IGRhdGEuYUxnOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMTY1KSArIGI5LnpkLmEzNyhkYXRhLnVyLCAwLjAxLCAyKSArIFNbMTFdICsgTCgxNjYpICsgKGUwICsgMSkgKyBTWzIwXSArIGRhdGEudXEgKyBTWzExXSArIEwoMTY3KSArIGFMZltlMCA8IDEwID8gMCA6IGUwIDwgNTAgPyAxIDogZTAgPCAyMDAgPyAyIDogZTAgPCAxMDAwID8gMyA6IDRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgxNjgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgxNjkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgxNzApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxUKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMTcxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcVUgPSBuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBiaS5lRC5kYXRhWzE0N10udmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xDQogICAgICAgICAgICAgICAgICAgICAgICB9LDEsdW5kZWZpbmVkLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxNDcsIGFMaChlLnRhcmdldC52YWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChxVSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxpID0gbmV3IHcoTCgxNCksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxVS5lLnJlYWRPbmx5ICYmIGF6LnkuYUxqKDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLmEySyhlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFMbC5hTG0oew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogZGF0YS5ydCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJzZUludChiaS5lRC5kYXRhWzE0N10udmFsdWUsIDEwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxuID0gbmV3IHcoTCgxNzIpLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50ZXh0Q29udGVudCA9PT0gTCgxNzIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSBMKDE3Myk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUucmVhZE9ubHkgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGkucTEoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaS5idXR0b24uc3R5bGUuY29sb3IgPSBiQS5uaTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTQ3LCBxVS5lLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxoKGJpLmVELmRhdGFbMTQ3XS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFthTG4uYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwUCA9IGFMZS5wTygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMaCA9IGZ1bmN0aW9uKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBiOS5nMS5hMnAoZjgsIDIsIDEwMDAwMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTG8gPSBNYXRoLm1heCgxLCAxICsgTWF0aC5mbG9vcigwLjAxICogKGY4IC0gMTAwKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBQLnRleHRDb250ZW50ID0gTCgxNzQsIFtmOCwgYmkuZUQuZGF0YVsxMDVdLnZhbHVlLCBhTG8sIGRhdGEucnQsIGY4IC0gYUxvXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMbi5idXR0b24udGV4dENvbnRlbnQgPSBMKDE3Mik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5yZWFkT25seSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaS5xMSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGkuYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUxoKGJpLmVELmRhdGFbMTQ3XS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYUxpLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMVSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDE3NSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFVID0gbmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZGF0YS5ydCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTENCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5yZWFkT25seSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgocVUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoWyhuZXcgdyhMKDE3NiksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLmEySihxVS5lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5hMksoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTFYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgxNzcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTHAgPSBuZXcgcVYoYmkuZUQuZGF0YVsxMDZdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMcC5lLnJlYWRPbmx5ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMcC5lLnR5cGUgPSBTWzMyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChhTHApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoWyhuZXcgdyhMKDE3OCksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnRleHRDb250ZW50ID09PSBMKDE3OCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50ZXh0Q29udGVudCA9IEwoMTc5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxwLmUudHlwZSA9IFNbNDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSBMKDE3OCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMcC5lLnR5cGUgPSBTWzMyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b24sIChuZXcgdyhMKDE3NiksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLmEySihhTHAuZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuYTJLKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSkuYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgxODApLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MCgpLmFLcywgbmV3IHJ3KDE1KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMTgxKSwgU1sxOV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBPKEwoMTgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgxODMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTyhMKDE4NCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTFcoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgxODUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgxODYpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg2LCB0LmE0MCgpLmFLcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoWyhuZXcgdyhMKDE4NyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA1LCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHQuYTQwKCkuYUtzLCBuZXcgcncoMTgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbKG5ldyB3KEwoMTg4KSArIGJpLmVELmRhdGFbMTA1XS52YWx1ZSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgMCwgbmV3IHYoTCgxODkpLEwoMTkwKSx0cnVlLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg3LCB0LmE0MSg3KS5hS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5SKSkuYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMTkxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgxOTIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnkudWIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTHE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxyID0gZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgMjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHFbYUJdLnExKGUxID09PSAwID8gYkEubXkgOiAoYUIgPT09IDAgPyBiQS5uUiA6IGJBLm45KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMcSA9IFtuZXcgdyhMKDE5MyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gTWF0aC5taW4oYmkuZUQuZGF0YVsxMTddLnZhbHVlLCBwVi5wVy5sZW5ndGggLSAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPCAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFYucFdbZTFdLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBWLnBXLnNwbGljZShlMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlMTsgYUIgPCBwVi5wVy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcFYucFdbYUJdLm5hbWUgPSAiIiArIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS55LnVlKGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMSA9IGJpLmVELmRhdGFbMTE3XS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwVi5wV1tlMV0udGV4dENvbnRlbnQgPSBwVi5wV1tlMV0udGV4dENvbnRlbnQucmVwbGFjZSgi4pqqIiwgIvCfn6IiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHIoZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm15KSwgbmV3IHcoTCgxOTQpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMSA9IE1hdGgubWluKGJpLmVELmRhdGFbMTE3XS52YWx1ZSwgcFYucFcubGVuZ3RoIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxIDwgMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gYmkueS51ZihlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA1LCBkYXRhLnJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDYsIGRhdGEucGFzc3dvcmQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MCgpLmFLcywgbmV3IHJ3KDE4KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYkEubXkpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBWID0gbmV3IHRUKGJpLmVELmRhdGFbMTE3XSxhTHIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFYucFdbMF0uc3R5bGUubWFyZ2luVG9wID0gU1syNV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUocFYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMcVsxXS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMcVswXS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTFooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgxOTUpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhMKDE5NikgKyBiOS56ZC5hMzcoZGF0YS51biwgMC4xLCAxKSArIFNbMTFdICsgTCgxNjYpICsgKGRhdGEudW8gKyAxKSArIFNbMjBdICsgZGF0YS51cSArIFNbMTFdICsgTCgxOTcpICsgZGF0YS51cCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMWSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDE5OCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZiA9IFtMKDE5OSksIEwoMjAwKSwgTCgyMDEpLCBMKDIwMildOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gZGF0YS5hTHM7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMDMpICsgKGRhdGEuelMgLyAxMDApLnRvRml4ZWQoMikgKyBTWzExXSArIEwoMTY2KSArIChlMCArIDEpICsgU1syMF0gKyBkYXRhLnVxICsgU1sxMV0gKyBMKDE2NykgKyBhTGZbZTAgPCAxMCA/IDAgOiBlMCA8IDUwID8gMSA6IGUwIDwgMjAwID8gMiA6IDNdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxjKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjA0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMDUpICsgZGF0YS5hTHQgKyBTWzExXSArIEwoMTY2KSArIChkYXRhLmFMdSArIDEpICsgU1syMF0gKyBkYXRhLnVxICsgU1sxMV0gKyBMKDE2NykgKyBibi5lMyhkYXRhLmFMdSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYUxOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFVID0gbmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGJpLmVELmRhdGFbMTU3XS52YWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwxLHVuZGVmaW5lZCxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE1NywgYUxoKGUudGFyZ2V0LnZhbHVlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5zdHlsZS5tYXJnaW5Ub3AgPSBTWzQxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgocVUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTG4gPSBuZXcgdyhMKDE3MiksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50ZXh0Q29udGVudCA9PT0gTCgxNzIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRleHRDb250ZW50ID0gTCgxNzMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5yZWFkT25seSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHZbMF0ucTEoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHZbMV0ucTEoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHZbMF0uYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHZbMV0uYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGgoYmkuZUQuZGF0YVsxNTddLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFthTG4uYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUx2ID0gW25ldyB3KCLiiJIiLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFVLmUucmVhZE9ubHkgJiYgYXoueS5hTGooMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLmEySyhlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFMbSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGJLLnBFKHBhcnNlSW50KGJpLmVELmRhdGFbMTU3XS52YWx1ZSwgMTApLCAzLCAzMjc2NykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsMSksIG5ldyB3KCIrIixmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxVS5lLnJlYWRPbmx5ICYmIGF6LnkuYUxqKDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5hMksoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFMbC5hTG0oew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBkYXRhLnJ0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBiSy5wRShwYXJzZUludChiaS5lRC5kYXRhWzE1N10udmFsdWUsIDEwKSwgMywgMzI3NjcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLDEpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcFAgPSBhTGUucE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxoID0gZnVuY3Rpb24oZjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBiOS5nMS5hMnAoZjgsIDMsIDMyNzY3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcFAudGV4dENvbnRlbnQgPSBMKDIwNiwgW2Y4IC0gMSwgZjgsIGJpLmVELmRhdGFbMTA1XS52YWx1ZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJCKFthTHZbMF0uYnV0dG9uLCBhTHZbMV0uYnV0dG9uXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAyOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMdlthQl0uYnV0dG9uLnN0eWxlLmZvbnRTaXplID0gIjEuNmVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLnRleHRDb250ZW50ID0gTCgxNzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxVS5lLnJlYWRPbmx5ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMdlswXS5xMSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUx2WzFdLnExKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHZbMF0uYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMdlsxXS5idXR0b24uc3R5bGUuY29sb3IgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaChiaS5lRC5kYXRhWzE1N10udmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTFAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyMDcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxVSA9IG5ldyBxVih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRhdGEudXNlcm5hbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUucmVhZE9ubHkgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKHFVKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgxNzYpLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5hMkoocVUuZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuYTJLKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSkuYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgyMDgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxRKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyMDkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwUCA9IGFMZS5wTyhkYXRhLmFMdy5sZW5ndGggKyBTWzEyMl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFAuc3R5bGUudGV4dEFsaWduID0gU1sxMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFsID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTHggPSBuZXcgdHcoMCwxLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSBlLnRhcmdldC52YWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFAudGV4dENvbnRlbnQgPSBnOCArIFNbMTIyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZzggPiAxNjApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFBbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUFsID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4ucTEoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFhQWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUFsID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxuLnExKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMeC5lLnJvd3MgPSA2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUx4LmUuc3R5bGUuZm9udFNpemUgPSBTWzE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMeC51MyhkYXRhLmFMdyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYUx4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTG4gPSBuZXcgdyhMKDIxMCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhQWwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MCgpLmFLcywgbmV3IHJ3KDI5LHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOOiBhTHgudTUoKS5zdWJzdHJpbmcoMCwgMTYwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYUxuLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5hTHkgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgyMTEsIFtkYXRhLmFMel0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoWyhuZXcgdyhkYXRhLmFMeSA9PT0gMSA/IEwoMjEyKSA6IEwoMjEzKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5hNDAoKS5hS3MsIG5ldyBydygyOSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTjogIiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBPKGRhdGEuYUx5ID09PSAxID8gTCgyMTQsIFtkYXRhLmFNMCAtIDFdKSA6IEwoMjE1LCBbZGF0YS5hTTAgLSAxXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBPKEwoMjExLCBbZGF0YS5hTHpdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxSKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEuYUxOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYUx5ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjE2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFEoZGF0YS5hTHcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoWyhuZXcgdyhMKDIxNywgMCwgU1s1M10pLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hTGooMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuYTJLKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTGwuYU0xKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiA1LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLDAsMCwxKSkuYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTGEocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTTIgPSBkYXRhLnV1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjE4KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMTksIFsoZGF0YS51cy5sZW5ndGggPyAoIlsiICsgZGF0YS51cyArICJdIikgOiAiLSIpXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjIwLCBbYjkuemQuYTM3KGFNMiwgMC4wMSwgMildKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjEsIFsoZGF0YS51dyArIDEpICsgU1syMF0gKyBkYXRhLnVxXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFNMyA9IGRhdGEudXg7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjIsIFtiOS56ZC5hMzcoYU0zLCAwLjEsIDEpXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFNNCA9IGRhdGEudXo7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjMsIFthTTRdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjQsIFtiOS56ZC5hMzcoYU0zIC8gTWF0aC5tYXgoYU00LCAxKSwgMC4xLCAyKV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNMiA9IGRhdGEudXY7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyMjUpLCBTWzE5XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMTksIFsoZGF0YS51dC5sZW5ndGggPyAoIlsiICsgZGF0YS51dCArICJdIikgOiAiLSIpXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjIwLCBbYjkuemQuYTM3KGFNMiwgMC4wMSwgMildKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTTMgPSBkYXRhLnV5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjIyLCBbYjkuemQuYTM3KGFNMywgMC4xLCAxKV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNNCA9IGRhdGEudjA7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjMsIFthTTRdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMjQsIFtiOS56ZC5hMzcoYU0zIC8gTWF0aC5tYXgoYU00LCAxKSwgMC4xLCAyKV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgyMjYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgyMjcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTGIocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDIyOCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjAzKSArIChkYXRhLmFNNSAvIDEwKS50b0ZpeGVkKDEpICsgU1sxMV0gKyBMKDE2NykgKyAoZGF0YS5hTTYubGVuZ3RoID8gTCgyMjksIFtkYXRhLmFNNl0pIDogTCgyMzApKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbKG5ldyB3KEwoMjMxKSxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhei55LmFMaigwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuYTJLKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFNMSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTyhMKDIzMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTyhMKDIzMykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucE8oTCgyMzQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTGQocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmFMTiAmJiAhZGF0YS5hTTcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgIT09IDAgJiYgIWRhdGEuYUxOICYmICFkYXRhLmFNNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzEwMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhLmFMTiAmJiBkYXRhLmFNOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgxNzgpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTGwuYU0xKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiA3LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuYU04ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5hTTcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoTCgyMzUsIFsoZGF0YS5hTTkgLyAxMDApLnRvRml4ZWQoMildKSArIFNbMTFdICsgTCgyMzYsIFsoMSArIGRhdGEuYU1BKSArIFNbMjBdICsgZGF0YS5hTUJdKSArIFNbMTFdICsgTCgyMzcsIFtkYXRhLmFNQyA/IEwoMjM4KSA6IEwoMjM5KV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEuYUxOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgyNDApLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFNMSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcng6IDgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hTTcgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTYwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjQxKSwgU1sxMl0pLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFNbNjFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKFNbNjRdICsgTCgyNDIpLCBTWzEyXSkuc3R5bGUud2hpdGVTcGFjZSA9IFNbMjhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKFNbNjRdICsgTCgyNDMpLCBTWzEyXSkuc3R5bGUud2hpdGVTcGFjZSA9IFNbMjhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKFNbNjRdICsgTCgyNDQpLCBTWzEyXSkuc3R5bGUud2hpdGVTcGFjZSA9IFNbMjhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjQ1KSwgU1sxMl0pLnN0eWxlLm1hcmdpblRvcCA9IFNbNTldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKEwoMjQ2KSwgU1sxMl0pLnN0eWxlLm1hcmdpblRvcCA9IFNbNTldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKFNbNTZdICsgYkouYU1EICsgIicgdGFyZ2V0PSdfYmxhbmsnPnBhdHJlb24uY29tL2MvdGVycml0b3JpYWw8L2E+IiwgU1sxMl0pLnN0eWxlLm1hcmdpblRvcCA9IFNbNjFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEySSA9ICJodHRwczovL3d3dy5wYXRyZW9uLmNvbS9vYXV0aDIvYXV0aG9yaXplP3N0YXRlPSIgKyBkYXRhLnJ0ICsgIiZyZXNwb25zZV90eXBlPWNvZGUmY2xpZW50X2lkPXdXdU9sRFZad24xc3hTTjlXbTRJOXNKQTNFd2Z3N1p6NE1qVE1mOWVsMnYzbHZpVmtEd0Z0cjkybjdUZGxyaGMmcmVkaXJlY3RfdXJpPWh0dHBzOi8vdGVycml0b3JpYWwuaW8vIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhMKDI0NyksIFNbMTJdKS5zdHlsZS5tYXJnaW5Ub3AgPSBTWzU5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhTWzU2XSArIGEySSArICInIHRhcmdldD0nX2JsYW5rJz5wYXRyZW9uLmNvbS9vYXV0aDIvLi4uPC9hPiIsIFNbMTJdKS5zdHlsZS5tYXJnaW5Ub3AgPSBTWzYxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5hTE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJMKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWCgobmV3IHJCKFsobmV3IHcoTCgxNzkpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTGwuYU0xKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiA2LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGRhdGEucnQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuYU04ID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhMKDI0OCksIFNbMTJdKS5zdHlsZS5tYXJnaW5Ub3AgPSBTWzEyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmFMTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJILmFNRShTWzk0XSwgZGF0YS5ydCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxBKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1GOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1HOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1IOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRiA9IG5ldyB0WShMKDI0OSksW25ldyB3KFNbMl0gKyBMKDM3KSxhTUkpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcgPSBuZXcgcFooYU1GLnRlLGFNSigpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmFJbmNvbWVUeXBlICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5hSW5jb21lRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LmFMSygpWzE5XSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmFJbmNvbWVUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFoKGFNSC51NSgpLCBhRC5kYXRhLmFJbmNvbWVEYXRhLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkucHAubWF4KGFELmRhdGEuYUluY29tZURhdGEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuYUluY29tZVR5cGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUQuZGF0YS5hSW5jb21lVHlwZSA9PT0gMSAmJiAhYUQuZGF0YS5hSW5jb21lVmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmFJbmNvbWVUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTChwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU0ocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1OKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUwocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI1MCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFg6IFtMKDI1MSksIEwoMjUyKSwgTCgyNTMpXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5hSW5jb21lVHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA9PT0gMiAmJiAhYUQuZGF0YS5hSW5jb21lRGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmFJbmNvbWVEYXRhID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmFJbmNvbWVUeXBlID0gZTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDIyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTShwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYUluY29tZVR5cGUgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oU1szN10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyBxVih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLmFJbmNvbWVWYWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwxLDAsZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJLLnBFKE1hdGguZmxvb3IoZS50YXJnZXQudmFsdWUpLCAwLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gYUQuZGF0YS5hSW5jb21lVmFsdWUgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTihwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYUluY29tZVR5cGUgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oU1sxOF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1IID0gbmV3IHR3KDAsMSwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1ILnUzKGI5LnpkLmEzRChhRC5kYXRhLmFJbmNvbWVEYXRhLCA0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYU1IKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTEQoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUg7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoNjIpLFtuZXcgdyhTWzJdICsgTCgzNyksYU1JKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HID0gbmV3IHBaKGFNRi50ZSxhTUooKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1JKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYUxLKClbMTldID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1LKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wcC5hMWgoYU1ILnU1KCksIGFELmRhdGEuYm90RGlmZmljdWx0eURhdGEsIGFFLms2Lmxlbmd0aCAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmJvdERpZmZpY3VsdHlUeXBlID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5wcC5hMVYoYUQuZGF0YS5ib3REaWZmaWN1bHR5RGF0YSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgIT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmJvdERpZmZpY3VsdHlEYXRhID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTChwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNUChwYiwgLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhRC5kYXRhLmJvdERpZmZpY3VsdHlUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFELmRhdGEudGVhbVBsYXllckNvdW50Lmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS50ZWFtUGxheWVyQ291bnRbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTVAocGIsIGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZSA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNTihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1MKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNTApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0WCA9IFtMKDI1MiksIEwoMjU0KSwgTCgyNTUpLCBMKDI1MyldOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmdhbWVNb2RlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBNYXRoLm1pbih2YWx1ZSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFguc3BsaWNlKDIsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFg6IHRYLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5nYW1lTW9kZSA9PT0gMCAmJiBlMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmJvdERpZmZpY3VsdHlUeXBlID0gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPT09IDMgJiYgIWFELmRhdGEuYm90RGlmZmljdWx0eURhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5ib3REaWZmaWN1bHR5RGF0YSA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuYm90RGlmZmljdWx0eVR5cGUgPT09IDIgJiYgIWFELmRhdGEuYm90RGlmZmljdWx0eVRlYW0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5ib3REaWZmaWN1bHR5VGVhbSA9IG5ldyBVaW50OEFycmF5KDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1QKHBiLCBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKGUxIDwgMCA/IEwoNjIpIDogKEwoNjEpICsgIiAiICsgYmYuek1bKGUxKSAlIDldKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhMKDI1NikgKyAiOiAiICsgYUQuZGF0YS50ZWFtUGxheWVyQ291bnRbZTFdKS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBTWzE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGUxIDwgMCA/IGFELmRhdGEuYm90RGlmZmljdWx0eVZhbHVlIDogYUQuZGF0YS5ib3REaWZmaWN1bHR5VGVhbVtlMV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogYUUuazYsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKGhUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmJvdERpZmZpY3VsdHlWYWx1ZSA9IGhUOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuYm90RGlmZmljdWx0eVRlYW1bZTFdID0gaFQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1OKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oU1sxOF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1IID0gbmV3IHR3KDAsMSwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1ILnUzKGI5LnpkLmEzRChhRC5kYXRhLmJvdERpZmZpY3VsdHlEYXRhLCA4KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYU1IKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTVEoZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUxMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1SLCBhTVMsIGFNVCwgYU1VOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1WLCBhTVc7DQogICAgICAgICAgICAgICAgICAgIHZhciBjb2xvcnM7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTVgsIGFNWTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNWiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTWEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1iID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTWMgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNZCA9IFsxLCA1LCA2MCwgNCAqIDYwLCAyNCAqIDYwLCA3ICogMjQgKiA2MCwgMzAgKiAyNCAqIDYwXTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTWUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNZigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU1oID0gWyJNMSIsICJNNSIsICJIMSIsICJINCIsICJEMSIsICJXMSIsICJNTiJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKEwoMjU3KSArICIsICIgKyBhTWhbZGF0YS5hTWldICsgIiwgIiArIGI5LmExTS5hMjYoYU1YKSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hQXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoMjU4KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0sZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNZSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGRhdGEuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGVqLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXggPSBNYXRoLm1heChtYXgsIGVqW2FCXS5hTWoubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGVqW2FCXS5hTWoubGVuZ3RoIDwgbWF4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqW2FCXS5hTWoudW5zaGlmdCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1mKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdFOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMjcgPSAxMDAwICogNjAgKiBkbC5nZXRUaW1lem9uZU9mZnNldCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhUID0gZGwuZ2V0VGltZSgpIC0gYTI3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYU1YID0gbmV3IERhdGUoaFQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYU1pID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1rKGRsLCBhMjcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGdFID0gMTAwMCAqIDYwICogYU1kW2RhdGEuYU1pXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmFNaSA8PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1ZID0gbmV3IERhdGUoaFQgKyBnRSAtIGRsLmdldFRpbWUoKSAlIGdFKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTVkgPSBuZXcgRGF0ZShoVCArIGdFIC0gKGRsLmdldFRpbWUoKSArIDMgKiAyNCAqIDYwICogNjAgKiAxMDAwKSAlIGdFKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTWsoZGwsIGEyNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFNbCA9IGRsLmdldFVUQ0Z1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkbC5nZXRVVENNb250aCgpICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA8IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1ZID0gbmV3IERhdGUoRGF0ZS5VVEMoYU1sLCBtb250aCkgLSBhMjcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTVkgPSBuZXcgRGF0ZShEYXRlLlVUQyhhTWwgKyAxLCAwKSAtIGEyNyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1nKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYxID0gYjkuY29sb3I7DQogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnMgPSBbYkEubW0sIGYxLm1lKDI1NSwgMCwgMCksIGYxLm1lKDAsIDIwMCwgMCksIGYxLm1lKDgwLCA4MCwgMjU1KSwgZjEubWUoMjU1LCAyNTUsIDApLCBmMS5tZSgyNTUsIDAsIDI1NSksIGYxLm1lKDAsIDI1NSwgMjU1KSwgZjEubWUoMjU1LCAxNDAsIDApLCBmMS5tZSgxMjgsIDEyOCwgMTI4KSwgZjEubWUoMCwgMjU1LCAxNDApXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNYyA9IGJpLmVELmRhdGFbMTI3XS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYxID0gaC5rOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtID0gYUxMLnRqKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU1tID0gZjEgKiB0bS50bDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByMCA9IGYxICogdG0ucjA7DQogICAgICAgICAgICAgICAgICAgICAgICBhTVYgPSBiOS5wZy5zSygwLjA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNVyA9IGI5LnBnLnNLKDAuMDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1SID0gYjkucGcuc0soMC4wNik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTVMgPSByMCArIGFNVjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNVCA9IGguaSAtIGFNUiAtIGFNVzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNVSA9IGFNbSArIHIwIC0gYU1TIC0gYU1XOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTW4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNbygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1wKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTW8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lV2lkdGggPSBiYi55MjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZVN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLm1vdmVUbyhhTVIsIGFNUyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oYU1SLCBhTVMgKyBhTVUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVRvKGFNUiArIGFNVCwgYU1TICsgYU1VKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgYU1qLCBnOCwgZW4sIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBkYXRhLmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU1xID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTXIgPSAwLjEyNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTXMgPSBhTWMgPyAoMSA8PCAxNikgOiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTWogPSBnW2FCXS5hTWo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZzggPSBhTWoubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNcSA9IE1hdGgubWF4KGc4LCBhTXEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSAwOyBleiA8IGc4OyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNciA9IE1hdGgubWF4KGFNaltlel0sIGFNcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNcyA9IE1hdGgubWluKGFNaltlel0sIGFNcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1EID0gYU1TICsgYU1VOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHgxID0gYU1VIC8gKGFNciAtIGFNcyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeDAgPSAxIC8gKGFNcSAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYmIueTI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNaiA9IGdbYUJdLmFNajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnOCA9IGFNai5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSBhTVI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8ubW92ZVRvKGVuICsgYU1ULCBtRCAtIHgxICogKGFNaltnOCAtIDFdIC0gYU1zKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChleiA9IGc4IC0gMjsgZXogPj0gMDsgZXotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oZW4gKyB4MCAqIGV6ICogYU1ULCBtRCAtIHgxICogKGFNaltlel0gLSBhTXMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBjb2xvcnNbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU10KGFNcywgYU1yLCBtRCwgeDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU11KGFNcSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhNHAoYU1xLCBhTXMsIGFNcik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU10KGFNcywgYU1yLCBtRCwgeDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCAwLjI1ICogYU1SKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gY29sb3JzWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gMC45MiAqIGFNUjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCAzOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYU1zICsgYUIgKiAoYU1yIC0gYU1zKSAvIDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoKGY4IC8gMTAwMCkudG9GaXhlZCgzKSwgZW4sIG1EIC0geDEgKiAoZjggLSBhTXMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTXUoYU1xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBhTVMgKyBhTVUgKyAwLjE1ICogYU1XOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZm9udCA9IGI5LnBnLnJWKDAsIE1hdGgubWluKDAuNCAqIGFNVywgMC4wMjggKiBoLmkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gY29sb3JzWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuYTFNLmEyOShhTVgpLCBhTVIgKyBhTVQsIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS5hMU0uYTI5KG5ldyBEYXRlKGFNWS5nZXRUaW1lKCkgLSAxMDAwICogNjAgKiAoYU1xIC0gMSkgKiBhTWRbZGF0YS5hTWldKSksIGFNUiwgZXApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGE0cChhTXEsIGFNcywgYU1yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFNYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTXEgPCAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0gKGFNWiAtIGFNUikgLyBhTVQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTEgPSBnRCAqIChhTXEgLSAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTXYgPSBNYXRoLmZsb29yKGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTXcgPSBNYXRoLmZsb29yKGUxICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU14ID0gZTEgLSBhTXY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU15ID0gMTAwMDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFNeiA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFOMCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFOMSA9IGFNciAtIChhTXIgLSBhTXMpICogKGFNYSAtIGFNUykgLyBhTVU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGRhdGEuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTWogPSBnW2FCXS5hTWo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc4ID0gYU1qLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU13ID49IGc4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBhTWpbYU12XSArIGFNeCAqIChhTWpbYU13XSAtIGFNalthTXZdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUF4ID0gTWF0aC5hYnMoYU4xIC0gZjgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQXggPCBhTXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU15ID0gYUF4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTXogPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU4wID0gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFNeiA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU4yID0gYU1TICsgYU1VIC0gKGFOMCAtIGFNcykgLyAoYU1yIC0gYU1zKSAqIGFNVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVXaWR0aCA9IDAuNSAqIGJiLnkyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBjb2xvcnNbYU16XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubW92ZVRvKGFNUiwgYU4yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVUbyhhTVosIGFOMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oYU1aLCBhTVMgKyBhTVUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmFyYyhhTVosIGFOMiwgMC4xMCAqIGFNUiwgMCwgMiAqIE1hdGguUEkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gY29sb3JzW2FNel07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU4zID0gYU1TICsgYU1VICsgMC4xNSAqIGFNVzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwsIGE3STsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA+IGFNcSAtIDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhN0kgPSBhTVkuZ2V0VGltZSgpIC0gMTAwMCAqIDYwICogYU1kW2RhdGEuYU1pXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbCA9IG5ldyBEYXRlKGE3SSArIChlMSAtIChhTXEgLSAyKSkgKiAoYU1YLmdldFRpbWUoKSAtIGE3SSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbCA9IG5ldyBEYXRlKGFNWS5nZXRUaW1lKCkgLSAxMDAwICogNjAgKiAoYU1xIC0gZTEgLSAxKSAqIGFNZFtkYXRhLmFNaV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gYjkuYTFNLmEyOShkbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU40ID0gYjkucGcubWVhc3VyZVRleHQocE4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFONSA9IGJLLnBFKGFNWiwgYU1SICsgMC41ICogYU40LCBhTVIgKyBhTVQgLSAwLjUgKiBhTjQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYjkuY29sb3IubWUoNzAsIDUwLCAyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChhTjUgLSAwLjUyICogYU40LCBhTVMgKyBhTVUsIDEuMDQgKiBhTjQsIDAuNTUgKiBhTVcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gY29sb3JzWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQocE4sIGFONSwgYU4zKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCAwLjI1ICogYU1SKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU41ID0gMC45MiAqIGFNUjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gKGFOMCAvIDEwMDApLnRvRml4ZWQoMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTjQgPSBiOS5wZy5tZWFzdXJlVGV4dChwTik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU42ID0gYU41IC0gMS4wNCAqIGFONDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGI5LmNvbG9yLm1lKDcwLCA1MCwgMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoYU42LCBhTjIgLSAwLjY1ICogMC4yNSAqIGFNUiwgYU1SIC0gYU42LCAxLjEgKiAwLjI1ICogYU1SKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGNvbG9yc1thTXpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQocE4sIGFONSwgYU4yKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTXAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9udFNpemUgPSAwLjUgKiBhTVY7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5mb250ID0gYjkucGcuclYoMCwgZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGRhdGEuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGcubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gYU1TIC0gMC41ICogYU1WOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IGdbYUJdLm5hbWUgKyAiICAiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBwTi50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU40ID0gYjkucGcubWVhc3VyZVRleHQocE4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gMC41ICogKGguaSAtIGFONCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU40ID4gaC5pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCBoLmkgLyBhTjQgKiBmb250U2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGNvbG9yc1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoZ1thQl0ubmFtZSwgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbiArPSBiOS5wZy5tZWFzdXJlVGV4dChnW2FCXS5uYW1lICsgIiAgIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ndCA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU43KGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwVyA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU43KGt5LCBreik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTjcoa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTVogPSBreTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNYSA9IGt6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhMTAoa3ksIGt6KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTWIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTWIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTWIgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGExMChreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBreSA+IGFNUiAmJiBreSA8IGFNUiArIGFNVCAmJiBreiA+IGFNUyAmJiBreiA8IGFNUyArIGFNVTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMMigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkoTCgyNTkpLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hTEooMTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxNID0gbmV3IHBaKGFMTC50ZSxhTE8oKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxPKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFOOCgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYU45KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTkEoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFOQigpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTjgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNjApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTyhMKDI2MSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMbiA9IG5ldyB3KEwoMjYyKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMzAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hTkMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcVUgPSBuZXcgcVYoYmkuZUQuZGF0YVsxMjZdLDAsZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxuLmJ1dHRvbi5jbGljaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChxVSk7DQogICAgICAgICAgICAgICAgICAgICAgICBxVS5lLnBsYWNlaG9sZGVyID0gImEsYixjIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUuc3R5bGUubWFyZ2luVG9wID0gU1syNV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYUxuLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFOOSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTG4gPSBuZXcgdyhMKDI2MiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTMwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnkuYU5DKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORCA9IG5ldyBxVihiaS5lRC5kYXRhWzEyOV0sMSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTkQuZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTkUgPSBuZXcgcVYoYmkuZUQuZGF0YVsxMjhdLDEsZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxuLmJ1dHRvbi5jbGljaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI2MykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkUuZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBTWzI1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI2NCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYUxuLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFOQSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI2NSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YVsxMjVdLnRYID0gWyJNMSIsICJNNSIsICJIMSIsICJINCIsICJEMSIsICJXMSIsICJNTiJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VChiaS5lRC5kYXRhWzEyNV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5CKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjY2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHI1KGJpLmVELmRhdGFbMTI3XSxMKDI2NykpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUwxKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUxMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5GOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1UOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5HOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5IOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5JOw0KICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JzID0gWzAsIDAsIDBdOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5KID0gLTE7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKEwoMjY4KSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hQXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldLGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORiA9IG5ldyBxSShbMC41LCAwLjI1XSxbMC41LCAwLjVdLDEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYmkuZUQuZGF0YVsxMjFdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzWzBdID0gKGY4ID4+IDEyKSAvIDYzOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzWzFdID0gKChmOCA+PiA2KSAmIDYzKSAvIDYzOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzWzJdID0gKGY4ICYgNjMpIC8gNjM7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEyMSwgKGFOSygwLCA2NCkgPDwgMTIpICsgKGFOSygxLCA2NCkgPDwgNikgKyBhTksoMiwgNjQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORi5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IGguazsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bSA9IGFMTC50aigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU5GLmVwID0gTWF0aC5tYXgoYU5GLmVwLCBmMSAqIHRtLnIwICsgYmIuZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTkwgPSBmMSAqIHRtLnRsIC0gMiAqIGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORi5qID0gTWF0aC5taW4oYU5GLmosIGFOTCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkYuaSA9IDIgKiBhTkYuajsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORi5lcCA9IGYxICogdG0ucjAgKyAwLjUgKiAoZjEgKiB0bS50bCAtIGFORi5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORi5lbiA9IDAuNSAqIChoLmkgLSBhTkYuaSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTVQgPSAwLjI1ICogYU5GLmk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkcgPSBhTkYuZW4gKyBhTVQgKyBiYi5nYXA7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkggPSBhTkYuaSAtIGFNVCAtIGJiLmdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOSSA9IChhTkYuaiAtIDIgKiBiYi5nYXApIC8gMzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gYmIueTI7DQogICAgICAgICAgICAgICAgICAgICAgICBhTW8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOTSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOTSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOTSgyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNbygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMCA9IGFOSygwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGFOSygxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IGFOSygyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IFNbN10gKyBlMCArICIsIiArIHNKICsgIiwiICsgZjAgKyAiKSI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChhTkYuZW4sIGFORi5lcCwgYU1ULCBhTkYuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlUmVjdChhTkYuZW4sIGFORi5lcCwgYU1ULCBhTkYuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSAoZTAgKyBzSiArIGYwIDwgMC40ICogKDMgKiAyNTUpICYmIHNKIDwgMTUwKSA/IGJBLm1tIDogYkEubWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUodG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHRvLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCAwLjEgKiBhTkYuaik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5yb3RhdGUoLU1hdGguUEkgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KEwoMjY5KSwgLWFORi5lcCAtIDAuNSAqIGFORi5qLCBhTkYuZW4gKyAwLjUgKiBhTVQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFOTShhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gYUIgPT09IDAgPyAxNTAgOiBhQiA9PT0gMiA/IDMwIDogMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzSiA9IGFCID09PSAxID8gMTMwIDogYUIgPT09IDIgPyAzMCA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSBhQiA9PT0gMiA/IDIyMCA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU5OID0gYU5GLmVwICsgYUIgKiAoYmIuZ2FwICsgYU5JKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IFNbN10gKyBlMCArICIsIiArIHNKICsgIiwiICsgZjAgKyAiKSI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdChhTkcsIGFOTiwgY29sb3JzW2FCXSAqIGFOSCwgYU5JKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZVN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VSZWN0KGFORywgYU5OLCBhTkgsIGFOSSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigwLCAwLjMyICogYU5JKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoKGFCID09PSAwID8gTCgyNzApIDogYUIgPT09IDEgPyBMKDI3MSkgOiBMKDI3MikpICsgYU5LKGFCKSwgYU5HICsgYmIuZ2FwLCBhTk4gKyAwLjUzICogYU5JKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTksoYUIsIGFOTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU5PID0gYU5PIHx8IDI1NjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiSy5wRShNYXRoLmZsb29yKGFOTyAqIGNvbG9yc1thQl0pLCAwLCBhTk8gLSAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWExMChreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU5KID0gYksucEUoTWF0aC5mbG9vcigoa3ogLSBhTkYuZXApIC8gKGFOSSArIDAuNzUgKiBiYi5nYXApKSwgMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnNbYU5KXSA9IGJLLnBFKChreSAtIGFORykgLyBhTkgsIDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTEwKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGt5IDwgYU5HIHx8IGt6IDwgYU5GLmVwIHx8IGt5ID4gYU5GLmVuICsgYU5GLmkgfHwga3ogPiBhTkYuZXAgKyBhTkYuaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBXID0gZnVuY3Rpb24oa3kpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTkogPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzW2FOSl0gPSBiSy5wRSgoa3kgLSBhTkcpIC8gYU5ILCAwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBaID0gZnVuY3Rpb24oa3ksIGt6LCBkZWx0YVkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYTEwKGt5LCBreikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTEgPSBiSy5wRShNYXRoLmZsb29yKChreiAtIGFORi5lcCkgLyAoYU5JICsgMC43NSAqIGJiLmdhcCkpLCAwLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yc1tlMV0gPSBiSy5wRShjb2xvcnNbZTFdICsgKDEgLSAyICogKGRlbHRhWSA+IDApKSAvIDI1NiwgMCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwdSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFOSiA+PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5KID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTDkoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUg7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFHID0gW25ldyB3KFNbMl0gKyBMKDM3KSxhTUkpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmdhbWVNb2RlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcUcucHVzaChuZXcgdyhMKDI3MyksYU5QLDEsMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoMjc0KSxxRyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcgPSBuZXcgcFooYU1GLnRlLGFNSigpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmNvbG9yc1R5cGUgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmNvbG9yc0RhdGEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdC5hTEsoKVsxOV0gPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdC5hMEwoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTlAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1LKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuZ2FtZU1vZGUgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1UuYTNZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuZ2FtZU1vZGUgPT09IDAgJiYgYUQuZGF0YS5jb2xvcnNUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFoKGFNSC51NSgpLCBhRC5kYXRhLmNvbG9yc0RhdGEsIDI2MjE0Myk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1KKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTUwocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuZ2FtZU1vZGUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5jb2xvcnNUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNTihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmEzVS5hM1koKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYU5RKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjUwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5nYW1lTW9kZSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wVShuZXcgdFQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogW0woMjc1KSwgTCgyNTMpXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEuY29sb3JzVHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY29sb3JzVHlwZSA9IGUxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5jb2xvcnNUeXBlID09PSAxICYmICghYUQuZGF0YS5jb2xvcnNEYXRhIHx8IGFELmRhdGEuY29sb3JzRGF0YS5sZW5ndGggIT09IGFELmVkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5jb2xvcnNEYXRhID0gbmV3IFVpbnQzMkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJMKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByNSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEuc2VsZWN0YWJsZUNvbG9yDQogICAgICAgICAgICAgICAgICAgICAgICB9LEwoMjc2KSxmdW5jdGlvbih2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc2VsZWN0YWJsZUNvbG9yID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTU4ocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzE4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUggPSBuZXcgdHcoMCwxLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUgudTMoYjkuemQuYTNEKGFELmRhdGEuY29sb3JzRGF0YSwgMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFNSCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5RKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjU2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYmYuek0ubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhUID0gKGFCICsgMSkgJSBiZi56TS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhTGUucFMoKGhUID09PSAwID8gIiIgOiAiVGVhbSAiKSArIGJmLnpNW2hUXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3R5bGUubWFyZ2luVG9wID0gU1syNV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudFtoVF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LDEsMCxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZlsxXS5xMSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllckNvdW50ID0gYksucEUoTWF0aC5mbG9vcihlLnRhcmdldC52YWx1ZSksIDAsIDUxMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gcGxheWVyQ291bnQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEudGVhbVBsYXllckNvdW50W2UudGFyZ2V0LmFOUl0gPSBwbGF5ZXJDb3VudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSkuZS5hTlIgPSBoVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgcTAoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gcncoaWQsIGEycywgYU5TKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTlQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU5VID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTlYgPSBpZDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkoTCgyNzcpLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFOUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hQXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTlQgPSBuZXcgckEoYUxMLnRlLEwoMjc4KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMTUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hTlcoaWQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDE2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYU5XKGlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYU5aKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDE3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYU5XKGlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYU5aKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDE4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZSgwLCAzMjUzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmFFSygwLCBpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5ZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhei55LmFOVyhpZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYU5hLmFOYihhMnMuc0UsIGEycy5zRiwgYTJzLnNHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTlkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhei55LmFOVyhpZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYU5hLmFOYyhhMnMuc0UsIGEycy5hTmQsIGEycy5hTmUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDIzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYU5XKGlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTmEuYU5mKGEycy5hTWksIGEycy56Zyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5ZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMjQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hTlcoaWQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFOYS5hTmcoYTJzLmFNaSwgYTJzLnNGLCBhMnMuc0cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDI1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYU5XKGlkKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTGwuYU0xKGEycyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5ZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXoueS5hTlcoaWQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFOYS5hTmgoYTJzLnNFLCBhMnMuYU5kLCBhMnMuYU5lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTlkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhei55LmFOVyhpZCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFOaShhMnMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTlkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTlQucGMuaW5uZXJIVE1MICs9IFNbMTFdICsgTCgyNzkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU5qID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDE1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5YKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAxNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFBby5hTlooMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAxNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFBby5hTlooMyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAxOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0aGlzLmFLcywgbmV3IHJ3KDE2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAyMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFOYS5hTmIoYTJzLnNFLCBhMnMuc0YsIGEycy5zRyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAyMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFOYS5hTmMoYTJzLnNFLCBhMnMuYU5kLCBhMnMuYU5lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDIzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYU5hLmFOZihhMnMuYU1pLCBhMnMuemcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMjQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTmEuYU5nKGEycy5hTWksIGEycy5zRiwgYTJzLnNHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDI1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFNMShhMnMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTmEuYU5oKGEycy5zRSwgYTJzLmFOZCwgYTJzLmFOZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAyOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFMbC5hTmkoYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFOViA9IGlkID0gMjU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFNMShhMnMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU5rID0gZnVuY3Rpb24oY29kZSwgYnIsIGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYnIgJiYgY29kZSAhPT0gaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29kZSA9PT0gMTUgfHwgY29kZSA9PT0gMTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoNywgdGhpcy5hS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSAxNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoMCwgMzI1Mik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkueS51ZSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmkuZUQuZGF0YVsxMTddLnRYICYmIGJpLmVELmRhdGFbMTE3XS50WC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGJpLnkudWYoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEwNSwgZWoucnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDYsIGVqLnBhc3N3b3JkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHRoaXMuYUtzLCBuZXcgcncoMTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDUsICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LmFBcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29kZSA9PT0gMjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTAsIHRoaXMuYUtzLCBuZXcgYU5sKGRhdGEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29kZSA9PT0gMjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTMsIDAsIG5ldyBhTVEoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTWk6IGEycy5hTWkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IDI1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LmFMMy5ydCA9IGEycy5ydDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTUsIHRoaXMuYUtzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTlgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNyg0OCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyNCwgTWF0aC5mbG9vcihiSy5wb3coMjQpICogTWF0aC5yYW5kb20oKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMjQsIE1hdGguZmxvb3IoYksucG93KDI0KSAqIE1hdGgucmFuZG9tKCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmRYKGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDExMCwgYkUucnkucnooYkUucnkuczAoOCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFMbC5hTm0oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTlQucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMNygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNRjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNRzsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYgPSBuZXcgdFkoIvCflKcgIiArIEwoMjgwKSxbbmV3IHcoU1syXSArIEwoMzcpLGFNSSksIG5ldyB3KEwoMjgxKSxhTm4pXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTm8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRyA9IG5ldyBwWihhTUYudGUsYU1KKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFObygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU5xKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5xKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuY2FudmFzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwVHlwZSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY2FudmFzID0gYlIudmI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwVHlwZSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY2FudmFzID0gYlIuYUl4KGJSLmEzdChhRC5kYXRhKSwgMCkudmI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5tYXBUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEucGFzc2FibGVXYXRlciA9IGFELmRhdGEucGFzc2FibGVNb3VudGFpbnMgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5jYW52YXMgPSBiUi5hSXgoYlIuYTN0KGFELmRhdGEpLCBhRC5kYXRhLm1hcFNlZWQpLnZiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFOcCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmdhbWVNb2RlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudCA9IG5ldyBVaW50MTZBcnJheShbMCwgMSwgMSwgMCwgMCwgMCwgMCwgMCwgMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1UuYTNZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IGI5LnBwLmExYihhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5udW1iZXJUZWFtcyA9IGc4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmJvdERpZmZpY3VsdHlUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc3Bhd25pbmdUeXBlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc3Bhd25pbmdUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1JKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuZ2FtZU1vZGUgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnRlYW1QbGF5ZXJDb3VudCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTnIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY2FudmFzID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg1LCA1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTnIoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTU2LCBiOC5hM2sueVUoKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5pc1JlcGxheSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhTnIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmEzVS5hM3YoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmFFVigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNVLmEzcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5jYW52YXMgPSBhRC5kYXRhLm1hcFR5cGUgPT09IDIgPyBiUi52YiA6IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmEzVyA9IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1KKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTnMocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU5RKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOdChwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFOdSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYU52KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTncoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTngocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU55KHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOeihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTzAocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU8xKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPMihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5zKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyODIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMXIgPSBhRC5kYXRhLmNhbnZhczsNCiAgICAgICAgICAgICAgICAgICAgICAgIGExci5zdHlsZS53aWR0aCA9IFNbMV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGU6IGExcg0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJCKFsobmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKS5idXR0b25dKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5RKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxOiAtMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5wbGF5ZXJDb3VudA0KICAgICAgICAgICAgICAgICAgICAgICAgfSwxLDAsZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXJDb3VudCA9IGJLLnBFKE1hdGguZmxvb3IoZS50YXJnZXQudmFsdWUpLCAxLCA1MTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gYUQuZGF0YS5wbGF5ZXJDb3VudCA9IHBsYXllckNvdW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmdhbWVNb2RlID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTzMgPSBiOS5wcC5hMWIoYUQuZGF0YS50ZWFtUGxheWVyQ291bnQsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1UuYTNZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTzQgPSBiOS5wcC5hMWIoYUQuZGF0YS50ZWFtUGxheWVyQ291bnQsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU80ICE9PSBhTzMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU50KHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyODQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wVShuZXcgdFQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRYOiBbU1sxMDVdLCAiVGVhbXMiXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5nYW1lTW9kZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmdhbWVNb2RlID09PSBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuZ2FtZU1vZGUgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTzUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPNSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOcCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbYU51KCksIGFOdigpLCBhTncoKV07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDM7IGFCIDwgNjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNRy5wYy5yZW1vdmVDaGlsZChhTUcucGRbYUJdLnBMKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUcucGRbYUJdID0gZ1thQiAtIDNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNRy5wYy5hcHBlbmRDaGlsZChhTUcucGRbYUJdLnBMKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTnUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNzQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTzY7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5nYW1lTW9kZSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPNiA9IFtMKDI3NSksIEwoMjUzKV1bYUQuZGF0YS5jb2xvcnNUeXBlXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU82ID0gYUQuZGF0YS5udW1iZXJUZWFtcyArICIgVGVhbSIgKyAoYUQuZGF0YS5udW1iZXJUZWFtcyA9PT0gMSA/ICIiIDogInMiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhhTzYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU52KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoNjIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW0woMjUyKSArICI6ICIgKyBhRS5rNlthRC5kYXRhLmJvdERpZmZpY3VsdHlWYWx1ZV0sIEwoMjU0KSwgTCgyNTUpLCBMKDI1MyldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKGdbYUQuZGF0YS5ib3REaWZmaWN1bHR5VHlwZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU53KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKCJTcGF3bmluZyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbTCgyNzUpLCBMKDI4NSksIEwoMjUzKV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoZ1thRC5kYXRhLnNwYXduaW5nVHlwZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU54KHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyODYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW0woMjg3KSwgTCgyODgpLCBMKDI1MyldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKGdbYUQuZGF0YS5wbGF5ZXJOYW1lc1R5cGVdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgckIoW25ldyB3KEwoMjgzKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKS5idXR0b25dKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU55KHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNDkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW0woMjUxKSwgTCgyNTIpICsgIjogIiArIGFELmRhdGEuYUluY29tZVZhbHVlLCBMKDI1MyldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKGdbYUQuZGF0YS5hSW5jb21lVHlwZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTnoocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI4OSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbTCgyNTEpLCBMKDI1MikgKyAiOiAiICsgYUQuZGF0YS50SW5jb21lVmFsdWUsIEwoMjUzKV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFMoZ1thRC5kYXRhLnRJbmNvbWVUeXBlXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJCKFtuZXcgdyhMKDI4MyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDI2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkuYnV0dG9uXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPMChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjkwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IFtMKDI1MSksIEwoMjUyKSArICI6ICIgKyBhRC5kYXRhLmlJbmNvbWVWYWx1ZSwgTCgyNTMpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wUyhnW2FELmRhdGEuaUluY29tZVR5cGVdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgckIoW25ldyB3KEwoMjgzKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKS5idXR0b25dKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU8xKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyOTEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gW0woMjUxKSwgTCgyNTIpICsgIjogIiArIGFELmRhdGEuc1Jlc291cmNlc1ZhbHVlLCBMKDI1MyldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBTKGdbYUQuZGF0YS5zUmVzb3VyY2VzVHlwZV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyODMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTzIocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI5MikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbbmV3IHcoTCgyOTMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmEzVS5hM3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnkuYUdPWzBdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKS5idXR0b25dKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJCKFtuZXcgdyhMKDI5NCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmwuYUdEKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgckIoW25ldyB3KEwoMjk1KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibC5hR0YoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkuYnV0dG9uXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYudGUuc2Nyb2xsVG9wID0gdC55LmFHT1swXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hR09bMF0gPSBhTUYudGUuc2Nyb2xsVG9wOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTEkoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBxYSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoMjk2KSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYUxKKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRlLnN0eWxlLm92ZXJmbG93WSA9IFNbOV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYudGUuYWRkRXZlbnRMaXN0ZW5lcihTWzMwXSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWEgPSBhTUYudGUuc2Nyb2xsVG9wID49IGFNRi50ZS5zY3JvbGxIZWlnaHQgLSBhTUYudGUuY2xpZW50SGVpZ2h0IC0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZS50ZXh0Q29udGVudCA9ICIiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTzcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcWEgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcXQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZS5zdHlsZS5wYWRkaW5nID0gIjAuNGVtICIgKyBiOS5wZy5wcShiYi5wbik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUYudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPNygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNHIgPSBicC5hNDIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGE0ci5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcW8gPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxcChxbywgYTRyW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYudGUuYXBwZW5kQ2hpbGQocW8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcXQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnhXID0gZnVuY3Rpb24oYTN5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcW8gPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBxcChxbywgYTN5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZS5hcHBlbmRDaGlsZChxbyk7DQogICAgICAgICAgICAgICAgICAgICAgICBxdCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcXAocW8sIGEzeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBMID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTzggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMTRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTzkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbMTRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPOC50ZXh0Q29udGVudCA9IGFXLmE5aihhM3kuZUYpICsgIjoiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU84LnN0eWxlLmNvbG9yID0gYkEubjE7DQogICAgICAgICAgICAgICAgICAgICAgICBhTzguc3R5bGUucGFkZGluZ1JpZ2h0ID0gU1s0Ml07DQogICAgICAgICAgICAgICAgICAgICAgICBhTzguc3R5bGUuZGlzcGxheSA9ICJ0YWJsZS1jZWxsIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPOC5zdHlsZS53aWR0aCA9ICI2Y2giOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU84LnN0eWxlLnRleHRBbGlnbiA9ICJlbmQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgcEwuYXBwZW5kQ2hpbGQoYU84KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPOS50ZXh0Q29udGVudCA9IGEzeS5wTjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBMLmFwcGVuZENoaWxkKGFPOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwTC5zdHlsZS5kaXNwbGF5ID0gInRhYmxlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhM3kub0opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT0EocEwsIGEzeS5vSik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBxby5hcHBlbmRDaGlsZChwTCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9BKHBMLCBvSikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9KID49IDEwMjQgLSBhai5xdy54cCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRzkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzkuc3JjID0gYWoudmUueGRbb0ogLSAxMDI0ICsgYWoucXcueHBdLnRvRGF0YVVSTCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHOS5zdHlsZS53aWR0aCA9IFNbNDBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFHOS5zdHlsZS5oZWlnaHQgPSBTWzQwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzkuc3R5bGUudmVydGljYWxBbGlnbiA9IFNbMzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBMLmFwcGVuZENoaWxkKGFHOSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxZiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1sxNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFmLnRleHRDb250ZW50ID0gYWoucXcueTQob0opOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLmRpc3BsYXkgPSBTWzQ5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS5mb250U2l6ZSA9IFNbNDBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFmLnN0eWxlLmxpbmVIZWlnaHQgPSBTWzE3XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxZi5zdHlsZS52ZXJ0aWNhbEFsaWduID0gU1szM107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcEwuYXBwZW5kQ2hpbGQocWYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHF0KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHFhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRlLnNjcm9sbFRvcCA9IGFNRi50ZS5zY3JvbGxIZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcTAoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxGKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1GOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1HOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1IOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRiA9IG5ldyB0WShMKDI5MCksW25ldyB3KFNbMl0gKyBMKDM3KSxhTUkpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcgPSBuZXcgcFooYU1GLnRlLGFNSigpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmlJbmNvbWVUeXBlICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5pSW5jb21lRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LmFMSygpWzE5XSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLmlJbmNvbWVUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFoKGFNSC51NSgpLCBhRC5kYXRhLmlJbmNvbWVEYXRhLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1MKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTShwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU4ocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjUwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogW0woMjUxKSwgTCgyNTIpLCBMKDI1MyldLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLmlJbmNvbWVUeXBlDQogICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSAyICYmICFhRC5kYXRhLmlJbmNvbWVEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuaUluY29tZURhdGEgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuaUluY29tZURhdGEuZmlsbCgzMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuaUluY29tZVR5cGUgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1NKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5pSW5jb21lVHlwZSAhPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzM3XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEuaUluY29tZVZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICB9LDEsMCxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYksucEUoTWF0aC5mbG9vcihlLnRhcmdldC52YWx1ZSksIDAsIDI1NSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSBhRC5kYXRhLmlJbmNvbWVWYWx1ZSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1OKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5pSW5jb21lVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzE4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUggPSBuZXcgdHcoMCwxLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUgudTMoYjkuemQuYTNEKGFELmRhdGEuaUluY29tZURhdGEsIDQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChhTUgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUYudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHEwKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFLeCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPQjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPQzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFORjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHFVOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU9EOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFGNCA9IG5ldyBzNCgpOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFORiA9IG5ldyBxSShbMC45ICogMC41LCAwLjkgKiAwLjNdLFswLjUsIDAuNV0sMiAvIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9DID0gW25ldyB3KCLimpTvuI88YnI+IiArIEwoMjk3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT0UoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYkEubkYpLCBuZXcgdygi8J+Xoe+4jzxicj4iICsgTCgyODApLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPRSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxiQS5uWCksIG5ldyB3KCLwn5SRPGJyPiIgKyBMKDI5OCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9FKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5uKSwgbmV3IHcoIuKYsDxicj4iICsgTCgyOTkpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPRSgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICxiQS5teiksIG5ldyB3KCIiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsYkEubWksZmFsc2UpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFVID0gbmV3IHFWKGJpLmVELmRhdGFbMTIyXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYU9DLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPQ1thQl0uYnV0dG9uLnN0eWxlLnBvc2l0aW9uID0gU1szXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUuc3R5bGUucG9zaXRpb24gPSBTWzNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5zdHlsZS50ZXh0QWxpZ24gPSBTWzEwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUucGxhY2Vob2xkZXIgPSBMKDMwMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9FKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5zZXRTdGF0ZSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFiLnNOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYi5hRXYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlMSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hM24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZTEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI4LmFHWS52TShiaS5lRC5kYXRhWzE1Nl0udmFsdWUsIDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmEzVS5hM3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDE5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZTEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgIT09IDAgfHwgYmkuZUQuZGF0YVsxNDBdLnZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LnJ2LCBuZXcgcncoMTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnkuYU9GKHQucnYsIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUxID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuc2V0U3RhdGUoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5zZXRTdGF0ZSgxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFGNC5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT0NbNF0ucTEoYjkuY29sb3IuYTF5KGJpLmVELmRhdGFbMTIxXS52YWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocVUuZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYU9DLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYU9DW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU9HKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT0coKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuaWQgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTAuZG4gPCA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhT0QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT0QgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPiBhT0QgKyAxMDAwICogNjAgKiA2MCAqIDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC51UC5zZXRTdGF0ZSgxNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU9EID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hRjQucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQocVUuZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYU9DLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYU9DW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUY0LnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hRjQucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkYucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2FwID0gMC41ICogYmIuZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNzID0gMC44NCAqICgxMCAvIDk5KSAqIGFORi5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPSCA9IDMgKiBnYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9JID0gMC4xNiAqIGFORi5qOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE3cCA9IDAuMTkgKiBhTkYuaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IGFORi5lbiArIGE3cDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFORi5lcCArIHNzICsgYU9IOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLjUgKiAoYU5GLmkgLSBnYXApIC0gYTdwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIyID0gYU5GLmkgLSAyICogYTdwIC0gYU9JIC0gZ2FwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuc0wocVUuZSwgZW4sIGVwLCByMiwgYU9JKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNMKGFPQ1s0XS5idXR0b24sIGVuICsgcjIgKyBnYXAsIGVwLCBhT0ksIGFPSSk7DQogICAgICAgICAgICAgICAgICAgICAgICBlcCArPSBhT0kgKyBnYXA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IDAuNSAqIChhTkYuZXAgKyBhTkYuaiAtIGVwIC0gZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNMKGFPQ1swXS5idXR0b24sIGVuLCBlcCwgaSwgaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5zTChhT0NbMV0uYnV0dG9uLCBlbiArIGkgKyBnYXAsIGVwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnNMKGFPQ1syXS5idXR0b24sIGVuLCBlcCArIGogKyBnYXAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuc0woYU9DWzNdLmJ1dHRvbiwgZW4gKyBpICsgZ2FwLCBlcCArIGogKyBnYXAsIGksIGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFPQy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT0NbYUJdLmJ1dHRvbi5zdHlsZS5mb250ID0gYjkucGcuclYoMCwgYjkucGcuYTJFKDAuMDY1ICogYU5GLmopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihhT0NbYUJdLmJ1dHRvbiwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBxVS5lLnN0eWxlLmZvbnQgPSBiOS5wZy5yVigwLCBiOS5wZy5hMkUoMC4wOCAqIGFORi5qKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5wcihxVS5lLCA1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFhLmFFWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVQudG4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPLnRuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiWC50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9KKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT0ooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFiLnNOKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IGFiLmFFYyhTWzIxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbU8gPSAwLjg0ICogYU5GLmkgLyBmMS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybShtTywgMCwgMCwgbU8sIGFORi5lbiArIDAuMDggKiBhTkYuaSwgYU5GLmVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYU9CKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9CID0gYjkuYTFJLmEycShmMSwgYjkuYTFJLmEydywgWzAsIDAsIDBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVuID0gLTE7IGVuIDw9IDE7IGVuICs9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlcCA9IC0xOyBlcCA8PSAxOyBlcCArPSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShhT0IsIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGYxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG0gPSBhYi5hRWMoU1s4M10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPSyA9IDAuNjY2NiAqIG1PICogZjEuaGVpZ2h0IC8gaG0uaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1QID0gMC41ICogaC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1RID0gYU5GLmVwICsgMC41ICogbU8gKiBmMS5oZWlnaHQgLSAwLjUgKiBhT0sgKiBobS5oZWlnaHQ7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oYU9LLCAwLCAwLCBhT0ssIG1QIC0gMC42ICogbU8gKiBmMS53aWR0aCwgbVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGhtLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybShhT0ssIDAsIDAsIGFPSywgbVAgKyAwLjYgKiBtTyAqIGYxLndpZHRoIC0gYU9LICogaG0ud2lkdGgsIG1RKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShobSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMNCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPTTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT00gPSBbbmV3IHcoTCgzMDEpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTigxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSksIG5ldyB3KEwoMzAyKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT04oMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpLCBuZXcgdyhMKDMwMyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9OKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLDAsMCwxKSwgbmV3IHcoTCgzMDQpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTigwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSksIG5ldyB3KEwoMzA1KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT04oOSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpLCBuZXcgdyhMKDMwNiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9OKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSksIG5ldyB3KEwoMzA3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT04oMTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLDAsMCwxKV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdFogPSBbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTCA9IG5ldyB0WShMKDMwOCksdFopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9MID0gbmV3IHFGKGFPTSxhTEwudGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPTihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHQucnYsIG5ldyBydygyMSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0U6IGFCLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGOiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNHOiAxMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT0wucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFCRih0aXRsZSwgcFQsIGFPTykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUxMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU5UOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYU9PKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9PID0gW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hMEwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm5SKV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkodGl0bGUsYU9PKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOVCA9IG5ldyByQShhTEwudGUscFQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKGFMTC50ZS5zdHlsZSwgMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOVC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYU5sKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPUDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBkYXRhLmRhdGEubGVuZ3RoID8gMCA6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9PID0gW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoTCgzMDkpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPUSgtMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGYxLDAsMSksIG5ldyB3KEwoMzEwKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT1EoMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLGYxLDAsMSksIG5ldyB3KEwoMjU4KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTEsIDEwLCBuZXcgYU9SKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc0U6IGRhdGEuc0UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBybCA9IFtMKDMxMSksIEwoMzEyKSwgTCgzMTMpLCBMKDMxNCksIEwoMzE1KSwgTCgzMTYpLCBMKDMxNyksIEwoMzE4KSwgTCgzMTkpLCBMKDMyMCksIEwoMzA2KSwgTCgzMDcpLCBMKDMyMSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKHJsW2RhdGEuc0VdLGFPTyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT1MoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT1MoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmY6IFtdDQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJmID0gZWoucmY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9UID0gZGF0YS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYU9ULmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZyAmJiBhT1RbMF1bMF0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTEgPSBbMCwgMSwgMiwgMywgLTEsIC0xLCAtMSwgLTEsIC0xLCA0LCA1LCA2LCAtMV1bZGF0YS5zRV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LnNIW2UxXSA9IGFPVFswXVsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9VID0gWzAuMSwgMC4wMDEsIDAuMDEsIDEsIDEwMCwgMSwgMSwgMC4xLCAxMDAsIDAuMDEsIDAuMDEsIDAuMDEsIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1PID0gYU9VW2RhdGEuc0VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPViA9IFsxLCAzLCAyLCAwLCAwLCAwLCAwLCAxLCAwLCAyLCAyLCAyLCAwXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMzAgPSBhT1ZbZGF0YS5zRV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmwgPSBbW0woMzIyKSwgTCgzMjMpICsgIiDihpciLCBMKDMyNCldLCBbTCgzMjIpLCBMKDMyNSksIEwoMzI2KSwgTCgzMjcpICsgIiDihpciXSwgW0woMzIyKSwgTCgzMjMpICsgIiDihpciLCBMKDMyNildLCBbTCgzMjIpLCBMKDMyMykgKyAiIOKGlyIsIEwoMzI2KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzMzApICsgIiDihpciLCBMKDMzMSkgKyAiIOKGlyIsIEwoMTE5KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzMzIpICsgIiDihpciLCBMKDMzMykgKyAiIOKGlyIsIEwoMzM0KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzMzUpICsgIiDihpciLCBMKDMzNikgKyAiIOKGlyIsIEwoMzM3KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzMzIpICsgIiDihpciLCBMKDMzMykgKyAiIOKGlyIsIEwoMzM4KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzMzApICsgIiDihpciLCBMKDMzMSkgKyAiIOKGlyIsIEwoMTE5KV0sIFtMKDMyMiksIEwoMzIzKSArICIg4oaXIiwgTCgzMjYpXSwgW0woMzIyKSwgTCgzMjMpICsgIiDihpciLCBMKDMzOSldLCBbTCgzMjIpLCBMKDMyMykgKyAiIOKGlyIsIEwoMzI2KV0sIFtMKDMyOCksIEwoMzI5KSwgTCgzNDApICsgIiDihpciLCBMKDM0MSkgKyAiIOKGlyIsIEwoMzQyKV1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJxID0gW1syNSwgNDAsIDM1XSwgWzE1LCAyNSwgMjUsIDM1XSwgWzI1LCA0MCwgMzVdLCBbMjUsIDQwLCAzNV0sIFsxMiwgMTYsIDMwLCAzMCwgMTJdLCBbMTIsIDE2LCAzMCwgMzAsIDEyXSwgWzEyLCAxNiwgMzAsIDMwLCAxMl0sIFsxMiwgMTYsIDMwLCAzMCwgMTJdLCBbMTIsIDE2LCAzMCwgMzAsIDEyXSwgWzI1LCA0MCwgMzVdLCBbMjUsIDQwLCAzNV0sIFsyNSwgNDAsIDM1XSwgWzEyLCAxMywgMjUsIDI1LCAyNV1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWoucmwgPSBybFtkYXRhLnNFXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnJxID0gcnFbZGF0YS5zRV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zRSA9PT0gMCB8fCBkYXRhLnNFID09PSAyIHx8IGRhdGEuc0UgPT09IDMgfHwgZGF0YS5zRSA9PT0gOSB8fCBkYXRhLnNFID09PSAxMCB8fCBkYXRhLnNFID09PSAxMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJmLnB1c2goW3sNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4OiAoKGFPVFthQl1bMF0gKyAxKSArICIuIiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYU9UW2FCXVsxXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFPVFthQl1bNF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogYU9UW2FCXVszXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogKG1PICogYU9UW2FCXVsyXSkudG9GaXhlZChhMzApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGw6IDANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zRSA9PT0gMTIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9XID0gYU9UW2FCXVszXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmYucHVzaChbew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjg6ICIiICsgYU9UW2FCXVswXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4OiAiIiArIGFPVFthQl1bNF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYU9UW2FCXVs1XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFPVFthQl1bMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYU9UW2FCXVs2XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFPVFthQl1bMl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYm4uZTcoYU9XICUgMTYsIGFPVyA+PiA0KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc0UgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZi5wdXNoKFt7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogKChhT1RbYUJdWzBdICsgMSkgKyAiLiIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGw6IDANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjg6IGFPVFthQl1bMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogKG1PICogYU9UW2FCXVsyXSkudG9GaXhlZChhMzApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGw6IDANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjg6IGFPVFthQl1bM10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBhT1RbYUJdWzVdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnU6IGFPVFthQl1bNF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zRSA9PT0gNCB8fCBkYXRhLnNFID09PSA1IHx8IGRhdGEuc0UgPT09IDYgfHwgZGF0YS5zRSA9PT0gNyB8fCBkYXRhLnNFID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPWCA9IGFPVFthQl1bNV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnNFID09PSA0IHx8IGRhdGEuc0UgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPWCA9ICgxMDAgKiAoYU9YICUgNjQpIC8gKGFPWCA+PiA2KSkudG9GaXhlZCgwKSArICIlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhT1ggPT09IFNbMV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zRSA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT1ggKz0gIiAoIiArIEwoMzQzKSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT1ggKz0gIiAoIiArIEwoMzQ0KSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zRSA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFPWCA+PSAzMjc2OCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPWCA9IC0oYU9YIC0gMzI3NjgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9YID0gKG1PICogYU9YKS50b0ZpeGVkKGEzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmYucHVzaChbew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjg6ICIiICsgYU9UW2FCXVswXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4OiAiIiArIGFPVFthQl1bNl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYU9UW2FCXVs3XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFPVFthQl1bMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogYU9UW2FCXVsyXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogYU9UW2FCXVs4XSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRsOiAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGFPVFthQl1bM10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogYU9UW2FCXVs0XQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmODogIiIgKyBhT1gsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU9QID0gbmV3IHJlKGFMTC50ZSxlaik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9RKGhwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBkYXRhLmRhdGEubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW4gPSBwYXJzZUludChkYXRhLmRhdGFbMF1bMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1heCA9IG1pbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMTsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRDAgPSBwYXJzZUludChkYXRhLmRhdGFbYUJdWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW4gPSBNYXRoLm1pbihhRDAsIG1pbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXgoYUQwLCBtYXgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNGOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhwIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGID0gbWluICsgaHA7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGID0gbWF4ICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MCgpLmFLcywgbmV3IHJ3KDIxLHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRTogZGF0YS5zRSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRjogc0YsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0c6IHNGICsgTWF0aC5hYnMoaHApDQogICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPUC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9SKGEycykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUxMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYUxNOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkWCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTCA9IG5ldyB0WShMKDM0NSksW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmFMSigxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0gPSBuZXcgcFooYUxMLnRlLGFMTygpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTE8oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYU45KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhT1koKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFPWigpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTjkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORCA9IG5ldyBxVihiaS5lRC5kYXRhWzEzMl0sMSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLmNsaWNrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORSA9IG5ldyBxVihiaS5lRC5kYXRhWzEzMV0sMSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTkQuZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI2MykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkUuZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBTWzE5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI2NCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU9hID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNGID0gTWF0aC5mbG9vcihhTkUuZS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNHID0gTWF0aC5mbG9vcihhTkQuZS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExWiA9IE1hdGgubWluKHNGLCBzRyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFLVCA9IE1hdGgubWF4KHNGLCBzRyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFaOiBhMVosDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLVDogYUtUDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhTG4gPSBuZXcgdyhMKDI2MiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBZID0gYU9hKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHQuYTQxKDEwKS5hS3MsIG5ldyBydygyMSx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNFOiBhMnMuc0UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGOiBwWS5hMVosDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNHOiBwWS5hS1QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMbi5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT1koKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORCA9IG5ldyBxVihiaS5lRC5kYXRhWzEzNF0sMSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLmNsaWNrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORSA9IG5ldyBxVihiaS5lRC5kYXRhWzEzM10sMCxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTkQuZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShhMnMuc0UgPT09IDEgPyBMKDM0NikgOiBMKDM0NykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkUuZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBTWzE5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM0OCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTG4gPSBuZXcgdyhMKDI2MiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFOZCA9IGFORS5lLnZhbHVlLnNsaWNlKDAsIDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU5lID0gTWF0aC5hYnMoTWF0aC5mbG9vcihhTkQuZS52YWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MSgxMCkuYUtzLCBuZXcgcncoMjIsew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRTogYTJzLnNFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTmQ6IGFOZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU5lOiBhTmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMbi5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT1ooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxuOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORCA9IG5ldyBxVihiaS5lRC5kYXRhWzE1Ml0sMSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTG4uYnV0dG9uLmNsaWNrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFORSA9IG5ldyBxVihiaS5lRC5kYXRhWzE1MV0sMCxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTkQuZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM0OSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTkUuZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBTWzE5XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM0OCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFORCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTG4gPSBuZXcgdyhMKDI2MiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFOZCA9IGFORS5lLnZhbHVlLnNsaWNlKDAsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTmUgPSBNYXRoLmFicyhNYXRoLmZsb29yKGFORC5lLnZhbHVlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHQuYTQxKDEwKS5hS3MsIG5ldyBydygyOCx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNFOiBhMnMuc0UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOZDogYU5kLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTmU6IGFOZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYUxuLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0ucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMSCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPYjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNSOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU9jID0gW25ldyBBcnJheSg0KSwgW10sIG5ldyBBcnJheSgyKSwgbmV3IEFycmF5KDIpXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPZCA9IG5ldyBBcnJheSg0KTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPZiA9IG5ldyBBcnJheSgyKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPZyA9IFtMKDYxKSwgTCgzMDUpLCBMKDM1MCksIEwoMzUxKV07DQogICAgICAgICAgICAgICAgICAgIHZhciBzUTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNUOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNRID0gbmV3IHJFKFtuZXcgdyhhT2dbMF0sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9oKDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoYU9nWzFdLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPaCgwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KGFPZ1syXSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2goMCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhhT2dbM10sZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9oKDAsIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0sYkEubncpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1IgPSBuZXcgckUoW25ldyB3KCIiLDAsMiksIG5ldyB3KCIiLDAsMiksIG5ldyB3KCIiLDAsMiksIG5ldyB3KCIiLDAsMiksIG5ldyB3KCIiLDAsMildLGJBLm54LDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPaSA9IG5ldyByRShbbmV3IHcoTCgzNTIpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPaCgyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoMTE1KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2goMiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSxiQS5udyk7DQogICAgICAgICAgICAgICAgICAgICAgICBzVCA9IG5ldyByRShbbmV3IHcoTCgzNTMpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNSSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoTCgzNTQpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPaigxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldLGJBLm53KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPYiA9IG5ldyBzUChzUSxzUixhT2ksc1QsYUNsLGJtLnROLmFESCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgNDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPY1swXVthQl0gPSBuZXcgcWUoIjAiLHNRLnFHW2FCXS5idXR0b24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU9jWzJdWzFdID0gbmV3IHFlKCIwIixhT2kucUdbMV0uYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPY1szXVsxXSA9IG5ldyBxZSgiMCIsc1QucUdbMV0uYnV0dG9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPZSA9IFtuZXcgcWUoIiIsYU9pLnFHWzFdLmJ1dHRvbiwxLDEpLCBuZXcgcWUoIiIsc1QucUdbMV0uYnV0dG9uLDEsMSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9rKDAsIGJtLnkucWpbMF0sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9rKDIsIGJtLnkucWpbMl0sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9mID0gW25ldyBxZShMKDI1NiksYU9iLnNwKCksMSwwKSwgbmV3IHFlKCIiLGFPYi5zcCgpLDEsMSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9mWzBdLnFmLnN0eWxlLmZvbnRTaXplID0gU1s0Ml07DQogICAgICAgICAgICAgICAgICAgICAgICBhT2ZbMV0ucWYuc3R5bGUuZm9udFNpemUgPSBTWzQyXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhQ2woKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTVzID0gYU9iLnNlLnFVLmUudmFsdWUudHJpbSgpLnNsaWNlKDAsIDEyNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVzLmxlbmd0aCA8IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2UucVUuZS52YWx1ZSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0uYUJJLno1KGE1cyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRDggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhT2Iuc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnRIKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmEwTSgzMjQwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg1LCA1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT2ooYU9sKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBibS55LnFqWzNdID0gMSAtIGJtLnkucWpbM107DQogICAgICAgICAgICAgICAgICAgICAgICBhT2soMywgMSwgYm0ueS5xalszXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU9sKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUN3LmFDeCg0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS55LnFqWzNdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTU4LCBibS55LnFqWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCSSA9IGZ1bmN0aW9uKHJ0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2goMiwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSBhT2Iuc2UucVUuZS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhT20gPSAiQCIgKyBydCArICIgIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwTi5sZW5ndGggJiYgIWI5LnpkLmEyTChwTiwgIiAiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPbSA9ICIgIiArIGFPbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBOICs9IGFPbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPYi5zZS5xVS5lLnZhbHVlID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2UucVUuZS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9oKGV6LCBmMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJtLnkucWpbZXpdID09PSBmMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleiA9PT0gMCAmJiBibS55LnFqWzNdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9qKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU9rKGV6LCBibS55LnFqW2V6XSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2soZXosIGYwLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkucWpbZXpdID0gZjA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXogPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hQ3cuYUN4KDIsIGYwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0ueS5xalsyXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2YubFkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNlLnFnKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPYi5zZS5xZygwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hNDAoKS5hQ2EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MCgpLmFDWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleiA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hQ3cuYUN4KDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2UubFkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNuKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUN3LmFDeCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNmLmxZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPYi5zbygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhT2soZXosIGYwLCBjb2xvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNoW2V6XS5xR1tmMF0ucTEoY29sb3IgPyBiQS5uQiA6IGJBLm53KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNmLmxZKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDYSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPbiA9IGJtLnkucWpbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcWsgPSBibS55LnFsW2FPbl07DQogICAgICAgICAgICAgICAgICAgICAgICBiUi5hNyhxay5lTSwgcWsubWFwU2VlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBzUi5xR1swXS5idXR0b24udGV4dENvbnRlbnQgPSBMKDI4MikgKyAiOiAiICsgYlIudlIudlNbcWsuZU1dLm5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICBzUi5xR1sxXS5idXR0b24udGV4dENvbnRlbnQgPSBMKDI4NCwgMCwgIk1vZGUiKSArICI6ICIgKyBhT28ocWsuYUJxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNSLnFHWzJdLmJ1dHRvbi50ZXh0Q29udGVudCA9IEwoMzU1KSArICI6ICIgKyBiUi52Ui52U1txay5hRFhdLm5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICBzUi5xR1szXS5idXR0b24udGV4dENvbnRlbnQgPSBMKDM1NiwgMCwgIk5leHQgTW9kZSIpICsgIjogIiArIGFPbyhxay5hRFkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1IucUdbNF0uYnV0dG9uLnRleHRDb250ZW50ID0gTCgzNTcpICsgIjogIiArIGFPcChxay5hQ2MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc1IucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDWiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPbiA9IGJtLnkucWpbMF07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcWsgPSBibS55LnFsW2FPbl07DQogICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2wocWsuc20pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGJtLnQxLnQyLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPY1swXVthQl0ucWYudGV4dENvbnRlbnQgPSAiIiArIGJtLnQxLnQyW2FCXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdDEgPSBibS50MS50MlthT25dOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPcSA9IHQxLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhT3IgPSBibS50MS50M1thT25dOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9jWzJdWzFdLnFmLnRleHRDb250ZW50ID0gIiIgKyBhT3E7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2NbM11bMV0ucWYudGV4dENvbnRlbnQgPSAiIiArIGFPcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNSLnFHWzRdLmJ1dHRvbi50ZXh0Q29udGVudCA9IEwoMzU3KSArICI6ICIgKyBhT3AocWsuYUNjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCA0OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPcyA9IGJtLnkucWxbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYU9kW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2RbYUJdID0gbmV3IHFlKGJSLnZSLnZTW2FPcy5lTV0ubmFtZSxzUS5xR1thQl0uYnV0dG9uLDEsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhT3Muc20gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9kW2FCXS5xZi50ZXh0Q29udGVudCA9IGJSLnZSLnZTW2FPcy5lTV0ubmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LnpkLnN0YXJ0c1dpdGgoYU9nW2FCXSwgIvCfj4YgIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhT3MuYUJ3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2dbYUJdID0gYU9nW2FCXS5zdWJzdHJpbmcoMyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzUS5xR1thQl0uYnV0dG9uLnRleHRDb250ZW50ID0gYU9nW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNRLnFHW2FCXS5idXR0b24uYXBwZW5kQ2hpbGQoYU9jWzBdW2FCXS5xZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzUS5xR1thQl0uYnV0dG9uLmFwcGVuZENoaWxkKGFPZFthQl0ucWYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhT3MuYUJ3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPZ1thQl0gPSAi8J+PhiAiICsgYU9nW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc1EucUdbYUJdLmJ1dHRvbi50ZXh0Q29udGVudCA9IGFPZ1thQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNRLnFHW2FCXS5idXR0b24uYXBwZW5kQ2hpbGQoYU9jWzBdW2FCXS5xZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNRLnFHW2FCXS5idXR0b24uYXBwZW5kQ2hpbGQoYU9kW2FCXS5xZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPdCA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFPdSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFPbiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPdCA9IGJtLnFxLmFDQSh0MSwgMCwgYU9xKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT3UgPSBibS5xcS5hQ0EodDEsIDAsIGFPcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhT2VbMF0ucWYudGV4dENvbnRlbnQgPSBhT3Q7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2VbMV0ucWYudGV4dENvbnRlbnQgPSBhT3U7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2ZbMV0ucWYudGV4dENvbnRlbnQgPSAiTVA6ICIgKyBibS55LmFDUlswXSArICIgICBTUDogIiArIGJtLnkuYUNSWzFdICsgIiAgIExvYmJ5OiAiICsgYjkucHAuYTFtKGJtLnQxLnQyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPbyhhQnEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQnEgPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhQnEgKyAyKSArICIgIiArIEwoMzU4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUJxID09PSA3IHx8IGFCcSA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTCgzMDUpICsgIiAoRnVsbC1TZW5kaW5nOiAiICsgKGFCcSA9PT0gNyA/IEwoMzU5KSA6IEwoMzYwKSkgKyAiKSI7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFCcSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTWzEwOV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTCgzNjEpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUNlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2UubFkoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFPcChmOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1diA9IGJLLmRtKGY4LCA2MCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTV3ID0gZjggJSA2MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoYTV2IDwgMTAgPyAiMCIgOiAiIikgKyBhNXYgKyAiOiIgKyAoYTV3IDwgMTAgPyAiMCIgOiAiIikgKyBhNXc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2Iuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2Uuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBibS50Ti5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm0uc3oucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2UucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT2IucmVzaXplKDEgLSBibS55LnFqWzJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLm1lc3NhZ2UucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm0ueS5xalszXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2ooMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9iLnNoWzNdLnFHWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA8IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT2ooMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS3koKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTE07DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKEwoMzYyKSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg3LCB0LmE0MSg3KS5hS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoTCgxOTQpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPdigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxNID0gbmV3IHBaKGFMTC50ZSxhTE8oKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU92KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA1LCBiRi5yeS52QihhTE0ucGRbMF0ucEtbMF0uZS52YWx1ZSwgNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA2LCBiRi5yeS52QihhTE0ucGRbMV0ucEtbMF0uZS52YWx1ZSwgOCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIHQuYTQxKDcpLmFLcywgbmV3IHJ3KDE4KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxPKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMVSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxWKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMVSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDE3NSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyBxVih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxOiAtMQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTFYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgxNzcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTHAgPSBuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTENCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxwLmUudHlwZSA9IFNbMzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFMcCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbKG5ldyB3KEwoMTc4KSxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudGV4dENvbnRlbnQgPT09IEwoMTc4KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRleHRDb250ZW50ID0gTCgxNzkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHAuZS50eXBlID0gU1s0M107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50ZXh0Q29udGVudCA9IEwoMTc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxwLmUudHlwZSA9IFNbMzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYUxlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0ucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMNSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFPTTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhT00gPSBbbmV3IHcoTCgzMTYpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTig1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSksIG5ldyB3KEwoMzE3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT04oNik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpLCBuZXcgdyhMKDMxOCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9OKDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgLDAsMCwxKSwgbmV3IHcoTCgzMjEpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTigxMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwwLDEpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0WiA9IFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hMEwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKEwoMzYzKSx0Wik7DQogICAgICAgICAgICAgICAgICAgICAgICBhT0wgPSBuZXcgcUYoYU9NLGFMTC50ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU9OKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5ydiwgbmV3IHJ3KDIxLHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRTogYUIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0Y6IDAsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc0c6IDEwDQogICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUtvKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVEID0ge307DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc0ggPSBuZXcgQXJyYXkoNyk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUwzID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTDAgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJjID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR08gPSBbMF07DQogICAgICAgICAgICAgICAgICAgIHRoaXMueiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDUsIDUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM24gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQueCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVouZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoYWEuYTA5KCkgPT09IDAgPyA1IDogMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFOQyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpLmVELmRhdGFbMTMwXS52YWx1ZSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg4LCB0LmE0MCgpLmFLcywgbmV3IHJ3KDI0LHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1pOiBiaS5lRC5kYXRhWzEyNV0udmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNGOiBiaS5lRC5kYXRhWzEyOF0udmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNHOiBiaS5lRC5kYXRhWzEyOV0udmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBiaS5lRC5kYXRhWzEyNl0udmFsdWUuc3BsaXQoIiwiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBnLnNsaWNlKDAsIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBnLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbYUJdID0gZ1thQl0udHJpbSgpLnNsaWNlKDAsIDcpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZy5sZW5ndGggPT09IDEgJiYgZ1swXS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5hNDAoKS5hS3MsIG5ldyBydygyMyx7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1pOiBiaS5lRC5kYXRhWzEyNV0udmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgemc6IGcNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU9GID0gZnVuY3Rpb24oYUtzLCB0YXJnZXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg0LCBhS3MsIG5ldyB2KCJEYXRhIFVzYWdlIEluZm9ybWF0aW9uIiwiRG8geW91IHdhbnQgeW91ciB1c2VybmFtZSBhbmQgb3RoZXIgZGF0YSB0byBiZSByZW1lbWJlcmVkIGZvciB0aGUgbmV4dCBzZXNzaW9uPzxicj5UaGUgYXBwIG1pZ2h0IG5vdCBmdW5jdGlvbiBjb3JyZWN0bHkgaWYgeW91IGRlY2xpbmUgZGF0YSB1c2FnZS48YnI+UGxlYXNlIHJlYWQgb3VyIHByaXZhY3kgcG9saWN5IGZvciBtb3JlIGluZm9ybWF0aW9uOiA8YSBocmVmPSciICsgYkouYU93ICsgU1syNl0gKyBiSi5hT3cgKyBTWzI5XSxmYWxzZSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudShhS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoIuKchSBBY2NlcHQiLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE0MCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMiwgYUtzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgYUtzLCBuZXcgcncodGFyZ2V0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0pKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU94ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgNzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc0hbYUJdID0gYkYudjIudjYoYkcub2koNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zSFsxXSA9ICJbIiArIHRoaXMuc0hbMV0gKyAiXSI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYUY0LnI5KHRoaXMuc0gpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTDgoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhT3k7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoMjgyKSxbbmV3IHcoU1syXSArIEwoMzcpLGFNSSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLm1hcFR5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HID0gbmV3IHBaKGFNRi50ZSxhTUooKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1JKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYjUudEgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYUxLKClbMTldID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1KKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTUwocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU96KHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFQMChwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhUDEocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVAyKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFQMyhwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhUDQocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjUwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogW0woMzY0KSwgTCgzNjUpLCBMKDM2NildLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLm1hcFR5cGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLm1hcFR5cGUgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjUuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5jYW52YXMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEucGFzc2FibGVXYXRlciA9IGFELmRhdGEucGFzc2FibGVNb3VudGFpbnMgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNS50SCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlID49IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHJMKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5wYXNzYWJsZVdhdGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxMKDM2NyksZnVuY3Rpb24odmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5wYXNzYWJsZVdhdGVyID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5wYXNzYWJsZU1vdW50YWlucw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sTCgzNjgpLGZ1bmN0aW9uKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEucGFzc2FibGVNb3VudGFpbnMgPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU96KHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdFggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBiUi52Ui5hSnAubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFgucHVzaChiUi52Ui52U1tiUi52Ui5hSnBbYUJdXS5uYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0VSA9IGZ1bmN0aW9uKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5tYXBQcm9jZWR1cmFsSW5kZXggPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUDUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogdFgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEubWFwUHJvY2VkdXJhbEluZGV4DQogICAgICAgICAgICAgICAgICAgICAgICB9LHRVKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVAwKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlICE9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdFggPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBiUi52Ui5hSnEubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFgucHVzaChiUi52Ui52U1tiUi52Ui5hSnFbYUJdXS5uYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0VSA9IGZ1bmN0aW9uKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5tYXBSZWFsaXN0aWNJbmRleCA9IGUxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wVShuZXcgdFQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRYOiB0WCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5tYXBSZWFsaXN0aWNJbmRleA0KICAgICAgICAgICAgICAgICAgICAgICAgfSx0VSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQMShwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI4MikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyByQihbKG5ldyB3KEwoMzY5KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNS5hRzEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpLmJ1dHRvbl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUDIocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPeSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU95LnBNKEwoMzcwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVA2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuY2FudmFzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVA3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFPeSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVAzKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKFNbOThdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxVSA9IG5ldyBxVih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLm1hcFNlZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sMSwwLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUlzID0gTWF0aC5hYnMoTWF0aC5mbG9vcihlLnRhcmdldC52YWx1ZSkpICUgMTYzODQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwU2VlZCA9PT0gYUlzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5tYXBTZWVkID0gYUlzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTG4gPSBuZXcgdyhMKDI3NSksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSXMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNjM4NCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwU2VlZCA9PT0gYUlzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS52YWx1ZSA9IGFELmRhdGEubWFwU2VlZCA9IGFJczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUDUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgocVUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMbi5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQNChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEubWFwVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM3MSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFVID0gbmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEubWFwTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwwLDAsZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEubWFwTmFtZSA9IGUudGFyZ2V0LnZhbHVlID0gZS50YXJnZXQudmFsdWUuc2xpY2UoMCwgMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChxVSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVA1KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVA4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUDYoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUDgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU95LnBMLmxhc3RDaGlsZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPeS5wTC5yZW1vdmVDaGlsZChhT3kucEwubGFzdENoaWxkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUDYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVA5ID0gYlIuYTN0KGFELmRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5jYW52YXMgPSBiUi5hSXgoYVA5LCBhRC5kYXRhLm1hcFNlZWQpLnZiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVA3KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVA3KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExciA9IGFELmRhdGEuY2FudmFzOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTFyLnN0eWxlLndpZHRoID0gU1sxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPeS5wTC5hcHBlbmRDaGlsZChhMXIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUc4ID0gZnVuY3Rpb24oYTFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5jYW52YXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUDgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY2FudmFzID0gYTFyOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVA3KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiB2KHRpdGxlLCBwVCwgYVBBLCBhT08pIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFOVDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFPTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTyA9IFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICldOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMID0gbmV3IHRZKHRpdGxlLGFPTyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTlQgPSBuZXcgckEoYUxMLnRlLHBUKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUEEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oYUxMLnRlLnN0eWxlLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU5ULnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTEIoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUg7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoMjg2KSxbbmV3IHcoU1syXSArIEwoMzcpLGFNSSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRyA9IG5ldyBwWihhTUYudGUsYU1KKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1PKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmFMSygpWzE5XSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnBsYXllck5hbWVzVHlwZSA9PT0gMiAmJiBiOS5wcC5hMVYoYUQuZGF0YS5wbGF5ZXJOYW1lc0RhdGEpLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEucGxheWVyTmFtZXNUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnBsYXllck5hbWVzVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEucGxheWVyTmFtZXNEYXRhID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUsoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5wbGF5ZXJOYW1lc1R5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wcC5hMWooYU1ILnU1KCksIGFELmRhdGEucGxheWVyTmFtZXNEYXRhLCAyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1KKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTUwocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1OKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUwocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDI1MCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFg6IFtMKDI4NyksIEwoMjg4KSwgTCgyNTMpXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5wbGF5ZXJOYW1lc1R5cGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnBsYXllck5hbWVzVHlwZSA9IGUxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyMyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgckwoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHI1KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5zZWxlY3RhYmxlTmFtZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSxMKDM3MiksZnVuY3Rpb24odmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnNlbGVjdGFibGVOYW1lID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTU4ocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnBsYXllck5hbWVzVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzE4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUggPSBuZXcgdHcoMCwxLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmRhdGEucGxheWVyTmFtZXNEYXRhIHx8IGFELmRhdGEucGxheWVyTmFtZXNEYXRhLmxlbmd0aCAhPT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnBsYXllck5hbWVzRGF0YSA9IG5ldyBBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5wbGF5ZXJOYW1lc0RhdGEuZmlsbCgiIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTUgudTMoYjkuemQuYTNEKGFELmRhdGEucGxheWVyTmFtZXNEYXRhLCAxLCAiXCIiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYU1IKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS3coKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciB1MTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYgPSBuZXcgdFkoTCgzNzMpLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hTEooMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDM3NCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEudTYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoMzc1KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MS51NygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoTCgzNzYpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxLmNsZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDM3NyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBCKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB1MSA9IG5ldyB0dyhMKDM3OCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRlLmFwcGVuZENoaWxkKHUxLmUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKGFQQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUEQoYVBDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUEQgPSBmdW5jdGlvbihhUEMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUEMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEudTMoYVBDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGI4Lm93LmEzai5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEudTMoYjgub3cuYTNqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI4Lm93LmEzaiA9IGI4LmEzay55VSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdTEudTMoYjguYVBFKGI4Lm93LmEzaikpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdTEucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUEIoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGI4LmFQRih1MS51NSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSAmJiBwTi5sZW5ndGggPiAwICYmIHBOID09PSBiOC5vdy5hM2opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOC5hUEcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI4LmFHWS52TShwTikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5hUEcoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUYudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBCKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS3YoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTE07DQogICAgICAgICAgICAgICAgICAgIHZhciBwYjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFBbjsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkoTCgzNzkpLFtuZXcgdyhTWzJdICsgTCgzNyksYVBIKSwgbmV3IHcoTCgzODApLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnVqKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxPKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0gPSBuZXcgcFooYUxMLnRlLHBiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUEgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUFuICE9PSBiaS5lRC5kYXRhWzEyXS52YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI2LmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjYuYUFtKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVGID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDQsIDEsIG5ldyB2KEwoMzgxKSxMKDM4MiksZmFsc2UsW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhTWzY2XSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGIDwgZUYgKyAxNTAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuYTIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLGJBLm45KV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxPKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM4MykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBPKEwoMzg0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUEkocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVBKKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wVShuZXcgdFQoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRYOiBbIjEiLCAiMiJdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAoYVouYUVHIC0gMSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWi5hRUcgPSBhQiArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMzg1KSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5lRC5kYXRhWzFdLnRYID0gW0woMzg2KSwgTCgzODcpLCBMKDM4OCksIEwoMzg5KV07DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKGJpLmVELmRhdGFbMV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMzkwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5lRC5kYXRhWzldLnRYID0gW0woMzg3KSwgTCgzOTEpLCBMKDM5MildOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VChiaS5lRC5kYXRhWzldKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDM5MykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkuZUQuZGF0YVsxMV0udFggPSBbTCgzOTQpLCBMKDkpLCBMKDM5NSldOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VChiaS5lRC5kYXRhWzExXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgzOTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoYmkuZUQuZGF0YVsyXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgzOTcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoYmkuZUQuZGF0YVs3XSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgzOTgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoYmkuZUQuZGF0YVs4XSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgzOTkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcVYoYmkuZUQuZGF0YVs1XSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCg0MDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcjUoYmkuZUQuZGF0YVsxM10sTCg0MDEpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHI1KGJpLmVELmRhdGFbMTRdLEwoNDAyKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQSihwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoNDAzKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVBLID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbKG5ldyB3KEwoNDA0KSxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYlcuYVBMKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFQSy5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBLW2FCXS5lLnZhbHVlID0gYlcuYUFEW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcuYTJLKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSkuYnV0dG9uXSkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBiVy5hUE0ubGVuZ3RoOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBPKGJXLmFQTVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCAyOyBleisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlMSA9IDIgKiBhQiArIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcVUgPSBuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGJXLmFBRFtlMV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFVLmUuYVBOID0gZTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQSy5wdXNoKHFVKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcVUuZS5hZGRFdmVudExpc3RlbmVyKFNbODVdLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29kZSA9IGUuY29kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gY29kZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJXLmFQTyhlLnRhcmdldC5hUE4sIGNvZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXogJiYgKHFVLmUuc3R5bGUubWFyZ2luTGVmdCA9ICI0JSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxVS5lLnN0eWxlLndpZHRoID0gIjQ4JSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChxVSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQSShwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoNDA1KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGI2LmRhdGEuYUF2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogZywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYjYuZGF0YS5hQXooZykNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMiwgZ1tlMV0uc3BsaXQoIjoiKVswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFBbiA9IGJpLmVELmRhdGFbMTJdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTE0ucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTEwudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGRYKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMQygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNRjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNRzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFNSDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcTAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYgPSBuZXcgdFkoTCg0MDYpLFtuZXcgdyhTWzJdICsgTCgzNyksYU1JKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HID0gbmV3IHBaKGFNRi50ZSxhTUooKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1JKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYUxLKClbMTldID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1LKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc3Bhd25pbmdUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFoKGFNSC51NSgpLCBhRC5kYXRhLnNwYXduaW5nRGF0YSwgYlIuYUdBIC0gMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1PKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc3Bhd25pbmdUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5wcC5hMVYoYUQuZGF0YS5zcGF3bmluZ0RhdGEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc3Bhd25pbmdUeXBlID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5zcGF3bmluZ1R5cGUgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnNwYXduaW5nRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1KKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBiID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhTUwocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1NKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTihwYik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1MKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgyNTApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0WCA9IFtMKDI3NSksIEwoMjg1KSwgTCgyNTMpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFELmRhdGEuc3Bhd25pbmdUeXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuZ2FtZU1vZGUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WC5zcGxpY2UoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBVKG5ldyB0VCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdFg6IHRYLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSxmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc3Bhd25pbmdUeXBlID0gZTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuZ2FtZU1vZGUgPT09IDAgJiYgZTEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5zcGF3bmluZ1R5cGUgPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5zcGF3bmluZ1R5cGUgPT09IDIgJiYgIWFELmRhdGEuc3Bhd25pbmdEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc3Bhd25pbmdEYXRhID0gbmV3IFVpbnQxNkFycmF5KDIgKiBhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgckwoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHI1KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5zZWxlY3RhYmxlU3Bhd24NCiAgICAgICAgICAgICAgICAgICAgICAgIH0sTCg0MDcpLGZ1bmN0aW9uKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS5zZWxlY3RhYmxlU3Bhd24gPSB2YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTShwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKFNbOThdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChuZXcgcVYoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxOiAtMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYUQuZGF0YS5zcGF3bmluZ1NlZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sMSwwLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBNYXRoLmFicyhNYXRoLmZsb29yKGUudGFyZ2V0LnZhbHVlKSkgJSAxNjM4NDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC52YWx1ZSA9IGFELmRhdGEuc3Bhd25pbmdTZWVkID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTU4ocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnNwYXduaW5nVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzE4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUggPSBuZXcgdHcoMCwxLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUgudTMoYjkuemQuYTNEKGFELmRhdGEuc3Bhd25pbmdEYXRhLCAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYU1IKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5zaG93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnF4KCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1HLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBxMCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhS3UoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTEw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhT0w7DQogICAgICAgICAgICAgICAgICAgIHZhciBhT007DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU9NID0gW25ldyB3KEwoNDA4KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUFAoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDMwOCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoMzYzKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMTcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSwgbmV3IHcoTCg0MDkpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hTkMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDAsMSksIG5ldyB3KEwoMzczKSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDQxMCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDE4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoMzc5KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUFAoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDQxMSksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBRKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDQxMiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBSKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDQxMyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBTKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApLCBuZXcgdyhMKDQxNCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTAwKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0WiA9IFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LmFBcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKV07DQogICAgICAgICAgICAgICAgICAgICAgICBhUFQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSAmJiBhMC5kbiA+PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9NLnB1c2gobmV3IHcoTCg0MTUpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS5hMDEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkoTCg0MTYpLHRaKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFPTCA9IG5ldyBxRihhT00sYUxMLnRlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUFQoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgIT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhT00udW5zaGlmdChuZXcgdyhMKDI5NiksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU9NLnVuc2hpZnQobmV3IHcoTCg0MTcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYy5hUFUgPj0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmQuYTE3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT00udW5zaGlmdChuZXcgdyhMKDQxOCksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5ncCAmJiBhTS5wSChhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIub08oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC54KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTS5ncSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU0uYTE3KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMCwxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT00udW5zaGlmdChuZXcgdyhMKDQxOSksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5ncCAmJiBhdi5oUShhRC5lUSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYlUuYTRLKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5oMi5oTSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LngoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFNLmdxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTS5hMTcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICwwLDEpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUFAoaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMCAmJiAhYmkuZUQuZGF0YVsxNDBdLnZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC55LmFPRih0LnJ2LCBpZCA9PT0gMCA/IDE2IDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDgsIDEsIG5ldyBydygxNikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBRKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJsID0gW1NbMTAwXSwgTCg0MjApLCBMKDQyMSksICJZb3VUdWJlIFR1dG9yaWFsIiwgIkRpc2NvcmQiLCBMKDQyMiksIEwoMzAxKSwgTCg0MjMpLCBMKDMwNCksIEwoNDI0KSwgIlRlcm1zIiwgIlByaXZhY3kiXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMkcgPSBbYkouYU1ELCBiSi5hQkMsIGJKLmEwNSwgImh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9NlFCbUE5TjE2NjgiLCBiSi5hQkQsIGJKLmFQViwgYkouYVBXLCBiSi56biwgYkouYVBYLCBiSi5hUFksIGJKLmFQWiwgYkouYU93XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMC5pZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJsLnNwbGljZSgyLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBybC5zcGxpY2UoMCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJHLnNwbGljZSgyLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMkcuc3BsaWNlKDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhMC5pZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJsLnNwbGljZSgxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBybC5zcGxpY2UoMCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTJHLnNwbGljZSgxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMkcuc3BsaWNlKDAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDQsIDEsIG5ldyB2KEwoNDExKSxiOS5wZy5hMkYocmwsIGEyRyksZmFsc2UsW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQUigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSg0LCAxLCBuZXcgdihMKDQxMiksbC5kbiArICI8YnI+PGEgaHJlZj0nIiArIGJKLmFQViArIFNbMjZdICsgYkouYVBWICsgU1syOV0sdHJ1ZSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBTKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDQsIDEsIG5ldyB2KEwoNDEzKSxMKDQyNSkgKyBTWzExXSArIEwoNDI2KSxmYWxzZSxbbmV3IHcoU1syXSArIEwoMzcpLGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICksIG5ldyB3KEwoNDI3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMC5hMS56eigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTAwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuYTAwKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgMSwgbmV3IHYoTCg0MjgpLEwoNDI5KSArICIgPGEgaHJlZj0nIiArIGJKLmFPdyArIFNbMjZdICsgYkouYU93ICsgU1syOV0sZmFsc2UsW25ldyB3KFNbMl0gKyBMKDM3KSxmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApXSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTAuYTEuc2V0U3RhdGUoMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlxKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhT0wucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgIT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmMuYVBVID49IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU9NWzJdLnB6ID09PSBiQS5teSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT01bMl0ucTEoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU9NWzJdLnB6ICE9PSBiQS5teSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhT01bMl0ucTEoYkEubXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZ3AgJiYgYU0ucEgoYUQuZVEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFPTVsxXS5weiA9PT0gYkEubXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9NWzFdLnExKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFPTVsxXS5weiAhPT0gYkEubXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU9NWzFdLnExKGJBLm15KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmdwICYmIGF2LmhRKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhT01bMF0ucHogPT09IGJBLm15KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTVswXS5xMSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhT01bMF0ucHogIT09IGJBLm15KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPTVswXS5xMShiQS5teSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTQgPSBmdW5jdGlvbihmMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxMLnRmWzBdLnB5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBkWCgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTEcoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUY7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUc7DQogICAgICAgICAgICAgICAgICAgIHZhciBhTUg7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHEwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GID0gbmV3IHRZKEwoMjkxKSxbbmV3IHcoU1syXSArIEwoMzcpLGFNSSldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRyA9IG5ldyBwWihhTUYudGUsYU1KKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNSygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc1Jlc291cmNlc1R5cGUgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnNSZXNvdXJjZXNEYXRhID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYUxLKClbMTldID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHQuYTBMKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1LKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc1Jlc291cmNlc1R5cGUgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wcC5hMWgoYU1ILnU1KCksIGFELmRhdGEuc1Jlc291cmNlc0RhdGEsIDIwNDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1MKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTShwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU4ocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjUwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogW0woMjUxKSwgTCgyNTIpLCBMKDI1MyldLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLnNSZXNvdXJjZXNUeXBlDQogICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSAyICYmICFhRC5kYXRhLnNSZXNvdXJjZXNEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuc1Jlc291cmNlc0RhdGEgPSBuZXcgVWludDE2QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLnNSZXNvdXJjZXNUeXBlID0gZTE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDI4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTShwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmRhdGEuc1Jlc291cmNlc1R5cGUgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gbmV3IHBKKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oU1szN10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKG5ldyBxVih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZTE6IC0xLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLnNSZXNvdXJjZXNWYWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwxLDAsZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJLLnBFKE1hdGguZmxvb3IoZS50YXJnZXQudmFsdWUpLCAwLCAyMDQ3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC52YWx1ZSA9IGFELmRhdGEuc1Jlc291cmNlc1ZhbHVlID0gdmFsdWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBiLnB1c2goYUxlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTU4ocGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnNSZXNvdXJjZXNUeXBlICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKFNbMThdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNSCA9IG5ldyB0dygwLDEsMCwxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNSC51MyhiOS56ZC5hM0QoYUQuZGF0YS5zUmVzb3VyY2VzRGF0YSwgMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFNSCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRi5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNRi50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgcTAoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYUxFKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1GOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1HOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYU1IOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBxMCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNRiA9IG5ldyB0WShMKDI4OSksW25ldyB3KFNbMl0gKyBMKDM3KSxhTUkpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcgPSBuZXcgcFooYU1GLnRlLGFNSigpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhTUkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnRJbmNvbWVUeXBlICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuZGF0YS50SW5jb21lRGF0YSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LmFMSygpWzE5XSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0LmEwTCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnRJbmNvbWVUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFoKGFNSC51NSgpLCBhRC5kYXRhLnRJbmNvbWVEYXRhLCAyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNSigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU1MKHBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFNTShwYik7DQogICAgICAgICAgICAgICAgICAgICAgICBhTU4ocGIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBiOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTChwYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoMjUwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFUobmV3IHRUKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WDogW0woMjUxKSwgTCgyNTIpLCBMKDI1MyldLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhRC5kYXRhLnRJbmNvbWVUeXBlDQogICAgICAgICAgICAgICAgICAgICAgICB9LGZ1bmN0aW9uKGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSAyICYmICFhRC5kYXRhLnRJbmNvbWVEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEudEluY29tZURhdGEgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEudEluY29tZURhdGEuZmlsbCgzMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEudEluY29tZVR5cGUgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnUoMjYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1NKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS50SW5jb21lVHlwZSAhPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzM3XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgobmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlMTogLTEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFELmRhdGEudEluY29tZVZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICB9LDEsMCxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYksucEUoTWF0aC5mbG9vcihlLnRhcmdldC52YWx1ZSksIDAsIDI1NSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSBhRC5kYXRhLnRJbmNvbWVWYWx1ZSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwYi5wdXNoKGFMZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYU1OKHBiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS50SW5jb21lVHlwZSAhPT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGUgPSBuZXcgcEooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShTWzE4XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUggPSBuZXcgdHcoMCwxLDAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUgudTMoYjkuemQuYTNEKGFELmRhdGEudEluY29tZURhdGEsIDQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChhTUgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhTGUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYU1GLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnF4ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYucXgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUYucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTUcucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNCA9IGZ1bmN0aW9uKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTUYudGZbMF0ucHkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHEwKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMNigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFMTTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZFgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwgPSBuZXcgdFkoTCg0MTApLFtuZXcgdyhTWzJdICsgTCgzNyksZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hMEwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTSA9IG5ldyBwWihhTEwudGUsYUxPKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFMTygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGIucHVzaChhUGEoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBhKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMZSA9IG5ldyBwSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBNKEwoNDMwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVBiID0gbmV3IHFWKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYmkuZUQuZGF0YVsxMDVdLnZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxOiAtMQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUGIuZS5yZWFkT25seSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoYVBiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTShMKDMzMyksIFNbMTldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUGMgPSBuZXcgcVYoYmkuZUQuZGF0YVsxNDhdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUGMgPSBuZXcgcVYoYmkuZUQuZGF0YVsxNDhdLDAsdW5kZWZpbmVkLGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGgoYmkuZUQuZGF0YVsxNDldLnZhbHVlLCBlLnRhcmdldC52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKGFQYyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucE0oTCgzMzcpLCBTWzE5XSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVBkID0gbmV3IHFWKGJpLmVELmRhdGFbMTQ5XSwxLHVuZGVmaW5lZCxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxoKGUudGFyZ2V0LnZhbHVlLCBiaS5lRC5kYXRhWzE0OF0udmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wWChhUGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQZS5idXR0b24udGV4dENvbnRlbnQgPSBMKDE3Mik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBjLmUucmVhZE9ubHkgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUGQuZS5yZWFkT25seSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaS5xMSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGkuYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFQZSA9IG5ldyB3KEwoMTcyKSxmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudGV4dENvbnRlbnQgPT09IEwoMTcyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRleHRDb250ZW50ID0gTCgxNzMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUGMuZS5yZWFkT25seSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQZC5lLnJlYWRPbmx5ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUxpLnExKDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGkuYnV0dG9uLnN0eWxlLmNvbG9yID0gYkEubmk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE0OSwgYVBkLmUudmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGgoYmkuZUQuZGF0YVsxNDldLnZhbHVlLCBiaS5lRC5kYXRhWzE0OF0udmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICAgICAgICBhTGUucFgoKG5ldyByQihbYVBlLmJ1dHRvbl0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxpID0gbmV3IHcoTCgxNCksZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUGMuZS5yZWFkT25seSAmJiBhei55LmFMaigwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy5hMksoZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5hTGwuYUxtKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGJpLmVELmRhdGFbMTQ4XS52YWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwYXJzZUludChiaS5lRC5kYXRhWzE0OV0udmFsdWUsIDEwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAsMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcFAgPSBhTGUucE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMZS5wTyhMKDQzMSkpLnN0eWxlLmZvbnRXZWlnaHQgPSBTWzM2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTGggPSBmdW5jdGlvbihmOCwgcE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmOCA9IGI5LmcxLmEycChmOCwgMiwgMTAwMDAwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFMbyA9IE1hdGgubWF4KDEsIDEgKyBNYXRoLmZsb29yKDAuMDEgKiAoZjggLSAxMDApKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcFAudGV4dENvbnRlbnQgPSBMKDE3NCwgW2Y4LCBiaS5lRC5kYXRhWzEwNV0udmFsdWUsIGFMbywgcE4sIGY4IC0gYUxvXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlLnBYKChuZXcgckIoW2FMaS5idXR0b25dKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUxoKGJpLmVELmRhdGFbMTQ5XS52YWx1ZSwgYmkuZUQuZGF0YVsxNDhdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhTGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTEwuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFMTS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE0ID0gZnVuY3Rpb24oZjEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMTC50ZlswXS5weSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZFgoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYnQoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgTWF0aC5sb2cyICE9PSBTWzM0XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5sb2cyID0gZnVuY3Rpb24oZW4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5sb2coZW4pIC8gTWF0aC5sb2coMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBNYXRoLmxvZzEwICE9PSBTWzM0XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5sb2cxMCA9IGZ1bmN0aW9uKGVuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubG9nKGVuKSAvIE1hdGgubG9nKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIE1hdGguc2lnbiAhPT0gU1szNF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguc2lnbiA9IGZ1bmN0aW9uKGVuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuID4gMCA/IDEgOiBlbiA8IDAgPyAtMSA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2UoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhUGYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGE4MzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQZzsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQaDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFQaTsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBqKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVBmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE4MyA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVBnID0gbmV3IEFycmF5KDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAzOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBnW2FCXSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdTID0gTWF0aC5mbG9vcigxICsgMC4wMjAgKiBoLm1pbik7DQogICAgICAgICAgICAgICAgICAgICAgICBhUGggPSBuZXcgQXJyYXkoNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUGkgPSBuZXcgQXJyYXkoNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUGlbMV0gPSBhUGlbM10gPSBhUGhbMF0gPSBhUGhbMl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVBpWzBdID0gYVBoWzNdID0gLXdTOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVBoWzFdID0gYVBpWzJdID0gd1M7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMTIgPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSC5tVSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhUGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUGooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFQZ1tlMV0gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE4MyA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhODMgPSBzZXRJbnRlcnZhbChhUGssIDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUGsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTE1ID0gZnVuY3Rpb24oZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVBmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBqKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhUGdbZTFdID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTgzID09PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUGwgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMzsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQbCA9IGFQbCB8fCBhUGdbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhUGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1LID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFQZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhODMgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAzOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBnW2FCXSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhODMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTgzID0gLTE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUGsoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTgzID09PSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMCB8fCAhYUgubVUoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLm1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFQbCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAzOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFQZ1thQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVBsID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUcgKz0gYVBoW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUkgKz0gYVBpW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWYuYTBXKGFQaFthQl0sIGFQaVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5hN2woKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFQbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFxLm1LKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNmKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBuZXcgYVBtKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubFQgPSBuZXcgYVBuKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubzUgPSBuZXcgYVBvKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUN3ID0gbmV3IGFQcCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFBbyA9IG5ldyBhUHEoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTGwgPSBuZXcgYVByKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2ggPSBuZXcgYVBzKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU5hID0gbmV3IGFQdCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1WSA9IG5ldyBhUHUoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUHYgPSBuZXcgYVB3KCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVB4ID0gbmV3IGFQeSgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQeiA9IG5ldyBhUTAoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUTEgPSBuZXcgYVEyKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBtKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFSiA9IDU7DQogICAgICAgICAgICAgICAgICAgIHZhciBhUTM7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVE0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFRNTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFRNiA9IDE1MDAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwRyA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBGID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUTQgPSBuZXcgQXJyYXkodGhpcy5hRUopOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1aiA9ICIudGVycml0b3JpYWwuaW8iOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUTRbMF0gPSBTWzIxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSXMgPSBheC5hSkQoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBheC5hM1ooMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDE7IGFCIDwgdGhpcy5hRUo7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFRNFthQl0gPSBhSy55YSgpICsgYTVqOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYXguYTNaKGFJcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUTMgPSBuZXcgQXJyYXkodGhpcy5hRUopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVE1ID0gbmV3IEFycmF5KHRoaXMuYUVKKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB0aGlzLmFFSiAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUTVbYUJdID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUGY6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRjogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVE3OiBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFFSygwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVE4ID0gZnVuY3Rpb24oYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhUTNbYUJdOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSB0aGlzLmFFSiAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hTGooYUIpICYmIGJlLmVGID4gYVE1W2FCXS5lRiArIGFRNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5hUTkoYUIsIGFRNVthQl0uYVE3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYUxqKDApICYmIGJlLmVGID4gYVE1WzBdLmVGICsgODAwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRNVswXS5lRiA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUVLKDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTlcgPSBmdW5jdGlvbihpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYUVLKDAsIGlkKSAmJiB0aGlzLmFRQSgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUVLID0gZnVuY3Rpb24oYTA3LCBhS3MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVE1W2EwN10uYVBmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUIoYTA3LCBhS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUTNbYTA3XS5hUUMoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLmFRRChhS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhUTNbYTA3XS5hTGooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFRQihhMDcsIGFLcyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRQiA9IGZ1bmN0aW9uKGEwNywgYUtzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhUTVbYTA3XS5hUGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVFFKGEwNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUTNbYTA3XSA9IG5ldyBhUUYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLmRYKGEwNywgYUtzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFEID0gZnVuY3Rpb24oYTA3LCBhS3MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUUMoYTA3KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLmFRRChhS3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUcgPSBmdW5jdGlvbihhMDcsIGFLcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYXouYUFvLmFRSChhMDcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUEgPSBmdW5jdGlvbihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYUxqKGFCKSAmJiBhUTNbYUJdLmFRQSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUkgPSBmdW5jdGlvbihhQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVEzW2FCXS5hUUkoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUxqID0gZnVuY3Rpb24oYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhUTVbYUJdLmFQZiAmJiBhUTNbYUJdLmFMaigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFDKGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVE1W2FCXS5hUGYgJiYgYVEzW2FCXS5hUUMoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbmQgPSBmdW5jdGlvbihhMDcsIGFDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhUUUoYTA3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLnNlbmQoYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMG4gPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRNVthMDddLmFRNyA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoubFQuYVFKID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRRShhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRNVthMDddLmVGID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgICAgICBhUTVbYTA3XS5hUTcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oYTA3LCBhUUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUUMoYTA3KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLmNsb3NlKGFRSyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRTCA9IGZ1bmN0aW9uKGEwNywgYVFLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvLmEwSihhUUspOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFRQyhhMDcpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVEzW2EwN10uY2xvc2UoYVFLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBNID0gZnVuY3Rpb24oYVFLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IHRoaXMuYUVKIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoYUIsIGFRSyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRTSA9IGZ1bmN0aW9uKGEwNywgYVFLKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IHRoaXMuYUVKIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQiAhPT0gYTA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoYUIsIGFRSyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM2wgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UodGhpcy5hMEcsIDMyNDYpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUU4gPSBmdW5jdGlvbihhMDcsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFRM1thMDddLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBvLmEwNihhMDcsIGUuY29kZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUG4oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFKID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5qcygpICUgMjUwICE9PSAyNDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYVFPKCsodGhpcy5hUUogJiYgYWcubGxbYUQuZVFdKSwgYVFQKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUogPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRUCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhbC5qdyArIGJNLnkub3U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVB1KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRUSA9IGZ1bmN0aW9uKGEwNywgYUMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmRYKGFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiRy5zaXplID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hUUwoYTA3LCAzMjA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkcub2koMSkgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUVIoYTA3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVFTKGEwNyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5hUVQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRUihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUVUgPSBiRy5vaSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUVUgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUVYoYTA3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVFVID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB2LmFRVyhhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDMgfHwgYVFVID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXcuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVFVID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB4LmFRWChhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB6LmFRWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDExKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB4LmFRWihhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB6LmFRYSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDEzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVExLmFRYigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDE0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVExLmFRYygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDE1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB4LmFRZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDE2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB2LmFRZShhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDE3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB2LmFRZihhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhUVUgPT09IDE5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYVB2LmFRZyhhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRVihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDcgIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LnkuYU94KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVFoID0gYkcub2koMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRaSA9IGJHLm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBuZXcgQXJyYXkoYVFoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBhUWg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IGJHLm9pKGFRaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhVC5hOEEoZyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUWogPSBmdW5jdGlvbihhQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkcuZFgoYUMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkcuZTEgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRVSA9IGJHLm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFRVSA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRaygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUWwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFtID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiRy5lMSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVFVID0gYkcub2koNik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVFuID0gYkcub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYTBGID09PSBhUW4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmEwRyA9IGFRbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmNsb3NlKGF6LnkuYTBGLCAzMjQ3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYTBHID0gYVFuOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXcuYUJ1ID0gYkcub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXcuYUVkID0gYkcub2koYVFVID09PSAzID8gOSA6IDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYUVLKGFRbiwgNSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei5vNS5hRWsoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFrKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkcuZTEgKz0gMjA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSBhRC5kYXRhID0gbmV3IGEzVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRbyA9IGFRcCg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQnogPSBlai5odW1hbkNvdW50ID0gYkcub2koOSkgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWouc2VsZWN0YWJsZVNwYXduID0gZWouZ2FtZU1vZGUgPT09IDEgfHwgYUJ6IDwgMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWouY29sb3JzRGF0YSA9IG5ldyBVaW50MzJBcnJheShhQnopOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWoucGxheWVyTmFtZXNEYXRhID0gbmV3IEFycmF5KGFCeik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYUJ6OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkcuZTErKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5jb2xvcnNEYXRhW2FCXSA9IGJHLm9pKDE4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5wbGF5ZXJOYW1lc0RhdGFbYUJdID0gYkYudjIudjYoYkcub2koNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuYUVWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi5hNyhhUW8sIGVqLm1hcFNlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFsKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkcuZTEgKz0gMjA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSBhRC5kYXRhID0gbmV3IGEzVCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRbyA9IGFRcCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQnogPSBlai5odW1hbkNvdW50ID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnNlbGVjdGFibGVTcGF3biA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBlai5lbG8gPSBuZXcgVWludDE2QXJyYXkoYUJ6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLmNvbG9yc0RhdGEgPSBuZXcgVWludDMyQXJyYXkoYUJ6KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnBsYXllck5hbWVzRGF0YSA9IG5ldyBBcnJheShhQnopOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFCejsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJHLmUxKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouY29sb3JzRGF0YVthQl0gPSBiRy5vaSgxOCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZWxvW2FCXSA9IGJHLm9pKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlai5wbGF5ZXJOYW1lc0RhdGFbYUJdID0gYkYudjIudjYoYkcub2koNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWEuYUVWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi5hNyhhUW8sIGVqLm1hcFNlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFwKGFRcSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVqID0gYUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnNlbGVjdGVkUGxheWVyID0gYkcub2koYVFxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLnNwYXduaW5nU2VlZCA9IGJHLm9pKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQnEgPSBiRy5vaSg0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhQnEgPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLm51bWJlclRlYW1zID0gYUJxICsgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUJxID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSBlai5pc1pvbWJpZU1vZGUgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLm51bWJlclRlYW1zID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWouZ2FtZU1vZGUgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqLmJhdHRsZVJveWFsZU1vZGUgPSBhQnEgPT09IDcgPyAwIDogKGFCcSA9PT0gMTAgPyAxIDogMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlai5pc0NvbnRlc3QgPSBiRy5vaSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUW8gPSBiRy5vaSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVqLm1hcFR5cGUgPSBiUi5hQngoYVFvKSA/IDAgOiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYlIuYUJ5KGVqLCBhUW8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZWoubWFwU2VlZCA9IGJHLm9pKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhUW87DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFTKGEwNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbCA9IGFhLmEwOSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsICE9PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdy5hRXAoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwNyAhPT0gYXoueS5hMEcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmFRTChhMDcsIDMyNDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFRVSA9IGJHLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFRVSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLnpBLmFRcihiRy5hQyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRcygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUXQgPSBiRy5vaSgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUXQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUXUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVF0ID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVF2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFRdCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFRdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWwuYTkgfHwgbC5hQSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IDMgKiA2MCAqIDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyBlZyAqIDMyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gTWF0aC5taW4oYjcubzIub2subGVuZ3RoLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYkMuYVF4KDMyLCBiNy5vMi5va1thQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYXoueS5hMEcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUXUoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbzUgPSBiRy5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFtvNV0gPT09IDAgfHwgYWcubGxbYUQuZVFdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9KID0gYkcub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU4ub0kobzUsIGFELmVRLCBvSik7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5wRihvNSwgMSwgb0opOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFRdigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvNSA9IGJHLm9pKDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW281XSA9PT0gMCB8fCBhZy5sbFthRC5lUV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI0LmFJYygwLCBbbzVdLCB0cnVlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLm9aKG81LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUXcoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbzUgPSBiRy5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBiRy5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5sbFtvNV0gPT09IDAgfHwgYWcubGxbdGFyZ2V0XSA9PT0gMCB8fCBhZy5sbFthRC5lUV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI0LmFJYygxLCBbbzVdLCB0cnVlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLnBGKG81LCAzLCA5Nik7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5wRih0YXJnZXQsIDQsIDk2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE1ZihvNSwgdGFyZ2V0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUTAoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFZID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS55LnVhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDUsIGJFLnJ5LnJ6KGJFLnJ5LnMwKDUpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDYsIGJFLnJ5LnJ6KGJFLnJ5LnMwKDgpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDksIGJHLm9pKDMwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMDgsIGJpLmVELmRhdGFbMTA5XS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMTEsIGJpLmVELmRhdGFbMTA5XS52YWx1ZSArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTA3LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDExMCwgIiIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUWEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiRy5zaXplIDwgYkMuYVF5KDEgKyA2ICsgNSArIDMgKyAzICsgMyArIDgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hUUwoMCwgMzI1NCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcnU6IGJHLm9pKDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bjogYkcub2koMTYpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVvOiBiRy5vaSgzMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXA6IGJHLm9pKDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cTogYkcub2koMzApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVyOiBiRy5hUXooMzIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBiRi52NC52TSg1KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1czogYkYudjQudk0oMyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXQ6IGJGLnY0LnZNKDMpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1OiBiRy5hUXooMzIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV2OiBiRy5hUXooMzIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV3OiBiRy5vaSgzMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXg6IGJHLmFReigzMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXk6IGJHLmFReigzMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXo6IGJHLmFReigzMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdjA6IGJHLmFReigzMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUx0OiBiRy5hUXooMzIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMdTogYkcuYVF6KDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTTU6IGJHLmFReigzMiksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYU02OiBiRi52NC52TSgzKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHk6IGJHLmFReigyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHo6IGJHLmFReigxMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUx3OiBiRi52NC52TSg4KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTTA6IGJHLmFReig1KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTGc6IGJHLm9pKDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTHM6IGJHLm9pKDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6UzogYkcuYVF6KDMyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTTc6IGJHLm9pKDEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNODogYkcub2koMSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5hTTcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFNOSA9IGJHLmFReigzMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hTUEgPSBiRy5vaSgzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hTUIgPSBiRy5vaSgzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hTUMgPSBiRy5vaSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuYTQwKCkuYU5WID09PSAyNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFMTiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQueS5hTDMgPSBkYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MCgpLmFOaygyNSwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuYUxOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE2MCwgKyhkYXRhLmFNNyAmJiBkYXRhLmFNQykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJ0ID0gYmkuZUQuZGF0YVsxMDVdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnkuYUwwID0gZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgudW0oZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYU5rKDE2LCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUTIoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFiID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYkcuc2l6ZSA8IGJDLmFReSgxICsgNiArIDYgKyAxMCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmFRTCgwLCAzMjU5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0UgPSBiRy5vaSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc0UgPT09IDkgfHwgc0UgPT09IDEwIHx8IHNFID09PSAxMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaChbYkcub2koMzApLCBiRi52NC52TSg1KSwgYkcuYVF6KDMyKSwgMCwgYkcub2koMzApXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYU5rKDIxLCB0cnVlLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzRTogc0UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc0UgPT09IDEyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKFtiRy5vaSgyMCksIGJHLm9pKDMwKSwgYkcub2koMzApLCBiRy5hUXooMzIpLCBiRy5vaSgzMCksIGJGLnY0LnZNKDUpLCBiRi52NC52TSg1KV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MCgpLmFOaygyMSwgdHJ1ZSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc0U6IHNFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhZID0gYkcub2koMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiRy5hUjAoMSArIDYgKyA2ICsgMTAgKyAxNiArIGhZICogMTYgKyBlZyAqIChzRSA9PT0gMCA/ICgzMCArIDUgKyAxNiArIDMwICsgMzApIDogc0UgPT09IDEgPyAoMTYgKyAzICsgMTYgKyA1ICsgMzEgKyAzMCkgOiAoc0UgPT09IDIgfHwgc0UgPT09IDMpID8gKDMwICsgNSArIDMyICsgMzAgKyAzMCkgOiAoNCAqIDMwICsgMzIgKyAzMCArIDIwICsgNSArIDUpKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmFRTCgwLCAzMjYwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc0UgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goW2JHLm9pKDMwKSwgYkYudjIudjYoYkcub2koNSkpLCBiRy5vaSgxNiksIGJHLm9pKDMwKSwgYkcub2koMzApXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzRSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaChbYkcub2koMTYpLCBiRi52Mi52NihiRy5vaSgzKSksIGJHLm9pKDE2KSwgYkYudjIudjYoYkcub2koNSkpLCBiRy5vaSgzMSksIGJHLm9pKDMwKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc0UgPT09IDIgfHwgc0UgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goW2JHLm9pKDMwKSwgYkYudjIudjYoYkcub2koNSkpLCBiRy5hUXooMzIpLCBiRy5vaSgzMCksIGJHLm9pKDMwKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKFtiRy5vaSgyMCksIGJHLm9pKDMwKSwgYkcub2koMzApLCBiRy5vaSgzMCksIGJHLm9pKDMwKSwgYkcuYVF6KDMyKSwgYkcub2koMzApLCBiRi52Mi52NihiRy5vaSg1KSksIGJGLnYyLnY2KGJHLm9pKDUpKV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hNDAoKS5hTmsoMjEsIHRydWUsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc0U6IHNFLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRYyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJHLnNpemUgPCBiQy5hUXkoMSArIDYgKyA0ICsgNyArIDExKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYVFMKDAsIDMyNjUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUjEgPSBiRy5vaSg0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUjIgPSBiRy5vaSg3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUjMgPSBiRy5vaSgxMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJHLmFSMCgxICsgNiArIDQgKyA3ICsgMTEgKyBhUjIgKiAxNiArIGFSMyAqIDE2ICsgYVIxICogKDMgKyA4KSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhei55LmFRTCgwLCAzMjY2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFSMTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6aCA9IGJGLnYyLnY2KGJHLm9pKDMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVI0ID0gYkcub2koOCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFNaiA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCBhUjQ7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYU1qLnB1c2goYkcub2koMTYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIlsiICsgemggKyAiXSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFNajogYU1qDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYU5rKDIzLCB0cnVlLCBkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQdygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUVcgPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDcgIT09IGF6LnkuYTBGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZShhMDcsIDMyMzkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSAhPT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoYTA3LCAzMjcxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBibS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcWsgPSBibS55LnFsW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5zbSA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5lTSA9IGJHLm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFrLm1hcFNlZWQgPSBiRy5vaSgxNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUJxID0gYkcub2koNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYURYID0gYkcub2koNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYURZID0gYkcub2koNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUJ3ID0gYkcub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUNjID0gYkcub2koMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFrLnNwYXduaW5nU2VlZCA9IGJHLm9pKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyQ291bnQgPSBiRy5vaSgxNik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm0udDEudDNbYUJdID0gYkcub2koMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCBwbGF5ZXJDb3VudDsgZXorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS50MS5hQlQoYUIsIGJHLm9pKDMwKSwgYkYudjQudk0oNSksIGJHLm9pKDQpLCBiRy5vaSgzMCksIGJHLm9pKDcpLCBiRy5vaSgxNiksIGJHLm9pKDE4KSwgYkcub2koMTEpLCBiRy5vaSgxMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHQudSgyOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBibS55LmFDVCh0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFlID0gZnVuY3Rpb24oYTA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTA3ICE9PSBhei55LmEwRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoYTA3LCAzMjM5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJtLmEwRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoYTA3LCAzMjUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBibS55LmFDUlswXSA9IGJHLm9pKDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkuYUNSWzFdID0gYkcub2koMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFSNSA9IGJHLm9pKDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGV6ID0gMDsgZXogPCBhUjU7IGV6KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBiRy5vaSgzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm0udDEuYUJUKGJHLm9pKDIpLCBiRy5vaSgzMCksIGJGLnY0LnZNKDUpLCAwLCAxMjM0NTY2LCAxMjcsIDAsIGJHLm9pKDE4KSwgMCwgYkcub2koMTIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJtLnQxLmFCayhiRy5vaSgxNiksIGJHLm9pKDIpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJtLnQxLmFCZyhiRy5vaSgxNiksIGJHLm9pKDIpLCBiRy5vaSgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS50MS5hQmooYkcub2koMTYpLCBiRy5vaSgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibS50MS5hQlooYkcub2koMTYpLCBiRy5vaSgyKSwgYkcub2koNCksIGJHLm9pKDMwKSwgYkcub2koNyksIGJHLm9pKDE2KSwgYkcub2koMTEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJtLnQxLmFCYShiRy5vaSgxNiksIGJHLm9pKDIpLCBiRy5vaSgxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcWsgPSBibS55LnFsW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5zbSA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocWsuc20gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYTBHID0gYkcub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hQnUgPSBiRy5vaSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibS5hQkouZGcoYUIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuZU0gPSBiRy5vaSg2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsubWFwU2VlZCA9IGJHLm9pKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUJxID0gYkcub2koNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFrLmFEWCA9IGJHLm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hRFkgPSBiRy5vaSg0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuYUJ3ID0gYkcub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFrLmFDYyA9IGJHLm9pKDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWsuc3Bhd25pbmdTZWVkID0gYkcub2koMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hRFoucHVzaChxay5hRFpbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxay5hRFouc2hpZnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBibS55LmFDVigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUWYgPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMDcgIT09IGF6LnkuYTBGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZShhMDcsIDMyNzIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYm0uYTBFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5jbG9zZShhMDcsIDMyNzMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxaSA9IGJHLm9pKDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFrID0gYm0ueS5xbFtxaV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcW0gPSBxay5xbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHFrLnFuID0gYkcub2koMjApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRHID0gYkcub2koNik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgdEc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxbS5wdXNoKGFSNigpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJtLnkuYUNkKHFpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSNigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IGJHLm9pKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogYkcub2koMzApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByOiBibS5hQkkuYUQyKGJGLnY0LnZNKDcpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBiRy5vaSgzMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDNTogYkcub2koMyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBiRy5vaSgzMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogYkcub2koMzApDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnQ6IGJHLm9pKDMwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUM1OiBiRy5vaSgzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiBiRy5vaSgzMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDNTogYkcub2koMyksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBiRy5vaSg0KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBiRy5vaSgzMCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydDogYkcub2koMzApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQzU6IGJHLm9pKDMpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGJHLm9pKDMwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDNTogYkcub2koNikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYkcub2koMTcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFnID0gZnVuY3Rpb24oYTA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTA3ICE9PSBhei55LmEwRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoYTA3LCAzMjc2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJtLmEwRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuY2xvc2UoYTA3LCAzMjc3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBibS5tZXNzYWdlLmFDeShhUjYoKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUHkoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFYID0gZnVuY3Rpb24oYTA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJHLmFSMCgxICsgNiArIDMgKyAzMCArIDMwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYVFMKGEwNywgMzI2OSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFRdCA9IGJHLm9pKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFEID0gYmguYVI3LmlxKGJHLm9pKDMwKSwgYkcub2koMzApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFBby5hUjgoYTA3LCBxRCwgYVF0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUXQgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwNyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaS5lRC5kYXRhWzEwNV0udmFsdWUubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LmFBby5hTlooMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFSOShhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUxsLmFSOShhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF6LnkuYVE4KGEwNykuYVJBKCkgPT09IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWEuYTA5KCkgPT09IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUN3LmFFTChhMDcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXoueS5hUTgoYTA3KS5hUkEoKSA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYS5hMDkoKSA9PT0gOCB8fCBhYS5hMDkoKSA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoubzUuYUVrKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUVogPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IGJHLm9pKDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmkucjgucjkoMTYwLCBiRy5vaSgzMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYVFJKGEwNyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhVC5hODYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXouYUFvLmFOWigxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjYuYUFtKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQucnYgPT09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hNDAoKS5hTmooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAyMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJ2ID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuYTQwKCkuYU5rKDE3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlkID09PSAyMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDEwNiwgYmkuZUQuZGF0YVsxMTBdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaS5yOC5yOSgxMTAsICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5ydiA9PT0gOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmE0MCgpLmFOaygxNSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBiRy5vaSgxNik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJCID0gYkcub2koMTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiRy5hUjAoMSArIDYgKyAxNiArIDE2ICsgMTYgKyBlZyAqIDEwICsgYVJCICogMTYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hUUwoMCwgMzI3MCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChiRi52Mi52NihiRy5vaSgxMCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI2LmFBcShnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQbygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUTkgPSBmdW5jdGlvbihhMDcsIGFRNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCBhUTcgPyAxIDogMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYTA3LCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFFayA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyA4ICsgMTAgKyA5ICsgMTAgKyAxNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoOCwgYXoueS5hMEYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTAsIGF3LmFCdSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg5LCBhdy5hRWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTAsIGwuZHEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTQsIGwuZGopOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm82ID0gZnVuY3Rpb24oZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDIyLCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYXoueS5hMEcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubzcgPSBmdW5jdGlvbihpRiwgajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgMTAgKyAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTAsIGlGKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYXoueS5hMEcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub0IgPSBmdW5jdGlvbihpRiwgbzkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgMTAgKyA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNCwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxMCwgaUYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoOSwgbzkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9DID0gZnVuY3Rpb24oaUYsIGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNCArIDEwICsgMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCAzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBpRik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyMiwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9GID0gZnVuY3Rpb24obTgsIGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNCArIDEwICsgMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBtOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyMiwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9IID0gZnVuY3Rpb24oajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYXoueS5hMEcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub0wgPSBmdW5jdGlvbihlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDQgKyAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDQsIDYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTAsIGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vTiA9IGZ1bmN0aW9uKG9NKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNCArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCA3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIG9NKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vUCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vUSA9IGZ1bmN0aW9uKGlGLCBlUywgajYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgMTAgKyAxMCArIDIyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNCwgMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTAsIGlGKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBqNik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyMiwgZVMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9YID0gZnVuY3Rpb24oYVJDLCBhUkQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA0ICsgOSArIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNCwgMTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoOSwgYVJEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBhUkMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9hID0gZnVuY3Rpb24oYTVZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNCArIDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCAxNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg5LCBhNVkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9lID0gZnVuY3Rpb24oYVJFLCB0YXJnZXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFSRS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNCArIDkgKyBlZyAqIDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCAxMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg5LCB0YXJnZXQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg5LCBhUkVbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVByKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFSRiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyAoMTQgKyA0ICsgNyArIDEgKyAxICsgNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAxNik7DQogICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYVJHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUjkgPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgKDMwICsgNDggKyAzMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAxNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUkgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhMDcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU5tID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDQ4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMTgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkYucnkudkgoYmkuZUQuZGF0YVsxMTBdLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZCgwLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFOaSA9IGZ1bmN0aW9uKGEycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYTJzLnBOLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgNiArIDggKyBlZyAqIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMjkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgYTJzLnJ4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDgsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJFLnYyLnZIKGEycy5wTik7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTTEgPSBmdW5jdGlvbihkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDYgKyAzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIDI1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIGRhdGEucngpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkYucnkudkkoZGF0YS5ydCwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTG0gPSBmdW5jdGlvbihkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDYgKyAzMCArIDMyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMjcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgZGF0YS5yeCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRi5yeS52SShkYXRhLnJ0LCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmFReCgzMiwgZGF0YS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJIKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkYucnkudkkoYmkuZUQuZGF0YVsxMDVdLnZhbHVlLCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJGLnJ5LnZJKGJpLmVELmRhdGFbMTA2XS52YWx1ZSwgOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgzMCwgYmkuZUQuZGF0YVsxMDldLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUHMoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2cgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFELmp2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHlxID0gYlEucmVzdWx0LnlxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0geXEubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDQgKyAxMCArIDEgKyAxICsgZWcgKiAxNiArIGtkICogKDkgKyAyNCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxMCwga2QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgKyhhRC55eSA9PT0gMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgYUQuekkgJSAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4VSA9IGFnLnhVOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMTYsIHhVW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ1QgPSBhZy5nVDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGtkOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0geXFbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDksIGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyNCwgZ1RbZ0RdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVB0KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFOYiA9IGZ1bmN0aW9uKHNFLCBzRiwgc0cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgNiArIDIgKiAoMSArIDMwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIDIxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIHNFKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsICsoc0YgPCAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCArKHNHIDwgMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMzAsIE1hdGguYWJzKHNGKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgzMCwgTWF0aC5hYnMoc0cpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZCgwLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFOYyA9IGZ1bmN0aW9uKHNFLCBhTmQsIGFOZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyA2ICsgNSArIGFOZC5sZW5ndGggKiAxNiArIDMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgc0UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXouYUFvLmFSSShhTmQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMzAsIGFOZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTmggPSBmdW5jdGlvbihzRSwgYU5kLCBhTmUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgNiArIDMwICsgMzApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAyOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCBzRSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRi5yeS52SShhTmQsIDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMzAsIGFOZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoMCwgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTmYgPSBmdW5jdGlvbihhTWksIHpnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB6Zy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFkgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoWSArPSB6Z1thQl0ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyAzICsgNCArIDcgKyBlZyAqIDMgKyBoWSAqIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMywgYU1pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDQsIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDcsIGhZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMywgemdbYUJdLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkUudjIudkgoemdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZCgwLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFOZyA9IGZ1bmN0aW9uKGFNaSwgc0YsIHNHKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDMgKyAyICogKDEgKyAyMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAyNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgzLCBhTWkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgKyhzRiA8IDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsICsoc0cgPCAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgyMCwgTWF0aC5hYnMoc0YpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDIwLCBNYXRoLmFicyhzRykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKDAsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFQcCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRUwgPSBmdW5jdGlvbihhMDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IGJpLmVELmRhdGFbMTIyXS52YWx1ZS5zbGljZSgwLCAyMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDEwICsgMiArIDUgKyB1c2VybmFtZS5sZW5ndGggKiAxNiArIDE4ICsgMiAqIDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEwLCBsLmRxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDIsIGJpLmVELmRhdGFbMTU4XS52YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhei5hQW8uYVJJKHVzZXJuYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUkogPSBiOS5jb2xvci5hMXcoYmkueS51aCgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDYsIGFSSlswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCBhUkpbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgYVJKWzJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUksgPSBiNi5hQXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDksIGFSS1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg5LCBhUktbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hMEYgPSBhMDc7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LnNlbmQoYTA3LCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFDeCA9IGZ1bmN0aW9uKGFSTCwgYTJzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiRC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkQuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRC5hOCg2LCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJELmE4KDMsIGFSTCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVJMID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkQuYTgoMiwgYTJzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVJMID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkUudjQueVUoYTJzLCA3LCBiRCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFSTCA9PT0gNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJELmE4KDMsIGEycy5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkQuYTgoMywgYTJzLnZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiRC5hOCgzMCwgYTJzLnJ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhei55LmEwRiwgYkQuYVJNKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVBxKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRSCA9IGZ1bmN0aW9uKGEwNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyAoMTQgKyA0ICsgNyArIDEgKyAxICsgNSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCAxMyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUk4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhMDcsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVI4ID0gZnVuY3Rpb24oYTA3LCBxRCwgYVF0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hNygxICsgNiArIDMgKyAzMCArIDMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMywgYVF0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDMwLCBxRFswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgzMCwgcURbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGEwNywgYkMuYUMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hTlogPSBmdW5jdGlvbihpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyA2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKDAsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFwID0gZnVuY3Rpb24oaWQsIHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBNYXRoLm1pbihwTi5sZW5ndGgsIDYzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgNiArIDYgKyBlZyAqIDE2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMjYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkUudjIudkgocE4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKDAsIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVJPID0gZnVuY3Rpb24oYVFuLCBwWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTcoMSArIDYgKyBwWS5sZW5ndGggKiAoMTYgKyAxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg2LCA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBwWS5sZW5ndGg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxNiwgcFlbYUJdWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxMCwgcFlbYUJdWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGF6Lnkuc2VuZChhUW4sIGJDLmFDKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFPID0gZnVuY3Rpb24oYVJQLCBhUlEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE3KDEgKyA2ICsgMSArIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoNiwgMTkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkMuYTgoMSwgYVJQKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJDLmE4KDEyLCBhUlEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5zZW5kKGF6LnkuYTBHLCBiQy5hQyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUk4oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxNCwgbC5kaik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg0LCBhMC5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg3LCBhMC5kbik7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCArbC5hOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCgxLCArbC5hQSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg1LCAobmV3IERhdGUoKSkuZ2V0SG91cnMoKSAlIDI0KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFSSSA9IGZ1bmN0aW9uKHVzZXJuYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiQy5hOCg1LCB1c2VybmFtZS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYkUudjIudkgodXNlcm5hbWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVFGKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYTA3Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUtzOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVJSOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVJTID0gWyJ3c3M6Ly8iLCAiL3M1MC8iLCAiL3M1MS8iLCAiL3M1Mi8iXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFSVCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbihlMSwgYVJVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhMDcgPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFLcyA9IGFSVTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSVigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUlcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhUlIucmVhZHlTdGF0ZSA9PT0gYVJSLkNPTk5FQ1RJTkc7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFMaiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFSUi5yZWFkeVN0YXRlID09PSBhUlIuT1BFTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFBID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVJUOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUUkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSVCA9IDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFRQyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYVJXKCkgfHwgdGhpcy5hTGooKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVFEID0gZnVuY3Rpb24oYVJVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhS3MgPSBhUlU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFSQSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFLczsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uKGFDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hTGooKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSUi5zZW5kKGFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UgPSBmdW5jdGlvbihhUUspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFRQygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVJSLmNsb3NlKGFRSyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5xeCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVJSLm9ub3BlbiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhUlIub25tZXNzYWdlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSUi5vbmNsb3NlID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSUi5vbmVycm9yID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSVigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUlggPSBhUlNbMF0gKyBhei55LmFRNFthMDddICsgYVJTWzEgKyBsLmRrXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSUiA9IG5ldyBXZWJTb2NrZXQoYVJYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSUi5iaW5hcnlUeXBlID0gImFycmF5YnVmZmVyIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSUi5vbm9wZW4gPSBhUUc7DQogICAgICAgICAgICAgICAgICAgICAgICBhUlIub25tZXNzYWdlID0gYVJZOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVJSLm9uY2xvc2UgPSBhUU47DQogICAgICAgICAgICAgICAgICAgICAgICBhUlIub25lcnJvciA9IGFSWjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUUcoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmFRRyhhMDcsIGFLcyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJZKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LmE1WS5hUVEoYTA3LCBuZXcgVWludDhBcnJheShlLmRhdGEpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUlooKSB7fQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUU4oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYXoueS5hUU4oYTA3LCBlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkRygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFSYSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYTV0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgczIgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZ2FwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHZhciB4RCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHZhciBhMVcgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTFXID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhNXQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTFXID0gbmV3IFVpbnQzMkFycmF5KGFELndIICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUmIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE2ZyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBNYXRoLmZsb29yKChhMC5hMS5yNCgpICYmICFhRC5tRikgPyAoMC4xOCAqIGgubWluKSA6ICgwLjEzICogaC5waSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaSAqPSAxICsgKDAuNSArIDAuMiAqIGEwLmExLnI0KCkpICogYUQubUY7DQogICAgICAgICAgICAgICAgICAgICAgICBpICs9IGkgJSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgczIgPSBNYXRoLmZsb29yKDcgKiBpIC8gOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMgPSBjYW52YXMgPyBjYW52YXMgOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFNbNF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQgPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGE6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ2FwID0gTWF0aC5tYXgoMSwgMC4wMTUgKiBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVXaWR0aCA9IGdhcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZVN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24oeEQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEJhc2VsaW5lKHhELCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSYygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMm8gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsNiA9IHRoaXMubDcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZi5rSFtsNl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTFXW2w2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGw2ID0gYVJkKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGwgPSBhZy5nVFtsQVswXV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobDYgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGExV1tsNl0gPiBkbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMVdbbDZdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56dSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYTV0ID0gMzE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sNygpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sNyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGw2ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQud0g7IGFCID4gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMVdbYUJdID4gYTFXW2w2XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsNiA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsNjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSZCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsNiA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhRC53SDsgYUIgPj0gMTsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsNiA9PT0gLTEgfHwgYTFXW2FCXSA+IGExV1tsNl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbDYgPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbDY7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sOCA9IGZ1bmN0aW9uKGFSZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqeCA9IGFsLmp4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhbC5qdzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmSiA9IGJOLmZKOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0ganhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZVtnRF0gPT09IGFSZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmSltnOCsrXSA9IGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZCWzBdID0gZzg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEyUCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGc4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQud0g7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnOCArPSBhMVdbYUJdID4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaFYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKythNXQgPj0gMzIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhNXQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSZigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJiKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhRC53SDsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExV1thQl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFsLmp3IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGExV1tiZi5lZVthbC5qeFthQl1dXSArPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSZigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQud0g7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMVdbYUJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhbC5qdyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMVdbYmYuZWVbYWwuanhbYUJdXV0gKz0gYWcuZ1RbYWwuanhbYUJdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFSYSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUmEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUmMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSYygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUmcgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IE1hdGguZmxvb3IoaSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUwID0gTWF0aC5mbG9vcihzMiAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFSaCA9IDEuNSAqIE1hdGguUEk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELndIOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWcgKz0gYTFXW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTFXW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUmcrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB4NygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhUmcgPT09IGFELndIKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhRC53SDsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGExV1thQl0gPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVJqKGFCLCBmMSwgZTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSayhmMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDw9IGFELndIOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTFXW2FCXSA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUmkgPSBhUmggKyAyICogTWF0aC5QSSAqIGExV1thQl0gLyBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUmwoYUIsIGYxLCBlMCwgYVJoLCBhUmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSbShmMSwgZTAsIGFSaCwgYVJpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgIT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVJuKGYxLCBlMCwgYVJoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVJoID0gYVJpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSbihmMSwgZTAsIDEuNSAqIE1hdGguUEkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFSbyhmMSwgZTApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHg3KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVJhID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5jbGVhclJlY3QoMCwgMCwgaSwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiQS5tajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KDAsIDAsIGksIGkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCAwLCBpLCBnYXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFJlY3QoMCwgMCwgZ2FwLCBpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxSZWN0KGkgLSBnYXAsIDAsIGdhcCwgaSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsUmVjdCgwLCBpIC0gZ2FwLCBpLCBnYXApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSaihhQiwgZjEsIGUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsU3R5bGUgPSBiZi5hUnBbYmYua0hbYUJdXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYXJjKGYxLCBmMSwgZTAsIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUmwoYUIsIGYxLCBlMCwgYVJoLCBhUmkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJmLmFScFtiZi5rSFthQl1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5hcmMoZjEsIGYxLCBlMCwgYVJoLCBhUmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQubGluZVRvKGYxLCBmMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJrKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9udFNpemUgPSBmMSAvIDM7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5mb250ID0gYjkucGcuclYoMSwgZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5maWxsVGV4dChTWzFdLCBmMSwgZjEgKyAwLjEgKiBmb250U2l6ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJtKGYxLCBlMCwgYVJoLCBhUmkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUnEsIHU0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gKGFSaSAtIGFSaCkgLyAoMiAqIE1hdGguUEkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gMSAqIGUwICogTWF0aC5taW4oZjgsIDAuMzcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvbnRTaXplIDwgOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFScSA9IChhUmggKyBhUmkpIC8gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHU0ID0gTWF0aC5mbG9vcigxMDAgKiBmOCArIDAuNSkgKyAiJSI7DQogICAgICAgICAgICAgICAgICAgICAgICBlMCAqPSAwLjUyNSAtIE1hdGgubWF4KDAuNiAqIChmOCAtIDAuNyksIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZm9udCA9IGI5LnBnLnJWKDEsIGZvbnRTaXplKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuZmlsbFRleHQodTQsIGYxICsgTWF0aC5jb3MoYVJxKSAqIGUwLCBmMSArIE1hdGguY29zKGFScSArIDEuNSAqIE1hdGguUEkpICogZTApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSbihmMSwgZTAsIGFScSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB4RC5tb3ZlVG8oZjEsIGYxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmxpbmVUbyhmMSArIE1hdGguY29zKGFScSkgKiBlMCwgZjEgKyBNYXRoLmNvcyhhUnEgKyAxLjUgKiBNYXRoLlBJKSAqIGUwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSbyhmMSwgZTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeEQuYXJjKGYxLCBmMSwgZTAsIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHhELnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5tRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoY2FudmFzLCBiYi5nYXAsIGJiLmdhcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGNhbnZhcywgYmIuZ2FwLCBhNmggKyAyICogYmIuZ2FwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjeigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFScigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBhUnMoInJlcGxheSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNsZWFyKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdC51KDMsIDAsIHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJyKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYVJzKFNbOTRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGFScygiYSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYkguY2xlYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJILmNsZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoOCwgdC5ydiwgbmV3IHJ3KDEwMDAsew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ4OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0OiB2YWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydTogMA0KICAgICAgICAgICAgICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEwNCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTA0LnNlYXJjaCA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAiIiwgYTA0LnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciAzNTI6ICIgKyBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFScyhrZXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgVVJMU2VhcmNoUGFyYW1zID09PSBTWzI3XSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFQQyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJ0ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhhUEMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYVJ0LmdldChrZXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gU1s0NF0gfHwgdmFsdWUubGVuZ3RoIDwgMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU1FID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEwLmlkICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTA0ID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdEID0gYTA0LnNlYXJjaFBhcmFtczsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRC5zZXQoa2V5LCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTA0LnNlYXJjaCA9IGdELnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgIiIsIGEwNC50b1N0cmluZygpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3IgMzU4OiAiICsgZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjZygpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFSdTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGc7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBuZXcgVWludDE2QXJyYXkoMTAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gZy5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0gPSBiSy5kbShhQiAqIDMyNzY4LCAxMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM1ooMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gZnVuY3Rpb24oZ0QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnW2dEXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUpEID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYksuZG0oYVJ1IC0gMSwgMik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzWiA9IGZ1bmN0aW9uKGFJcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVJ1ID0gKGFJcyAqIDIpICUgMzI3NjggKyAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb20gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSdSA9IGFSdSAqIDE2NyAlIDMyNzY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFSdTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuakQgPSBmdW5jdGlvbihsZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJLLmRtKGxnICogdGhpcy5yYW5kb20oKSwgMzI3NjgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qbiA9IGZ1bmN0aW9uKGdEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ0QgIT09IDAgJiYgdGhpcy5yYW5kb20oKSA8IHRoaXMudmFsdWUoZ0QpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pWiA9IGZ1bmN0aW9uKGV6LCBmMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV6ICsgdGhpcy5qRChmMCAtIGV6KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGN2KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLm93ID0gbmV3IGFSdigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzayA9IG5ldyBhUncoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR1kgPSBuZXcgYVJ4KCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3cuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3cuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFSeSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVJ5KCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQucnYgIT09IDMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuanMoKSAlIDE1ICE9PSA1ICYmIGFELnoxICE9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdC5hNDAoKS5hUEQoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQRyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWEuYUVWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5hM1UuYTNzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhRC5kYXRhLmNhbnZhcyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICBhei55LmNsb3NlKGF6LnkuYTBHLCAzMjU3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuYTBHID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuaXNSZXBsYXkgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUQuYTNYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQRiA9IGZ1bmN0aW9uKHBOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIgPSBwTi5pbmRleE9mKCI9Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTi5zdWJzdHJpbmcoYUIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVBFID0gZnVuY3Rpb24ocE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly90ZXJyaXRvcmlhbC5pby8/cmVwbGF5PSIgKyBwTjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSdigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUnogPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVMxID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzIgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVM0ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hM2ogPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFTNSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVJ6ID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzEgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVMyID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMyA9IFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVM0ID0gWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVM1ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTNqID0gIiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm94ID0gZnVuY3Rpb24oaWQsIGZOLCBmUCwgZlIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5ncCB8fCBhRC56MSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFTM1thUzVdID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYVM0W2FTNV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzMucHVzaCgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzQucHVzaCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVM1Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzNbYVM1XSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUnoucHVzaChpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMC5wdXNoKGZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVMxLnB1c2goZlAgPT09IHVuZGVmaW5lZCA/IDAgOiBmUCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFTMi5wdXNoKGZSID09PSB1bmRlZmluZWQgPyAwIDogZlIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzRbYVM1XSsrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYVMzW2FTNV0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFTNFthUzVdKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hUzMucHVzaCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVM0LnB1c2goMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhUzUrKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFSeCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFTNiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudk0gPSBmdW5jdGlvbihwTiwgYVM3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhUzYgPSBhUzc7DQogICAgICAgICAgICAgICAgICAgICAgICBiRi5yeS52RShiRi5yeS52QyhiRi5yeS52QShwTikpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE0eiA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhTU8oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFTOCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhUzkoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiRy5lMSA8IDggKiBiRy5zaXplIC0gMTMgfHwgYkcuZTEgPiA4ICogYkcuc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTQSgiT3V0IE9mIEJvdW5kcyBFcnJvcjogIiArIGJHLmUxICsgIiAiICsgKDggKiBiRy5zaXplKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYjgub3cuYTNqID0gcE47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZGF0YS5tYXBUeXBlID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNBKCJMb2FkIGJhc2U2NCBpbWFnZS4uLiIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hR1ogPSBmdW5jdGlvbihhRzksIGFTQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoU1s0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSBhMXIuZ2V0Q29udGV4dCgiMmQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGExci53aWR0aCA9IGFHOS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGExci5oZWlnaHQgPSBhRzkuaGVpZ2h0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKGFHOSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVM2IHx8IGFTQikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEuY2FudmFzID0gYTFyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFELmRhdGEubWFwVHlwZSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC54KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC51KDE5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5hUEcoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFNTygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiRy5zaXplIDwgMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU0EoIkZpbGUgVG9vIFNtYWxsIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTQyA9IGJHLm9pKDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhU0MgIT09IGwuclZlcnNpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9ICJJbmNvbXBhdGlibGUgVmVyc2lvbiAgIFJlcXVpcmVkOiAiICsgbC5yVmVyc2lvbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByICs9ICIgICBGb3VuZDogIiArIGFTQzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByICs9ICIgICBDb21wYXRpYmxlIGF0IHRlcnJpdG9yaWFsLmlvLyIgKyBhU0M7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNBKHIsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFSUSA9IGJHLm9pKDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU0QgPSBiRy5vaSgzMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVNEICE9PSBiRy5zaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNBKCJTaXplIEVycm9yOiAiICsgYVNEICsgIiAiICsgYkcuc2l6ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFTRShhUlEsIGFTQykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU0EocE4sIGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVM2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudSg0LCAzLCBuZXcgdigi4pqg77iPICIgKyBMKDQzMikscE4sMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE0eiA9IEwoNDMzKSArICI6ICIgKyBwTjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0LnUoNCwgMywgbmV3IHYoTCg0MzQpLHBOLDEpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU0UoaiwgYVNDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0QgPSBiRy5hQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJHLnNpemU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJRID0gYVNDOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAzOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVJRID0gKGFSUSArIGdEW2FCXSkgJiA0MDk1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFSUSA9PT0gaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVNBKCJIYXNoIEVycm9yOiAiICsgYVJRICsgIiAiICsgaiArICIgIiArIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUzgoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTAgPSBiRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwWSA9IGFELmRhdGEgPSBuZXcgYTNUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5tYXBUeXBlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5tYXBQcm9jZWR1cmFsSW5kZXggPSBpMC5vaSg4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLm1hcFJlYWxpc3RpY0luZGV4ID0gaTAub2koOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5tYXBTZWVkID0gaTAub2koMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkubWFwTmFtZSA9IGkwLmFTRig1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLm1hcFR5cGUgPT09IDIgJiYgaTAuYVNHKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5wYXNzYWJsZVdhdGVyID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5wYXNzYWJsZU1vdW50YWlucyA9IGkwLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkucGxheWVyQ291bnQgPSBpMC5vaSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5odW1hbkNvdW50ID0gaTAub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuc2VsZWN0ZWRQbGF5ZXIgPSBpMC5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmdhbWVNb2RlID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5wbGF5ZXJNb2RlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5iYXR0bGVSb3lhbGVNb2RlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5udW1iZXJUZWFtcyA9IGkwLm9pKDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuaXNab21iaWVNb2RlID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5pc0NvbnRlc3QgPSBpMC5vaSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmlzUmVwbGF5ID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5lbG8gPSBpMC5hU0goMiwgMTQsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuY29sb3JzVHlwZSA9IGkwLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuY29sb3JzUGVyc29uYWxpemVkID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5jb2xvcnNEYXRhID0gaTAuYVNIKDEwLCAxOCwgNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLnNlbGVjdGFibGVDb2xvciA9IGkwLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkudGVhbVBsYXllckNvdW50ID0gaTAuYVNIKDQsIDEwLCA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLm5ldXRyYWxCb3RzID0gaTAub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5ib3REaWZmaWN1bHR5VHlwZSA9IGkwLm9pKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuYm90RGlmZmljdWx0eVZhbHVlID0gaTAub2koNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5ib3REaWZmaWN1bHR5VGVhbSA9IGkwLmFTSCg0LCA0LCA5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmJvdERpZmZpY3VsdHlEYXRhID0gaTAuYVNIKDEwLCA0LCA1MTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuc3Bhd25pbmdUeXBlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5zcGF3bmluZ1NlZWQgPSBpMC5vaSgxNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5zcGF3bmluZ0RhdGEgPSBpMC5hU0goMTEsIDEyLCAxMDI0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLnNlbGVjdGFibGVTcGF3biA9IGkwLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkucGxheWVyTmFtZXNUeXBlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5wbGF5ZXJOYW1lc0RhdGEgPSBpMC5hU0koMTAsIDUsIDUxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5zZWxlY3RhYmxlTmFtZSA9IGkwLm9pKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuYUluY29tZVR5cGUgPSBpMC5vaSgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmFJbmNvbWVWYWx1ZSA9IGkwLm9pKDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuYUluY29tZURhdGEgPSBpMC5hU0goMTAsIDgsIDUxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS50SW5jb21lVHlwZSA9IGkwLm9pKDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkudEluY29tZVZhbHVlID0gaTAub2koOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS50SW5jb21lRGF0YSA9IGkwLmFTSCgxMCwgOCwgNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmlJbmNvbWVUeXBlID0gaTAub2koMik7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5pSW5jb21lVmFsdWUgPSBpMC5vaSg4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLmlJbmNvbWVEYXRhID0gaTAuYVNIKDEwLCA4LCA1MTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcFkuc1Jlc291cmNlc1R5cGUgPSBpMC5vaSgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLnNSZXNvdXJjZXNWYWx1ZSA9IGkwLm9pKDExKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBZLnNSZXNvdXJjZXNEYXRhID0gaTAuYVNIKDEwLCAxMSwgNTEyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUzkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTAgPSBiRzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2TiA9IGkwLm9pKDUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTSiA9IGkwLm9pKDMwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU0sgPSBpMC5vaSgzMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVNKICsgYVNLID4gOCAqIGkwLnNpemUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU0EoIkNvcnJ1cHRlZCBGaWxlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVNMKGFTSik7DQogICAgICAgICAgICAgICAgICAgICAgICBhU00oYVNLLCB2Tik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU0woZWcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU04gPSBuZXcgVWludDhBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVNPID0gbmV3IFVpbnQxNkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU1AgPSBuZXcgVWludDMyQXJyYXkoZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTUSA9IG5ldyBVaW50MzJBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUnogPSBhU047DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUzAgPSBhU087DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUzEgPSBhU1A7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUzIgPSBhU1E7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBiRy5vaSg0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU05bYUJdID0gaWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNPW2FCXSA9IGJHLm9pKDkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU1BbYUJdID0gYkcub2koMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNQW2FCXSA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNRW2FCXSA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTUFthQl0gPSBiRy5vaSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTUVthQl0gPSBiRy5vaSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTUFthQl0gPSBiRy5vaSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTUVthQl0gPSBiRy5vaSgyMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU1BbYUJdID0gYkcub2koMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU1FbYUJdID0gYkcub2koMjIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNQW2FCXSA9IGJHLm9pKDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTUFthQl0gPSBiRy5vaSgxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU1BbYUJdID0gYkcub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gMTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNQW2FCXSA9IGJHLm9pKDIwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNRW2FCXSA9IGJHLm9pKDIyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNNKGVnLCB2Tikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTMyA9IG5ldyBVaW50OEFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUzQgPSBuZXcgQXJyYXkoZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVM0LmZpbGwoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUzMgPSBhUzM7DQogICAgICAgICAgICAgICAgICAgICAgICBiOC5vdy5hUzQgPSBhUzQ7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUzNbYUJdID0gYkcub2koMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVM0W2FCXSA9IGJHLm9pKHZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUncoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueVUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2TiA9IGFTUigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVNTKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhU1Qodk4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVNVKHZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU1YgPSBiRC5lMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5SCA9IGJLLmRtKGFTViAtIDEsIDYpICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiQy5hUXkoNiAqIHlIKSAhPT0gYkQuZy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiRC5nLnB1c2goMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhU1coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLmRYKGJELmcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFEID0gYkUucnkucnooYkUucnkuczAoeUgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJHLnRIKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiRC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHFEOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNTKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBZID0gYUQuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYkQ7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEyLCBsLnJWZXJzaW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZTEgKz0gMTIgKyAzMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMiwgcFkubWFwVHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDgsIHBZLm1hcFByb2NlZHVyYWxJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDgsIHBZLm1hcFJlYWxpc3RpY0luZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMTQsIHBZLm1hcFNlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hU1gocFkubWFwTmFtZSwgNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBwWS5tYXBUeXBlID09PSAyICYmIGkuYVNZKHBZLmNhbnZhcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIHBZLnBhc3NhYmxlV2F0ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5wYXNzYWJsZU1vdW50YWlucyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEwLCBwWS5wbGF5ZXJDb3VudCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEwLCBwWS5odW1hbkNvdW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoOSwgcFkuc2VsZWN0ZWRQbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5nYW1lTW9kZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDIsIHBZLnBsYXllck1vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyLCBwWS5iYXR0bGVSb3lhbGVNb2RlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoNCwgcFkubnVtYmVyVGVhbXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5pc1pvbWJpZU1vZGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5pc0NvbnRlc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5pc1JlcGxheSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmRlKHBZLmVsbywgMiwgMTQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBwWS5jb2xvcnNUeXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMSwgcFkuY29sb3JzUGVyc29uYWxpemVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZGUocFkuY29sb3JzRGF0YSwgMTAsIDE4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMSwgcFkuc2VsZWN0YWJsZUNvbG9yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZGUocFkudGVhbVBsYXllckNvdW50LCA0LCAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIHBZLm5ldXRyYWxCb3RzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMiwgcFkuYm90RGlmZmljdWx0eVR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCg0LCBwWS5ib3REaWZmaWN1bHR5VmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5kZShwWS5ib3REaWZmaWN1bHR5VGVhbSwgNCwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmRlKHBZLmJvdERpZmZpY3VsdHlEYXRhLCAxMCwgNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDIsIHBZLnNwYXduaW5nVHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDE0LCBwWS5zcGF3bmluZ1NlZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5kZShwWS5zcGF3bmluZ0RhdGEsIDExLCAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEsIHBZLnNlbGVjdGFibGVTcGF3bik7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDIsIHBZLnBsYXllck5hbWVzVHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmFTWihwWS5wbGF5ZXJOYW1lc0RhdGEsIDEwLCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMSwgcFkuc2VsZWN0YWJsZU5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyLCBwWS5hSW5jb21lVHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDgsIHBZLmFJbmNvbWVWYWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmRlKHBZLmFJbmNvbWVEYXRhLCAxMCwgOCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDIsIHBZLnRJbmNvbWVUeXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoOCwgcFkudEluY29tZVZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZGUocFkudEluY29tZURhdGEsIDEwLCA4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMiwgcFkuaUluY29tZVR5cGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCg4LCBwWS5pSW5jb21lVmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5kZShwWS5pSW5jb21lRGF0YSwgMTAsIDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyLCBwWS5zUmVzb3VyY2VzVHlwZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDExLCBwWS5zUmVzb3VyY2VzVmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5kZShwWS5zUmVzb3VyY2VzRGF0YSwgMTAsIDExKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU1Qodk4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYkQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJ6ID0gYjgub3cuYVJ6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZOID0gYjgub3cuYVMwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZQID0gYjgub3cuYVMxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZSID0gYjgub3cuYVMyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYVJ6Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoNSwgdk4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgzMCwgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgzMCwgYjgub3cuYVM0Lmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjEgPSBhUnpbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoNCwgZjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoOSwgZk5bYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyMiwgZlBbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYxID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMTAsIGZQW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMTAsIGZSW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEwLCBmUFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDksIGZSW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA9PT0gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEwLCBmUFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDIyLCBmUlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjEgPT09IDQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxMCwgZlBbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgyMiwgZlJbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYxID09PSA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMTAsIGZQW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmMSA9PT0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDEwLCBmUFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjEgPT09IDcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCgxLCBmUFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZjEgPT09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMjAsIGZQW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMjIsIGZSW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFTVSh2Tikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBiRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUzMgPSBiOC5vdy5hUzM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVM0ID0gYjgub3cuYVM0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYVMzLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMSwgYVMzW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hOCh2TiwgYVM0W2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNhKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBiRC5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJRID0gbC5yVmVyc2lvbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMzsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSUSA9IChhUlEgKyBnW2FCXSkgJiA0MDk1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFSUTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU1coKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGJEOw0KICAgICAgICAgICAgICAgICAgICAgICAgaS5lMSA9IDEyICsgMTI7DQogICAgICAgICAgICAgICAgICAgICAgICBpLmE4KDMxLCBpLmcubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZTEgPSAxMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGkuYTgoMTIsIGFTYSgpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU1IoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVM0ID0gYjgub3cuYVM0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYVM0Lmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXgobWF4LCBhUzRbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2VShNYXRoLm1heChtYXgsIDEpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGYxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYnIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFTYiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVNjID0gLTEwMDAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVNkID0gLTE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhU2UgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmkgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmogPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1pbiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWF4ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5waSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGsgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmsgPSAxOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gYVNmKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCkgKyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gYVNmKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpICsgMjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGYxID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZUKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhU2coMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB2VCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGEwViA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXNBIik7DQogICAgICAgICAgICAgICAgICAgICAgICB0byA9IGEwVi5nZXRDb250ZXh0KCIyZCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCsrZjEgPj0gNTApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemUoMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhU2goKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFTaCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhU2QgPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGIDwgYVNkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVNlKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhU2QgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgyMDAwICogYVNlID49IGJlLmVGICsgNCAqIDIwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3IgMzc0OCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGEwLmExLnNldFN0YXRlKDE1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRpID0gZnVuY3Rpb24oaHApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZShocCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExQiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFTYyArIDEwMDAgPiBiZS5lRikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFTYyA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplKDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcmVzaXplKGFTaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZjEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYi5zTigpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFTZyhhU2kpIHx8IGJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnIgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYi5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiVi5hQVAucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVkuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiWC5kWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFaLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFULnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFPLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID49IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVYucmVzaXplKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVUucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVIucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTS5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYkIucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2LnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVEucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZC5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWYucmVzaXplKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYLnJlc2l6ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVMuYTdsKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWEuYUVYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFhLmFFWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNmKGY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZjggJiYgZjggPiAxMjgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihmOCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTI4Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFTaihpLCBqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGkgPSAoaSArIGopIC8gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU2sgPSAoYTAuaWQgIT09IDAgfHwgaSA8IGopID8gNzAwIDogMTIwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU2wgPSBNYXRoLm1pbihhU2sgLyBwaSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmkuZUQuZGF0YVsxXS52YWx1ZSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTbCA9IDIgKiBhU2wgLyAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU2wgPSBNYXRoLm1pbihhU2wgKyAoYmkuZUQuZGF0YVsxXS52YWx1ZSAtIDEpICogKDEgLSBhU2wpIC8gMiwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoLmsgPSAod2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSkgKiBhU2w7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNnKGFTaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMyLCBhN0EsIHMzLCBzazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoLnJkID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHMyID0gYVNmKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhN0EgPSBhU2YoKHdpbmRvdy52aXN1YWxWaWV3cG9ydCAmJiBhMC5pZCAhPT0gMikgPyB3aW5kb3cudmlzdWFsVmlld3BvcnQuaGVpZ2h0IDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhU2ooczIsIGE3QSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVNpICYmICFhU2IpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU2IgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYTBWKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYVNiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVNiID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhMFYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgczMgPSBNYXRoLmZsb29yKDAuNSArIHMyICogaC5rKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNrID0gTWF0aC5mbG9vcigwLjUgKyBhN0EgKiBoLmspOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMzID09PSBoLmkgJiYgc2sgPT09IGguaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGguaSA9IHMzOw0KICAgICAgICAgICAgICAgICAgICAgICAgaC5qID0gc2s7DQogICAgICAgICAgICAgICAgICAgICAgICBoLm1pbiA9IGFBMShzMywgc2spOw0KICAgICAgICAgICAgICAgICAgICAgICAgaC5tYXggPSBhNUUoczMsIHNrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGgucGkgPSBiSy5kbShzMyArIHNrLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGgudGsgPSBzMyAvIHNrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYTBWLndpZHRoID0gczM7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuaGVpZ2h0ID0gc2s7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuc3R5bGUud2lkdGggPSBzMiArICJweCI7DQogICAgICAgICAgICAgICAgICAgICAgICBhMFYuc3R5bGUuaGVpZ2h0ID0gYTdBICsgInB4IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTZCA9IGJlLmVGICsgMTAwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGREKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFSNyA9IG5ldyBhU20oKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56cSA9IG5ldyBhU24oKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNuKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnpyID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGdEOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWwuanc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeXAgPSBhbC5qeDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4VSA9IGFnLnhVOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE2eiA9IHRoaXMuYUZzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0geXBbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuakooZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhVW2dEXSA9IGE2ejsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcDIgPSBhZy5wMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpeSA9IGFnLml5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl6ID0gYWcuaXo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgelkgPSBhZy56WTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gYUQuanY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6WVthQl0gPT09IDAgfHwgaXpbYUJdIDwgMSB8fCAyICogcDJbYUJdID4gMyAqIChpeVthQl0gKyBpelthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhVW2FCXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHpvID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgem8gKz0geFVbYUJdID4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB6bzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oNjU1MzUsIGJlLmpzKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNtKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IDI1NjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKGFTbywgYVNwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IG5ldyBVaW50OEFycmF5KHNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVNxKGcsIGFTbywgYVNwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFTcihnLCBhU28sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVNyKGcsIGFTcCwgNyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhU3MoZyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVFQKGcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNxKGcsIGFTbywgYVNwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBzaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTdCA9IDMgKyAoNCArIGFTbykgJSAzMjc2ODsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhU3UgPSAxMiArIGFTcCAlIDMyNzY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTdiA9IDE3ICsgKChhU28gJiBhU3ApICsgKGFTbyB8IGFTcCkgKyBhU28pICUgMzI3Njg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFTdCA9IDEgKyAoYVN0ICogYVN1KSAlIGFTdjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IGFTdCAlIDI1NjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhU3IoZywgZjgsIGhUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBzaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IChnW2FCXSArICgoZjggPj4gKChhQiArIGhUKSAlIDMwKSkgJiAxKSkgJSAyNTY7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVNzKGcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBzaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IDMwMDAwOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBnW2UxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2UxXSA9IChmOCArIGFCICsgZ1soZTEgKyBhQikgJSBlZ10pICUgMjU2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxID0gKGY4ICsgYUIgKyBlMSArIChmOCAmIGUxKSkgJSBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhUVAoZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gc2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhN0EgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNrID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQiArPSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTdBID0gKCgxICsgYTdBKSAqIChnW2FCXSArIDEpKSAlIDEwNzM3NDE4MjQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2sgPSAoKDEgKyBzaykgKiAoZ1thQiArIDFdICsgMSkpICUgMTA3Mzc0MTgyNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbYTdBLCBza107DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gY2koKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhU3c7DQogICAgICAgICAgICAgICAgICAgIHZhciBhU3g7DQogICAgICAgICAgICAgICAgICAgIHZhciBoODsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFTeTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBlbiwgZXAsIGFSSiwgYVN6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGksIGosIHhELCBoYSwgdmUsIGY4LCBnRCwgZXcsIGV6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFUMCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVN4ID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhU3cgPSBiSy5kbSg2NCArIDMyLCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiUi5lTSA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFSSiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVN6ID0gMTYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhUkogPSAxMjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVN6ID0gMzI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhU3kgPSBTWzddICsgYVJKICsgIiwiICsgYVJKICsgIiwiICsgYVJKICsgIikiOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVN4ID0gbmV3IEFycmF5KDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDM7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU3hbYUJdID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChTWzRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gYUIgJSAyID09PSAwID8gYlIuZXIgOiBhU3c7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IGFCICUgMiA9PT0gMCA/IGFTdyA6IGJSLmVzICsgMiAqIGFTdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU3hbYUJdLndpZHRoID0gaTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhU3hbYUJdLmhlaWdodCA9IGo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQgPSBhU3hbYUJdLmdldENvbnRleHQoIjJkIiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYSA9IHhELmdldEltYWdlRGF0YSgwLCAwLCBpLCBqKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZSA9IGhhLmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCICUgMiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gYVN3IC0gMTsgZXAgPj0gMDsgZXAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZjggPSBhU3ogKyBNYXRoLmZsb29yKChlcCArIDEpICogKGFSSiAtIGFTeikgLyAoYVN3ICsgMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlbiA9IGkgLSAxOyBlbiA+PSAwOyBlbi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSAoKGFCID09PSAwID8gYVN3IC0gZXAgLSAxIDogZXApICogaSArIGVuKSAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0RdID0gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0QgKyAxXSA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2dEICsgMl0gPSBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVtnRCArIDNdID0gMjU1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlbiA9IGFTdyAtIDE7IGVuID49IDA7IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYVN6ICsgTWF0aC5mbG9vcigoZW4gKyAxKSAqIChhUkogLSBhU3opIC8gKGFTdyArIDEpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBqIC0gMSAtIGFTdzsgZXAgPj0gYVN3OyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSAoZXAgKiBpICsgKGFCID09PSAzID8gYVN3IC0gZW4gLSAxIDogZW4pKSAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0RdID0gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0QgKyAxXSA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2dEICsgMl0gPSBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVtnRCArIDNdID0gMjU1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXogPSAxOyBleiA+PSAwOyBlei0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVuID0gYVN3IC0gMTsgZW4gPj0gMDsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBhU3cgLSAxOyBlcCA+PSAwOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV3ID0gKE1hdGgucG93KChlbiAqIGVuICsgZXAgKiBlcCksIDAuNSkgKyAxKSAvIChhU3cgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXcgPSBldyA+IDEgPyAxIDogZXc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4ID0gYVN6ICsgTWF0aC5mbG9vcihldyAqIChhUkogLSBhU3opKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSAoKGV6ID09PSAwID8gYVN3IC0gZXAgLSAxIDogZXAgKyBleiAqIChqIC0gYVN3KSkgKiBpICsgKGFCID09PSAxID8gZW4gOiBhU3cgLSBlbiAtIDEpKSAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2dEXSA9IGY4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVtnRCArIDFdID0gZjg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2dEICsgMl0gPSBmODsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZ0QgKyAzXSA9IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeEQucHV0SW1hZ2VEYXRhKGhhLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFUMShhU3opOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVQwKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaDggPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVN5ID0gU1s3XSArIGJSLnZjWzBdICsgIiwiICsgYlIudmNbMV0gKyAiLCIgKyBiUi52Y1syXSArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiUi5hSjAoYlIuZU0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoOCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUMShhNE8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLmZpbGxTdHlsZSA9IFNbN10gKyBhNE8gKyAiLCIgKyBhNE8gKyAiLCIgKyBhNE8gKyAiKSI7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5maWxsUmVjdCgwLCAwLCBiUi5lciwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiUi52WC5maWxsUmVjdCgwLCBiUi5lcyAtIDEsIGJSLmVyLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLmZpbGxSZWN0KDAsIDAsIDEsIGJSLmVzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJSLnZYLmZpbGxSZWN0KGJSLmVyIC0gMSwgMCwgMSwgYlIuZXMpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMueDcgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleiA9IGg4ID8gMCA6IC1hU3c7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFLYihleiwgZXosIGJSLmVyIC0gMiAqIGV6LCBiUi5lcyAtIDIgKiBleiwgYlouYVQyLCBiWi5hVDMsIGJaLmFUNCwgYlouYVQ1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGFTeTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCAwLCBoLmksIGguaik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaDgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUthKDAsIC1hU3csIGJSLmVyLCBhU3csIGJaLmFUMiwgYlouYVQzLCBiWi5hVDQsIGJaLmFUNSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5kcmF3SW1hZ2UoYVN4WzBdLCBiWi5hVDYsIGJaLmFUNyAtIGFTdyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUthKGJSLmVyLCAtYVN3LCBhU3csIGJSLmVzICsgMiAqIGFTdywgYlouYVQyLCBiWi5hVDMsIGJaLmFUNCwgYlouYVQ1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShhU3hbMV0sIGJaLmFUNiArIGJSLmVyLCBiWi5hVDcgLSBhU3cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLYSgwLCBiUi5lcywgYlIuZXIsIGFTdywgYlouYVQyLCBiWi5hVDMsIGJaLmFUNCwgYlouYVQ1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShhU3hbMl0sIGJaLmFUNiwgYlouYVQ3ICsgYlIuZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFLYSgtYVN3LCAtYVN3LCBhU3csIGJSLmVzICsgMiAqIGFTdywgYlouYVQyLCBiWi5hVDMsIGJaLmFUNCwgYlouYVQ1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShhU3hbM10sIGJaLmFUNiAtIGFTdywgYlouYVQ3IC0gYVN3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQyKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmg5ID0gbmV3IGFUOCgpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFGcSA9IG5ldyBhVDkoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54QSA9IG5ldyBhVEEoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gbmV3IGFUQigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlQID0gbmV3IGFUQygpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0TyA9IG5ldyBhVEQoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVEUgPSBuZXcgYVRGKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuamogPSBuZXcgYVRHKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMua1ggPSBuZXcgYVRIKCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVRJID0gbmV3IGFUSigpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnhBLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVAuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTRPLmRYKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUSS5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVEkudG4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueEEudG4oKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFURygpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5kYXRhLnBhc3NhYmxlV2F0ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuZ01bcGxheWVyXS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0ueS5vdSA9PT0gYk0ueS5rOSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdCA9IGJNLnkub3RbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdCA+PSBNYXRoLm1heCgzICogYW4ucGVyZm9ybWFuY2Uua3gsIGFFLms5W2FFLmhLW3BsYXllcl1dKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvdCA9PT0gYk0ueS5wNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEucDAocGxheWVyLCBhRS5rN1thRS5oS1twbGF5ZXJdXSwgMzIsIDApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbi5pYy5pcShwbGF5ZXIpICYmICFhbi5pZy5pcShwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhVEsocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhVEwocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUTChwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LmcxLnAzKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICBiTS55LnA5KHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVEsoYTJTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTJUOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUTSA9IChiTi5mSFsxXSArIGJMLmhmW2JOLmZIWzJdIC0gMV0pIDw8IDI7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZVgoYVRNKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYTJUID0gYWMuZVkoYVRNKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMlMgPT09IGEyVCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZVooYTJTLCBhMlQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVQ4KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhBID0gZnVuY3Rpb24ocGxheWVyLCBhVE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuZGF0YS5wYXNzYWJsZVdhdGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTC5pSyhhVE4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJNLnkub3UgPT09IGJNLnkuazkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk0ueS5vdFtwbGF5ZXJdID09PSBiTS55LnA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmdNW3BsYXllcl0ubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiTS5rWC5rWShwbGF5ZXIsIGFUTikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFUTyhhVE4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9FID0gZnVuY3Rpb24ocGxheWVyLCBtOCwgYVROKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJMLmlLKGFUTikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucEEocGxheWVyLCBtOCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJNLmtYLnBCKGFUTikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFUTyhhVE4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBBID0gZnVuY3Rpb24ocGxheWVyLCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBhVFA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0YgPSBwbGF5ZXIgPDwgMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzRyA9IHNGICsgYk0ueS5vdFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUUSA9IGJNLnkuYVRROw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUUiA9IGJNLnkuYVRSOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IHNGOyBhQiA8IHNHOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVRQID0gYVRRW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09IGFUUlthVFBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZIWzNdID0gYVRQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9EID0gZnVuY3Rpb24oZVMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNFAgPSBiTS5hNE8uYTRQOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBBKGFELmVRLCBhNFApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYjcuaDIub0QoYTRQLCBlUyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRSID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gYUQuZVE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBiTS55Lm90W3BsYXllcl07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRRID0gYk0ueS5hVFE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUIgPSBiTS55Lm1COw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNGID0gcGxheWVyIDw8IDM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0cgPSBzRiArIGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUUyA9IDE2ICogNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhTXogPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gc0cgLSAxOyBhQiA+PSBzRjsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFQgPSBhVFFbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldyA9IGJMLmh4KGt5LCBreiwgbUJbYVRUXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV3IDwgYVRTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUUyA9IGV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTXogPSBhVFQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhVFUoYU16LCBreSwga3opKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYk0uYTRPLmE0UCA9IGJNLnkuYVRSW2FNel07DQogICAgICAgICAgICAgICAgICAgICAgICBiay5wOC5hNFIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNFkgPSBmdW5jdGlvbihreSwga3opIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJNLnkub3U7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWcgPCAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1CID0gYk0ueS5tQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFMgPSAxNiAqIDU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU16ID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXcgPSBiTC5oeChreSwga3osIG1CW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV3IDwgYVRTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUUyA9IGV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTXogPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFUVShhTXosIGt5LCBreikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYU16Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tQSA9IGZ1bmN0aW9uKHBsYXllciwgaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJNLnkub3RbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzRiA9IHBsYXllciA8PCAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNHID0gc0YgKyBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFIgPSBiTS55LmFUUjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFEgPSBiTS55LmFUUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gc0Y7IGFCIDwgc0c7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRUID0gYVRRW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVRSW2FUVF0gPT09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhVFQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRm4gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJNLnkub3RbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzRiA9IHBsYXllciA8PCAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNHID0gc0YgKyBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFEgPSBiTS55LmFUUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNVggPSBiTS55LmE1WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoSyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IHNGOyBhQiA8IHNHOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgKz0gYTVYW2FUUVthQl1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhLOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tRyA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYk0ueS5vdFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVnID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJNLnkuYVRRW3BsYXllciA8PCAzXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUVShhQiwga3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUIgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUViA9IGJNLnkubUJbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUVyA9IGJMLmkzKGFUVik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRYID0gYkwuaTYoYVRWKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVFkgPSAxLjI1ICogMTYgKiAoMC45ICsgMC4xICogTWF0aC5sb2cxMChiTS55LmE1WFthQl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFUWSA9IE1hdGgubWF4KGFUWSwgYkwuaUooYjkucGcuc0soMC4wMiwgMS43KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJLLmFLaShiTC5pMihreSksIGJMLmk1KGt6KSwgYVRXLCBhVFgsIGFUWSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVRPKGFUTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUWiA9IDQgKyAwLjAzICogKDEgKyAxLjUgKiBhMC5hMS5yNCgpKSAqIGgucGkgLyBpSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiTC5pNyhhVE4sIGJOLmZIWzFdKSA8IGFUWjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVDkoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUZyID0gZnVuY3Rpb24ocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRRID0gYk0ueS5hVFE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0YgPSBwbGF5ZXIgPDwgMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzRyA9IHNGICsgYk0ueS5vdFtwbGF5ZXJdIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBzRzsgYUIgPj0gc0Y7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUYShhVFFbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVRhID0gZnVuY3Rpb24oYVRiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGJNLnk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRjID0geS5vdSAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRkID0geS5hNVdbYVRiXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVGUgPSB5LmFUZlthVGJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUZyA9IHkubUJbYVRiXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHkub3UgPSBhVGM7DQogICAgICAgICAgICAgICAgICAgICAgICB5LmE1V1thVGJdID0geS5hNVdbYVRjXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHkuYVRoW2FUYl0gPSB5LmFUaFthVGNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgeS5hVGlbYVRiXSA9IHkuYVRpW2FUY107DQogICAgICAgICAgICAgICAgICAgICAgICB5Lm1CW2FUYl0gPSB5Lm1CW2FUY107DQogICAgICAgICAgICAgICAgICAgICAgICB5LmFUalthVGJdID0geS5hVGpbYVRjXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHkuYTVYW2FUYl0gPSB5LmE1WFthVGNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgeS5hVGZbYVRiXSA9IHkuYVRmW2FUY107DQogICAgICAgICAgICAgICAgICAgICAgICB5LmFUUlthVGJdID0geS5hVFJbYVRjXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHkuYVRrW2FUYl0gPSB5LmFUa1thVGNdOw0KICAgICAgICAgICAgICAgICAgICAgICAgeS5hVGxbYVRiXSA9IHkuYVRsW2FUY107DQogICAgICAgICAgICAgICAgICAgICAgICB5LmFUUVt5LmE1V1thVGJdXSA9IGFUYjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFUbShhVGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk0uaVAuaVBbYkwuaU8oeS5tQlthVGJdKV1beS5hVGZbYVRiXV0gPSBhVGI7DQogICAgICAgICAgICAgICAgICAgICAgICBhVG4oYkwuaU8oYVRnKSwgYVRlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUbShhUnEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSBhUnEgPj4gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gYk0ueTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHkub3RbcGxheWVyXSAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRvID0gKHBsYXllciA8PCAzKSArIGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgeS5vdFtwbGF5ZXJdID0gZWc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVRvID09PSBhUnEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB5LmFUUVthUnFdID0geS5hVFFbYVRvXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHkuYTVXW3kuYVRRW2FScV1dID0gYVJxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUbihhQiwgYVRwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUxlID0gYk0uaVAuaVBbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhTGUucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVRwID09PSBhTGUubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYUxlW2FUcF0gPSBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk0ueS5hVGZbZV0gPSBhVHA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVRBKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYVRxOw0KICAgICAgICAgICAgICAgICAgICB2YXIgeGUgPSA4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYVRyID0gbmV3IEFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHEgPSBuZXcgQXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVRyWzBdID0gYVRzKDI1NSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHJbMV0gPSBhVHMoMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVHMoZTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoWCA9IHhlICsgNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMXIgPSBiOS5wZy52VChoWCwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhkID0gYjkucGcuZ2V0Q29udGV4dChhMXIsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhID0gYjkucGcuZ2V0SW1hZ2VEYXRhKGhkLCBoWCwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZlID0gaGEuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFUdCh2ZSwgaFggKyAxLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICsgMiwgZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVR0KHZlLCAyICogaFggKyAxLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIDIgKiBoWCAtIDMsIGUxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFUdCh2ZSwgMiAqIGhYIC0gMiwgZTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVR0KHZlLCAzICogaFggLSAyLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMykgKyAxLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMikgKyAxLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMikgKyAyLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMikgLSAyLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMSkgLSAzLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVHQodmUsIGhYICogKGhYIC0gMSkgLSAyLCBlMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5wdXRJbWFnZURhdGEoaGEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGExcjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVHQodmUsIGVTLCBlMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gNCAqIGVTOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmVbZUtdID0gMjU1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmVbZUsgKyAxXSA9IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VLICsgMl0gPSBlMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VLICsgM10gPSAyNTU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdlQocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTFyID0gYjkucGcudlQoeGUsIHhlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IGI5LnBnLmdldENvbnRleHQoYTFyLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFUdShoZCwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMXI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVR1KGhkLCBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXAsIGkxLCBpNCwgZXcsIGVTLCBhVHYsIGFUdywgYVR4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhYID0geGU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGEgPSBiOS5wZy5nZXRJbWFnZURhdGEoaGQsIGhYLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmUgPSBoYS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gKGhYID4+IDEpIC0gMC41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFTeSA9IGFjLmE2NyhwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUeSA9IGI5LnBwLmExUChhU3ksIDAuNSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LnBwLmExUihhU3ksIGFUeSwgMzAwKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBwLmExVChhU3ksIDEwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gMDsgZXAgPCBoWDsgZXArKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSAwOyBlbiA8IGhYOyBlbisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkxID0gZW4gLSBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaTQgPSBlcCAtIGtkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlUyA9IChlcCAqIGhYICsgZW4pICogNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXcgPSBpMSAqIGkxICsgaTQgKiBpNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVR3ID0gKChoWCAtIDEuNSkgKiAoaFggLSAxLjUpIC8gNCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUeCA9ICgoaFggLSA0LjUpICogKGhYIC0gNC41KSAvIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVHYgPSBldyA8PSBhVHggPyBhVHkgOiBhU3k7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VTXSA9IGFUdlswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZVMgKyAxXSA9IGFUdlsxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZVMgKyAyXSA9IGFUdlsyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZVMgKyAzXSA9IGV3ID4gYVR3ID8gMCA6IDI1NTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5wdXRJbWFnZURhdGEoaGEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgYVR6LCBhS2osIGFLaywgZW4sIGVwLCBwbGF5ZXIsIGZvbnRTaXplLCBhMXIsIGVrLCBoSywgYVUwLCBpMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVTEsIGFVMiwgYVUzLCBhVTQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUIgPSBiTS55Lm1COw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1VyA9IGJNLnkuYTVXOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1WCA9IGJNLnkuYTVYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUbCA9IGJNLnkuYVRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVNSA9IGFUcTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVTYgPSBhRC5lUTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVTcgPSAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJNLnkub3U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVU4ID0gaC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVOSA9IGguajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVUEgPSBiUi5lciA8PCA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVQiA9IHhlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVWID0gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZUsgPSBlViAvIGFVQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQyA9IGlHIC8gZVY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBpSSAvIGVWOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1QID0gKGFVOCArIGlHKSAvIGVWOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1RID0gKGFVOSArIGlJKSAvIGVWOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkxID0gbVAgLSBtQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpNCA9IG1RIC0gbUQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSB0bzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTS5oOS5wQShhRC5lUSwgYk0uYTRPLmE0UCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVTcgPSBiTi5mSFszXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGVWIDwgOTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbihoZCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QmFzZWxpbmUoaGQsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIgPSBhNVdbYUJdID4+IDM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBhNVhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUeiA9IDAuOSArIDAuMSAqIE1hdGgubG9nMTAoaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkwID0gbUJbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFLaiA9IChpMCAlIGFVQSkgLyAxNiAtIGFUejsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhS2sgPSBNYXRoLmZsb29yKGkwIC8gYVVBKSAvIDE2IC0gYVR6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuID0gYVU4ICogKGFLaiAtIG1DKSAvIGkxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gYVU5ICogKGFLayAtIG1EKSAvIGk0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVMyA9ICsocGxheWVyID09PSBhVTYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVMiA9IDEgKyBhVTMgLyA4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVNCA9IGVWICogYVR6Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVMSA9IC0yICogYVU0ICogYVUyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVMiA9IGFVMyAqIGFVNCAvIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuIDwgYVUxIHx8IGVwIDwgYVUxIHx8IGVuID4gYVU4ICsgYVUyIHx8IGVwID4gYVU5ICsgYVUyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlayA9IDIgKiBhVHogKiBlSzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVTAgPSBhVHogKiBlVjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhMXIgPSBhVTVbcGxheWVyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTFyID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVU1W3BsYXllcl0gPSBhMXIgPSB2VChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhVTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuc2V0VHJhbnNmb3JtKGVrLCAwLCAwLCBlaywgZW4gLSBlayAqIDIsIGVwIC0gZWsgKiAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKGFUclsrKGFCID09PSBhVTcpXSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybShlaywgMCwgMCwgZWssIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuZHJhd0ltYWdlKGExciwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemUgPSBNYXRoLmZsb29yKGFVQyhoSykgKiBhVTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb250U2l6ZSA8IDYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5maWxsU3R5bGUgPSBhVGxbYUJdID8gYkEubksgOiBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5mb250ID0gYjkucGcuclYoMSwgZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLmZpbGxUZXh0KGI5LnpkLnlKKGhLKSwgZW4gKyBhVTAsIGVwICsgYVUwICsgMC4xICogZm9udFNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVUMoaEspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoSyA8IDEwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMC40MjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoSyA8IDEwMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDAuMzQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaEsgPCAxMDAwMDAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDAuMjY7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaEsgPCAxMDAwMDAwMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMC4xOTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwLjE1Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFUSigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGExcjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGhYID0gMjA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhMXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhMXIgPSBiTy55LmFVRChoWCwgYmYuYVVFWzddKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtVyA9IGlIOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1XID49IDUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVU4ID0gaC5pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVOSA9IGguajsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQyA9IGlHIC8gbVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBpSSAvIG1XOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1QID0gKGFVOCArIGlHKSAvIG1XOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1RID0gKGFVOSArIGlJKSAvIG1XOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdFID0gLWhYICogbVc7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVGID0gMC41ICogZ0U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVBID0gYlIuZXIgPDwgNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJNLnkub3U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUIgPSBiTS55Lm1COw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVRyA9IGExcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IHRvOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1XID4gMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLmdsb2JhbEFscGhhID0gMC41ICogKDUgLSBtVyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTAgPSBtQlthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVSCA9IChpMCAlIGFVQSkgLyAxNjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVJID0gTWF0aC5mbG9vcihpMCAvIGFVQSkgLyAxNjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBhVTggKiAoYVVIIC0gbUMpIC8gKG1QIC0gbUMpICsgYVVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGFVOSAqIChhVUkgLSBtRCkgLyAobVEgLSBtRCkgKyBhVUY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuID4gYVU4IHx8IGVwID4gYVU5IHx8IGVuIDwgZ0UgfHwgZXAgPCBnRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGQuc2V0VHJhbnNmb3JtKG1XLCAwLCAwLCBtVywgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYVVHLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmdsb2JhbEFscGhhID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnNldFRyYW5zZm9ybShtVywgMCwgMCwgbVcsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVRGKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGFUViwgYVRFOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUayA9IGJNLnkuYVRrOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1CID0gYk0ueS5tQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVGkgPSBiTS55LmFUaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBiTS55Lm91IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUViA9IG1CW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVEUgPSBhVGtbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVEUgPT09IDAgfHwgYVRWICE9PSBhVGlbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVUooYUIsIGJMLmlOKGFUViksIGFURSAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJNLmFGcS5hVGEoYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVVKKGFCLCBhVUssIGhTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgajY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gYk0ueS5hNVdbYUJdID4+IDM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRNID0gKGFVSyArIGJMLmhmW2hTXSkgPDwgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoSyA9IGJNLnkuYTVYW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJjLmFVTChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVYKGFUTSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqNiA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqNiA9IGFjLmVZKGFUTSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGo2ID09PSBwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGY4ID0gYjkuZzEuZzQocGxheWVyLCBoSyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJjLmc1KHBsYXllciwgaEsgLSBmOCwgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZVoocGxheWVyLCBqNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcuankub1MocGxheWVyLCBqNiwgaEspOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhZC5qSChwbGF5ZXIsIGo2KSAmJiAhYWQualoocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJjLmc1KHBsYXllciwgaEssIDEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1twbGF5ZXJdLnB1c2goYVVLIDw8IDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWQuajMocGxheWVyLCBoSywgajYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUYuajQocGxheWVyLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFVTSA9IGZ1bmN0aW9uKHBsYXllciwgZVMsIGhTLCBtOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhTID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVNiA9IGFELmVROw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5ncyhhVTYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlWihwbGF5ZXIsIGFVNikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhVTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcuZ01bYVU2XS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBoUy0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUTSA9IChlUyArIGJMLmhmW2hTXSkgPDwgMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWMuZVgoYVRNKSAmJiAhZVoocGxheWVyLCBhYy5lWShhVE0pKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IDQ7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVE0gPSAoZVMgKyBiTC5oZlthQl0pIDw8IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhYy5lYihhVE0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZVgoYVRNKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVZKGFUTSkgPT09IGFVNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5hNFEoNzE5LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLnhXKDE4MCwgTCg0MzUsIFthZy54WFtwbGF5ZXJdXSksIDcxOSwgcGxheWVyLCBiQS5uSiwgYkEubWosIC0xLCB0cnVlLCB1bmRlZmluZWQsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmMDogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtODogbTgNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVRCKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFVTiA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuazkgPSA1MTI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucDYgPSA4Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLm91ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVU8gPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1VyA9IG5ldyBVaW50MTZBcnJheSh0aGlzLms5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGggPSBuZXcgVWludDMyQXJyYXkodGhpcy5rOSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVRpID0gbmV3IFVpbnQzMkFycmF5KHRoaXMuazkpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1CID0gbmV3IFVpbnQzMkFycmF5KHRoaXMuazkpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFUaiA9IG5ldyBVaW50MTZBcnJheSh0aGlzLms5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNVggPSBuZXcgVWludDMyQXJyYXkodGhpcy5rOSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVRmID0gbmV3IFVpbnQxNkFycmF5KHRoaXMuazkpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFUUiA9IG5ldyBVaW50MTZBcnJheSh0aGlzLms5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGsgPSBuZXcgVWludDhBcnJheSh0aGlzLms5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGwgPSBuZXcgVWludDhBcnJheSh0aGlzLms5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdCA9IG5ldyBVaW50OEFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVFEgPSBuZXcgVWludDE2QXJyYXkodGhpcy5wNiAqIGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVU8gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFVTiA9IG5ldyBVaW50OEFycmF5KGJSLmVyICsgYlIuZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdC5maWxsKDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wOSA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gdGhpcy5vdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVVAgPSBiTC5pTShiTi5mSFswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVRID0gdGhpcy5vdFtwbGF5ZXJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVUiA9IChwbGF5ZXIgPDwgMykgKyBhVVE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE1V1tlZ10gPSBhVVI7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUaFtlZ10gPSBhVVA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1CW2VnXSA9IGFVUDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVRpW2VnXSA9IGJMLmlNKGJOLmZIWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVRqW2VnXSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaEsgPSBiTi5mRFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoSyA8IDYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjkuZzEuZzIocGxheWVyLCA2MCAtIGhLKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE1WFtlZ10gPSA2MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNVhbZWddID0gaEs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUZltlZ10gPSBiTS5pUC5wOShlZywgYkwuaU8oYVVQKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUUltlZ10gPSB0aGlzLmFVTzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVRrW2VnXSA9IGJOLmZIWzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGxbZWddID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVVPID0gKHRoaXMuYVVPICsgMSkgJiAxMDIzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVFFbYVVSXSA9IGVnOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdFtwbGF5ZXJdID0gYVVRICsgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3UrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJNLmFURS5hVU0ocGxheWVyLCBiTi5mSFsxXSwgYk4uZkhbMl0sIHRoaXMuYVRSW2VnXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm9EID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRQID0gYk4uZkhbM107DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUaFthVFBdID0gdGhpcy5tQlthVFBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGlbYVRQXSA9IGJMLmlNKGJOLmZIWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVRqW2FUUF0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVGtbYVRQXSA9IGJOLmZIWzJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYk0uYVRFLmFVTSh0aGlzLmE1V1thVFBdID4+IDMsIGJOLmZIWzFdLCBiTi5mSFsyXSwgdGhpcy5hVFJbYVRQXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiTS5hVEUuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGFELmVROw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gYk0uaDkuYUZuKGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFVUyh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFVVCh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFVVSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFVVih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJjLmc1KGdELCBkbCAtIGJNLmg5LmFGbihnRCksIDE1KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFVVShySSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmpzKCkgJSA1ICE9PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCLCBoSzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNVggPSBySS5hNVg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBySS5vdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaEsgPSBhNVhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE1WFthQl0gPSBNYXRoLm1heChoSyAtIE1hdGgubWF4KDEsIGhLID4+IDcpLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVVYockkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNVggPSBySS5hNVg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRsID0gckkuYVRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gckkub3U7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVRsW2FCXSA9IGFUbFthQl0gPj4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTVYW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTS5hRnEuYVRhKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVVTKHJJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGFVUCwgYVVXLCBhVVgsIGFVWSwgYVVaLCBhVWEsIGFVYiwgYVVjLCBhVWQsIGFVZSwgZWosIGFVZiwgZ0U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRoID0gckkuYVRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUaSA9IHJJLmFUaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQiA9IHJJLm1COw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1WCA9IHJJLmE1WDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVGwgPSBySS5hVGw7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRqID0gckkuYVRqOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUZiA9IHJJLmFUZjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IHJJLm91Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVQSA9IGJSLmVyIDw8IDQ7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVYID0gbUJbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVVyA9IGFUaVthQl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFVWCA9PT0gYVVXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVVAgPSBhVGhbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVWiA9IGFVUCAlIGFVQTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVWEgPSB+figoYVVQICsgMC41KSAvIGFVQSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVViID0gYVVXICUgYVVBOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVYyA9IH5+KChhVVcgKyAwLjUpIC8gYVVBKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVWQgPSBhVWIgLSBhVVo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVlID0gYVVjIC0gYVVhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqID0gfn5NYXRoLnNxcnQoYVVkICogYVVkICsgYVVlICogYVVlICsgMC41KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRSA9IDIwMDAwMCArIE1hdGgubWluKDIwICogYTVYW2FCXSwgNDAwMDAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVRsW2FCXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRSA9IGJLLmRtKGdFLCA1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVmID0gYVRqW2FCXSArIE1hdGgubWF4KH5+KChnRSArIDAuNSkgLyBlaiksIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVWYgPj0gNjU1MzUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbUJbYUJdID0gYVVZID0gYVVXOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUalthQl0gPSBhVWY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1CW2FCXSA9IGFVWSA9IGFVWiArIGJLLmRtKGFVZiAqIGFVZCwgNjU1MzYpICsgYVVBICogKGFVYSArIGJLLmRtKGFVZiAqIGFVZSwgNjU1MzYpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVRmW2FCXSA9IGJNLmlQLmFVZyhhVGZbYUJdLCBhVVgsIGFVWSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVVUKHJJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuanMoKSAlIDIgIT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGhULCBrZCwgZjAsIGYxLCBhVWgsIHh6LCBhVWksIGg1LCB2bSwgaGosIGhrLCBtQywgbUQsIGFVUCwgYVVXLCBhVWo7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXcsIGFVaywgYVVsLCBhVW07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBySS5vdTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQiA9IHJJLm1COw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1VyA9IHJJLmE1VzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNVggPSBySS5hNVg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVRsID0gckkuYVRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlQID0gYk0uaVAuaVA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVuID0gaVAubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVbyA9IGJNLmlQLmFVbzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVUEgPSBiUi5lciA8PCA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVcCA9IGFELmhWOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFSZSA9IGJmLmVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFUUyA9IDEyMCAqIDEyMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRSA9IChlZyAtIDEpICogKGJLLmRtKGJlLmpzKCksIDIpICUgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhUID0gTWF0aC5hYnMoYUIgLSBnRSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVQID0gbUJbaFRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtkID0gYkwuaU8oYVVQKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoNSA9IGE1V1toVF0gPj4gMzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtQyA9IGFVUCAlIGFVQTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtRCA9IH5+KChhVVAgKyAwLjUpIC8gYVVBKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVWwgPSBhNVhbaFRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjAgPSAwOyBmMCA8IDk7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVoID0ga2QgKyBhVW9bZjBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVVoIDwgMCB8fCBhVWggPj0gYVVuKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVWkgPSBpUFthVWhdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4eiA9IGFVaS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSAwOyBmMSA8IHh6OyBmMSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVWogPSBhVWlbZjFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0gPSBhNVdbYVVqXSA+PiAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGg1ID09PSB2bSB8fCAoYVVwICYmIGFSZVtoNV0gPT09IGFSZVt2bV0gJiYgYVJlW2g1XSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVVyA9IG1CW2FVal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaiA9IG1DIC0gKGFVVyAlIGFVQSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoayA9IG1EIC0gfn4oKGFVVyArIDAuNSkgLyBhVUEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXcgPSBoaiAqIGhqICsgaGsgKiBoazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldyA8IGFUUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVbSA9IGE1WFthVWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVW0gPD0gYVVsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVayA9IE1hdGgubWF4KDEsIGJLLmRtKGFVbSArIGJLLmRtKGFVbCAtIGFVbSwgMTApLCAxMCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVayA9IE1hdGgubWF4KDEsIGJLLmRtKGFVbCwgMTApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTVYW2FVal0gPSBNYXRoLm1heChhVW0gLSBhVWssIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFUbFthVWpdID0gNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVEMoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVVxID0gMzI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZW4gPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVwID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pUSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVVyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVXMgPSA0Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlQID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVW8gPSBuZXcgSW50MTZBcnJheSg5KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pUSA9IDEgKyBiSy5kbShiUi5lciAtIDEsIHRoaXMuYVVxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVVyID0gMSArIGJLLmRtKGJSLmVzIC0gMSwgdGhpcy5hVXEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pUCA9IG5ldyBBcnJheSh0aGlzLmlRICogdGhpcy5hVXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucHAuYTFPKHRoaXMuaVApOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVV0KHRoaXMuYVVvLCB0aGlzLmlRKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFVdChhVW8sIGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVuID0gLTE7IGVuIDw9IDE7IGVuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVwID0gLTE7IGVwIDw9IDE7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVVvWzMgKiAoMSArIGVwKSArIDEgKyBlbl0gPSBlcCAqIGkgKyBlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wOSA9IGZ1bmN0aW9uKGFVdSwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaVBbYUJdLnB1c2goYVV1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlQW2FCXS5sZW5ndGggLSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVWcgPSBmdW5jdGlvbihhVXYsIGFVUCwgYVVXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVV3LCBhVXg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc0YgPSBiTC5pTyhhVVApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNHID0gYkwuaU8oYVVXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzRiA9PT0gc0cpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVV2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVV3ID0gdGhpcy5pUFtzRl0ucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pUFtzRl0ubGVuZ3RoID09PSBhVXYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wOShhVXcsIHNHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFVeCA9IHRoaXMuaVBbc0ZdW2FVdl07DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlQW3NGXVthVXZdID0gYVV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgYk0ueS5hVGZbYVV3XSA9IGFVdjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnA5KGFVeCwgc0cpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVRIKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmtZID0gZnVuY3Rpb24ocGxheWVyLCBhVXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoUywgaGk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaDQgPSBiTC5ocShwbGF5ZXIsIGFVeSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaDQgPT09IGFVeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhTID0gYkwuaGgoaDQsIGFVeSk7DQogICAgICAgICAgICAgICAgICAgICAgICBoaSA9IGJMLmlSKGg0LCBoUyk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjLmg4KGhpIDw8IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaFMgPSBiTC5obyhoNCwgYVV5LCBoUyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGkgPSBiTC5pUihoNCwgaFMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWMuaDgoaGkgPDwgMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZIWzBdID0gaGk7DQogICAgICAgICAgICAgICAgICAgICAgICBiTi5mSFsxXSA9IGFVeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZIWzJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoaSA9PT0gYVV5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTBLKGJMLmlNKGhpKSwgYVV5KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiTi5mSFsyXSAhPT0gMCAmJiBiTC5odyhwbGF5ZXIsIChiTi5mSFsxXSArIGJMLmhmW2JOLmZIWzJdIC0gMV0pIDw8IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBCID0gZnVuY3Rpb24oYVV5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVQID0gYk0ueS5tQltiTi5mSFszXV07DQogICAgICAgICAgICAgICAgICAgICAgICBiTi5mSFsxXSA9IGFVeTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZIWzJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMEsoYVVQLCBhVXkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYTBLKGFVVywgYVV5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFVeihhVVcsIGFVeSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYk4uZkFbMF0gPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuaDgoYVV5IDw8IDIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFWMChhVXkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJOLmZIWzJdICYmIGFjLmVsKGJOLmZIWzRdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVYxKGJMLmlOKGFVVykpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVV6KGFVVywgYVROKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGkgPSBiTC5pTihhVVcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWMiA9IE1hdGguYWJzKGJMLmVvKGFUTikgLSBiTC5lbyhoaSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWMyA9IE1hdGguYWJzKGJMLmVxKGFUTikgLSBiTC5lcShoaSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGgubWF4KGFWMiwgYVYzKSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFWNChhVVcsIGJMLmlNKGFUTiksIGFWMiwgYVYzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWNChhVVAsIGFVVywgYVYyLCBhVjMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVjUgPSBiTC5pMyhhVVApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWNiA9IGJMLmk2KGFVUCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVY3ID0gYkwuaTMoYVVXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVjggPSBiTC5pNihhVVcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWOSA9IGFWNyAtIGFWNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVkEgPSBhVjggLSBhVjY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZCID0gTWF0aC5hYnMoYVY5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVkMgPSBNYXRoLmFicyhhVkEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWRCA9IGFWOSA+IDAgPyAxIDogMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVkUgPSBhVkEgPiAwID8gMiA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVZCID4gYVZDKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZGKGFWNSwgYVY2LCBhVjUgKyBhVkIsIGFWNiArIGFWQywgYVZELCBhVkUsIGFWMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWRihhVjYsIGFWNSwgYVY2ICsgYVZDLCBhVjUgKyBhVkIsIGFWRSwgYVZELCBhVjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWRihhVjUsIGFWNiwgYVY3LCBhVjgsIGFWRCwgYVZFLCBhVjIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZXA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVOID0gYk0ueS5hVU47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ0UgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWRyA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaiA9IGFWOCAtIGFWNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gYVY3IC0gYVY1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWSCA9IGFWNSAlIDE2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDE7IGFCIDw9IGFWMjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVTltnRSsrXSA9IGFWRDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVU5bZ0VdID0gYVZFOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gKChqICogKGFWSCArIChhQiA8PCA0KSkgKyAwLjUpIC8gaSkgPj4gNDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRSArPSBlcCAtIGFWRzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVkcgPSBlcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZNKGJOLmZBLCBnRSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVYwKGFUTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmg4KGFUTiA8PCAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFWSShhVE4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWSShhVE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgaFM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVOID0gYk0ueS5hVU47DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZKID0gYkw7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBiTi5mQVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVksgPSA0ICogYVROOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGVnIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhTID0gYVVOW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZMID0gYVZLOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWSyA9IGFWSi5pUyhhVkssIChoUyArIDIpICYgMyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmg4KGFWSykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkFbMF0gPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkhbMV0gPSBhVksgPj4gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYk4uZkhbMl0gPSAxICsgaFM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJOLmZIWzRdID0gYVZMOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVYxKGFWTSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZlID0gYUFYOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFVTiA9IGJNLnkuYVVOOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYk4uZkFbMF0gLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFWSyA9IDQgKiBhVk07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGcgPSBiTC5oZzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZLICs9IGhnW2FVTlthQl1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHZlW2FWSyArIDNdID09PSAwICYmIHZlW2FWSyArIDJdID09PSAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVREKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgeGUgPSAzMjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHhkID0gbmV3IEFycmF5KDIpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE0UCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE0UCA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhkWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgeGRbMF0gPSB2VCgyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgeGRbMV0gPSB2VCgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHZUKGYxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwLCBlUywgaTEsIGk0LCBldzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoWCA9IHhlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExciA9IGI5LnBnLnZUKGhYLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGQgPSBiOS5wZy5nZXRDb250ZXh0KGExciwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGEgPSBiOS5wZy5nZXRJbWFnZURhdGEoaGQsIGhYLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmUgPSBoYS5kYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gKGhYID4+IDEpIC0gMC41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtlID0gTWF0aC5zcXJ0KGtkICoga2QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmUuZmlsbCgyNTUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlcCA9IDA7IGVwIDwgaFg7IGVwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVuID0gMDsgZW4gPCBoWDsgZW4rKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMSA9IGVuIC0ga2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGk0ID0gZXAgLSBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVMgPSAoZXAgKiBoWCArIGVuKSAqIDQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV3ID0gMjU1ICogMi44ICogKGtlIC0gTWF0aC5zcXJ0KGkxICogaTEgKyBpNCAqIGk0KSkgLyBrZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVbZVMgKyAyXSA9IGYxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVtlUyArIDNdID0gZXcgPiAyNTUgPyAwIDogZXc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaGQucHV0SW1hZ2VEYXRhKGhhLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMXI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVk4gPSBmdW5jdGlvbihoZCwgZUssIGVuLCBlcCwgZTAsIGFCKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmdzKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVLICo9ICg0IC8gMykgKiAoMjAgLyAzMik7DQogICAgICAgICAgICAgICAgICAgICAgICBlMCAqPSAoNCAvIDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuc2V0VHJhbnNmb3JtKGVLLCAwLCAwLCBlSywgZW4gLSBlMCwgZXAgLSBlMCk7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoeGRbKyhiTS55LmFUUlthQl0gPT09IHRoaXMuYTRQKV0sIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZGEoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVBNID0gW0woNDM2KSwgTCg0MzcpLCBMKDQzOCksIEwoNDM5KSwgTCg0NDApLCBMKDQ0MSksIEwoNDQyKSwgTCg0NDMpLCBMKDQ0NCksIEwoNDQ1KSwgTCg0NDYpLCBMKDQ0NyksIEwoNDQ4KSwgTCg0NDkpLCBMKDQ1MCldOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVZPID0gW1NbNTJdLCAiIiwgIktleUIiLCAiIiwgIktleVciLCAiIiwgIktleVMiLCAiIiwgIktleUQiLCAiIiwgIktleUEiLCAiIiwgIktleUgiLCAiIiwgIk51bXBhZEFkZCIsICIiLCAiTnVtcGFkU3VidHJhY3QiLCAiIiwgIkFycm93TGVmdCIsICIiLCAiQXJyb3dSaWdodCIsICIiLCAiQXJyb3dVcCIsICIiLCAiQXJyb3dEb3duIiwgIiIsICJLZXlNIiwgIiIsICJLZXlQIiwgIiJdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFBRCA9IG5ldyBBcnJheShhVk8ubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYmkuZUQuZGF0YVsxNTVdLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSB2YWx1ZS5zcGxpdCgiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gZy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlAoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZCA+IGFWTy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwga2Q7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1thQl0ubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFEW2FCXSA9IGdbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWUCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFWTy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiVy5hQURbYUJdID0gYVZPW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQTyA9IGZ1bmN0aW9uKGUxLCBjb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUFEID0gdGhpcy5hQUQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZRID0gYVZPOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUFEW2UxXSA9IGNvZGU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcE4gPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFBRC5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZSID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVlIucHVzaChhQURbYUJdID09PSBhVlFbYUJdID8gIiIgOiBhQURbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVnLS07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwTiArPSBhVlJbYUJdICsgIjsiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gKz0gYVZSW2VnXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE1NSwgcE4pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUEwgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpLnI4LnI5KDE1NSwgIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mMSA9IGZ1bmN0aW9uKGNvZGUsIGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29kZSA9PT0gdGhpcy5hQURbZTFdIHx8IGNvZGUgPT09IHRoaXMuYUFEW2UxICsgMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkVSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFWUyA9IDE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhVlQgPSBuZXcgQXJyYXkoYVZTKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFWVSA9IG5ldyBBcnJheShhVlMpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVZWID0gMjA7DQogICAgICAgICAgICAgICAgICAgIHZhciBlRSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHZhciBhVlcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudE1vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3JjID0gImRhdGE6YXVkaW8vbXBlZztiYXNlNjQsU1VRekJBQUFBQUFBSTFSVFUwVUFBQUFQQUFBRFRHRjJaalU0TGpjMkxqRXdNQUFBQUFBQUFBQUFBQUFBLy90VUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBU1c1bWJ3QUFBQThBQUFBRkFBQUNvQUJ0YlcxdGJXMXRiVzF0YlcxdGJXMXRiVzF0a3BLU2twS1NrcEtTa3BLU2twS1NrcEtTa3BLMnRyYTJ0cmEydHJhMnRyYTJ0cmEydHJhMnR0dmIyOXZiMjl2YjI5dmIyOXZiMjl2YjI5dmIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLzhBQUFBQVRHRjJZelU0TGpFekFBQUFBQUFBQUFBQUFBQUFKQWFSQUFBQUFBQUFBcURHSjd4eC8vc1VaQUFBQUdvV1RBVUFRQUlMUW9qd29CUUFRZmgxWUJnV2dBQTZpcVdEQU5BQS9xY2hDRUlSdWdRQUFBQVFSWC8vemg4QUFJS1E4UERBRHpILzRGNFNBcy85OWVyLy9sRDlacit0SDZCUEN2UlBEQ09zaEdsZk10di9DNFJoLy9zVVpBS0FBSXNkWElZVlFBQU5ncmtnd0JRQUFjd0JoVHdCZ0RBMkNtT0RnUUFCQVI0YlJwLy8vOWZGL2k5dEg1cStjNVFGQXZjUGdjdnBCQklBSE4rQUFINXMySFhKcE5ReGgvK3RmM3VrV2dRSXlSZU5vUTFTLy81QUJnS1kvL3NVWkFNQUFKZ2Myb1VKUUFJTHdwa1FvQlFBUWdRdmJoZ1NnQUE4Q3VhWEFGQUFFQklTR0daaDcvLy8vM2NTbFA5T3JTam1CZzBURVNtNlg4QVBqaXhzcGNEaGZUMmNLK3NSZkQ0QUVrQUFIK2I4WUFCb3NPcUZtOUZ2L3dydy8vc1VaQUlBQUhBTVhZWVV3QUFObzJqd3dCd0FBbkFCYVp3QmdBQXlpbU9EZ0NBQkF3RUdXRy8rMzFjbG1QMG0rMDA1ZlViZ3RRNDc4bUpBQUFyZ0FBTUFQZzBEUU5EaEtDdi8vOFJCeDMvL21NRkFRRUJFaW9RS0NpbE1RVTFGLy9zVVpBSVA4QUFBYVFBQUFBZ0FBQTBnQUFBQkFBQUJwQUFBQUNBQUFEU0FBQUFFTXk0eE1EQlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlZWVlYiOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhVlMgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZYKGFCLCBzcmMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVZXID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVZXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVZXID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFWUyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdLm9ucGF1c2UgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWVFthQl0ub25jYW5wbGF5dGhyb3VnaCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhVlRbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWWChhQiwgc3JjKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlVbYUJdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFWVFthQl0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhdWRpbyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZUW2FCXS5zcmMgPSBzcmM7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdLnNldEF0dHJpYnV0ZSgicHJlbG9hZCIsIFNbOV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZUW2FCXS5zZXRBdHRyaWJ1dGUoImNvbnRyb2xzIiwgU1s1XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdLnN0eWxlLmRpc3BsYXkgPSBTWzVdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZUW2FCXS5vbnBhdXNlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZVW2FCXSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdLm9uY2FucGxheXRocm91Z2ggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVlVbYUJdID0gYVZVW2FCXSA9PT0gMCA/IDEgOiBhVlVbYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhVlRbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVlkoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhVlYrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJvLnBsYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVZXKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGwgPiBlRSArIDY2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBhVlMgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVlVbYUJdID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRSA9IGRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZVW2FCXSA9IDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVlRbYUJdLnBsYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhVlYgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZWLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChhVlksIDY2KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNXKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE2eCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFsLmp3IDwgMykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZy5nVFtsQVswXV0gPj0gKGFELmpmID4+IDEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFWWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVZhKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVmEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZiID0gYWUuYUd0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoMiAqIGFnLmdoW2xBWzBdXSA+PSBhVmIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVlooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZiID0gYWUuYUd0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVZjID0gYWUuYUd1KGJnLmw3KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDIgKiBhVmMgPj0gYVZiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYzcoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5kYXRhLnNSZXNvdXJjZXNUeXBlID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZkKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFELmRhdGEuc1Jlc291cmNlc1R5cGUgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZmKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBiYy5saFs4XSA9IGFnLmdoW2FELmVRXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWZCgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVVEgPSBhRC5qdjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnaCA9IGFnLmdoOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFVUTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdoW2FCXSA9IDUxMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVVIgPSBhRC53QTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrOCA9IGFFLms4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhLID0gYUUuaEs7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYVVROyBhQiA8IGFVUjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdoW2FCXSA9IGs4W2hLW2FCXV07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVZlKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQud0E7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2ggPSBhZy5naDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzUmVzb3VyY2VzVmFsdWUgPSBhRC5kYXRhLnNSZXNvdXJjZXNWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdoW2FCXSA9IHNSZXNvdXJjZXNWYWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVmYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhRC53QTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnaCA9IGFnLmdoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNSZXNvdXJjZXNEYXRhID0gYUQuZGF0YS5zUmVzb3VyY2VzRGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdoW2FCXSA9IHNSZXNvdXJjZXNEYXRhW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkTCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFWZyA9IDUwMTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVmggPSBuZXcgVWludDMyQXJyYXkoYVZnKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMlcgPSBuZXcgVWludDMyQXJyYXkoYVZnKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOXMgPSBuZXcgVWludDE2QXJyYXkoYVZnKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUFUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVZpID0gMTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFWaiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWF4ID0gWzAsIDAsIDBdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFWayA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubGggPSBuZXcgQXJyYXkoMjEpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFWbCA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZsID0gW0woNDUxKSwgTCg0NTIpLCBMKDQ1MyksIEwoNDU0KSwgTCg0NTUpLCBMKDQ1NiksIEwoNDU3KSwgTCg0NTgpLCBMKDI4OSksIEwoMjkwKSwgTCg0NTkpLCBMKDQ2MCksIEwoNDYxKSwgTCg0NjIpLCAiIiwgTCg0NjMpLCBMKDQ2NCksIEwoNDY1KSwgTCgyNDkpLCBMKDQ2NiksIEwoNDY3KV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFQVSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhVmkgPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVmsgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZqID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFWbSh0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGguZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucDQgPSBmdW5jdGlvbihwbGF5ZXIsIGlGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmEyUihwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saFswXSArPSBpRiArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzFdKys7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzEyXSArPSBiTi5mRFsxXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub1UgPSBmdW5jdGlvbihwbGF5ZXIsIG85KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLm9VKGJOLmZEWzBdLCBiTi5mRFsxXSwgbzkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGhbMTJdICs9IGJOLmZEWzFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGhbMTZdICs9IGJOLmZEWzBdOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG85ID09PSBhRC5lUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmE1ayhiTi5mRFswXSwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzEwXSArPSBiTi5mRFswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucDcgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuYTJSKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzJdKys7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzEyXSArPSBiTi5mRFsxXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucEkgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuYTJSKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxoWzE5XSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saFsxMl0gKz0gYk4uZkRbMV07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFVTCA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiOS5nMS5hMlIocGxheWVyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGhbMjBdKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmc1ID0gZnVuY3Rpb24ocGxheWVyLCBhM0IsIGUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWI5LmcxLmEyUihwbGF5ZXIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saFtlMV0gKz0gYTNCOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pcSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYVZrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFWai0tID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFWbih0aGlzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFWbihzZWxmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFWaFtzZWxmLmFQVV0gPSBhZy5nVFthRC5lUV07DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmEyV1tzZWxmLmFQVV0gPSBhZy5naFthRC5lUV07DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmE5c1tzZWxmLmFQVV0gPSBhZS5hOXQoYUQuZVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZvKHNlbGYsIHNlbGYuYVBVKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYVBVKys7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5hUFUgPT09IGFWZykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWcChzZWxmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFWaiA9IGFWaSAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICBiZC5sWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2FELmVRXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYVZrID0gYmUuanMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVnAoc2VsZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgYVZtKHNlbGYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVZvKHNlbGYsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hUFUgPSAxICsgYksuZG0oYVZnLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMTsgYUIgPCBzZWxmLmFQVTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYVZoW2FCXSA9IHNlbGYuYVZoW2FCICogMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hMldbYUJdID0gc2VsZi5hMldbYUIgKiAyXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmE5c1thQl0gPSBzZWxmLmE5c1thQiAqIDJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWbyhzZWxmLCBhQik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhVmkgKj0gMjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVm0oc2VsZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXguZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVm8oc2VsZiwgYUIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWF4WzBdID0gTWF0aC5tYXgoc2VsZi5hVmhbYUJdLCBzZWxmLm1heFswXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1heFsxXSA9IE1hdGgubWF4KHNlbGYuYTJXW2FCXSwgc2VsZi5tYXhbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXhbMl0gPSBNYXRoLm1heChzZWxmLmE5c1thQl0sIHNlbGYubWF4WzJdKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkTSgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zMiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuczMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFWcSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVZyID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hN0EgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnMgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVZ0ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFWdiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ3ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNlcgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOVYgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhOID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ4ID0gLTE7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ5ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ6ID0gWzAsIDBdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRZID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE5ViA9IFtMKDQ2OCksIEwoMTIxLCAwLCAiQmFsYW5jZSIpLCBMKDEyMCwgMCwgU1sxMDFdKSwgTCg0NjkpXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ4ID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFWeSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemUoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGMgPSAxLjM2OTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSA9IGguaSA8IGhjICogaC5qID8gaC5pIDogKGguaiAqIGhjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IGEwLmExLnI0KCkgJiYgaC5pIDwgaC5qID8gMSA6IGEwLmExLnI0KCkgPyAwLjggOiBoLmkgPCBoLmogPyAwLjY1IDogMC41OTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSA9IE1hdGguZmxvb3IoZWogKiB0aGlzLmkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pIC09IGEwLmExLnI0KCkgJiYgaC5pIDwgaC5qID8gKDIgKiBiYi5nYXAgKyAyKSA6IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmogPSBNYXRoLmZsb29yKHRoaXMuaSAvIGhjKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTZXID0gTWF0aC5mbG9vcih0aGlzLmogLyAxNTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNlcgPSBNYXRoLm1heCh0aGlzLmE2VywgMS41KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuczIgPSBNYXRoLmZsb29yKDEgKyB0aGlzLmkgKiAwLjAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuczMgPSBNYXRoLmZsb29yKDEgKyB0aGlzLmkgKiAwLjA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTdBID0gdGhpcy5zMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFWdCA9IE1hdGguZmxvb3IoMC43NSAqIHRoaXMuYTdBKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2sgPSBNYXRoLmZsb29yKDEgKyB0aGlzLmkgKiAwLjA3NSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFWdSA9IE1hdGguZmxvb3IoMSArIHRoaXMuaSAqIDAuMTEyNSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFWdiA9IE1hdGguZmxvb3IodGhpcy5pICogKGEwLmExLnI0KCkgPyAwLjAzIDogMC4wMjkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ2ID0gTWF0aC5tYXgodGhpcy5hVnYsIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVncgPSBNYXRoLmZsb29yKHRoaXMuaSAqIDAuMDM1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ3ID0gTWF0aC5tYXgodGhpcy5hVncsIDQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnMgPSB0aGlzLmogLSAyICogdGhpcy5hN0EgLSB0aGlzLnNrIC0gdGhpcy5hVnU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVcwKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmd0ID0gZnVuY3Rpb24oa3ksIGt6KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd0MgPSBreTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3RCA9IGt6Ow0KICAgICAgICAgICAgICAgICAgICAgICAga3kgLT0gYksuZG0oaC5pIC0gdGhpcy5pLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGt6IC09IGJLLmRtKGguaiAtIHRoaXMuaiwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa3kgPCAwIHx8IGt6IDwgMCB8fCBreSA+PSB0aGlzLmkgfHwga3ogPj0gdGhpcy5qIHx8IChreSA+PSB0aGlzLmkgLSB0aGlzLmFWdSAmJiBreiA8IHRoaXMuYVZ1KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhTS5ndCh3Qywgd0QpID09PSAtMSAmJiAhYkIuZ3Qod0MsIHdEKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGt6IDwgdGhpcy5hVnUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChreiA8IHRoaXMuaiAtIHRoaXMuc2spIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFWeSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnggPSAoa3kgLSAyICogdGhpcy5zMiAtIHRoaXMuYVZxKSAvIHRoaXMuYVZyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmUxICE9PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIgPSBNYXRoLmZsb29yKGt5IC8gKHRoaXMuaSAvIHRoaXMuYTlWLmxlbmd0aCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUIgPSBhQiA8IDAgPyAwIDogYUIgPj0gdGhpcy5hOVYubGVuZ3RoID8gdGhpcy5hOVYubGVuZ3RoIC0gMSA6IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFCICE9PSB0aGlzLmUxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVcwKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEwVyA9IGZ1bmN0aW9uKGt5LCBreikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnpbMF0gPSBreTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ6WzFdID0ga3o7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oTiAmJiB0aGlzLmFWeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGt5IC09IGJLLmRtKGguaSAtIHRoaXMuaSwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRsID0gdGhpcy5hVng7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnggPSAoa3kgLSAyICogdGhpcy5zMiAtIHRoaXMuYVZxKSAvIHRoaXMuYVZyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5hVnggPj0gMCAmJiB0aGlzLmFWeCA8PSAxKSB8fCAoZGwgPj0gMCAmJiBkbCA8PSAxKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMHYgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFWeSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ5ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmExNyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaE4pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmMuYVBVIDwgMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzAoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucXggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaE4gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVZ4ID0gLTE7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFXMCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZTEgPCAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnEgPSBhUS5tZWFzdXJlVGV4dChiOS56ZC55SihiYy5tYXhbdGhpcy5lMV0pLCBiOS5wZy5yVigwLCB0aGlzLmFWdikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmUxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVnEgPSBhUS5tZWFzdXJlVGV4dChiOS56ZC5hMzQoNiwgMiksIGI5LnBnLnJWKDAsIHRoaXMuYVZ2KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFWciA9IHRoaXMuaSAtIDIgKiB0aGlzLnMyIC0gdGhpcy5hVnEgLSB0aGlzLnMzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhOKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzAoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oTikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTdSKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE3UiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gYksuZG0oaC5pIC0gdGhpcy5pLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcCA9IGJLLmRtKGguaiAtIHRoaXMuaiwgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1qOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QoMCwgdGhpcy5hVnUsIHRoaXMuaSwgdGhpcy5qIC0gdGhpcy5hVnUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYU9KKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2VSZWN0KDAsIDAsIHRoaXMuaSwgdGhpcy5qKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMik7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5mb250ID0gYjkucGcuclYoMCwgdGhpcy5hVnYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXMihiYy5hVmgsIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZTEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXMihiYy5hMlcsIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZTEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXMyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmUxID09PSAzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzQoZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXNShlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYU0uYTRwKE1hdGguZmxvb3IoZW4gKyB0aGlzLmkgLSAwLjcyNSAqIHRoaXMuYVZ1KSwgTWF0aC5mbG9vcihlcCArIDAuMjc1ICogdGhpcy5hVnUpLCBNYXRoLmZsb29yKDAuNDUgKiB0aGlzLmFWdSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZGw7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lV2lkdGggPSB0aGlzLmE2VzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRCYXNlbGluZSh0bywgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigxLCB0aGlzLmFWdyk7DQogICAgICAgICAgICAgICAgICAgICAgICBkbCA9IHRoaXMuaSAvIHRoaXMuYTlWLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm44Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFJlY3QodGhpcy5lMSAqIGRsLCB0aGlzLmogLSB0aGlzLnNrLCBkbCwgdGhpcy5zayk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5tbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIHRoaXMuaiAtIHRoaXMuc2sgLSAwLjUgKiB0aGlzLmE2VywgdGhpcy5pLCB0aGlzLmE2Vyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPD0gMzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KGFCICogZGwsIHRoaXMuaiAtIHRoaXMuc2ssIHRoaXMuYTZXLCB0aGlzLnNrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB0aGlzLmE5Vi5sZW5ndGggLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkueEQuYTIzKHRoaXMuYTlWW2FCXSwgMCwgMC45ICogZGwpLCAoYUIgKyAwLjUpICogZGwsIHRoaXMuaiAtIDAuNDYgKiB0aGlzLnNrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU9KID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5uWTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIHRoaXMuaSwgdGhpcy5hVnUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsUmVjdCgwLCB0aGlzLmFWdSAtIDAuNSAqIHRoaXMuYTZXLCB0aGlzLmksIHRoaXMuYTZXKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZvbnQgPSBiOS5wZy5yVigxLCAwLjM5ICogdGhpcy5hVnUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkueEQuYTIzKEwoNDcwKSwgMCwgMC44ICogdGhpcy5pKSwgTWF0aC5mbG9vcih0aGlzLmkgLyAyKSwgTWF0aC5mbG9vcigwLjU1ICogdGhpcy5hVnUpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVcyID0gZnVuY3Rpb24oZywgZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga2QgPSBiYy5tYXhbdGhpcy5lMV07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgZW4gKyAyICogdGhpcy5zMiArIHRoaXMuYVZxLCBlcCArIHRoaXMuYTdBICsgdGhpcy5hVnUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVdpZHRoID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMVEgPSB0aGlzLmFWcyAvIE1hdGguc3FydChrZCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLm1vdmVUbyh0aGlzLmFWciwgdGhpcy5hVnMgLSBhMVEgKiBNYXRoLnNxcnQoZ1tiYy5hUFUgLSAxXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBiYy5hUFUgLSAyOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8ubGluZVRvKGFCICogdGhpcy5hVnIgLyAoYmMuYVBVIC0gMSksIHRoaXMuYVZzIC0gYTFRICogTWF0aC5zcXJ0KGdbYUJdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zdHJva2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlSyA9IHRoaXMuYTRwKGcsIGExUSwgMC41KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlSyA8IDAuOTUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC55SihrZCksIC10aGlzLnMyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhlSyAtIDAuNSkgPiAwLjA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQueUooTWF0aC5mbG9vcihrZCAvIDQpKSwgLXRoaXMuczIsIE1hdGguZmxvb3IodGhpcy5hVnMgLyAyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZUsgPiAwLjA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoIjAiLCAtdGhpcy5zMiwgdGhpcy5hVnMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzMgPSBmdW5jdGlvbihlbiwgZXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCBlbiArIDIgKiB0aGlzLnMyICsgdGhpcy5hVnEsIGVwICsgdGhpcy5hN0EgKyB0aGlzLmFWdSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lV2lkdGggPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGExUSA9IHRoaXMuYVZzIC8gTWF0aC5tYXgoYmMubWF4W3RoaXMuZTFdLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmJlZ2luUGF0aCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8ubW92ZVRvKHRoaXMuYVZyLCB0aGlzLmFWcyAtIGExUSAqIGJjLmE5c1tiYy5hUFUgLSAxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGJjLmFQVSAtIDI7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0by5saW5lVG8oYUIgKiB0aGlzLmFWciAvIChiYy5hUFUgLSAxKSwgdGhpcy5hVnMgLSBhMVEgKiBiYy5hOXNbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVLID0gdGhpcy5hNHAoYmMuYTlzLCBhMVEsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gYmMubWF4W3RoaXMuZTFdIC8gMTAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVLIDwgMC45NSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnpkLmEzNChrZCwgMiksIC10aGlzLnMyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhlSyAtIDAuNSkgPiAwLjA1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQuYTM0KGtkIC8gMiwgMiksIC10aGlzLnMyLCBNYXRoLmZsb29yKHRoaXMuYVZzIC8gMikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVLID4gMC4wNSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnpkLmEzNCgwLCAyKSwgLXRoaXMuczIsIHRoaXMuYVZzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVc0ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgZW4gKyAwLjM0ICogdGhpcy5pLCBlcCArIDIgKiBhVnQgKyB0aGlzLmFWdSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5RyA9IHRoaXMuaiAtIDQgKiBhVnQgLSB0aGlzLnNrIC0gdGhpcy5hVnU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSAxMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gWzAsIDEsIDE5LCAyLCAyMCwgMywgNCwgNSwgNiwgN107DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gOTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbZ1thQl1dLCAwLCAwLjMxICogdGhpcy5pKSwgMCwgYUIgKiBhOUcgLyAoZWcgLSAxKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBiYy5saDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCBlbiArIDAuMzkgKiB0aGlzLmksIGVwICsgMiAqIGFWdCArIHRoaXMuYVZ1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI5LnBnLnRleHRBbGlnbih0bywgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC5hMzQoMTAwICogZjhbMF0gLyAoMTAyNCAqIE1hdGgubWF4KGY4WzFdLCAxKSksIDEpLCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSA4OyBhQiA+PSAxOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoZjhbZ1thQl1dLnRvU3RyaW5nKCksIDAsIGFCICogYTlHIC8gKGVnIC0gMSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQuYTM0KDEwMCAqICgxIC0gYWcuZ1RbYUQuZVFdIC8gZjhbN10pLCAwKSwgMCwgYTlHKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVc1ID0gZnVuY3Rpb24oZW4sIGVwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgZW4gKyAwLjc5ICogdGhpcy5pLCBlcCArIDIgKiBhVnQgKyB0aGlzLmFWdSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE5RyA9IHRoaXMuaiAtIDQgKiBhVnQgLSB0aGlzLnNrIC0gdGhpcy5hVnU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSA5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubjM7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMjsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbYUIgKyA4XSwgMCwgMC4zMSAqIHRoaXMuaSksIDAsIGFCICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkueEQuYTIzKGJjLmFWbFsxOF0sIDAsIDAuMzEgKiB0aGlzLmkpLCAwLCAzICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubjI7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS54RC5hMjMoYmMuYVZsWzExXSwgMCwgMC4zMSAqIHRoaXMuaSksIDAsIDQgKiBhOUcgLyBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsU3R5bGUgPSBiQS5uTDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbMTNdLCAwLCAwLjMxICogdGhpcy5pKSwgMCwgNSAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbMTVdLCAwLCAwLjMxICogdGhpcy5pKSwgMCwgNiAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbMTZdLCAwLCAwLjMxICogdGhpcy5pKSwgMCwgNyAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnhELmEyMyhiYy5hVmxbMTJdLCAwLCAwLjMxICogdGhpcy5pKSwgMCwgOCAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm5LOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkueEQuYTIzKGJjLmFWbFsxN10sIDAsIDAuMzEgKiB0aGlzLmkpLCAwLCBhOUcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubjM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBiYy5saDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhRDAgPSBmOFs4XSArIGY4WzldICsgZjhbMTBdICsgZjhbMThdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE1VCA9IGI5LnpkLnlKKGFEMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYU40ID0gdG8ubWVhc3VyZVRleHQoYTVUKS53aWR0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCBlbiArIDAuODMgKiB0aGlzLmkgKyBhTjQsIGVwICsgMiAqIGFWdCArIHRoaXMuYVZ1KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnpkLnlKKGY4WzhdKSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC55SihmOFs5XSksIDAsIDEgKiBhOUcgLyBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC55SihmOFsxMF0pLCAwLCAyICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQueUooZjhbMThdKSwgMCwgMyAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm4yOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYTVULCAwLCA0ICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubkw7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC55SihmOFsxM10pLCAwLCA1ICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQueUooZjhbMTVdKSwgMCwgNiAqIGE5RyAvIGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxUZXh0KGI5LnpkLnlKKGY4WzE2XSksIDAsIDcgKiBhOUcgLyBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChiOS56ZC55SihmOFsxMl0pLCAwLCA4ICogYTlHIC8gZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFXNiA9IGY4WzEyXSArIGY4WzEzXSArIGY4WzE1XSArIGY4WzE2XTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm5LOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYjkuemQueUooYVc2KSwgMCwgYTlHKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxTdHlsZSA9IGJBLm1tOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNHAgPSBmdW5jdGlvbihnLCBhMVEsIGE4Mikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYVZ4IDwgMCB8fCB0aGlzLmFWeCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMC4yNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiA9IHRoaXMuYVZ4ICogKGJjLmFQVSAtIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBNYXRoLmZsb29yKGFCKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmTiA9IGdbZV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZlAgPSBnW2UgPCBiYy5hUFUgLSAxID8gZSArIDEgOiBlXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZOID0gZk4gKyAoYUIgLSBlKSAqIChmUCAtIGZOKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLnN0cm9rZVN0eWxlID0gYkEubXA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hVnggPiAwLjA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzcoMCwgdGhpcy5hVnMgLSBhMVEgKiBNYXRoLnBvdyhmTiwgYTgyKSwgYUIgKiB0aGlzLmFWciAvIChiYy5hUFUgLSAxKSwgdGhpcy5hVnMgLSBhMVEgKiBNYXRoLnBvdyhmTiwgYTgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZk4gLyBiYy5tYXhbdGhpcy5lMV0gPiAwLjA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzcoYUIgKiB0aGlzLmFWciAvIChiYy5hUFUgLSAxKSwgdGhpcy5hVnMsIGFCICogdGhpcy5hVnIgLyAoYmMuYVBVIC0gMSksIHRoaXMuYVZzIC0gYTFRICogTWF0aC5wb3coZk4sIGE4MikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubk47DQogICAgICAgICAgICAgICAgICAgICAgICB0by5iZWdpblBhdGgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmFyYyhhQiAqIHRoaXMuYVZyIC8gKGJjLmFQVSAtIDEpLCB0aGlzLmFWcyAtIGExUSAqIE1hdGgucG93KGZOLCBhODIpLCBNYXRoLm1heCgyLCAwLjAxNCAqIHRoaXMuaiksIDAsIDIgKiBNYXRoLlBJKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlRiA9IHRoaXMuYVZ4ICogYmUuYTl1Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFnLmxsW2FELmVRXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVGID0gTWF0aC5mbG9vcihlRiAqIGJjLmFWayk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVGID0gTWF0aC5mbG9vcihlRiAqIGJlLmpzKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gYkEubW07DQogICAgICAgICAgICAgICAgICAgICAgICB0by5maWxsVGV4dChhODIgPT09IDEgPyBiOS56ZC5hMzQoZk4gLyAxMDAsIDIpIDogYjkuemQueUooTWF0aC5mbG9vcihmTikpLCAtdGhpcy5zMiwgdGhpcy5hVnMgLSBhMVEgKiBNYXRoLnBvdyhmTiwgYTgyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiOS5wZy50ZXh0QWxpZ24odG8sIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFRleHQoYVcuYTlqKGVGKSwgYUIgKiB0aGlzLmFWciAvIChiYy5hUFUgLSAxKSwgdGhpcy5hVnMgKyB0aGlzLmFWdiAtIChhMC5hMS5yNCgpID8gMiA6IDApIC0gdGhpcy5hNlcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYjkucGcudGV4dEFsaWduKHRvLCAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhMVEgKiBNYXRoLnBvdyhmTiwgYTgyKSAvIHRoaXMuYVZzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzcgPSBmdW5jdGlvbihtQywgbUQsIG1QLCBtUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uYmVnaW5QYXRoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0by5tb3ZlVG8obUMsIG1EKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmxpbmVUbyhtUCwgbVEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc3Ryb2tlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBidigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVzggPSAiaHR0cHM6Ly8iOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFXOSA9IHRoaXMuYVc4ICsgInRlcnJpdG9yaWFsLmlvLyI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVBWID0gdGhpcy5hVzkgKyAiY2hhbmdlbG9nIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUFogPSB0aGlzLmFXOSArICJ0ZXJtcyI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdBID0gdGhpcy5hVzkgKyAiY29va2llX3BvbGljeSI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU93ID0gdGhpcy5hVzkgKyAicHJpdmFjeSI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVBZID0gdGhpcy5hVzkgKyAidHV0b3JpYWwiOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQWCA9IHRoaXMuYVc5ICsgInBsYXllcnMiOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFQVyA9IHRoaXMuYVc5ICsgImNsYW5zIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56biA9IHRoaXMuYVc5ICsgImNsYW4tcmVzdWx0cyI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYU1EID0gImh0dHBzOi8vcGF0cmVvbi5jb20vYy90ZXJyaXRvcmlhbCI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJDID0gdGhpcy5hVzggKyAicGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD10ZXJyaXRvcmlhbC5pbyI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTA1ID0gdGhpcy5hVzggKyAiYXBwcy5hcHBsZS5jb20vYXBwL2lkMTU4MTExMDkxMyI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdCID0gdGhpcy5hVzggKyAid3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9dG9aVFE4YVJkRmMiOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFCRCA9IHRoaXMuYVc4ICsgImRpc2NvcmQuZ2cvcHRocXZwVFhtaCI7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUJFID0gdGhpcy5hVzggKyAid3d3Lmluc3RhZ3JhbS5jb20vZGF2aWR0c2NoYWNoZXIvIjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54dCA9ICLwn4em8J+Hq/Cfh6bwn4e98J+HpvCfh7Hwn4ep8J+Hv/Cfh6bwn4e48J+HpvCfh6nwn4em8J+HtPCfh6bwn4eu8J+HpvCfh7bwn4em8J+HrPCfh6bwn4e38J+HpvCfh7Lwn4em8J+HvPCfh6bwn4e68J+HpvCfh7nwn4em8J+Hv/Cfh6fwn4e48J+Hp/Cfh63wn4en8J+HqfCfh6fwn4en8J+Hp/Cfh77wn4en8J+HqvCfh6fwn4e/8J+Hp/Cfh6/wn4en8J+HsvCfh6fwn4e58J+Hp/Cfh7Twn4en8J+HpvCfh6fwn4e88J+Hp/Cfh7fwn4eu8J+HtPCfh7vwn4es8J+Hp/Cfh7Pwn4en8J+HrPCfh6fwn4er8J+Hp/Cfh67wn4eo8J+Hu/Cfh7Dwn4et8J+HqPCfh7Lwn4eo8J+HpvCfh67wn4eo8J+HsPCfh77wn4eo8J+Hq/Cfh7nwn4ep8J+HqPCfh7Hwn4eo8J+Hs/Cfh6jwn4e98J+HqPCfh6jwn4eo8J+HtPCfh7Dwn4ey8J+HqPCfh6zwn4eo8J+HqfCfh6jwn4e38J+HrfCfh7fwn4eo8J+HuvCfh6jwn4e88J+HqPCfh77wn4eo8J+Hv/Cfh6nwn4ew8J+HqfCfh6/wn4ep8J+HsvCfh6nwn4e08J+HqvCfh6jwn4eq8J+HrPCfh7jwn4e78J+HrPCfh7bwn4eq8J+Ht/Cfh6rwn4eq8J+HuPCfh7/wn4eq8J+HufCfh6rwn4e68J+Hq/Cfh7Dwn4er8J+HtPCfh6vwn4ev8J+Hq/Cfh67wn4er8J+Ht/Cfh6zwn4er8J+HtfCfh6vwn4e58J+Hq/Cfh6zwn4em8J+HrPCfh7Lwn4es8J+HqvCfh6nwn4eq8J+HrPCfh63wn4es8J+HrvCfh6zwn4e38J+HrPCfh7Hwn4es8J+HqfCfh6zwn4e18J+HrPCfh7rwn4es8J+HufCfh6zwn4es8J+HrPCfh7Pwn4es8J+HvPCfh6zwn4e+8J+HrfCfh7nwn4et8J+Hs/Cfh63wn4ew8J+HrfCfh7rwn4eu8J+HuPCfh67wn4ez8J+HrvCfh6nwn4eu8J+Ht/Cfh67wn4e28J+HrvCfh6rwn4eu8J+HsvCfh67wn4ex8J+HrvCfh7nwn4eo8J+HrvCfh6/wn4ey8J+Hr/Cfh7Xwn4ev8J+HqvCfh6/wn4e08J+HsPCfh7/wn4ew8J+HqvCfh7Dwn4eu8J+HvfCfh7Dwn4ew8J+HvPCfh7Dwn4es8J+HsfCfh6bwn4ex8J+Hu/Cfh7Hwn4en8J+HsfCfh7jwn4ex8J+Ht/Cfh7Hwn4e+8J+HsfCfh67wn4ex8J+HufCfh7Hwn4e68J+HsvCfh7Twn4ey8J+HsPCfh7Lwn4es8J+HsvCfh7zwn4ey8J+HvvCfh7Lwn4e78J+HsvCfh7Hwn4ey8J+HufCfh7Lwn4et8J+HsvCfh7bwn4ey8J+Ht/Cfh7Lwn4e68J+HvvCfh7nwn4ey8J+HvfCfh6vwn4ey8J+HsvCfh6nwn4ey8J+HqPCfh7Lwn4ez8J+HsvCfh6rwn4ey8J+HuPCfh7Lwn4em8J+HsvCfh7/wn4ey8J+HsvCfh7Pwn4em8J+Hs/Cfh7fwn4ez8J+HtfCfh7Pwn4ex8J+Hs/Cfh6jwn4ez8J+Hv/Cfh7Pwn4eu8J+Hs/Cfh6rwn4ez8J+HrPCfh7Pwn4e68J+Hs/Cfh6vwn4ew8J+HtfCfh7Lwn4e18J+Hs/Cfh7Twn4e08J+HsvCfh7Xwn4ew8J+HtfCfh7zwn4e18J+HuPCfh7Xwn4em8J+HtfCfh6zwn4e18J+HvvCfh7Xwn4eq8J+HtfCfh63wn4e18J+HsfCfh7Xwn4e58J+HtfCfh7fwn4e28J+HpvCfh7fwn4e08J+Ht/Cfh7rwn4e38J+HvPCfh7zwn4e48J+HuPCfh7Lwn4e48J+HufCfh7jwn4em8J+HuPCfh7Pwn4e38J+HuPCfh7jwn4eo8J+HuPCfh7Hwn4e48J+HrPCfh7jwn4e98J+HuPCfh7Dwn4e48J+HrvCfh7jwn4en8J+HuPCfh7Twn4e/8J+HpvCfh6zwn4e48J+HsPCfh7fwn4e48J+HuPCfh6rwn4e48J+HsfCfh7Dwn4en8J+HsfCfh7jwn4et8J+HsPCfh7Pwn4ex8J+HqPCfh7Lwn4er8J+HtfCfh7Lwn4e78J+HqPCfh7jwn4ep8J+HuPCfh7fwn4e48J+HqvCfh7jwn4e+8J+HqPCfh63wn4e58J+HvPCfh7nwn4ev8J+HufCfh7/wn4e58J+HrfCfh7nwn4ex8J+HufCfh6zwn4e58J+HsPCfh7nwn4e08J+HufCfh7nwn4e58J+Hs/Cfh7nwn4e38J+HufCfh7Lwn4e58J+HqPCfh7nwn4e78J+HuvCfh6zwn4e68J+HpvCfh6bwn4eq8J+HrPCfh6fwn4e68J+Hs/Cfh7rwn4e48J+Hu/Cfh67wn4e68J+HvvCfh7rwn4e/8J+Hu/Cfh7rwn4e78J+HpvCfh7vwn4eq8J+Hu/Cfh7Pwn4e88J+Hq/Cfh6rwn4et8J+HvvCfh6rwn4e/8J+HsvCfh7/wn4e8IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZDQoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IG5ldyBhV0MoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy54QSA9IG5ldyBhV0QoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55LmRYKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy55LmE1dCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueS5hNXQtLTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXRCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy50biA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJPLnkuYTV0ID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVdFKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV0YoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXRSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmdsb2JhbEFscGhhID0gTWF0aC5taW4oYk8ueS5hNXQgLyA1ODAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZHJhd0ltYWdlKGJPLnkuYVdHLCAxICsgYVMueDgoKSwgMSArIGFTLng5KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZ2xvYmFsQWxwaGEgPSAxOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXRigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtQyA9IGlHIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbUQgPSBpSSAvIGlIOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1QID0gKGguaSArIGlHKSAvIGlIOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1RID0gKGguaiArIGlJKSAvIGlIOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdFID0gYk8ueS5hV0ggKiBpSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV0kgPSBiTy55LmFXSTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuanYgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdKKGFCLCBnRSwgbUMsIG1ELCBtUCwgbVEsIGFXSSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0by5zZXRUcmFuc2Zvcm0oaUgsIDAsIDAsIGlILCAwLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhV0ooYUIsIGdFLCBtQywgbUQsIG1QLCBtUSwgYVdJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbYUJdID09PSAwIHx8IGFnLmdUW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IGguaSAqICgoYWcuaVVbYUJdICsgYWcuaVZbYUJdICsgMSkgLyAyIC0gbUMpIC8gKG1QIC0gbUMpIC0gMC41ICogZ0U7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXAgPSBoLmogKiAoKGFnLmlXW2FCXSArIGFnLmlYW2FCXSArIDEpIC8gMiAtIG1EKSAvIChtUSAtIG1EKSAtIDAuNSAqIGdFOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuID4gaC5pIHx8IGVwID4gaC5qIHx8IGVuIDwgLWdFIHx8IGVwIDwgLWdFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uc2V0VHJhbnNmb3JtKGlILCAwLCAwLCBpSCwgZW4sIGVwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmRyYXdJbWFnZShhV0lbYUQuaFYgPyBiZi5lZVthQl0gOiAxXSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVdDKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFXSCA9IDI4Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE1dCA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdHID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV0kgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVdLID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNXQgPSA3MDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhV0wodGhpcyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhQkEodGhpcywgYVdNKHRoaXMpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEzTSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVdNKHJJKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAockkuYVdHICE9PSBudWxsICYmIHJJLmFXRy53aWR0aCA9PT0gYlIuZXIgLSAyICYmIHJJLmFXRy5oZWlnaHQgPT09IGJSLmVzIC0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgckkuYVdHID0gYjkucGcudlQoYlIuZXIgLSAyLCBiUi5lcyAtIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXTChySSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhYID0gckkuYVdIOw0KICAgICAgICAgICAgICAgICAgICAgICAgckkuYVdJID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICBhV0sgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPD0gYUQud0g7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgckkuYVdJLnB1c2goYVdOKGhYLCBiZi5hVUVbYmYua0hbYUJdXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV0sucHVzaChhV04oaFggPj4gMSwgYmYuYVVFW2JmLmtIW2FCXV0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXSy5wdXNoKGFXTihoWCwgYmYuYVVFWzFdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBySS5hV0kucHVzaChhV04oaFgsIGJmLmFVRVs3XSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJJLmFXSS5wdXNoKGFXTihoWCwgYmYuYVVFWzRdKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdLLnB1c2goYVdOKGhYID4+IDEsIGJmLmFVRVs3XSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVVEID0gZnVuY3Rpb24oaFgsIGFXTykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFXTihoWCwgYVdPKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXTihoWCwgYVdPKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW4sIGVwLCBlUywgaTEsIGk0LCBldzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhMXIgPSBiOS5wZy52VChoWCwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhkID0gYjkucGcuZ2V0Q29udGV4dChhMXIsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhID0gYjkucGcuZ2V0SW1hZ2VEYXRhKGhkLCBoWCwgaFgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZlID0gaGEuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZCA9IChoWCA+PiAxKSAtIDAuNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV1AgPSAoa2QgKyAwLjUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVdQICo9IGFXUDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSAwOyBlcCA8IGhYOyBlcCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlbiA9IDA7IGVuIDwgaFg7IGVuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaTEgPSBlbiAtIGtkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpNCA9IGVwIC0ga2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVTID0gKGVwICogaFggKyBlbikgKiA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IGkxICogaTEgKyBpNCAqIGk0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZVtlU10gPSBhV09bMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VTICsgMV0gPSBhV09bMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VTICsgMl0gPSBhV09bMl07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlW2VTICsgM10gPSAoYVdQIC0gZXcpICogYVdPWzNdIC8gYVdQOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLnB1dEltYWdlRGF0YShoYSwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTFyOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFCQShySSwgYVdRKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdHID0gckkuYVdHOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhkID0gYjkucGcuZ2V0Q29udGV4dChhV0csIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQuZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFggPSBySS5hV0ggPj4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhkLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaGQuc2V0VHJhbnNmb3JtKDEsIDAsIDAsIDEsIDAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFXUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhkLmNsZWFyUmVjdCgwLCAwLCBhV0cud2lkdGgsIGFXRy5oZWlnaHQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaFggPSBoWCA8PCAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV1IgPSBheS5rTFs1XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZWcgLSBhV1I7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZOKGFCLCBoZCwgYVdLLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnIC09IGFXUjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoWCA9IGhYID4+IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYUQuanY7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVk4oYUIsIGhkLCBhV0ssIGhYKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmEzTSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQuanY7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFggPSB0aGlzLmFXSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV0kgPSB0aGlzLmFXSTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZCA9IGI5LnBnLmdldENvbnRleHQodGhpcy5hV0csIHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVZOKGFCLCBoZCwgYVdJLCBoWCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhVk4oYUIsIGhkLCBhMXIsIGhYKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWcubGxbYUJdID09PSAwIHx8IGFnLmdUW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IChhZy5pVVthQl0gKyBhZy5pVlthQl0gKyAxIC0gaFggLSAyKSA+PiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVwID0gKGFnLmlXW2FCXSArIGFnLmlYW2FCXSArIDEgLSBoWCAtIDIpID4+IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBoZC5kcmF3SW1hZ2UoYTFyW2FELmhWID8gKChhRC5rQyA9PT0gOSAmJiBhRS5oS1thQl0gPT09IDUpID8gMyA6IGJmLmVlW2FCXSkgOiAoYUIgPCBhRC5qdiA/IDEgOiAwKV0sIGVuLCBlcCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZDUoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub08gPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFOLnpEKHBsYXllciwgKHBsYXllciA9PT0gYUQuZVEgPyAyMSA6IDIyKSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhV1MocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFXVCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdiA9IGZ1bmN0aW9uKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAxICYmIGFnLmxsW3BsYXllcl0gIT09IDAgJiYgYWcuYTJOW3BsYXllcl0gIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV1MocGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFELno0LS07DQogICAgICAgICAgICAgICAgICAgICAgICBhRC56My0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uekQocGxheWVyLCA0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOS5nMS5ncigyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXLmxYKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVdUKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhV1QoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDggJiYgYUQuejEgPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUS55ZS56MCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXUyhwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5oMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFrLmFGaChwbGF5ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsLmFJZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5veS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjIuYUJUKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZEYoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVJwID0gWyJyZ2JhKDkwLDkwLDkwLDAuODgpIiwgInJnYmEoMTMwLDEyLDEyLDAuODgpIiwgInJnYmEoMTIsMTMwLDEyLDAuODgpIiwgInJnYmEoMTIsMTIsMTMwLDAuODgpIiwgInJnYmEoMTMwLDEzMCwxMiwwLjg4KSIsICJyZ2JhKDEzMCwxMiwxMzAsMC44OCkiLCAicmdiYSgxMiwxMzAsMTMwLDAuODgpIiwgInJnYmEoMTMwLDEzMCwxMzAsMC44OCkiLCAicmdiYSgwLDAsMCwwLjg4KSJdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE5RCA9IFsicmdiKDIxMCwyMDAsMjAwKSIsICJyZ2IoMjU1LDEyMCwxMjApIiwgInJnYigwLDIzMCwwKSIsICJyZ2IoMTUwLDE1MCwyNTUpIiwgInJnYigyNDAsMjQwLDI1KSIsICJyZ2IoMjU1LDcwLDI1NSkiLCAicmdiKDI1LDI0MCwyNDApIiwgYkEubW0sICJyZ2IoMTcwLDE3MCwxNzApIl07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdVID0gW2JBLm1tLCAicmdiKDI1NSwwLDApIiwgInJnYigwLDI1NSwwKSIsICJyZ2IoMCwwLDI1NSkiLCAicmdiKDI1NSwyNTUsMCkiLCAicmdiKDI1NSwwLDI1NSkiLCAicmdiKDAsMjU1LDI1NSkiLCBiQS5tbSwgYkEubWRdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFXViA9IFtiQS5tZCwgYkEubW0sIGJBLm1tLCBiQS5tbSwgYkEubWQsIGJBLm1kLCBiQS5tZCwgYkEubWQsIGJBLm1tXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFXVyA9IFsiMjU1LDI1NSwyNTUiLCAiMCwwLDAiLCAiMjU1LDQsNCIsICIyMDAsNCw0IiwgIjQsMjU1LDQiLCAiNCwxODAsNCIsICIyNTUsMTk1LDE5NSIsICI5MCwzLDMiLCAiMjAwLDI1NSwyMDAiLCAiMyw4NCwzIl07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUk4ID0gW1NbOF0gKyBhV1dbMF0gKyAiLCIsIFNbOF0gKyBhV1dbMV0gKyAiLCIsIFNbOF0gKyBhV1dbMl0gKyAiLCIsIFNbOF0gKyBhV1dbM10gKyAiLCIsIFNbOF0gKyBhV1dbNF0gKyAiLCIsIFNbOF0gKyBhV1dbNV0gKyAiLCIsIFNbOF0gKyBhV1dbNl0gKyAiLCIsIFNbOF0gKyBhV1dbN10gKyAiLCIsIFNbOF0gKyBhV1dbOF0gKyAiLCIsIFNbOF0gKyBhV1dbOV0gKyAiLCJdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFJOSA9IFtTWzddICsgYVdXWzBdICsgIikiLCBTWzddICsgYVdXWzFdICsgIikiLCBTWzddICsgYVdXWzJdICsgIikiLCBTWzddICsgYVdXWzNdICsgIikiLCBTWzddICsgYVdXWzRdICsgIikiLCBTWzddICsgYVdXWzVdICsgIikiLCBTWzddICsgYVdXWzZdICsgIikiLCBTWzddICsgYVdXWzddICsgIikiLCBTWzddICsgYVdXWzhdICsgIikiLCBTWzddICsgYVdXWzldICsgIikiXTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy56TSA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVVFID0gW1sxMjgsIDEyOCwgMTI4LCAxODBdLCBbMjU1LCAwLCAwLCAxODBdLCBbMCwgMjU1LCAwLCAxODBdLCBbNTAsIDUwLCAyNTUsIDE4MF0sIFsyNTUsIDI1NSwgMCwgMTgwXSwgWzI1NSwgMCwgMjU1LCAxODBdLCBbMCwgMjU1LCAyNTUsIDE4MF0sIFsyNTUsIDI1NSwgMjU1LCAxODBdLCBbMCwgMCwgMCwgMTgwXV07DQogICAgICAgICAgICAgICAgICAgIHZhciBhV1ggPSBbWzEyOCwgMTI4LCAxMjhdLCBbMjU1LCAwLCAwXSwgWzAsIDI1NSwgMF0sIFswLCAwLCAyNTVdLCBbMjU1LCAyNTUsIDBdLCBbMjU1LCAwLCAyNTVdLCBbMCwgMjU1LCAyNTVdLCBbMjU1LCAyNTUsIDI1NV0sIFswLCAwLCAwXV07DQogICAgICAgICAgICAgICAgICAgIHRoaXMua0ggPSBbMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOF07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWUgPSBuZXcgVWludDhBcnJheShhRC5lZCk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTlFID0gbmV3IFVpbnQ4QXJyYXkoYUQuZWQpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndOID0gbmV3IFVpbnQxNkFycmF5KGFELmVkKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy53TyA9IG5ldyBVaW50MTZBcnJheSh0aGlzLmtILmxlbmd0aCArIDEpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLndQID0gbmV3IFVpbnQxNkFycmF5KHRoaXMua0gubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56TSA9IFtMKDQ3MSksIEwoNDcyKSwgTCg0NzMpLCBMKDQ3NCksIEwoNDc1KSwgTCg0NzYpLCBMKDQ3NyksIEwoNDc4KSwgTCg0NzkpXTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWUuZmlsbCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVdZKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFELmhWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdaKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2EoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVdiKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhV2MoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdZID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IHRoaXMua0gubGVuZ3RoIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua0hbYUJdID0gYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhV1ooKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWUgPSBiZi5lZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuZGF0YS50ZWFtUGxheWVyQ291bnRbN10gLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWVbYUJdID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmRhdGEudGVhbVBsYXllckNvdW50WzddOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWVbYUJdID0gMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGJmLmtIWzFdID0gNzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJmLmtIWzJdID0gODsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGwgPSBuZXcgVWludDhBcnJheShhRC5qdik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG0gPSBuZXcgVWludDhBcnJheShhRC5qdik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdkID0gbmV3IFVpbnQxNkFycmF5KDgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFXZSA9IG5ldyBVaW50MTZBcnJheSh0aGlzLmtILmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXZihobCwgaG0sIGFXZCwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFGSyhhV2QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hV2coYVdlLCBobCwgaG0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hV2goaGwsIGhtLCBhV2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hV2koKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXYSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvcnNEYXRhID0gYUQuZGF0YS5jb2xvcnNEYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhRC5kYXRhLnNlbGVjdGFibGVDb2xvcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gYUQuanYgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yc0RhdGFbYUJdID0gYXguakQoMjYyMTQ0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdqID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldyA9IDI1NiAqIDM7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVJKID0gWzQgKiAoY29sb3JzRGF0YVswXSA+PiAxMiksIDQgKiAoKGNvbG9yc0RhdGFbMF0gPj4gNikgJiA2MyksIDQgKiAoY29sb3JzRGF0YVswXSAmIDYzKV07DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVhbVBsYXllckNvdW50ID0gYUQuZGF0YS50ZWFtUGxheWVyQ291bnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZWFtUGxheWVyQ291bnRbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGYwID0gMDsgZjAgPCAzOyBmMCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqICs9IE1hdGguYWJzKGFXWFthQl1bZjBdIC0gYVJKW2YwXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlaiA8IGV3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXaiA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldyA9IGVqOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV2sgPSBuZXcgVWludDE2QXJyYXkoOSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdrW2FCXSA9IHRlYW1QbGF5ZXJDb3VudFthQl07DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga0ggPSBiZi5rSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV2wgPSBuZXcgVWludDhBcnJheSg5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGtIWzBdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPCA5OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFXa1thQl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdsW2FCXSA9IGc4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrSFtnOCsrXSA9IGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBqQyA9IGFELmp2Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVdrW2FXal0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2tbYVdqXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVlWzBdID0gYVdsW2FXal07DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpDID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gakM7IGFCIDwgYUQud0E7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaFQgPSBrSFtmMV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFXa1toVF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdrW2hUXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZVthQl0gPSBhV2xbaFRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYxKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFCLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmMSA+PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZXJyb3IgMzI1Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV2YgPSBmdW5jdGlvbihobCwgaG0sIGFXaywgYVdtKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGYwLCBlLCBhV247DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB0aGlzLmtILmxlbmd0aCAtIGFXbTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gbmV3IFVpbnQxNkFycmF5KGVnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvcnNEYXRhID0gYUQuZGF0YS5jb2xvcnNEYXRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmp2IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjAgPSBlZzsgZjAgPj0gYVdtOyBmMC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdbZjAgLSAxXSA9IE1hdGguYWJzKDQgKiAoY29sb3JzRGF0YVthQl0gPj4gMTIpIC0gYVdYW2YwXVswXSkgKyBNYXRoLmFicyg0ICogKChjb2xvcnNEYXRhW2FCXSA+PiA2KSAmIDYzKSAtIGFXWFtmMF1bMV0pICsgTWF0aC5hYnMoNCAqIChjb2xvcnNEYXRhW2FCXSAmIDYzKSAtIGFXWFtmMF1bMl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV24gPSA3Njg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IGVnIC0gMTsgZjAgPj0gMDsgZjAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gKGYwICsgYUIpICUgZWc7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnW2VdIDwgYVduKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV24gPSBnW2VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGxbYUJdID0gZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2tbaGxbYUJdXSArPSA0Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXbiA9IDc2ODsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYwID0gZWcgLSAxOyBmMCA+PSAwOyBmMC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAoZjAgKyBhQikgJSBlZzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdbZV0gPCBhV24gJiYgZSAhPT0gaGxbYUJdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV24gPSBnW2VdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG1bYUJdID0gZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2tbaG1bYUJdXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hRksgPSBmdW5jdGlvbihhV2spIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjAsIGtmOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gdGhpcy5rSC5sZW5ndGggLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGVnOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rSFthQl0gPSBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2tbYUJdKys7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPD0gZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IDE7IGYwIDwgZWc7IGYwKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFXa1tmMF0gPiBhV2tba2ZdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZiA9IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXa1trZl0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua0hbYUJdID0ga2YgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV2cgPSBmdW5jdGlvbihhV2UsIGhsLCBobSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYwLCB6aCwgZjEsIGVqLCBlLCBtTywgc0o7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdvID0gdGhpcy5rSC5sZW5ndGggLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHFBID0gbmV3IFVpbnQxNkFycmF5KGFXbyk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdwID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVdxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB6ZyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFXciA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yICh2YXIgYUIgPSAwOyBhQiA8IGFELmp2OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgemggPSBiOS56ZC56aShhZy56ZlthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6aCAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYwID0gemcubGVuZ3RoIC0gMTsgZjAgPj0gMDsgZjAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpoID09PSB6Z1tmMF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV3JbZjBdLnB1c2goYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXcSA9IE1hdGgubWF4KGFXcSwgYVdyW2YwXS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGxvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemcucHVzaCh6aCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXcC5wdXNoKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdyLnB1c2goW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFXcSA9IE1hdGgubWF4KGFXcSwgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFELndIID4gMiAmJiBhV3EgPiBiSy5kbShhRC5qdiwgYUQud0gpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQud0gtLTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5rQy0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IHpnLmxlbmd0aCAtIDE7IGYwID49IDA7IGYwLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlaiA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSB6Zy5sZW5ndGggLSAxOyBmMSA+PSAwOyBmMS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVdwW2YxXSAmJiAoZWogPT09IC0xIHx8IGFXcltmMV0ubGVuZ3RoID4gYVdyW2VqXS5sZW5ndGgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlaiA9IGYxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSBhV28gLSAxOyBmMSA+PSAwOyBmMS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFBW2YxXSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSBhV3JbZWpdLmxlbmd0aCAtIDE7IGYxID49IDA7IGYxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUFbaGxbYVdyW2VqXVtmMV1dXSArPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxQVtobVthV3JbZWpdW2YxXV1dKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSBhV28gLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBlaiAlIGFXbzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMSA9IGFXbyAtIDE7IGYxID49IDA7IGYxLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxQVtmMV0gPiBxQVtlXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBmMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtTyA9IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYxID0gYUQud0g7IGYxID4gMDsgZjEtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMua0hbZjFdID09PSBlICsgMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1PID0gZjE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcUFbZV0gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobU8gPT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSiA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZjEgPSBhRC53SDsgZjEgPiAwOyBmMS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVdlW21PXSA+IGFXZVtmMV0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzSiA9PT0gYUQud0ggLSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGYxID0gYVdyW2VqXS5sZW5ndGggLSAxOyBmMSA+PSAwOyBmMS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2VbbU9dKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVlW2FXcltlal1bZjFdXSA9IG1POw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV3BbZWpdID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdoID0gZnVuY3Rpb24oaGwsIGhtLCBhV2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZjAsIGkwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gdGhpcy5rSC5sZW5ndGggLSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvcmRlciA9IGJLLmRtKGFELmp2LCBhRC53SCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuanYgJSBhRC53SCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXIrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV3MgPSBuZXcgVWludDhBcnJheShlZyArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IGVnOyBmMCA+PSAxOyBmMC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdzW3RoaXMua0hbZjBdXSA9IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgYUQuanY7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMCA9IGFXc1tobFthQl0gKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lZVthQl0gPT09IDAgJiYgaTAgPD0gYUQud0ggJiYgYVdlW2kwXSA8IGJvcmRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2VbaTBdKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWVbYUJdID0gaTA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IDA7IGFCIDwgYUQuanY7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMCA9IGFXc1tobVthQl0gKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lZVthQl0gPT09IDAgJiYgaTAgPD0gYUQud0ggJiYgYVdlW2kwXSA8IGJvcmRlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV2VbaTBdKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWVbYUJdID0gaTA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmMCA9IGFELndIOyBmMCA+PSAxOyBmMC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGFELmp2IC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVdlW2YwXSA+PSBib3JkZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVlW2FCXSA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVdlW2YwXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZVthQl0gPSBmMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVdpID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IGFELmp2OyBhQiA8IGFELmVkOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZVthQl0gPSAxICsgYUIgJSBhRC53SDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXYigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFELmVkOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdOID0gYmYud047DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgd08gPSBiZi53TzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3UCA9IGJmLndQOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVlID0gYmYuZWU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga0ggPSBiZi5rSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3RyA9IGtILmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlRCA9IG5ldyBBcnJheSh3Ryk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgd0c7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRFthQl0gPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZURba0hbZWVbYUJdXV0ucHVzaChhQik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMTsgYUIgPD0gd0c7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3T1thQl0gPSB3T1thQiAtIDFdICsgZURbYUIgLSAxXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCB3RzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IGVEW2FCXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtkID0gd09bYUJdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGhUID0gMDsgaFQgPCBnODsgaFQrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3TltoVCArIGtkXSA9IGVEW2FCXVtoVF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGp2ID0gYUQuanY7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCB3RzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc4ID0gZURbYUJdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZCA9IHdPW2FCXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGhUID0gMDsgaFQgPCBnODsgaFQrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod05baFQgKyBrZF0gPj0ganYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdQW2FCXSA9IGhUOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVdjKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYUQuZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWUgPSBiZi5lZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOUUgPSBiZi5hOUU7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIga0ggPSBiZi5rSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGE5RVthQl0gPSBrSFtlZVthQl1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTlFLmZpbGwoMSwgZWcgLSBheS5rTFs1XSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ1UoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZW4sIGVwOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gZmEgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbiA9IGJLLmRtKGZjW2FCXSwgNCkgJSBiUi5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVwID0gYksuZG0oZmNbYUJdLCA0ICogYlIuZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVVbZlZdID0gTWF0aC5taW4oZW4sIGFnLmlVW2ZWXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5pV1tmVl0gPSBNYXRoLm1pbihlcCwgYWcuaVdbZlZdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmlWW2ZWXSA9IE1hdGgubWF4KGVuLCBhZy5pVltmVl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVhbZlZdID0gTWF0aC5tYXgoZXAsIGFnLmlYW2ZWXSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZnAoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGFnLmc3W2ZWXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIHZhciBlaiwgZ0QsIGFCOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yIChhQiA9IGVnIC0gMTsgYUIgPj0gMDsgYUItLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlaiA9IDM7IGVqID49IDA7IGVqLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnRCA9IGFnLmc3W2ZWXVthQl0gKyBlaVtlal07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmVYKGdEKSB8fCAoYWMuZ0YoZ0QpICYmIGFjLmVZKGdEKSAhPT0gZlYpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjLmo5KGFnLmc3W2ZWXVthQl0sIGZWKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1tmVl1bYUJdID0gYWcuZzdbZlZdW2VnIC0gMV07DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5nN1tmVl0ucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBlZy0tOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZxKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gZlY7DQogICAgICAgICAgICAgICAgICAgIHZhciBnTCA9IGFnLmdMOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZ00gPSBhZy5nTTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGY2ID0gYWcuZjY7DQogICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGdMW3BsYXllcl0ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgbG9vcDogZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV3QgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhV3UgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnRCA9IGdMW3BsYXllcl1bYUJdICsgZWlbZWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5hRlUoZ0QsIHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVd0ID0gYVd0IHx8IGFjLmg4KGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhV3UgPSBhV3UgfHwgYWMuYUZUKGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhV3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnTVtwbGF5ZXJdLnB1c2goZ0xbcGxheWVyXVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhV3UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmNltwbGF5ZXJdLnB1c2goZ0xbcGxheWVyXVthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYy53aihnTFtwbGF5ZXJdW2FCXSwgcGxheWVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGdMW3BsYXllcl1bYUJdID0gZ0xbcGxheWVyXVtlZyAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZ0xbcGxheWVyXS5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVnLS07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ0ooKSB7DQogICAgICAgICAgICAgICAgICAgIGFnLmdUW2ZaXSAtPSBmYTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ0soYm9yZGVyKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IGJvcmRlci5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gZWcgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjLngzKGZaLCBib3JkZXJbYUJdKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlclthQl0gPSBib3JkZXJbZWcgLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXIucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWctLTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnTihib3JkZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYm9yZGVyLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWMueDMoZlosIGJvcmRlclthQl0pICYmIGFjLmViKGJvcmRlclthQl0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyW2FCXSA9IGJvcmRlcltlZyAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlci5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZy0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdPKGJvcmRlcikgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBib3JkZXIubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZWkgPSBhYy5laTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVqLCBnRDsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSBlZyAtIDE7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBib3JkZXJbYUJdICsgZWlbZWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5hRlUoZ0QsIGZaKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZy5nTFtmWl0ucHVzaChib3JkZXJbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyW2FCXSA9IGJvcmRlcltlZyAtIDFdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXIucG9wKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVnLS07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnUCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVqLCBnRDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gZmEgLSAxOyBhQiA+PSAwOyBhQi0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gZmNbYUJdICsgZWlbZWpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5hRlYoZlosIGdEKSAmJiBhYy5hRlcoZ0QpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnLmdMW2ZaXS5wdXNoKGdEKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWMuZ0EoZ0QsIGZaKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ1EoKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXA7DQogICAgICAgICAgICAgICAgICAgIGxvb3A6IHdoaWxlIChhZy5pV1tmWl0gPCBhZy5pWFtmWl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZW4gPSBhZy5pVltmWl07IGVuID49IGFnLmlVW2ZaXTsgZW4tLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy54MyhmWiwgKGFnLmlXW2ZaXSAqIGJSLmVyICsgZW4pICogNCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5pV1tmWl0rKzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBsb29wOiB3aGlsZSAoYWcuaVdbZlpdIDwgYWcuaVhbZlpdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGVuID0gYWcuaVZbZlpdOyBlbiA+PSBhZy5pVVtmWl07IGVuLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMueDMoZlosIChhZy5pWFtmWl0gKiBiUi5lciArIGVuKSAqIDQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGxvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYWcuaVhbZlpdLS07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbG9vcDogd2hpbGUgKGFnLmlVW2ZaXSA8IGFnLmlWW2ZaXSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlcCA9IGFnLmlYW2ZaXTsgZXAgPj0gYWcuaVdbZlpdOyBlcC0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLngzKGZaLCAoZXAgKiBiUi5lciArIGFnLmlVW2ZaXSkgKiA0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFnLmlVW2ZaXSsrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGxvb3A6IHdoaWxlIChhZy5pVVtmWl0gPCBhZy5pVltmWl0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZXAgPSBhZy5pWFtmWl07IGVwID49IGFnLmlXW2ZaXTsgZXAtLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy54MyhmWiwgKGVwICogYlIuZXIgKyBhZy5pVltmWl0pICogNCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhZy5pVltmWl0tLTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlWihwbGF5ZXIsIGo2KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAoYmYuZWVbcGxheWVyXSA9PT0gMCB8fCBiZi5lZVtwbGF5ZXJdICE9PSBiZi5lZVtqNl0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoRShwbGF5ZXIsIGo2KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhQiwgZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFXdiA9IGFkLmZsKHBsYXllcik7DQogICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGFXdjsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkLmZtKHBsYXllciwgYUIpICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBlID0gYWQuZnIocGxheWVyLCBhQik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoajYgPT09IGFELmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhDKGo2KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEua2goZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqNiA9PT0gYUQuZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhDKGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaEcoajYsIGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGhDKHBsYXllcikgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZWosIGFCLCBnRTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gYWcuZ0xbcGxheWVyXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIHZhciBlaSA9IGFjLmVpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGVqID0gMzsgZWogPj0gMDsgZWotLSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZ0UgPSBlaVtlal07DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gMDsgYUIgPCBlZzsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5lWChhZy5nTFtwbGF5ZXJdW2FCXSArIGdFKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhRmQocGxheWVyKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBlaiwgYUIsIGdFOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSBhZy5nTFtwbGF5ZXJdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnRSA9IGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjLmo4KGFnLmdMW3BsYXllcl1bYUJdKSAmJiBhYy5lWChhZy5nTFtwbGF5ZXJdW2FCXSArIGdFKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoRyhhMlMsIGEyVCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGRsLCBlaiwgZ0UsIGdEOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVVRID0gYWcuZ0xbYTJTXS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIHZhciBhVVIgPSBhZy5nTFthMlRdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFVUiA8IGFVUSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZGwgPSBhMlM7DQogICAgICAgICAgICAgICAgICAgICAgICBhMlMgPSBhMlQ7DQogICAgICAgICAgICAgICAgICAgICAgICBhMlQgPSBkbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRsID0gYVVROw0KICAgICAgICAgICAgICAgICAgICAgICAgYVVRID0gYVVSOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVVSID0gZGw7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnRSA9IGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGFVUTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdEID0gYWcuZ0xbYTJTXVthQl0gKyBnRTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZ0YoZ0QpICYmIGFjLmVZKGdEKSA9PT0gYTJUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFGZShhMlMsIGEyVCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGVqLCBnRSwgZ0Q7DQogICAgICAgICAgICAgICAgICAgIHZhciBhVVEgPSBhZy5nTFthMlNdLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGVpID0gYWMuZWk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoZWogPSAzOyBlaiA+PSAwOyBlai0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBnRSA9IGVpW2VqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSAwOyBhQiA8IGFVUTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhYy5qOChhZy5nTFthMlNdW2FCXSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ0QgPSBhZy5nTFthMlNdW2FCXSArIGdFOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWMuZ0YoZ0QpICYmIGFjLmVZKGdEKSA9PT0gYTJUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRSKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnA4ID0gbmV3IGFXdygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhV3coKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaEIgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuYTJPKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54Vyg4MCwgTCg0ODApLCA2MzcsIDAsIGJBLm5iLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTRSID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54Vyg4MCwgTCg0ODEpLCA2MzcsIDAsIGJBLm5iLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub0QgPSBmdW5jdGlvbihwbGF5ZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYjkuZzEuYTJPKHBsYXllcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi54Vyg4MCwgTCg0ODIpLCA2MzcsIDAsIGJBLm5iLCBiQS5taiwgLTEsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFXeCgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV3kgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhTy5pcSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVouaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGguaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF6LnkuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGF3LmFFcSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmRmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYS50bigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVd6KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVGID0gYmUuZUY7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFXeSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUVvID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hWDAgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFYMSA9IDc7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTV1ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hRW8gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hWDAgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hV3kgPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUXIgPSBmdW5jdGlvbihhQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmgxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOXYoYUMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVgwLnB1c2goYUMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IHRoaXMuYVgwLmxlbmd0aDsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiNy5vMi5pcSh0aGlzLmFYMFthQl0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFYMCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTl2ID0gZnVuY3Rpb24oYUMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC56MSA9PT0gMikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8yLmlxKGFDKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGI4LmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhVy5hOXYodGhpcy5hRW8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYUVvID09PSBhRC5hM1MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRC5veS5pcSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUVvID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFXeSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lRiA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUVvKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5hM0woKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLmxYKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmEuYUFWKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBoLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IGFXLmE5digtMSkgfHwgYmUuZGY7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbFooKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGID49IHRoaXMuZUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZUYgKz0gYmUuYTl1ICogTWF0aC5mbG9vcigxICsgKGJlLmVGIC0gdGhpcy5lRikgLyBiZS5hOXUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hWDIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZTErKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5lRiAtIHRoaXMuYTV1ID4gMjcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFYMygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hWDMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsVSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmRmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4NigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hNXUgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVgzID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBsVygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFYMiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVWLCBhQjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFXeSAhPT0gdGhpcy5hRW8gKiA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbFEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYS5hQVYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB1ViA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9vcDogd2hpbGUgKHRoaXMuYVg0KCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ViA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbFEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFYMC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB0aGlzLmFYMSAtIDI7IGFCID49IDA7IGFCLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxRKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBsb29wOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVWKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuYUFWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxPKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuYTNPKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFYNCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYVgwLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFFbysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI3Lm8yLmlxKHRoaXMuYVgwWzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFYMC5zaGlmdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVg1KCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYVg2Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYVg3Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYVg4Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVvOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVg5Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZUYgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV3kgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhWDYgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVg3ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFYOCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBhRW8gPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVg5ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGguaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiQi5hN00oKSA8IDEuNykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYQSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWEIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGxVKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZGYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhWEEoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGID49IGVGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVbiA9IGJlLmE5dSAvIGJCLmE3TSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRiArPSBhVW4gKiBNYXRoLmZsb29yKDEgKyAoYmUuZUYgLSBlRikgLyBhVW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIgfHwgYU0uZ3EgfHwgIWJCLmEzcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYQygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmEuYUFWKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZTErKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYRCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFYQigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhVW47DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPj0gZUYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuejEgPT09IDIgfHwgYU0uZ3EgfHwgIWJCLmEzcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsTygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRiA9IGJlLmVGOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFVbiA9IGJlLmE5dSAvIGJCLmE3TSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGJlLmVGIC0gZUYpIC8gYVVuID4gMTYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVGID0gYmUuZUYgLSAxNiAqIGFVbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYmUuZUYgPj0gZUYgJiYgYUQuejEgIT09IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVGICs9IGFVbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYQygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhLmFBVigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFYRCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFYQygpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhWEUoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVhGKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsUSgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFYRSgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhRC5rRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVg5ICUgNyAhPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYOSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFFbyA9PT0gYUQuYTNTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhWEYoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVcuYTl2KGFFbyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQub3kuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYVhGKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFYOSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUVvKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhZi5hM0woKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFmLmxYKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVhEKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmgxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSBhVy5hOXYoKGFFbyAtIChhWDkgJSA3ID09PSAwID8gMCA6IDEpKSArIChhWDkgJSA3KSAvIDcpIHx8IGJlLmRmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxaKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFNLmdxIHx8ICFiQi5hM3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbFcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhWEYoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUIsIGVnLCBrZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhWEcgPSBiOC5vdy5hUno7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZk4gPSBiOC5vdy5hUzA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZlAgPSBiOC5vdy5hUzE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZlIgPSBiOC5vdy5hUzI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVhIID0gYjgub3cuYVMzOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFYSSA9IGI4Lm93LmFTNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhWDYgPj0gYVhJLmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOLmEwSCgiUmVwbGF5IGZpbGUgc21hbGxlciB0aGFuIGV4cGVjdGVkLiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJCLmExOChmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYUQuejEgPSAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGtkID0gYVhJW2FYNl07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFYSFthWDZdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCsrYVg4ID49IGtkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYNisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWDggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGVnID0gYVg3ICsga2Q7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGFCID0gYVg3OyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYjcubzIub2ooYVhHW2FCXSwgZk5bYUJdLCBmUFthQl0sIGZSW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhWDcgKz0ga2Q7DQogICAgICAgICAgICAgICAgICAgICAgICBhWDYrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuekIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiOC5vdy5hUzQubGVuZ3RoIC0gYVg2IDw9IDIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBhTi5hMEgoIlJlcGxheSBmaWxlIGxhcmdlciB0aGFuIGV4cGVjdGVkLiIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYVhKKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZUYgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hV3kgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBoLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuaDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsWigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZTEgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmVGID49IGVGKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlRiArPSBiZS5hOXUgKiBNYXRoLmZsb29yKDEgKyAoYmUuZUYgLSBlRikgLyBiZS5hOXUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAyIHx8IGFNLmdxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbE8oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbFEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYS5hQVYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYU0uZ3EpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxaKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZS5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsVygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBsVSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlLmRmKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4NigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZE4oKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuekEgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRmID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZUYgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmE5dSA9IDU2Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgYVhLID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kWCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hM20oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYVhMKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZUYgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQuZ3ApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpBID0gbmV3IGFYNSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuekEuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpBID0gbmV3IGFYSigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpBID0gbmV3IGFXeigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuekEuZFgoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTNtID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpBID0gbmV3IGFXeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnpBLmFXeSsrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5qcyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuekEuYVd5Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVhMKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmUuZUYgPSBhWEsgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLnpBLmlxKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFYTCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUVQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IHBlcmZvcm1hbmNlLm5vdygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFYSyArIDEwMDAgPiBkbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZUYgPSBkbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuekEuaXEoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNwKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYUVEID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFYTSA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaXEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZS5lRiA8IGFFRCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGFFbigpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYUVuKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYUVEID0gYmUuZUYgKyA1MDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmdwIHx8IGFELmtFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGI5LmcxLmdzKGFELmVRKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkbCA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTV3ID0gZGwuZ2V0VVRDU2Vjb25kcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFYTSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNXcgPCA1MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWE0gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1dyA8IDUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVhNID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhNXYgPSAoZGwuZ2V0VVRDTWludXRlcygpICsgMSkgJSA2MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNXYgJSA1ICE9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1diA9PT0gMCB8fCBhNXYgPT09IDIwIHx8IGE1diA9PT0gNDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPCA3KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYTigwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1diA9PT0gMTAgfHwgYTV2ID09PSAzMCB8fCBhNXYgPT09IDUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA3IHx8IGFELmtDID09PSAxMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWE4oMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhNXYgPT09IDUgfHwgYTV2ID09PSAyNSB8fCBhNXYgPT09IDQ1KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELmtDID09PSA4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYTigyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGE1diA9PT0gMzUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUQua0MgPT09IDkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYVhOKDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhWE4oaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gW0woNDgzKSwgTCg0ODQpLCBMKDQ4NSksIEwoNDg2KV1baWRdOw0KICAgICAgICAgICAgICAgICAgICAgICAgYU4uYTViKHIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNqKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbUM7DQogICAgICAgICAgICAgICAgICAgIHZhciBtRDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG1QOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbVE7DQogICAgICAgICAgICAgICAgICAgIHZhciBhWE8gPSAwOw0KICAgICAgICAgICAgICAgICAgICB2YXIgYVhQID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMGEgPSBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWFAgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhWE8gPSAzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYUShlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhTC5xeCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYVhPID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYTBiID0gZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFELnoxID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudG91Y2hlcy5sZW5ndGggPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVhPID0gTWF0aC5tYXgoYVhPIC0gMSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhSC5tVSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUpUID0gYVhSKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVhRKGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhSlUgPSBhWFIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHkgPSBNYXRoLmZsb29yKChtQyArIG1QKSAvIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoeiA9IE1hdGguZmxvb3IoKG1EICsgbVEpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVMuYTdtKGh5LCBoeiwgTWF0aC5tYXgoMC4xMjUsIGFKVSkgLyBNYXRoLm1heCgwLjEyNSwgYUpUKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hMHkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbiwgZXA7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVhPKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVhPID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmUuZUYgPCBhWFAgKyA1MDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW4gPSAobUMgKyBtUCkgLyAyOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcCA9IChtRCArIG1RKSAvIDI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFMLmEwcyhlbiwgZXApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYUwuY2xpY2soZW4sIGVwLCB0cnVlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUuZGYgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFYUigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnBvdygoTWF0aC5wb3coKG1QIC0gbUMpLCAyKSArIE1hdGgucG93KChtUSAtIG1EKSwgMikpLCAwLjUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFYUShlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBtQyA9IGguayAqIGUudG91Y2hlc1swXS5jbGllbnRYOw0KICAgICAgICAgICAgICAgICAgICAgICAgbUQgPSBoLmsgKiBlLnRvdWNoZXNbMF0uY2xpZW50WTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1QID0gaC5rICogZS50b3VjaGVzWzFdLmNsaWVudFg7DQogICAgICAgICAgICAgICAgICAgICAgICBtUSA9IGguayAqIGUudG91Y2hlc1sxXS5jbGllbnRZOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGN5KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNpemUgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmUxID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hQyA9IG51bGw7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbihhQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFDID0gYUM7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpemUgPSBhQy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRIID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFDID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub2kgPSBmdW5jdGlvbihzaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYUI7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDID0gdGhpcy5hQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtVSA9IHRoaXMuZTEgKyBzaXplIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB0aGlzLmUxOyBhQiA8PSBtVTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGY4IHw9ICgoYUNbYUIgPj4gM10gPj4gKDcgLSAoYUIgJiA3KSkpICYgMSkgPDwgKG1VIC0gYUIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSArPSBzaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZTEgPiA4ICogdGhpcy5zaXplKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVW53cmFwcGVyIE92ZXJmbG93Iik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZjg7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFReiA9IGZ1bmN0aW9uKHNpemUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmMCA9IHNpemUgPj4gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlaiA9IDEgPDwgZjA7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWogKiB0aGlzLm9pKHNpemUgLSBmMCkgKyB0aGlzLm9pKGYwKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVIwID0gZnVuY3Rpb24oYVhTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaXplID09PSBiQy5hUXkoYVhTKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVNIID0gZnVuY3Rpb24odncsIGFYVCwgYVhVKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZzggPSB0aGlzLm9pKHZ3KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZzgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlZyA9IE1hdGgubWF4KGc4LCBhWFUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBhWFQgPD0gOCA/IG5ldyBVaW50OEFycmF5KGVnKSA6IGFYVCA8PSAxNiA/IG5ldyBVaW50MTZBcnJheShlZykgOiBuZXcgVWludDMyQXJyYXkoZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGc4OyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ1thQl0gPSB0aGlzLm9pKGFYVCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjggPSBnW2c4IC0gMV07DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWY4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBnLmZpbGwoZjgsIGc4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hU0kgPSBmdW5jdGlvbih2dywgYVhWLCBhWFUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnOCA9IHRoaXMub2kodncpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFnOCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gTWF0aC5tYXgoZzgsIGFYVSk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IG5ldyBBcnJheShlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZzg7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCXSA9IHRoaXMuYVNGKGFYVik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBnLmZpbGwoZ1tnOCAtIDFdLCBnOCk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVNGID0gZnVuY3Rpb24odncpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiRi52Mi52Nih0aGlzLm9pKHZ3KSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFTRyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBOID0gYkUucnkucnooYkUucnkuczAodGhpcy5vaSgzMCkpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gYjkuemQuYTNHKHBOLCAiXyIsICIvIik7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiA9IGI5LnpkLmEzRyhwTiwgIi0iLCAiXCsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhWFcgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgocE4ubGVuZ3RoICsgYVhXLmxlbmd0aCkgJSA0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYVhXID0gYVhXICsgIj0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcE4gPSBTWzkwXSArIHBOICsgYVhXOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFHOSA9IG5ldyBJbWFnZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUc5Lm9ubG9hZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI4LmFHWS5hR1ooYUc5KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzkub25sb2FkID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhRzkgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICAgICAgYUc5LnNyYyA9IHBOOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZnVuY3Rpb24gZEgoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVQ2ID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVDcgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFUMiA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVQzID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hVDQgPSAwOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFUNSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUFXID0gWzAsIDAsIDAsIDBdOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1UID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUNiA9IGFTLng4KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUNyA9IGFTLng5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFUMiA9IC10aGlzLmFUNjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVQzID0gLXRoaXMuYVQ3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hVDQgPSBoLmkgLyBpSDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYVQ1ID0gaC5qIC8gaUg7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBV1swXSA9IE1hdGguZmxvb3IodGhpcy5hVDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQVdbMV0gPSBNYXRoLmZsb29yKHRoaXMuYVQzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUFXWzJdID0gTWF0aC5mbG9vcih0aGlzLmFBV1swXSArIHRoaXMuYVQ0ICsgMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFBV1szXSA9IE1hdGguZmxvb3IodGhpcy5hQVdbMV0gKyB0aGlzLmFUNSArIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmEuYUFUID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNrKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYTZTOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbHk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZFggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2UyA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBseSA9IDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmlxID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZTID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYWCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVhYKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSBseSA9PT0gMCA/IGJlLmVGICsgMTYgOiBseTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2UyAtPSAoYmUuZUYgLSBseSkgKiAwLjAwMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGE2UyA9IGE2UyA8IDAgPyAwIDogYTZTOw0KICAgICAgICAgICAgICAgICAgICAgICAgbHkgPSBiZS5lRjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJlLmRmID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYTZTID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFYWSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYVhZKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdG8uZmlsbFN0eWxlID0gInJnYmEoMCwwLDAsIiArIGE2UyArICIpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvLmZpbGxSZWN0KDAsIDAsIGguaSwgaC5qKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhNigpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaXplID0gMDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSA9IDA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYUMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oYUMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hQyA9IGFDOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaXplID0gYUMubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hNyA9IGZ1bmN0aW9uKGFYUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kWChuZXcgVWludDhBcnJheSh0aGlzLmFReShhWFMpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hQzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMudEggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYUMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOCA9IGZ1bmN0aW9uKHNpemUsIGE2MCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDID0gdGhpcy5hQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtVSA9IHRoaXMuZTEgKyBzaXplIC0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYUIgPSB0aGlzLmUxOyBhQiA8PSBtVTsgYUIrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDW2FCID4+IDNdIHw9ICgoYTYwID4+IChtVSAtIGFCKSkgJiAxKSA8PCAoNyAtIChhQiAmIDcpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZTEgKz0gc2l6ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmUxID4gOCAqIHRoaXMuc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIldyYXBwZXIgT3ZlcmZsb3ciKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVF4ID0gZnVuY3Rpb24oc2l6ZSwgYTYwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZjAgPSBzaXplID4+IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWogPSAxIDw8IGYwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOChzaXplIC0gZjAsIGJLLmRtKGE2MCwgZWopKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTgoZjAsIGE2MCAlIGVqKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVhaID0gZnVuY3Rpb24oc2l6ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFDID0gdGhpcy5hQzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtVSA9IHRoaXMuZTEgKyBzaXplOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IHRoaXMuZTE7IGFCIDwgbVU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ1thQiA+PiAzXSAmPSAyNTUgXiAoMTI4ID4+PiAoYUIgJiA3KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFReSA9IGZ1bmN0aW9uKGFYUykgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhWFMgKyA3KSA+PiAzOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hWGEgPSBmdW5jdGlvbihnLCBqQywgbVUsIGFYYikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFCOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhQiA9IGpDOyBhQiA8IG1VOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOChhWGIsIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGN4KCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRYID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmcgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZTEgPSAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hUk0gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh0aGlzLmcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hOCA9IGZ1bmN0aW9uKGFYYywgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gdGhpcy5nOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1VID0gdGhpcy5lMSArIGFYYyAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYVhkID0gMSArIChtVSA+PiAzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChnLmxlbmd0aCA8IGFYZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaCgwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGFCID0gdGhpcy5lMTsgYUIgPD0gbVU7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnW2FCID4+IDNdIHw9ICgodmFsdWUgPj4gKG1VIC0gYUIpKSAmIDEpIDw8ICg3IC0gKGFCICYgNykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lMSArPSBhWGM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlID0gZnVuY3Rpb24oZywgdncsIGFYVCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFYZSA9IGI5LnBwLmExbChnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTgodncsIGFYZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYVhlOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOChhWFQsIGdbYUJdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuYVNaID0gZnVuY3Rpb24oZywgdncsIGFYVikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFYZSA9IGI5LnBwLmExbChnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYTgodncsIGFYZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgYVhlOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hU1goZ1thQl0sIGFYVik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmFTWCA9IGZ1bmN0aW9uKHBOLCB2dykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVnID0gcE4ubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOCh2dywgZWcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYUIgPSAwOyBhQiA8IGVnOyBhQisrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hOCgxNiwgcE4uY2hhckNvZGVBdChhQikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIDsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hU1kgPSBmdW5jdGlvbihhMXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwTiA9IGExci50b0RhdGFVUkwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhWGYgPSBwTi5zcGxpdCgiLCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFYZi5sZW5ndGggPCAyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImVycm9yIDI2NiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gYVhmW2FYZi5sZW5ndGggLSAxXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBOID0gYjkuemQuYTNHKHBOLCAiLyIsICJfIik7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiA9IGI5LnpkLmEzRyhwTiwgIlxcKyIsICItIik7DQogICAgICAgICAgICAgICAgICAgICAgICBwTiA9IGI5LnpkLmEzRyhwTiwgIj0iLCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdkYgPSBiRi5yeS52QyhwTik7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWcgPSB2Ri5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4KDMwLCBlZyk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhQiA9IDA7IGFCIDwgZWc7IGFCKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmE4KDYsIHZGW2FCXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGJxLCAxMDAwMCk7DQogICAgICAgICAgICAgICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBicSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICApKCk7DQogICAgICAgIDwvc2NyaXB0Pg0KICAgIDwvYm9keT4NCjwvaHRtbD4NCg==";
