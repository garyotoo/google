window.game = "PCFET0NUWVBFIGh0bWw+DQoNCg0KPCEtLSBVbHRpbWF0ZSBHYW1lIFN0YXNoIGZpbGUtLT4gDQo8IS0tIEZvciB0aGUgcmVndWxhcmx5IHVwZGF0aW5nIGRvYyBnbyB0byBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFfRm1IM0JsU0JRSTdGR2dBUUw1OS1aUGU4ZUN4czM1d2VsNkpVeVZhRzhRLyAtLT4NCg0KDQoJPGh0bWwgbGFuZz0iZW4iPg0KICAgIDxiYXNlIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9idWJibHMvVUdTLUFzc2V0c0BhZTY3MDZlNTIyNGM1NTU5NGM0OTFlZGZjN2Y1YWQ1NDFlMmVhMDJiL2Jhc2ViYWxsJTIwYnJvcy8iIDwvYmFzZT4NCgk8aGVhZD4NCg0KCSAgPG1ldGEgY2hhcnNldD0idXRmLTgiPg0KDQoJICA8dGl0bGU+QkFTRUJBTEwgQlJPUyEgfCBPZmZpY2lhbCBTaXRlPC90aXRsZT4NCgkgIDxtZXRhIG5hbWU9ImRlc2NyaXB0aW9uIiBjb250ZW50PSJPbmxpbmUgbXVsdGlwbGF5ZXIgYmFzZWJhbGwhIFN0cmlrZW91dHMsIHN0ZWFscywgYW5kIGdyYW5kIHNsYW1zISBIaXQgTnVrZXMhIiAvPg0KCSAgPG1ldGEgaWQ9InZpZXdwb3J0IiBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9bm8iIC8+DQoJICA8bGluayByZWw9InNob3J0Y3V0IGljb24iIHR5cGU9ImltYWdlL3BuZyIgaHJlZj0iLi9mYXZpY29uLnBuZyI+DQoJICA8bWV0YSBuYW1lPSJLZXl3b3JkcyIgY29udGVudD0iQmFzZWJhbGwsIFBsYXksIEZyZWUsIE9ubGluZSwgTXVsdGlwbGF5ZXIsIEdhbWVzLCBJTywgU3BvcnRzLCBTY3JvbGxpbmcsIEZyaWVuZHMiPg0KCSAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJCbHVlIFdpemFyZCBEaWdpdGFsIj4NCg0KCSAgPG1ldGEgcHJvcGVydHk9Im9nOnR5cGUiIGNvbnRlbnQ9IndlYnNpdGUiIC8+DQoJICA8bWV0YSBwcm9wZXJ0eT0ib2c6dGl0bGUiIGNvbnRlbnQ9IkJhc2ViYWxsIEJyb3MiIC8+DQoJICA8bWV0YSBwcm9wZXJ0eT0ib2c6ZGVzY3JpcHRpb24iIGNvbnRlbnQ9Ik9ubGluZSBtdWx0aXBsYXllciBiYXNlYmFsbCEgSGl0IGhvbWUgcnVucywgc3RlYWwgYmFzZXMsIHN0cmlrZSBvdXQgdGhlIHNpZGUhIiAvPg0KCSAgPGxpbmsgcmVsPSJtYW5pZmVzdCIgaHJlZj0ibWFuaWZlc3QuanNvbiI+DQoNCg0KCSAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iLi9CYXNlYmFsbEJyb3MuanM/dGg9NzYiPjwvc2NyaXB0Pg0KDQoJICA8c2NyaXB0Pg0KCSAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIiwgZnVuY3Rpb24oZXZlbnQpIHsNCgkgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KCSAgICB9LCB7DQoJICAgICAgY2FwdHVyZTogZmFsc2UsDQoJICAgICAgcGFzc2l2ZTogZmFsc2UNCgkgICAgfSk7DQoJICAgIGlmICh0eXBlb2Ygd2luZG93LmRldmljZVBpeGVsUmF0aW8gIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmRldmljZVBpeGVsUmF0aW8gPiAyKSB7DQoJICAgICAgdmFyIG1ldGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlld3BvcnQiKTsNCgkgICAgICBtZXRhLnNldEF0dHJpYnV0ZSgnY29udGVudCcsICd3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9JyArICgyIC8gd2luZG93LmRldmljZVBpeGVsUmF0aW8pICsgJywgdXNlci1zY2FsYWJsZT1ubycpOw0KCSAgICB9DQoJICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSkgew0KCSAgICAgIGlmICgoZS5rZXlDb2RlID09IDMyIHx8IGUua2V5Q29kZSA9PSAzOCB8fCBlLmtleUNvZGUgPT0gNDAgfHwgZS5rZXlDb2RlID09IDkpICYmIGUudGFyZ2V0ID09IGRvY3VtZW50LmJvZHkpIHsNCgkgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCgkgICAgICB9DQoJICAgIH0pOw0KCSAgICB2YXIgYUNvID0gJ1VTJzsNCgkgIDwvc2NyaXB0Pg0KDQoJICA8c3R5bGU+DQoJICAgIGh0bWwsDQoJICAgIGJvZHkgew0KCSAgICAgIG1hcmdpbjogMDsNCgkgICAgICBwYWRkaW5nOiAwOw0KCSAgICAgIGhlaWdodDogMTAwJTsNCgkgICAgICBiYWNrZ3JvdW5kOiAjMDAwMDAwOw0KCSAgICAgIGNvbG9yOiBvcmFuZ2U7DQoJICAgICAgaGVpZ2h0OiAxMDAlOw0KCSAgICAgIHdpZHRoOiAxMDAlOw0KCSAgICAgIGhlaWdodDogMTAwdmg7DQoJICAgICAgd2lkdGg6IDEwMHZ3Ow0KCSAgICAgIG1hcmdpbjogMDsNCgkgICAgICBwYWRkaW5nOiAwOw0KCSAgICB9DQoNCgkgICAgLmJvZHk6Oi13ZWJraXQtc2Nyb2xsYmFyIHsNCgkgICAgICAvKiBXZWJLaXQgKi8NCgkgICAgICB3aWR0aDogMHB4Ow0KCSAgICB9DQoNCgkgICAgI29wZW5mbC1jb250ZW50IHsNCgkgICAgICBiYWNrZ3JvdW5kOiAjMDAwMDAwOw0KCSAgICAgIHdpZHRoOiAxMDAlOw0KCSAgICAgIGhlaWdodDogMTAwJTsNCgkgICAgfQ0KDQoJICAgICNzcGlubmVyIHsNCgkgICAgICAtd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46IDUwJSA1MCU7DQoJICAgICAgLW1vei10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgNTAlOw0KCSAgICAgIC1vLXRyYW5zZm9ybS1vcmlnaW46IDUwJSA1MCU7DQoJICAgICAgdHJhbnNmb3JtLW9yaWdpbjogNTAlIDUwJTsNCgkgICAgICB3aWR0aDogODJweDsNCgkgICAgICBoZWlnaHQ6IDgxcHg7DQoJICAgICAgLXdlYmtpdC1hbmltYXRpb246IHNwaW4xIDJzIGluZmluaXRlIGxpbmVhcjsNCgkgICAgICAtbW96LWFuaW1hdGlvbjogc3BpbjEgMnMgaW5maW5pdGUgbGluZWFyOw0KCSAgICAgIC1vLWFuaW1hdGlvbjogc3BpbjEgMnMgaW5maW5pdGUgbGluZWFyOw0KCSAgICAgIC1tcy1hbmltYXRpb246IHNwaW4xIDJzIGluZmluaXRlIGxpbmVhcjsNCgkgICAgICBhbmltYXRpb246IHNwaW4xIDJzIGluZmluaXRlIGxpbmVhcjsNCgkgICAgfQ0KDQoNCg0KDQoJICAgIC8qIE1haW4gY29udGVudCBzdHlsaW5nICovDQoJICAgICNtb3JlIHsNCgkgICAgICBkaXNwbGF5OiBmbGV4Ow0KCSAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCgkgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWExYTFhOw0KCSAgICAgIHBhZGRpbmc6IDQwcHg7DQoJICAgICAgYm9yZGVyLXRvcDogMHB4IHNvbGlkICM0NDQ7DQoJICAgICAgY29sb3I6ICNmZmY7DQoJICAgICAgZm9udC1mYW1pbHk6ICdBcmlhbCcsIHNhbnMtc2VyaWY7DQoJICAgIH0NCg0KCSAgICAuaW5mby1ib3ggew0KCSAgICAgIHdpZHRoOiA0OCU7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzIyMjsNCgkgICAgICBwYWRkaW5nOiAyMHB4Ow0KCSAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCgkgICAgICBib3gtc2hhZG93OiAwIDRweCA4cHggcmdiYSgwLCAwLCAwLCAwLjQpOw0KCSAgICB9DQoNCgkgICAgaDMgew0KCSAgICAgIGZvbnQtc2l6ZTogMjRweDsNCgkgICAgICBjb2xvcjogI2ZmYTUwMDsNCgkgICAgICAvKiBCYXNlYmFsbC10aGVtZWQgY29sb3IgKi8NCgkgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KCSAgICB9DQoNCgkgICAgcCwNCgkgICAgYiB7DQoJICAgICAgbGluZS1oZWlnaHQ6IDEuNjsNCgkgICAgICBmb250LXNpemU6IDE2cHg7DQoJICAgIH0NCg0KCSAgICBwIHsNCgkgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KCSAgICB9DQoNCgkgICAgYiB7DQoJICAgICAgY29sb3I6ICNmZmQ3MDA7DQoJICAgICAgLyogSGlnaGxpZ2h0ZWQgcXVlc3Rpb24gY29sb3IgKi8NCgkgICAgfQ0KDQoNCgkgICAgLyogdW52aXNpdGVkIGxpbmsgKi8NCgkgICAgYTpsaW5rIHsNCgkgICAgICBjb2xvcjogI2ZmZDcwMDsNCgkgICAgfQ0KDQoJICAgIC8qIHZpc2l0ZWQgbGluayAqLw0KCSAgICBhOnZpc2l0ZWQgew0KCSAgICAgIGNvbG9yOiAjZmZkNzAwOw0KCSAgICB9DQoNCgkgICAgLyogbW91c2Ugb3ZlciBsaW5rICovDQoJICAgIGE6aG92ZXIgew0KCSAgICAgIGNvbG9yOiAjZmZkNzAwOw0KCSAgICB9DQoNCgkgICAgLyogc2VsZWN0ZWQgbGluayAqLw0KCSAgICBhOmFjdGl2ZSB7DQoJICAgICAgY29sb3I6ICNmZmQ3MDA7DQoJICAgIH0NCg0KCSAgICAubm90Y2gtdG9wLWxlZnQgew0KCSAgICAgIHdpZHRoOiAyMHB4Ow0KCSAgICAgIGhlaWdodDogMjBweDsNCgkgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLWNvbG9yLCAjMWExYTFhKTsNCgkgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQoJICAgICAgdG9wOiAtMTBweDsNCgkgICAgICBsZWZ0OiAtMTBweDsNCgkgICAgICBjbGlwLXBhdGg6IHBvbHlnb24oMTAwJSAwLCAwIDEwMCUsIDEwMCUgMTAwJSk7DQoJICAgIH0NCg0KCSAgICAvKiBGb290ZXIgc3R5bGluZyAqLw0KCSAgICBmb290ZXIgew0KCSAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDA7DQoJICAgICAgcGFkZGluZzogMjBweCAwOw0KCSAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCgkgICAgICBjb2xvcjogI2NjYzsNCgkgICAgICBmb250LXNpemU6IDE0cHg7DQoJICAgICAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICM0NDQ7DQoJICAgICAgbWFyZ2luLXRvcDogNDBweDsNCgkgICAgICBmb250LWZhbWlseTogJ0FyaWFsJywgc2Fucy1zZXJpZjsNCgkgICAgICBib3JkZXI6IDA7DQoJICAgIH0NCg0KCSAgICAuZmVlZGJhY2stZm9ybSB7DQoJICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KCSAgICAgIHRvcDogNTAlOw0KCSAgICAgIGxlZnQ6IDUwJTsNCgkgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsNCgkgICAgICB3aWR0aDogNTB2dzsNCgkgICAgICBoZWlnaHQ6IDUwdmg7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJBNkRCMDsNCgkgICAgICBwYWRkaW5nOiAyMHB4Ow0KCSAgICAgIGJvcmRlcjogNHB4IHNvbGlkICNGRjAwMDA7DQoJICAgICAgYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC41KTsNCgkgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQoJICAgICAgY29sb3I6ICNGRkZGRkY7DQoJICAgIH0NCg0KCSAgICAuZmVlZGJhY2stZm9ybSBoMyB7DQoJICAgICAgZm9udC1zaXplOiAyNHB4Ow0KCSAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQoJICAgICAgY29sb3I6ICNGRkZGRkY7DQoJICAgICAgdGV4dC1zaGFkb3c6IDJweCAycHggIzAwMDAwMDsNCgkgICAgfQ0KDQoJICAgIC5mZWVkYmFjay1mb3JtIHRleHRhcmVhIHsNCgkgICAgICB3aWR0aDogY2FsYygxMDAlIC0gMjBweCk7DQoJICAgICAgaGVpZ2h0OiA1MCU7DQoJICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsNCgkgICAgICBwYWRkaW5nOiAxMHB4Ow0KCSAgICAgIGZvbnQtc2l6ZTogMTZweDsNCgkgICAgICBmb250LWZhbWlseTogJ0NvdXJpZXIgTmV3JywgQ291cmllciwgbW9ub3NwYWNlOw0KCSAgICAgIGJvcmRlcjogM3B4IHNvbGlkICMwMDAwMDA7DQoJICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMDAwMDsNCgkgICAgICAvKiBCbGFjayBiYWNrZ3JvdW5kICovDQoJICAgICAgY29sb3I6ICNGRkZGRkY7DQoJICAgICAgLyogV2hpdGUgdGV4dCAqLw0KCSAgICAgIHJlc2l6ZTogbm9uZTsNCgkgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KCSAgICB9DQoNCgkgICAgLmZlZWRiYWNrLWZvcm0gYnV0dG9uIHsNCgkgICAgICB3aWR0aDogMTAwJTsNCgkgICAgICBwYWRkaW5nOiAxMnB4Ow0KCSAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkQ3MDA7DQoJICAgICAgLyogWWVsbG93aXNoIGJhY2tncm91bmQgKi8NCgkgICAgICBjb2xvcjogIzAwMDAwMDsNCgkgICAgICBib3JkZXI6IDNweCBzb2xpZCAjRkYwMDAwOw0KCSAgICAgIGJvcmRlci1yYWRpdXM6IDA7DQoJICAgICAgZm9udC1zaXplOiAxOHB4Ow0KCSAgICAgIGN1cnNvcjogcG9pbnRlcjsNCgkgICAgICBmb250LWZhbWlseTogJ0NvdXJpZXIgTmV3JywgQ291cmllciwgbW9ub3NwYWNlOw0KCSAgICAgIHRleHQtc2hhZG93OiAxcHggMXB4ICMwMDAwMDA7DQoJICAgIH0NCg0KCSAgICAuZmVlZGJhY2stZm9ybSBidXR0b246aG92ZXIgew0KCSAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkI4MDA7DQoJICAgICAgLyogU2xpZ2h0bHkgZGFya2VyIHllbGxvdyBvbiBob3ZlciAqLw0KCSAgICAgIGNvbG9yOiAjRkZGRkZGOw0KCSAgICB9DQoJICA8L3N0eWxlPg0KDQoJICA8IS0tIEdvb2dsZSB0YWcgKGd0YWcuanMpIC0tPg0KCSAgPHNjcmlwdCBhc3luYyBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9Ry1ENjdFQkZOR1I2Ij48L3NjcmlwdD4NCg0KCSAgPHNjcmlwdD4NCgkgICAgd2luZG93LmRhdGFMYXllciA9IHdpbmRvdy5kYXRhTGF5ZXIgfHwgW107DQoNCgkgICAgZnVuY3Rpb24gZ3RhZygpIHsNCgkgICAgICBkYXRhTGF5ZXIucHVzaChhcmd1bWVudHMpOw0KCSAgICB9DQoJICAgIGd0YWcoJ2pzJywgbmV3IERhdGUoKSk7DQoNCgkgICAgaWYgKGxvY2F0aW9uLmhvc3RuYW1lICE9ICJsb2NhbGhvc3QiKSBndGFnKCdjb25maWcnLCAnRy1ENjdFQkZOR1I2Jywgew0KCSAgICAgIGNvb2tpZV9mbGFnczogJ3NlY3VyZTtzYW1lc2l0ZT1ub25lJw0KCSAgICB9KTsNCgkgIDwvc2NyaXB0Pg0KDQoJICA8c2NyaXB0Pg0KCSAgICAvL0ludGVyc3RpdGlhbCBhZCBhdmFpbGFibGUgZXZlbnQNCgkgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiYWlwX2ludGVyc3RpdGlhbGFkYXZhaWxhYmxlIiwgZnVuY3Rpb24oZSkgew0KCSAgICAgIGNvbnNvbGUubG9nKCJBbiBpbnRlcnN0aXRpYWwgYWQgaXMgYXZhaWxhYmxlIik7DQoJICAgIH0pOw0KCSAgPC9zY3JpcHQ+DQoJICA8c2NyaXB0Pg0KCSAgICBjb25zb2xlLmxvZygiSW5pdHRpbmcgQUlQIikNCgkgICAgd2luZG93LmFpcHRhZyA9IHdpbmRvdy5haXB0YWcgfHwgew0KCSAgICAgIGNtZDogW10NCgkgICAgfTsNCgkgICAgYWlwdGFnLmNtZC5kaXNwbGF5ID0gYWlwdGFnLmNtZC5kaXNwbGF5IHx8IFtdOw0KCSAgICBhaXB0YWcuY21kLnBsYXllciA9IGFpcHRhZy5jbWQucGxheWVyIHx8IFtdOw0KDQoJICAgIC8vQ01QIHRvb2wgc2V0dGluZ3MNCgkgICAgYWlwdGFnLmNvbnNlbnRlZCA9IGZhbHNlOyAvLyBHRFBSIHNldHRpbmcsIHBsZWFzZSBzZXQgdGhpcyB2YWx1ZSB0byBmYWxzZSBpZiBhbiBFVSB1c2VyIGhhcyBkZWNsaW5lZCBvciBub3QgeWV0IGFjY2VwdGVkIG1hcmtldGluZyBjb29raWVzLCBmb3IgdXNlcnMgb3V0c2lkZSB0aGUgRVUgcGxlYXNlIHVzZSB0cnVlIGFuZCBmb3IgdXNlcnMgYWNjZXB0ZWQgdGhlIEdEUFIgYWxzbyB1c2UgdHJ1ZQ0KCSAgICBhaXB0YWcuY21wID0gew0KCSAgICAgIHNob3c6IHRydWUsDQoJICAgICAgcG9zaXRpb246ICJjZW50ZXJlZCIsDQoJICAgICAgYnV0dG9uOiBmYWxzZSwNCgkgICAgICBidXR0b25UZXh0OiAiUHJpdmFjeSBzZXR0aW5ncyIsDQoJICAgICAgYnV0dG9uUG9zaXRpb246ICJib3R0b20tbGVmdCINCgkgICAgfQ0KCSAgPC9zY3JpcHQ+DQoJICA8c2NyaXB0IGFzeW5jIHNyYz0idGFnLm1pbi5qcyI+PC9zY3JpcHQ+DQoNCgkgIDxzY3JpcHQ+DQoJICAgIGZ1bmN0aW9uIFNldHVwTVNOb3RpZmljYXRpb24oKSB7DQoJICAgICAgY29uc29sZS5sb2coIm5vdGlmeWluZyIpOw0KCSAgICAgIGlmICh0eXBlb2YgJG1zc3RhcnQgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygibm90aWZ5aW5nMiIpOw0KCSAgICAgICAgdmFyIGlkID0gYnRvYSgiaHR0cHM6Ly9iYXNlYmFsbGJyb3MuaW8vc2Jyb3NfMzY0eDE4MC5wbmciKTsNCgkgICAgICAgICRtc3N0YXJ0LnNjaGVkdWxlTm90aWZpY2F0aW9uQXN5bmMoew0KCSAgICAgICAgICB0aXRsZTogJ1VubG9jayBuZXcgYnJvcyBub3chJywNCgkgICAgICAgICAgZGVzY3JpcHRpb246ICdZb3UgYXJlIGp1c3QgYWJvdXQgdG8gdW5sb2NrIGEgbmV3IEJybyEgV2hvIHdpbGwgaXQgYmU/JywNCgkgICAgICAgICAgdHlwZTogMSwNCgkgICAgICAgICAgbWluRGVsYXlJblNlY29uZHM6IDI0ICogNjAgKiA2MA0KCSAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCJub3RpZmljYXRpb24gcmVzcG9uc2U6ICIgKyByZXNwb25zZSk7DQoJICAgICAgICB9KTsNCgkgICAgICAgICRtc3N0YXJ0LnNjaGVkdWxlTm90aWZpY2F0aW9uQXN5bmMoew0KCSAgICAgICAgICB0aXRsZTogJ0R1bmsgYWxsIG92ZXIgeW91ciBicm9zIScsDQoJICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTmV3IGJyb3MganVzdCB3YWl0aW5nIHRvIGJlIGR1bmtlZCBvbiEgVW5sb2NrIHRoZW0gbm93IScsDQoJICAgICAgICAgIHR5cGU6IDEsDQoJICAgICAgICAgIG1pbkRlbGF5SW5TZWNvbmRzOiAyNCAqIDcgKiA2MCAqIDYwDQoJICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsNCgkgICAgICAgICAgY29uc29sZS5sb2coIm5vdGlmaWNhdGlvbiByZXNwb25zZTogIiArIHJlc3BvbnNlKTsNCgkgICAgICAgIH0pOw0KDQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgdmFyIG1zQWRJRDsNCg0KCSAgICBmdW5jdGlvbiBMb2FkVmlkZW8oKSB7DQoJICAgICAgaWYgKHR5cGVvZiAkbXNzdGFydCAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgICRtc3N0YXJ0LmxvYWRBZHNBc3luYygpLnRoZW4oYWRJbnN0YW5jZSA9PiB7DQoJICAgICAgICAgIC8vIFVzZSB0aGUgYWRJbnN0YW5jZS5pbnN0YW5jZUlkIHRvIG1ha2UgYSBjYWxsIHRvIHNob3dBZHNBc3luYw0KCSAgICAgICAgICBtc0FkSUQgPSBhZEluc3RhbmNlLmluc3RhbmNlSWQ7DQoJICAgICAgICB9KTsNCg0KCSAgICAgICAgU2V0dXBNU05vdGlmaWNhdGlvbigpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dWaWRlbyh0aGVVbml0TmFtZSA9IG51bGwpIHsNCgkgICAgICBNYWluLkRvbmVWaWRlb0FkKHRydWUpOw0KCSAgICAgIHJldHVybjsgLy8hIHdoZW4gYWlwIGlzIGxpdmUsIHJlbW92ZSB0aGlzDQoNCgkgICAgICBjb25zb2xlLmxvZygnU0hPV19WSURFTzonICsgdGhlVW5pdE5hbWUpOw0KCSAgICAgIHZhciBhVW5pdE5hbWUgPSAiIjsNCgkgICAgICBpZiAodHlwZW9mICRtc3N0YXJ0ICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgJG1zc3RhcnQuc2hvd0Fkc0FzeW5jKG1zQWRJRCkudGhlbihhZEluc3RhbmNlID0+IHsNCgkgICAgICAgICAgLy8gVXNlIHRoZSBhZEluc3RhbmNlLnNob3dBZHNDb21wbGV0ZWRBc3luYyB0byBiZSBub3RpZmllZCBvZiB0aGUgY29tcGxldGlvbiBvZiBzaG93aW5nIHRoZSBhZHZlcnRpc2VtZW50DQoJICAgICAgICAgIGFkSW5zdGFuY2Uuc2hvd0Fkc0NvbXBsZXRlZEFzeW5jLnRoZW4oKHZhbCkgPT4gew0KCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNUyBWaWRlbyBBZCBDb21wbGV0ZScpOw0KCSAgICAgICAgICAgIE1haW4uRG9uZVZpZGVvQWQoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgICAgICAgICBMb2FkVmlkZW8oKTsNCgkgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4gew0KCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNcyBWaWRlbyBBZCBFcnJvcicpOw0KCSAgICAgICAgICAgIE1haW4uRG9uZVZpZGVvQWQoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTsNCgkgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgICAgICAgICBMb2FkVmlkZW8oKTsNCgkgICAgICAgICAgfSk7DQoJICAgICAgICB9KTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBnQ3JhenlTREsuYWRkRXZlbnRMaXN0ZW5lcigiYWRGaW5pc2hlZCIsIE1haW4uRG9uZVZpZGVvQWQpOyAvLyByZWVuYWJsZSBzb3VuZCwgZW5hYmxlIHVpDQoJICAgICAgICBnQ3JhenlTREsuYWRkRXZlbnRMaXN0ZW5lcigiYWRFcnJvciIsIE1haW4uRG9uZVZpZGVvQWQpOyAvLyByZWVuYWJsZSBzb3VuZCwgZW5hYmxlIHVpDQoJICAgICAgICBnQ3JhenlTREsucmVxdWVzdEFkKCk7DQoJICAgICAgICBjb25zb2xlLmxvZygnQ0dfQURfUkVRVUVTVEVEJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2NndmlkZW8nKTsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhZHBsYXllciA9PT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIE1haW4uRG9uZVZpZGVvQWQodHJ1ZSk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3ZpZGVvX2FkYmxvY2tlZCcpOw0KCSAgICAgICAgY29uc29sZS5sb2coJ1ZJREVPX0FEQkxPQ0tFRCcpOw0KDQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIHZhciBhU3RyID0gJ3ByZXJvbGwnOw0KCSAgICAgICAgLy9pZih0aGVVbml0TmFtZSAhPSBudWxsKSBhU3RyID0gdGhlVW5pdE5hbWU7DQoJICAgICAgICBsYXN0VW5pdFBsYXllZCA9IGFTdHI7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3N0YXJ0dmlkZW8tJyArIGFTdHIpOw0KDQoJICAgICAgICBhaXB0YWcuY21kLnBsYXllci5wdXNoKGZ1bmN0aW9uKCkgew0KCSAgICAgICAgICBhZHBsYXllci5zdGFydFZpZGVvQWQodGhlVW5pdE5hbWUpOw0KCSAgICAgICAgfSk7DQoJICAgICAgfQ0KCSAgICB9DQoJICA8L3NjcmlwdD4NCg0KCSAgPCEtLSBGaXJlYmFzZSBBcHAgKHRoZSBjb3JlIEZpcmViYXNlIFNESykgLS0+DQoJICA8c2NyaXB0IHNyYz0iZmlyZWJhc2UtYXBwLmpzIj48L3NjcmlwdD4NCgkgIDwhLS0gRmlyZWJhc2UgQXV0aGVudGljYXRpb24gLS0+DQoJICA8c2NyaXB0IHNyYz0iZmlyZWJhc2UtYXV0aC5qcyI+PC9zY3JpcHQ+DQoJICA8IS0tIEZpcmViYXNlIEZpcmVzdG9yZSAoRGF0YWJhc2UpIC0tPg0KCSAgPHNjcmlwdCBzcmM9ImZpcmViYXNlLWZpcmVzdG9yZS5qcyI+PC9zY3JpcHQ+DQoNCgkgIDxzY3JpcHQ+DQoJICAgIC8vIFlvdXIgd2ViIGFwcCdzIEZpcmViYXNlIGNvbmZpZ3VyYXRpb24NCgkgICAgY29uc3QgZmlyZWJhc2VDb25maWcgPSB7DQoJICAgICAgYXBpS2V5OiAiQUl6YVN5QnV6ajhYRVA3LTVrT0ZGaHl1eHlsUTZQMEIyR19vZ3NNIiwNCgkgICAgICBhdXRoRG9tYWluOiAiYmFzZWJhbGwtYnJvcy04ZGQ3Zi5maXJlYmFzZWFwcC5jb20iLA0KCSAgICAgIHByb2plY3RJZDogImJhc2ViYWxsLWJyb3MtOGRkN2YiLA0KCSAgICAgIHN0b3JhZ2VCdWNrZXQ6ICJiYXNlYmFsbC1icm9zLThkZDdmLmZpcmViYXNlc3RvcmFnZS5hcHAiLA0KCSAgICAgIG1lc3NhZ2luZ1NlbmRlcklkOiAiNjE4MDI0NTE2MjE4IiwNCgkgICAgICBhcHBJZDogIjE6NjE4MDI0NTE2MjE4OndlYjoxMWVmZmYyZDRiMDkyYWVmYWY5OWMzIg0KCSAgICB9Ow0KDQoNCgkgICAgLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZQ0KCSAgICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTsNCgkgICAgY29uc3QgYXV0aCA9IGZpcmViYXNlLmF1dGgoKTsNCgkgICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTsNCgkgICAgdmFyIHVzZXJEYXRhID0gIiI7DQoNCgkgICAgZnVuY3Rpb24gdHJpZ2dlclNpZ25JbigpIHsNCgkgICAgICB2YXIgcHJvdmlkZXIgPSBuZXcgZmlyZWJhc2UuYXV0aC5Hb29nbGVBdXRoUHJvdmlkZXIoKTsNCgkgICAgICBhdXRoLnNpZ25JbldpdGhQb3B1cChwcm92aWRlcik7DQoJICAgIH0NCg0KCSAgICAvLyBTYXZlIGdhbWUgZGF0YSBmdW5jdGlvbg0KCSAgICBmdW5jdGlvbiBzYXZlR2FtZURhdGEoZ2FtZURhdGEpIHsNCgkgICAgICBjb25zb2xlLmxvZygnc2F2aW5nIGdhbWVkYXRhOicgKyBnYW1lRGF0YSk7DQoJICAgICAgdmFyIHVzZXJJZCA9IGF1dGguY3VycmVudFVzZXIudWlkOw0KCSAgICAgIHVzZXJEYXRhID0gZ2FtZURhdGE7DQoJICAgICAgZGIuY29sbGVjdGlvbigndXNlcnMnKS5kb2ModXNlcklkKS5zZXQoew0KCSAgICAgICAgZ2FtZURhdGE6IGdhbWVEYXRhDQoJICAgICAgfSkudGhlbihmdW5jdGlvbigpIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdHYW1lIGRhdGEgc2F2ZWQnKTsNCgkgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikgew0KCSAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIGdhbWUgZGF0YTonLCBlcnJvcik7DQoJICAgICAgfSk7DQoJICAgIH0NCg0KCSAgICAvLyBMb2FkIGdhbWUgZGF0YSBmdW5jdGlvbg0KCSAgICBmdW5jdGlvbiBsb2FkR2FtZURhdGEoKSB7DQoJICAgICAgcmV0dXJuIHVzZXJEYXRhOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gbG9hZEdhbWVEYXRhQXN5bmMoKSB7DQoJICAgICAgdmFyIHVzZXJJZCA9IGF1dGguY3VycmVudFVzZXIudWlkOw0KCSAgICAgIGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZG9jKHVzZXJJZCkuZ2V0KCkudGhlbihmdW5jdGlvbihkb2MpIHsNCgkgICAgICAgIGlmIChkb2MuZXhpc3RzKSB7DQoJICAgICAgICAgIHVzZXJEYXRhID0gZG9jLmRhdGEoKS5nYW1lRGF0YTsNCgkgICAgICAgICAgLy9NYWluLkxvYWRHbG9iYWxzKCk7DQoJICAgICAgICAgIGNvbnNvbGUubG9nKCdHYW1lIGRhdGE6JywgZG9jLmRhdGEoKS5nYW1lRGF0YSk7DQoJICAgICAgICAgIGlmICh0eXBlb2YgTWFpbiAhPSAidW5kZWZpbmVkIikgew0KCSAgICAgICAgICAgIE1haW4uTG9hZERhdGFDb21wbGV0ZSgpOw0KCSAgICAgICAgICB9DQoJICAgICAgICAgIC8vIFVzZSB0aGUgZ2FtZSBkYXRhIGluIHlvdXIgZ2FtZQ0KCSAgICAgICAgfSBlbHNlIHsNCgkgICAgICAgICAgY29uc29sZS5sb2coJ05vIHN1Y2ggZG9jdW1lbnQhJyk7DQoJICAgICAgICB9DQoJICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsNCgkgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgZ2FtZSBkYXRhOicsIGVycm9yKTsNCgkgICAgICB9KTsNCgkgICAgfQ0KDQoJICAgIC8vIEZpcmViYXNlIGF1dGggc3RhdGUgb2JzZXJ2ZXINCgkgICAgYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZWQoZnVuY3Rpb24odXNlcikgew0KCSAgICAgIGlmICh1c2VyKSB7DQoJICAgICAgICBsb2FkR2FtZURhdGFBc3luYygpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdzaWduX2luJyk7DQoJICAgICAgICBjb25zb2xlLmxvZygndXNlciBzaWduZWQgaW4nKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgY29uc29sZS5sb2coJ05vIHVzZXIgc2lnbmVkIGluJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3NpZ25fb3V0Jyk7DQoJICAgICAgfQ0KCSAgICB9KTsNCg0KCSAgICBmdW5jdGlvbiBzaWduT3V0KCkgew0KCSAgICAgIGF1dGguc2lnbk91dCgpLnRoZW4oKCkgPT4gew0KCSAgICAgICAgTWFpbi5TaWduT3V0Q29tcGxldGUoKTsNCgkgICAgICAgIGNvbnNvbGUubG9nKCdzaWduZWQgb3V0Jyk7DQoJICAgICAgfSk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBpc1VzZXJMb2dnZWRJbigpIHsNCgkgICAgICByZXR1cm4gYXV0aC5jdXJyZW50VXNlciAhPT0gbnVsbDsNCgkgICAgfQ0KCSAgPC9zY3JpcHQ+DQoNCgk8L2hlYWQ+DQoNCgk8Ym9keSBzdHlsZT0ib3ZlcmZsb3c6aGlkZGVuOyI+DQoJICA8bm9zY3JpcHQ+RW5hYmxlIEphdmFTY3JpcHQgYnJvITwvbm9zY3JpcHQ+DQoJICA8c2NyaXB0Pg0KCSAgICAvL2FsZXJ0KCJHbG9iYWxzOiIrbG9jYWxTdG9yYWdlLmdldEl0ZW0oIi86R2xvYmFscyIpLmxlbmd0aCk7DQoJICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KCSAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KCSAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7DQoJICAgIGlmICh1cmwuaW5jbHVkZXMoInd3dy4iKSkgew0KCSAgICAgIHVybCA9IHVybC5yZXBsYWNlKCJ3d3cuIiwgIiIpOw0KDQoJICAgICAgdmFyIGYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7DQoJICAgICAgZi5hY3Rpb24gPSB1cmw7DQoJICAgICAgZi5tZXRob2QgPSAnUE9TVCc7DQoJICAgICAgdmFyIGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KCSAgICAgIGkudHlwZSA9ICdoaWRkZW4nOw0KCSAgICAgIGkubmFtZSA9ICdGR2xvYmFscyc7DQoJICAgICAgaS52YWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCIvOkdsb2JhbHMiKTsNCgkgICAgICBmLmFwcGVuZENoaWxkKGkpOw0KDQoJICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmKTsNCgkgICAgICBmLnN1Ym1pdCgpOw0KCSAgICB9IGVsc2Ugew0KCSAgICAgIHZhciBhUG9zdCA9ICIiOw0KCSAgICAgIHZhciBhU3RvcmFnZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCIvOkdsb2JhbHMiKTsNCgkgICAgICB2YXIgYUxlbiA9IDA7DQoJICAgICAgaWYgKGFTdG9yYWdlICE9IG51bGwgJiYgYVN0b3JhZ2UubGVuZ3RoID4gMCkgew0KCSAgICAgICAgYUxlbiA9IGFTdG9yYWdlLmxlbmd0aDsNCgkgICAgICB9DQoJICAgICAgaWYgKGFQb3N0Lmxlbmd0aCA+IGFMZW4pIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCIvOkdsb2JhbHMiLCBhUG9zdCk7DQoJICAgICAgaWYgKGFQb3N0Lmxlbmd0aCA+IDAgJiYgYVBvc3QubGVuZ3RoID09IGFMZW4pIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCIvOkdsb2JhbHMiLCBhUG9zdCk7DQoJICAgIH0NCgkgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoJICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoJICA8L3NjcmlwdD4NCg0KCSAgPGRpdiBpZD0ibG9hZGluZyIgc3R5bGU9InBvc2l0aW9uOiBhYnNvbHV0ZTsgei1pbmRleDogMTU7IHRvcDogNjAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIDApOyBiYWNrZ3JvdW5kOiBibGFjazsiPg0KCSAgICA8Y2VudGVyPjxpbWcgc3JjPSJhc3NldHMvbG9hZGluZzQucG5nIj48YnIgLz4NCgkgICAgICA8aW1nIHNyYz0iYXNzZXRzL2Zicm8ucG5nIj4NCgkgICAgICA8aW1nIHNyYz0iYXNzZXRzL2JiYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9zYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy93YnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9rYnJvLnBuZyI+DQoJICAgICAgPGltZyBzcmM9ImFzc2V0cy9iYnJvLnBuZyI+DQoJICAgIDwvY2VudGVyPg0KCSAgPC9kaXY+DQoNCgkgIDxkaXYgaWQ9ImdhbWUyIiBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgIj4NCgkgICAgPGRpdiBpZD0ib3BlbmZsLWNvbnRlbnQiIG9uYmx1cj0id2luZG93LmZvY3VzKCk7IHdpbmRvdy5zY3JvbGxUbygwLCAwKTsiIHN0eWxlPSJ3aWR0aDogY2FsYygxMDAlKTsgZmxvYXQ6bGVmdDsiPg0KCSAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4NCgkgICAgICAgIGxpbWUuZW1iZWQoIkJhc2ViYWxsQnJvcyIsICJvcGVuZmwtY29udGVudCIsIDAsIDAsIHsNCgkgICAgICAgICAgcGFyYW1ldGVyczoge30NCgkgICAgICAgIH0pOw0KCSAgICAgIDwvc2NyaXB0Pg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0icHJlcm9sbCIgc3R5bGU9IndpZHRoOiA5NjBweDsgaGVpZ2h0OiA1NDBweDsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDUwJTsgbGVmdDogNTAlOyB6LWluZGV4OiAxMDA7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOyI+DQoJICAgIDwvZGl2Pg0KDQoJICAgIDxkaXYgaWQ9ImJhc2ViYWxsYnJvcy1pb18zMDB4MjUwIiBzdHlsZT0id2lkdGg6IDMzNnB4OyBoZWlnaHQ6IDI4MHB4OyB2aXNpYmlsaXR5OmhpZGRlbjsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDMwcHg7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgICAgPHNjcmlwdD4NCgkgICAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLID09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICAgIGFpcHRhZy5jbWQuZGlzcGxheS5wdXNoKGZ1bmN0aW9uKCkgew0KCSAgICAgICAgICAgIGFpcERpc3BsYXlUYWcuZGlzcGxheSgnYmFzZWJhbGxicm9zLWlvXzMwMHgyNTAnKTsNCgkgICAgICAgICAgfSk7DQoJICAgICAgICB9DQoJICAgICAgPC9zY3JpcHQ+DQoJICAgIDwvZGl2Pg0KCSAgICA8ZGl2IGlkPSJiYXNlYmFsbGJyb3MtaW9fMzAweDI1MF8yIiBzdHlsZT0id2lkdGg6IDMzNnB4OyBoZWlnaHQ6IDI4MHB4OyB2aXNpYmlsaXR5OmhpZGRlbjsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDMwcHg7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDtvdmVyZmxvdzogaGlkZGVuOyI+DQoJICAgICAgPHNjcmlwdD4NCgkgICAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLID09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICAgIGFpcHRhZy5jbWQuZGlzcGxheS5wdXNoKGZ1bmN0aW9uKCkgew0KCSAgICAgICAgICAgIGFpcERpc3BsYXlUYWcuZGlzcGxheSgnYmFzZWJhbGxicm9zLWlvXzMwMHgyNTBfMicpOw0KCSAgICAgICAgICB9KTsNCgkgICAgICAgIH0NCgkgICAgICA8L3NjcmlwdD4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9ImJhc2ViYWxsYnJvcy1pb18zMzZ4MjgwIiBzdHlsZT0idmlzaWJpbGl0eTpoaWRkZW47IHdpZHRoOiAzMzZweDsgaGVpZ2h0OiA2MDBweDsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0iYmFzZWJhbGxicm9zLWlvXzMzNngyODBfMiIgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuOyB3aWR0aDogMzM2cHg7IGhlaWdodDogNjAwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogMzBweDsgei1pbmRleDogMTAwO292ZXJmbG93OiBoaWRkZW47Ij4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9ImJhc2ViYWxsYnJvcy1pb183Mjh4OTAiIHN0eWxlPSJ2aXNpYmlsaXR5OmhpZGRlbjsgd2lkdGg6IDcyOHB4OyBoZWlnaHQ6IDkwcHg7IGRpc3BsYXk6IG5vbmU7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAzMHB4OyBsZWZ0OiAzMHB4OyB6LWluZGV4OiAxMDA7b3ZlcmZsb3c6IGhpZGRlbjsiPg0KCSAgICA8L2Rpdj4NCgkgICAgPGRpdiBpZD0iYmFzZWJhbGxicm9zLWlvXzcyOHg5MF9tIiBzdHlsZT0idmlzaWJpbGl0eTpoaWRkZW47IHdpZHRoOiA3MjhweDsgaGVpZ2h0OiA5MHB4OyBkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMzBweDsgbGVmdDogMzBweDsgei1pbmRleDogMTAwO292ZXJmbG93OiBoaWRkZW47Ij4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgaWQ9ImJhc2ViYWxsYnJvcy1pb185NzB4MjUwIiBzdHlsZT0idmlzaWJpbGl0eTpoaWRkZW47IHdpZHRoOiA5NzBweDsgaGVpZ2h0OiAyNTBweDsgZGlzcGxheTogbm9uZTsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDMwcHg7IGxlZnQ6IDMwcHg7IHotaW5kZXg6IDEwMDsgdGV4dC1hbGlnbjogY2VudGVyO292ZXJmbG93OiBoaWRkZW47Ij4NCgkgICAgPC9kaXY+DQoNCgkgICAgPGRpdiBjbGFzcz0iZmVlZGJhY2stZm9ybSIgaWQ9ImZlZWRiYWNrRm9ybSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KCSAgICAgIDxoMz5SZXBvcnQgYSBCdWcvR2xpdGNoPC9oMz4NCgkgICAgICA8dGV4dGFyZWEgaWQ9ImZlZWRiYWNrIiBwbGFjZWhvbGRlcj0iRGVzY3JpYmUgdGhlIGJ1ZyBvciBnbGl0Y2ggd2l0aCBhIGxvdCBvZiBkZXRhaWxzLCBsaWtlIGhvdyB0byBtYWtlIHRoZSBnbGl0Y2ggaGFwcGVuIGFuZCBhbnl0aGluZyBlbHNlIHdoZXRoZXIgaXQgc2VlbXMgdXNlZnVsIG9yIG5vdC4uLiI+PC90ZXh0YXJlYT4NCgkgICAgICA8dGV4dGFyZWEgaWQ9ImVtYWlsIiBwbGFjZWhvbGRlcj0iRW1haWwgYWRkcmVzcyAob3B0aW9uYWwpIiBzdHlsZT0iaGVpZ2h0OiA1MHB4OyI+PC90ZXh0YXJlYT4NCgkgICAgICA8dGV4dGFyZWEgaWQ9ImRpc2NvcmQiIHBsYWNlaG9sZGVyPSJEaXNjb3JkIElEIChvcHRpb25hbCkiIHN0eWxlPSJoZWlnaHQ6IDUwcHg7Ij48L3RleHRhcmVhPg0KCSAgICAgIDxidXR0b24gb25jbGljaz0ic2VuZEZlZWRiYWNrKCkiIGlkPSJzdWJtaXRCdG4iPlN1Ym1pdCBGZWVkYmFjazwvYnV0dG9uPg0KCSAgICAgIDxiciAvPg0KCSAgICAgIDxiciAvPg0KCSAgICAgIDxidXR0b24gb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZlZWRiYWNrRm9ybScpLnN0eWxlLmRpc3BsYXk9J25vbmUnIiBpZD0ic3VibWl0QnRuIj5DYW5jZWw8L2J1dHRvbj4NCgkgICAgICA8cCBpZD0icmVzcG9uc2VNc2ciPjwvcD4NCgkgICAgPC9kaXY+DQoJICAgIDxzY3JpcHQ+DQoJICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb0ZlZWRiYWNrID0gdHJ1ZTsNCgkgICAgICBmdW5jdGlvbiBnZXRPU0Zyb21Vc2VyQWdlbnQoKSB7DQoJICAgICAgICBjb25zdCB1c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50Ow0KCSAgICAgICAgY29uc3QgcGxhdGZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm07DQoNCgkgICAgICAgIC8vIENoZWNrIGZvciBjb21tb24gcGxhdGZvcm1zIGFuZCBPUw0KCSAgICAgICAgaWYgKC9XaW5kb3dzIE5UL2kudGVzdCh1c2VyQWdlbnQpKSByZXR1cm4gJ1dpbmRvd3MnOw0KCSAgICAgICAgaWYgKC9NYWMgT1MgWC9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdtYWNPUyc7DQoJICAgICAgICBpZiAoL0xpbnV4L2kudGVzdCh1c2VyQWdlbnQpKSByZXR1cm4gJ0xpbnV4JzsNCgkgICAgICAgIGlmICgvQW5kcm9pZC9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdBbmRyb2lkJzsNCgkgICAgICAgIGlmICgvaVBob25lfGlQYWR8aVBvZC9pLnRlc3QodXNlckFnZW50KSkgcmV0dXJuICdpT1MnOw0KCSAgICAgICAgaWYgKC9Dck9TL2kudGVzdCh1c2VyQWdlbnQpKSByZXR1cm4gJ0Nocm9tZSBPUyc7DQoNCgkgICAgICAgIC8vIERlZmF1bHQgdG8gdGhlIHBsYXRmb3JtIGlmIG5vIG1hdGNoDQoJICAgICAgICByZXR1cm4gcGxhdGZvcm0gfHwgJ1Vua25vd24nOw0KCSAgICAgIH0NCgkgICAgICBhc3luYyBmdW5jdGlvbiBzZW5kRmVlZGJhY2soKSB7DQoJICAgICAgICB2YXIgZmVlZGJhY2sgPSAnKicgKyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmVlZGJhY2siKS52YWx1ZS50cmltKCkgKyAnKic7DQoJICAgICAgICB2YXIgZW1haWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZW1haWwiKS52YWx1ZS50cmltKCk7DQoJICAgICAgICB2YXIgZGlzY29yZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkaXNjb3JkIikudmFsdWUudHJpbSgpOw0KCSAgICAgICAgY29uc3Qgc2NyZWVuUmVzb2x1dGlvbiA9IGAke3dpbmRvdy5zY3JlZW4ud2lkdGh9eCR7d2luZG93LnNjcmVlbi5oZWlnaHR9YDsNCgkgICAgICAgIGNvbnN0IHdpbmRvd1Jlc29sdXRpb24gPSBgJHt3aW5kb3cuaW5uZXJXaWR0aH14JHt3aW5kb3cuaW5uZXJIZWlnaHR9YDsNCgkgICAgICAgIHZhciBhT1MgPSBnZXRPU0Zyb21Vc2VyQWdlbnQoKTsNCgkgICAgICAgIHZhciBhQ2l0eSA9ICdVbmtub3duJzsNCgkgICAgICAgIGNvbnN0IGhvc3RuYW1lID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lOw0KCSAgICAgICAgY29uc3QgZ3B1ID0gKCgpID0+IHsNCgkgICAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7DQoJICAgICAgICAgIGNvbnN0IGdsID0gY2FudmFzLmdldENvbnRleHQoJ3dlYmdsJykgfHwgY2FudmFzLmdldENvbnRleHQoJ2V4cGVyaW1lbnRhbC13ZWJnbCcpOw0KCSAgICAgICAgICBjb25zdCBkZWJ1Z0luZm8gPSBnbD8uZ2V0RXh0ZW5zaW9uKCdXRUJHTF9kZWJ1Z19yZW5kZXJlcl9pbmZvJyk7DQoJICAgICAgICAgIGNvbnN0IGdwdUluZm8gPSBkZWJ1Z0luZm8gPyBnbC5nZXRQYXJhbWV0ZXIoZGVidWdJbmZvLlVOTUFTS0VEX1JFTkRFUkVSX1dFQkdMKSA6ICdVbmtub3duJzsNCg0KCSAgICAgICAgICAvLyBDbGVhbnVwDQoJICAgICAgICAgIGNhbnZhcy5yZW1vdmUoKTsgLy8gUmVtb3ZlIHRoZSBjYW52YXMgZnJvbSB0aGUgRE9NIChpZiBpdCB3YXMgYWRkZWQpDQoJICAgICAgICAgIHJldHVybiBncHVJbmZvOw0KCSAgICAgICAgfSkoKTsNCg0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICdcbkRvbWFpbjogJyArIGhvc3RuYW1lOw0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIE9TOiAnICsgYU9TOw0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIFNjcmVlbiByZXM6ICcgKyBzY3JlZW5SZXNvbHV0aW9uOw0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIFdpbmRvdyByZXM6ICcgKyB3aW5kb3dSZXNvbHV0aW9uOw0KCSAgICAgICAgZmVlZGJhY2sgPSBmZWVkYmFjayArICcsIEdQVTogJyArIGdwdTsNCgkgICAgICAgIGZlZWRiYWNrID0gZmVlZGJhY2sgKyAnLCBDaXR5OiAnICsgYUNpdHk7DQoJICAgICAgICBmZWVkYmFjayA9IGZlZWRiYWNrICsgJywgRW1haWw6ICcgKyBlbWFpbDsNCgkgICAgICAgIGZlZWRiYWNrID0gZmVlZGJhY2sgKyAnLCBEaXNjb3JkOiAnICsgZGlzY29yZDsNCg0KCSAgICAgICAgY29uc3QgcmVzcG9uc2VNc2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzcG9uc2VNc2ciKTsNCgkgICAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdWJtaXRCdG4iKTsNCg0KCSAgICAgICAgaWYgKCFmZWVkYmFjaykgew0KCSAgICAgICAgICBhbGVydCgiUGxlYXNlIGVudGVyIGZlZWRiYWNrLiIpOw0KCSAgICAgICAgICByZXR1cm47DQoJICAgICAgICB9DQoNCgkgICAgICAgIHN1Ym1pdEJ0bi5kaXNhYmxlZCA9IHRydWU7DQoJICAgICAgICByZXNwb25zZU1zZy50ZXh0Q29udGVudCA9ICJTdWJtaXR0aW5nLi4uIjsNCg0KCSAgICAgICAgdHJ5IHsNCgkgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgic2VuZEZlZWRiYWNrLnBocCIsIHsNCgkgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCgkgICAgICAgICAgICBoZWFkZXJzOiB7DQoJICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCINCgkgICAgICAgICAgICB9LA0KCSAgICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoew0KCSAgICAgICAgICAgICAgZmVlZGJhY2s6IGZlZWRiYWNrDQoJICAgICAgICAgICAgfSkNCgkgICAgICAgICAgfSk7DQoNCgkgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOw0KDQoJICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAic3VjY2VzcyIpIHsNCgkgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmVlZGJhY2tGb3JtIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsgLy8gQ2xvc2UgdGhlIGZlZWRiYWNrIGZvcm0NCgkgICAgICAgICAgICBhbGVydChyZXN1bHQubWVzc2FnZSk7IC8vIFNob3cgc3VjY2VzcyBtZXNzYWdlDQoJICAgICAgICAgIH0gZWxzZSB7DQoJICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlZWRiYWNrRm9ybSIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7IC8vIENsb3NlIHRoZSBmZWVkYmFjayBmb3JtDQoJICAgICAgICAgICAgYWxlcnQocmVzdWx0Lm1lc3NhZ2UpOyAvLyBTaG93IGVycm9yIG1lc3NhZ2UNCgkgICAgICAgICAgfQ0KCSAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCgkgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZlZWRiYWNrRm9ybSIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7IC8vIENsb3NlIHRoZSBmZWVkYmFjayBmb3JtDQoJICAgICAgICAgIGFsZXJ0KCJFcnJvciBzdWJtaXR0aW5nIGZlZWRiYWNrLiBQbGVhc2UgdHJ5IGFnYWluLiIpOw0KCSAgICAgICAgfQ0KDQoJICAgICAgICBzdWJtaXRCdG4uZGlzYWJsZWQgPSBmYWxzZTsNCgkgICAgICB9DQoJICAgIDwvc2NyaXB0Pg0KDQoNCg0KCSAgPC9kaXY+DQoJICA8YnIgLz4NCgkgIDxkaXYgdGFiaW5kZXg9Ii0xIiBpZD0ibW9yZSI+DQoJICAgIDxkaXYgY2xhc3M9ImluZm8tYm94Ij4NCgkgICAgICA8aDM+QWJvdXQgQmFzZWJhbGwgQnJvczwvaDM+DQoJICAgICAgPHA+QmFzZWJhbGwgQnJvcyBpcyBhIHNpbXBsZSwgZmFzdC1wYWNlZCBiYXNlYmFsbCBnYW1lIHRoYXQncyBlYXN5IHRvIGxlYXJuIGFuZCBoYXMgbG90cyBvZiBjcmF6eSBoaWppbmtzISBXaXRoIG9ubGluZSBtdWx0aXBsYXllciBnYW1lcGxheSwgZnJhbmNoaXNlIG1vZGUsIGZ1biBwaXRjaGluZywgYW5kIHNvIG11Y2ggbW9yZSE8L3A+DQoJICAgICAgPHA+Q29udHJvbHM6IFVzZSBlaXRoZXIgdGhlIGFycm93IGtleXMgb3IgV0FTRCB0byBjb250cm9sIHlvdXIgYnJvLiBTcGFjZSBiYXIgd2lsbCB0aHJvdyBhIHRoZSBiYWxsLCBkaXZlLCBzbGlkZSwgb3IgY2hhbmdlIGRpcmVjdGlvbnMgd2hlbiB5b3UncmUgcnVubmluZyB0aGUgYmFzZXMuPC9wPg0KCSAgICAgIDxwPkJlIHN1cmUgdG8gZm9sbG93IHVzIG9uIHNvY2lhbCBtZWRpYSBmb3IgdGhlIGxhdGVzdCB1cGRhdGVzIGFuZCBpbmZvITwvcD4NCgkgICAgICA8YnIgLz4NCgkgICAgICA8aDM+Q2hhbmdlbG9nICgzLzEzLzIwMjQpPC9oMz4NCgkgICAgICA8cD5GaXhlZCBhbm90aGVyIGdsaXRjaCB3aGVyZSB0aGUgZ2FtZSBlbmRzIHRvIGVhcmx5IGlmIHRoZSBob21lIHRlYW0gc2NvcmVzIG9uIHRoZWlyIGxhc3QgYXQgYmF0IHdoaWxlIHN0aWxsIGxvc2luZy48L3A+DQoJICAgICAgPHA+TWFkZSBjcHUgcGxheWVycyBiZXR0ZXIgYXQgY2F0Y2hpbmcgZmx5IGJhbGxzLiBTaG91bGQgbWFrZSBpdCBtb3JlIGRpZmZpY3VsdCBpbiAxcCBnYW1lcy48L3A+DQoJICAgICAgPHA+VXBkYXRlZCB0aGVtZSBzb25nLjwvcD4NCgkgICAgICA8cD5GaXhlZCBtb3JlIGlubmluZ3MgZ2xpdGNoZXMuPC9wPg0KCSAgICAgIDxwPkZpeGVkIGdsaXRjaCB3aGVyZSBob21lIHRlYW0gd291bGRuJ3QgZ2V0IHRoZWlyIGZhaXIgYXQgYmF0IGluIGV4dHJhIGlubmluZ3MuPC9wPg0KCSAgICAgIDxwPkltcHJvdmVkIHZpcnR1YWwgY29udHJvbGxlciBvbiBpUGFkcyBhbmQgcG5vbmVzLjwvcD4NCgkgICAgPC9kaXY+DQoJICAgIDxkaXYgY2xhc3M9ImluZm8tYm94Ij4NCgkgICAgICA8aDM+RkFRPC9oMz4NCgkgICAgICA8Yj5XaHkgaXNuJ3QgdGhlIGdhbWUgbG9hZGluZz88L2I+DQoJICAgICAgPHA+WW91IHNob3VsZCBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIG1ha2Ugc3VyZSBvdXIgc2l0ZSBpc24ndCBibG9ja2VkLiBBbHNvLCBkaXNhYmxlIGFsbCBhZCBibG9ja2Vycy48L3A+DQoJICAgICAgPGI+SG93IGRvIEkgcGxheT88L2I+DQoJICAgICAgPHA+VXNlIHlvdXIgYXJyb3cga2V5cyBhbmQgc3BhY2UgYmFyISBUaGUgcmVzdCBpcyBlYXN5LSBwaWNrIHlvdXIgcGxheSBhbmQgZ28hPC9wPg0KCSAgICAgIDxiPldoaWNoIGJyb3dzZXIgc2hvdWxkIEkgdXNlPzwvYj4NCgkgICAgICA8cD5Zb3Ugc2hvdWxkIHVzZSBDaHJvbWUuIEl0IGlzIHRoZSBvbmx5IGJyb3dzZXIgZ3VhcmFudGVlZCB0byB3b3JrLiBCYXNlYmFsbCBCcm9zIGhhcyBhbHNvIGJlZW4gdGVzdGVkIHRvIHdvcmsgb24gRmlyZWZveCBhbmQgU2FmYXJpLCBidXQgbm90IGd1YXJhbnRlZWQuPC9wPg0KCSAgICAgIDxiPkFyZSB0aGVyZSBtb3JlIEJyb3MgZ2FtZXM/PC9iPg0KCSAgICAgIDxwPlllcyEgQ2hlY2sgb3V0IDxhIHRhYmluZGV4PSItMSIgaHJlZj0iaHR0cHM6Ly9mb290YmFsbGJyb3MuaW8iPkZvb3RiYWxsIEJyb3M8L2E+LCBocmVmPSJodHRwczovL2Jhc2tldGJyb3MuaW8iPkJhc2tldCBCcm9zPC9hPiwgPGEgdGFiaW5kZXg9Ii0xIiBocmVmPSJodHRwczovL3NvY2NlcmJyb3MuZ2ciPlNvY2NlciBCcm9zPC9hPiBhbmQgPGEgdGFiaW5kZXg9Ii0xIiBocmVmPSJodHRwczovL3dyZXN0bGVicm9zLmlvIj5XcmVzdGxlIEJyb3M8L2E+LiBBbHNvIGJlIHN1cmUgdG8gY2hlY2sgb3V0IDxhIHRhYmluZGV4PSItMSIgaHJlZj0iaHR0cHM6Ly9mcmVlZ2FtZXMuaW8iIHRhcmdldD0iX2JsYW5rIj5XZWIgZ2FtZXMgYXQgRnJlZUdhbWVzLmlvPC9hPjwvcD4NCgkgICAgICA8Yj5EbyB5b3UgaGF2ZSBhIGZhdm9yaXRlIHRlYW0/PC9iPg0KCSAgICAgIDxwPlllcywgYnV0IHdlJ3JlIG5vdCBzYXlpbmcgd2hpY2ggb25lLiBEcm9wIHVzIGFuIGUtbWFpbCBpZiB5b3UgdGhpbmsgeW91IGtub3cuPC9wPg0KCSAgICAgIDxiPkknbSBibG9ja2VkLCB3aGVyZSBlbHNlIGNhbiBpIHBsYXk/PC9iPg0KCSAgICAgIDxwPkNoZWNrIGhlcmUsIHRoZXNlIGxpbmtzIHdvcmsgZm9yIGFsbCB0aGUgYnJvcyBnYW1lczogPGEgaHJlZj0iaHR0cHM6Ly9zaXRlcy5nb29nbGUuY29tL2JsdWV3aXphcmQuY29tL2Jhc2tldC1icm9zLXVuYmxvY2tlZCI+QmFzZWJhbGwgQnJvcyBVbmJsb2NrZWQ8L2E+PC9wPg0KDQoJICAgIDwvZGl2Pg0KCSAgPC9kaXY+DQoJICA8Zm9vdGVyIGlkPSJmb290ZXIiIHRhYmluZGV4PSItMSI+DQoJICAgIDxkaXYgdGFiaW5kZXg9Ii0xIiBjbGFzcz0iZm9vdGVyLWxpbmtzIj4NCgkgICAgICA8YSB0YWJpbmRleD0iLTEiIGhyZWY9Imh0dHBzOi8vYmx1ZXdpemFyZC5jb20iPkNvcHlyaWdodCAyMDI0IEJsdWUgV2l6YXJkIERpZ2l0YWw8L2E+IHwNCgkgICAgICA8YSB0YWJpbmRleD0iLTEiIGhyZWY9Imh0dHBzOi8vYmx1ZXdpemFyZC5jb20vdGVybXMvIj5UZXJtcyBvZiBTZXJ2aWNlPC9hPiB8DQoJICAgICAgPGEgdGFiaW5kZXg9Ii0xIiBocmVmPSJodHRwczovL2JsdWV3aXphcmQuY29tL3ByaXZhY3lwb2xpY3kvIj5Qcml2YWN5IFBvbGljeTwvYT4NCgkgICAgPC9kaXY+DQoJICA8L2Zvb3Rlcj4NCgkgIDxzY3JpcHQ+DQoJICAgIHZhciBsYXN0UmVmcmVzaCA9IDA7DQoNCgkgICAgZnVuY3Rpb24gcmVmcmVzaFRhZyh0aGVUYWcpIHsNCgkgICAgICB0cnkgew0KCSAgICAgICAgYWlwdGFnLmNtZC5kaXNwbGF5LnB1c2goZnVuY3Rpb24oKSB7DQoJICAgICAgICAgIGFpcERpc3BsYXlUYWcucmVmcmVzaCh0aGVUYWcpOw0KCSAgICAgICAgfSk7DQoJICAgICAgICBjb25zb2xlLmxvZygnVGFnIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHknKTsNCgkgICAgICB9IGNhdGNoIChlcnJvcikgew0KCSAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyB0aGUgdGFnOicsIGVycm9yKTsNCgkgICAgICB9DQoJICAgIH0NCg0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDEoZG9SZWZyZXNoKSB7DQoJICAgICAgaWYgKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCg0KCSAgICAgIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCg0KDQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7DQoJICAgICAgICB2YXIgbXMgPSBkLmdldFRpbWUoKTsNCgkgICAgICAgIGlmIChtcyAtIGxhc3RSZWZyZXNoID4gMTAwMDApIHsNCgkgICAgICAgICAgZ0NyYXp5U0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsiYmFzZWJhbGxicm9zLWlvXzE2MHg2MDAiXSk7DQoJICAgICAgICAgIGxhc3RSZWZyZXNoID0gbXM7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Jhc2ViYWxsYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fMTYweDYwMF8yJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlDQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWQnKTsNCg0KCSAgICB9DQoNCgkgICAgdmFyIGxhc3RSZWZyZXNoNiA9IDA7DQoJICAgIHZhciBkb1RhZ09uY2UgPSB0cnVlOw0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDYoKSB7DQoJICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpOw0KCSAgICAgIHZhciBtcyA9IGQuZ2V0VGltZSgpOw0KCSAgICAgIGlmIChtcyAtIGxhc3RSZWZyZXNoNiA8IDEwMDAwKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGxhc3RSZWZyZXNoNiA9IG1zOw0KDQoNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFzZWJhbGxicm9zLWlvXzMwMHgyNTAnKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSB7DQoJICAgICAgICByZXR1cm47DQoJICAgICAgfQ0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCg0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykge30gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fMzAweDI1MCcpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncyA9PSAiIikgew0KCSAgICAgICAgICBpZiAoZG9UYWdPbmNlKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9wcm9zcGVyJyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9wcm9zcGVyJyk7DQoJICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncy5pUHJvc3BlclRlc3QgIT09ICJ1bmRlZmluZWQiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2xlZ2FjeScpOw0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3JlcXVlc3RfbGVnYWN5Jyk7DQoJICAgICAgICB9DQoJICAgICAgICBkb1RhZ09uY2UgPSBmYWxzZTsNCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICB9DQoNCgkgICAgdmFyIGxhc3RSZWZyZXNoMiA9IDA7DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkMigpIHsNCg0KCSAgICAgIHZhciBkID0gbmV3IERhdGUoKTsNCgkgICAgICB2YXIgbXMgPSBkLmdldFRpbWUoKTsNCgkgICAgICBpZiAobXMgLSBsYXN0UmVmcmVzaDIgPCAxMDAwMCkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICBsYXN0UmVmcmVzaDIgPSBtczsNCg0KDQoJICAgICAgaWYgKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18zMDB4MjUwXzInKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KDQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7DQoJICAgICAgICB2YXIgbXMgPSBkLmdldFRpbWUoKTsNCgkgICAgICAgIGlmIChtcyAtIGxhc3RSZWZyZXNoMiA+IDEwMDAwKSB7DQoJICAgICAgICAgIC8vaG5kbGVkIGJ5IHRoZSBmaXJzdCBiYW5uZXIgcmVxdWVzdA0KCSAgICAgICAgICAvL2dDcmF6eVNESy5yZXF1ZXN0QmFubmVyKFt7Y29udGFpbmVySWQ6ICdiYXNlYmFsbGJyb3MtaW9fMzAweDI1MF8yJyxzaXplOiAnMzAweDI1MCcsfV0pOw0KCSAgICAgICAgICBnQ3JhenlTREsucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJiYXNlYmFsbGJyb3MtaW9fMzAweDI1MCIsICJiYXNlYmFsbGJyb3MtaW9fMzAweDI1MF8yIl0pOw0KDQoJICAgICAgICAgIGxhc3RSZWZyZXNoMiA9IG1zOw0KCSAgICAgICAgfQ0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fMzAweDI1MF8yJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgICBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzID09ICIiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX3Byb3NwZXInKTsNCgkgICAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdyZXF1ZXN0X3Byb3NwZXInKTsNCgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcHRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYWlwdGFnLnNldHRpbmdzLmlQcm9zcGVyVGVzdCAhPT0gInVuZGVmaW5lZCIpIHsNCgkgICAgICAgICAgaWYgKGRvVGFnT25jZSkgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfbGVnYWN5Jyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9sZWdhY3knKTsNCgkgICAgICAgIH0NCgkgICAgICB9IGVsc2UNCgkgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAnYmFubmVyX2FkYmxvY2tlZCcpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkMygpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFzZWJhbGxicm9zLWlvXzcyOHg5MCcpOw0KCSAgICAgIGlmIChsID09IG51bGwpIHJldHVybjsNCgkgICAgICBsLnN0eWxlLmRpc3BsYXkgPSAnJzsNCgkgICAgICBsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBnQ3JhenlTREsucmVxdWVzdFJlc3BvbnNpdmVCYW5uZXIoWyJiYXNlYmFsbGJyb3MtaW9fNzI4eDkwIl0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fNzI4eDkwJyk7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9iYW5uZXJfcmVxdWVzdGVkJyk7DQoJICAgICAgfSBlbHNlDQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWQnKTsNCg0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkNCgpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCAxMjAwKSByZXR1cm47DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18zMzZ4MjgwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbImJhc2ViYWxsYnJvcy1pb18zMzZ4MjgwIl0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fMzM2eDI4MCcpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncyA9PSAiIikgew0KCSAgICAgICAgICBpZiAoZG9UYWdPbmNlKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9wcm9zcGVyJyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9wcm9zcGVyJyk7DQoJICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncy5pUHJvc3BlclRlc3QgIT09ICJ1bmRlZmluZWQiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2xlZ2FjeScpOw0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3JlcXVlc3RfbGVnYWN5Jyk7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlDQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWQnKTsNCg0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkNygpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCAxMjAwKSByZXR1cm47DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18zMzZ4MjgwXzInKTsNCgkgICAgICBpZiAobCA9PSBudWxsKSByZXR1cm47DQoJICAgICAgbC5zdHlsZS5kaXNwbGF5ID0gJyc7DQoJICAgICAgbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOw0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgZ0NyYXp5U0RLLnJlcXVlc3RSZXNwb25zaXZlQmFubmVyKFsiYmFzZWJhbGxicm9zLWlvXzMzNngyODBfMiJdKTsNCgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXBEaXNwbGF5VGFnICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgcmVmcmVzaFRhZygnYmFzZWJhbGxicm9zLWlvXzMzNngyODBfMicpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncyA9PSAiIikgew0KCSAgICAgICAgICBpZiAoZG9UYWdPbmNlKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9wcm9zcGVyJyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9wcm9zcGVyJyk7DQoJICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncy5pUHJvc3BlclRlc3QgIT09ICJ1bmRlZmluZWQiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2xlZ2FjeScpOw0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3JlcXVlc3RfbGVnYWN5Jyk7DQoJICAgICAgICB9DQoJICAgICAgfSBlbHNlDQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWQnKTsNCg0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gU2hvd0FkOCgpIHsNCgkgICAgICBpZiAoL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgew0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCgkgICAgICB2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmFzZWJhbGxicm9zLWlvXzcyOHg5MF9tJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbImJhc2ViYWxsYnJvcy1pb183Mjh4OTAiXSk7DQoJICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWlwRGlzcGxheVRhZyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIHJlZnJlc2hUYWcoJ2Jhc2ViYWxsYnJvcy1pb183Mjh4OTBfbScpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgIH0gZWxzZQ0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdiYW5uZXJfYWRibG9ja2VkJyk7DQoNCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIFNob3dBZDkoKSB7DQoJICAgICAgaWYgKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb185NzB4MjUwJyk7DQoJICAgICAgaWYgKGwgPT0gbnVsbCkgcmV0dXJuOw0KCSAgICAgIGwuc3R5bGUuZGlzcGxheSA9ICcnOw0KCSAgICAgIGwuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGdDcmF6eVNESy5yZXF1ZXN0UmVzcG9uc2l2ZUJhbm5lcihbImJhc2ViYWxsYnJvcy1pb185NzB4MjUwIl0pOw0KCSAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFpcERpc3BsYXlUYWcgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICByZWZyZXNoVGFnKCdiYXNlYmFsbGJyb3MtaW9fOTcweDI1MCcpOw0KCSAgICAgICAgU2VuZEV2ZW50KCdldmVudCcsICdhaXBfYmFubmVyX3JlcXVlc3RlZCcpOw0KCSAgICAgICAgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncyA9PSAiIikgew0KCSAgICAgICAgICBpZiAoZG9UYWdPbmNlKSBTZW5kRXZlbnQoJ2V2ZW50JywgJ2FpcF9wcm9zcGVyJyk7DQoJICAgICAgICAgIFNlbmRFdmVudCgnZXZlbnQnLCAncmVxdWVzdF9wcm9zcGVyJyk7DQoJICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhaXB0YWcgIT09ICd1bmRlZmluZWQnICYmIGFpcHRhZy5zZXR0aW5ncy5pUHJvc3BlclRlc3QgIT09ICJ1bmRlZmluZWQiKSB7DQoJICAgICAgICAgIGlmIChkb1RhZ09uY2UpIFNlbmRFdmVudCgnZXZlbnQnLCAnYWlwX2xlZ2FjeScpOw0KCSAgICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ3JlcXVlc3RfbGVnYWN5Jyk7DQoJICAgICAgICB9DQoNCg0KCSAgICAgICAgZG9UYWdPbmNlID0gZmFsc2U7DQoJICAgICAgfSBlbHNlIHsNCgkgICAgICAgIGwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybChhc3NldHMvdHVybm9mZjIuanBnKSI7DQoJICAgICAgICBTZW5kRXZlbnQoJ2V2ZW50JywgJ2Jhbm5lcl9hZGJsb2NrZWRfbWVzc2FnZV9zaG93bicpOw0KCSAgICAgIH0NCg0KCSAgICB9DQoNCg0KDQoNCg0KCSAgICBmdW5jdGlvbiByaWdodChzdHIsIGNocikgew0KCSAgICAgIHJldHVybiBzdHIuc2xpY2Uoc3RyLmxlbmd0aCAtIGNociwgc3RyLmxlbmd0aCk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTZXRDR0ludml0ZUxpbmsoKSB7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZ2xpbmsiKTsNCgkgICAgICAgIHZhciBhU3RyID0gbWV0YS52YWx1ZTsNCgkgICAgICAgIGFTdHIgPSByaWdodChhU3RyLCA4KTsNCgkgICAgICAgIHZhciBhQ0dMaW5rID0gZ0NyYXp5U0RLLmludml0ZUxpbmsoew0KCSAgICAgICAgICByb29tSWQ6IGFTdHINCgkgICAgICAgIH0pOw0KCSAgICAgICAgbWV0YS52YWx1ZSA9IGFDR0xpbms7DQoJICAgICAgICBtZXRhLnNlbGVjdA0KCSAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ0NvcHknKQ0KCSAgICAgICAgY29uc29sZS5sb2coIkNPUElFRCBDRyBVUkwiKTsNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTaG93QWRCcmVhaygpIHsNCgkgICAgICAvL2NoZWNrIGlmIHRoZSBhZHNsaWIgaXMgbG9hZGVkIGNvcnJlY3RseSBvciBibG9ja2VkIGJ5IGFkYmxvY2tlcnMgZXRjLg0KCSAgICAgIGlmICh0eXBlb2YgZ0NyYXp5U0RLICE9PSAndW5kZWZpbmVkJykgew0KCSAgICAgICAgTWFpbi5Eb25lSW50ZXJzdGl0aWFsQWQoZmFsc2UpOw0KCSAgICAgICAgcmV0dXJuOw0KCSAgICAgIH0NCg0KCSAgICAgIGlmICh0eXBlb2YgYWRwbGF5ZXIgPT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBNYWluLkRvbmVJbnRlcnN0aXRpYWxBZCh0cnVlKTsNCgkgICAgICAgIHJldHVybjsNCgkgICAgICB9DQoJICAgICAgYWlwdGFnLmNtZC5wbGF5ZXIucHVzaChmdW5jdGlvbigpIHsNCgkgICAgICAgIGFkcGxheWVyLnN0YXJ0QWRCcmVhaygpOw0KCSAgICAgIH0pOw0KCSAgICB9DQoNCg0KCSAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3BlbmZsLWNvbnRlbnQiKS5hZGRFdmVudExpc3RlbmVyKCJ3aGVlbCIsIGRvU2Nyb2xsKTsNCgkgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vcmUiKS5hZGRFdmVudExpc3RlbmVyKCJ3aGVlbCIsIGRvU2Nyb2xsKTsNCg0KCSAgICBmdW5jdGlvbiBkb1Njcm9sbChldmVudCkgew0KCSAgICAgIHdpbmRvdy5zY3JvbGwoMCwgd2luZG93LnNjcm9sbFkgKyBldmVudC5kZWx0YVkpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gZG9TY3JvbGwyKGV2ZW50KSB7DQoJICAgICAgd2luZG93LnNjcm9sbCgwLCB3aW5kb3cuc2Nyb2xsWSArIGV2ZW50LmRlbHRhWSk7DQoJICAgIH0NCg0KDQoJICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KCSAgICAgIC8vY29uc29sZS5sb2coImFjdGl2ZSBlbGVtZW50OiIgKyBkb2N1bWVudC5hY3RpdmVFbGVtZW50KTsNCgkgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC50YWdOYW1lID09ICJJRlJBTUUiKSB7DQoJICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTsNCgkgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgICAgICAvL2NvbnNvbGUubG9nKCdyZWZvY3VzaW5nJyk7DQoJICAgICAgfQ0KCSAgICB9LCAzMCk7DQoNCg0KCSAgICAvKnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgDQoJICAgIAl2YXIgbCA9IHdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcm9sbCcpOw0KCSAgICAJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgIT09ICd2aXNpYmxlJykgew0KCSAgICAJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpLmZvY3VzKCk7DQoJICAgIAkJaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KQ0KCSAgICAJCXsNCgkgICAgCQkJLy9kb2N1bWVudC5hY3RpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQoJICAgIAkJCXdpbmRvdy5mb2N1cygpOw0KCSAgICAJCQl3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5mbC1jb250ZW50JykuZm9jdXMoKTsNCgkgICAgCQl9DQoJICAgIAl9DQoJICAgIH0sIDEwMDApOyovDQoNCg0KCSAgICAvKgkJc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyANCgkgICAgCQkJdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18xNjB4NjAwJyk7DQoJICAgIAkJCWlmKGwgIT0gbnVsbCAmJiB0eXBlb2YgbC5zdHlsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbC5zdHlsZS52aXNpYmlsaXR5ID09ICd2aXNpYmxlJykgew0KCSAgICAJCQkJU2hvd0FkNSgpOw0KCSAgICAJCQl9DQoJICAgIAkJfSwgMzAwMDApOw0KDQoJICAgIAkJc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyANCgkgICAgCQkJdmFyIGwgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhc2ViYWxsYnJvcy1pb18xNjB4NjAwXzInKTsNCgkgICAgCQkJaWYobCAhPSBudWxsICYmIHR5cGVvZiBsLnN0eWxlICE9PSAndW5kZWZpbmVkJyAmJiBsLnN0eWxlLnZpc2liaWxpdHkgPT0gJ3Zpc2libGUnKSB7DQoJICAgIAkJCQlTaG93QWQxKCk7DQoJICAgIAkJCX0NCgkgICAgCQl9LCAzMjAwMCk7Ki8NCg0KCSAgICB2YXIgc2lkID0gJzAyazA2ZXRtcDZmbmFkNnFrMmU4MnMxZGZpJw0KDQoJICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXR1cyhmcm9tRXZlbnQgPSBmYWxzZSkgew0KCSAgICAgIGNvbnN0IHJlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOw0KCSAgICAgIHZhciBhU3RyID0gInJlY29yZHNlc3Npb24ucGhwP3M9IiArIHNpZDsNCgkgICAgICBpZiAoZnJvbUV2ZW50ID09IHRydWUpIGFTdHIgPSBhU3RyICsgIiZlPTEiDQoJICAgICAgcmVxLm9wZW4oIkdFVCIsIGFTdHIpOw0KCSAgICAgIHJlcS5zZW5kKCk7DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBTZW5kRXZlbnQodGhlRXZlbnQsIHRoZUFjdGlvbiwgdGhlUGFybXMgPSAnJykgew0KCSAgICAgIGlmICh0aGVQYXJtcyA9PSAnJykgew0KCSAgICAgICAgZ3RhZyh0aGVFdmVudCwgdGhlQWN0aW9uKTsNCgkgICAgICB9IGVsc2Ugew0KCSAgICAgICAgZ3RhZyh0aGVFdmVudCwgdGhlQWN0aW9uLCB0aGVQYXJtcyk7DQoJICAgICAgfQ0KCSAgICAgIHVwZGF0ZVN0YXR1cyh0cnVlKTsNCgkgICAgICAvL2NvbnNvbGUubG9nKCJTZW5kaW5nIGV2ZW50OiAiICsgdGhlRXZlbnQgKyAiLyIgKyB0aGVBY3Rpb24gKyAiLyIgKyB0aGVQYXJtcyk7DQoJICAgIH0NCgkgICAgLy9zZXRJbnRlcnZhbChmdW5jdGlvbigpIHsgdXBkYXRlU3RhdHVzLCA0KjYwKjEwMDApOwkJCQ0KCSAgICAvL3NldEludGVydmFsKCBmdW5jdGlvbigpIHsgDQoJICAgIC8vCXdpbmRvdy5zY3JvbGxUbygwLCAwKTsgDQoJICAgIC8vfSwgMjAwMCApOwkJCQkJDQoJICAgIHVwZGF0ZVN0YXR1cyh0cnVlKTsNCg0KCSAgICAvL3NldEludGVydmFsKENsZWFyQWRzLCAyMDAwKTsJCQ0KDQoJICAgIGZ1bmN0aW9uIEVtYWlsU2lnbnVwKCkgew0KCSAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2lnbnVwIikgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRlbGV0ZW1lIikpIHJldHVybjsNCgkgICAgICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsNCg0KCSAgICAgIC8vCQkJaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KCSAgICAgIGlmcmFtZS5zdHlsZS53aWR0aCA9ICI1NTBweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9ICIiICsgd2luZG93LmlubmVySGVpZ2h0IC0gMTAwICsgInB4IjsNCgkgICAgICBpZnJhbWUuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOw0KCSAgICAgIGlmcmFtZS5zdHlsZS50b3AgPSAiNTBweCI7DQoJICAgICAgaWZyYW1lLnN0eWxlLmxlZnQgPSAiNTAlIjsNCgkgICAgICBpZnJhbWUuc3R5bGVbIm1hcmdpbi1sZWZ0Il0gPSAiLTIyNXB4IjsNCgkgICAgICAvL2lmcmFtZS5zdHlsZVsibWFyZ2luLXJpZ2h0Il0gPSAiLTI3NXB4IjsNCgkgICAgICBpZnJhbWUuc3R5bGVbIm1heC13aWR0aCJdID0gIjEwMCUiOw0KCSAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoImlkIiwgInNpZ251cCIpOw0KDQoJICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpOw0KCSAgICB9DQoNCgkgICAgZnVuY3Rpb24gR2FtZVBsYXlTdGFydCgpIHsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCJHYW1lUGxheVN0YXJ0Iik7DQoJICAgICAgICBnQ3JhenlTREsuZ2FtZXBsYXlTdGFydCgpOw0KCSAgICAgIH0NCgkgICAgfQ0KDQoJICAgIGZ1bmN0aW9uIEdhbWVQbGF5U3RvcCgpIHsNCgkgICAgICBpZiAodHlwZW9mIGdDcmF6eVNESyAhPT0gJ3VuZGVmaW5lZCcpIHsNCgkgICAgICAgIGNvbnNvbGUubG9nKCJHYW1lUGxheVN0b3AiKTsNCgkgICAgICAgIGdDcmF6eVNESy5nYW1lcGxheVN0b3AoKTsNCgkgICAgICB9DQoJICAgIH0NCg0KCSAgICBmdW5jdGlvbiBIYXBweVRpbWUoKSB7DQoJICAgICAgaWYgKHR5cGVvZiBnQ3JhenlTREsgIT09ICd1bmRlZmluZWQnKSB7DQoJICAgICAgICBjb25zb2xlLmxvZygiaGFwcHl0aW1lIik7DQoJICAgICAgICBnQ3JhenlTREsuaGFwcHl0aW1lKCk7DQoJICAgICAgfQ0KCSAgICB9DQoNCgkgICAgdmFyIHNjcm9sbGVyTWVzc2FnZSA9ICIgV0VMQ09NRSBUTyBCQVNFQkFMTCBCUk9TISBBUkUgWU9VIFJFQURZIFRPIEhJVCBTT01FIE5VS0VTPyBXRSdSRSBTVElMTCBNQUtJTkcgQURKVVNUTUVOVFMtIFlPVSBDQU4gQ0hFQ0sgVEhFIEJPVFRPTSBPRiBUSEUgUEFHRSBGT1IgVEhFIExBVEVTVCBDSEFOR0VTISBJRiBZT1UgSEFWRSBBIEdMSVRDSCBPUiBGRUVEQkFDSywgWU9VIENBTiBFTUFJTCBJTkZPQEJMVUVXSVpBUkQuQ09NISEhICI7DQoNCgkgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuZmwtY29udGVudCcpOw0KCSAgICAvLyBGdW5jdGlvbiB0byBrZWVwIHRoZSBlbGVtZW50IGZvY3VzZWQNCgkgICAgZnVuY3Rpb24ga2VlcEZvY3VzKCkgew0KCSAgICAgIGVsZW1lbnQuZm9jdXMoKTsNCgkgICAgfQ0KCSAgICAvLyBFdmVudCBsaXN0ZW5lcnMgdG8gcmVzdG9yZSBmb2N1cyB3aGVuIGxvc3QNCgkgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywga2VlcEZvY3VzKTsNCgkgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGtlZXBGb2N1cyk7DQoJICA8L3NjcmlwdD4NCgk8L2JvZHk+DQoNCgk8L2h0bWw+";
